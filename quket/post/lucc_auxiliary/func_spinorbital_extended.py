from math import fsum
from itertools import product, groupby, chain
from operator import itemgetter

from numpy import einsum, array, zeros, isclose, outer, where

from quket.fileio.fileio import prints


#                            Frozen || Core | Active || Secondary
#                              nf   ||  nc  |   na   ||    ns
#
#    integrals                 nf   ||  nc  |   na   ||    ns
#    integrals_active               ||      |   na   ||
#    H_tlide                   nf   ||  nc  |   na   ||    ns
#    1234RDM                        ||      |   na   ||
#    excitation_list                ||  nc  |   na   ||    ns


####  This is the main driver that call subroutines  ###########################


def do_spinorbital_extended(Quket, HD, y_excitation_list, x_excitation_list):

    from quket.post.lucc_auxiliary.interface import \
            sort_by_space_spin, \
            fullspin_to_spaceorbital, \
            shift_index_by_n, \
            get_bound_for_active_space, \
            get_bound_for_extended_space

    #=== Setting some constants ===============================================#
    # No need to multiply by 2
    nCor = Quket.n_core_orbitals
    nAct = Quket.n_active_orbitals
    ActFloor, ActCeil = get_bound_for_active_space(Quket)
    CoreFloor = get_bound_for_extended_space(Quket)[0]

    #=== Prepare a matrix to contain einsum results ===========================#
    y_excitation_list = tuple( tuple(x) for x in y_excitation_list)
    x_excitation_list = tuple( tuple(x) for x in x_excitation_list)
    Amat_dimension = len(y_excitation_list), len(x_excitation_list)
    Amat = zeros(Amat_dimension)

    #=== Analysising the excitation_list ======================================#
    # Sort and Transpose
    tv_excitation_list, \
    tv_spacetypes, \
    tv_spintypes, \
    tv_paritys = zip(*(
        sort_by_space_spin(2*nCor, 2*(nCor+nAct), e)
        for e in y_excitation_list) )

    pr_excitation_list, \
    pr_spacetypes, \
    pr_spintypes, \
    pr_paritys = zip(*(
        sort_by_space_spin(2*nCor, 2*(nCor+nAct), e)
        for e in x_excitation_list) )

    # Compress index from full-spin to space-orbital
    tv_excitation_list = fullspin_to_spaceorbital(tv_excitation_list)
    pr_excitation_list = fullspin_to_spaceorbital(pr_excitation_list)

    #=== Do Einsums ===========================================================#

    #--- [H, tv]
    for i, (tv_excite, tv_space, tv_spin, p1) in enumerate(zip(tv_excitation_list, tv_spacetypes, tv_spintypes, tv_paritys)):
        tv_is_pureA = set(tv_space) == {'A'}
        if tv_is_pureA:
            tv_excite_AA = shift_index_by_n(tv_excite, n=-nCor)

        #--- [ [H, pr] , tv]
        for j, (pr_excite, pr_space, pr_spin, p2) in enumerate(zip(pr_excitation_list, pr_spacetypes, pr_spintypes, pr_paritys)):
            pr_is_pureA = set(pr_space) == {'A'}
            if pr_is_pureA:
                pr_excite_AA = shift_index_by_n(pr_excite, n=-nCor)

            #--- Compute the actually value of double commutator
            func_key = f"{pr_space}{pr_spin}_{tv_space}{tv_spin}"

            if func_key in FUNCMAPPER:
                if pr_is_pureA and tv_is_pureA:
                    e = (pr_excite_AA, tv_excite_AA)
                else:
                    e = (pr_excite, tv_excite)

                Amat[i,j] = -FUNCMAPPER[func_key](ActFloor, ActCeil, HD, *e) \
                            if p1^p2 else \
                            FUNCMAPPER[func_key](ActFloor, ActCeil, HD, *e)

    return 0.5 * Amat


####  Subroutinues are under this line  ########################################

def lucc_AAaa(actfloor, actceil, HD, *e):
    (p,r) = e
    result = 0
    result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaa'][r,:,:,:] ) ,
                     +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaa'][p,:,:,:] ) ))
    result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daa'][r,:] ) ,
                         -einsum( 'i,i->', HD['Haa'][r,:], HD['Daa'][p,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dabab'][r,:,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dabab'][p,:,:,:] ) ))
    return result


def lucc_AAaa_AAaa(actfloor, actceil, HD, *e):
    (p,r),(t,v) = e
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['Haaaa'][r,v,:,:], HD['Daaaa'][p,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][r,t,:,:], HD['Daaaa'][p,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][p,v,:,:], HD['Daaaa'][r,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][p,t,:,:], HD['Daaaa'][r,v,:,:] ) ))
    result += 2 * fsum(( +HD['Haa'][p,t] * HD['Daa'][r,v] ,
                         -HD['Haa'][p,v] * HD['Daa'][r,t] ,
                         -HD['Haa'][r,t] * HD['Daa'][p,v] ,
                         +HD['Haa'][r,v] * HD['Daa'][p,t] ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,:,t,:], HD['Daaaa'][r,:,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,:,v,:], HD['Daaaa'][r,:,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,:,t,:], HD['Daaaa'][p,:,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,:,v,:], HD['Daaaa'][p,:,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][p,:,t,:], HD['Dabab'][r,:,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][p,:,v,:], HD['Dabab'][r,:,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][r,:,t,:], HD['Dabab'][p,:,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][r,:,v,:], HD['Dabab'][p,:,t,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaa'][t,:,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Daa'][t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dabab'][t,:,:,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaa'][v,:,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daa'][v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dabab'][v,:,:,:] ) ))
    if p==v:
        result += -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaa'][t,:,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][r,:], HD['Daa'][t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dabab'][t,:,:,:] ) ))
    if p==t:
        result += +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaa'][v,:,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][r,:], HD['Daa'][v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dabab'][v,:,:,:] ) ))
    return result


def lucc_AAaa_AAbb(actfloor, actceil, HD, *e):
    (p,r),(t,v) = e
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Habba'][p,:,t,:], HD['Dabba'][r,:,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][p,:,v,:], HD['Dabba'][r,:,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][r,:,t,:], HD['Dabba'][p,:,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][r,:,v,:], HD['Dabba'][p,:,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbaab'][t,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbaab'][v,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbaab'][t,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbaab'][v,p,:,:] ) ))
    return result


def lucc_AAaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(t,u,v,w) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Haaaa'][p,w,:,:], HD['Daaaaaa'][r,t,u,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][p,v,:,:], HD['Daaaaaa'][r,t,u,w,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][p,t,:,:], HD['Daaaaaa'][r,v,w,u,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][p,u,:,:], HD['Daaaaaa'][r,v,w,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][r,w,:,:], HD['Daaaaaa'][p,t,u,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][r,v,:,:], HD['Daaaaaa'][p,t,u,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][r,t,:,:], HD['Daaaaaa'][p,v,w,u,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][r,u,:,:], HD['Daaaaaa'][p,v,w,t,:,:] ) ))
    result += 2 * fsum(( +HD['Haa'][p,t] * HD['Daaaa'][r,u,v,w] ,
                         -HD['Haa'][p,u] * HD['Daaaa'][r,t,v,w] ,
                         +HD['Haa'][p,w] * HD['Daaaa'][r,v,t,u] ,
                         -HD['Haa'][p,v] * HD['Daaaa'][r,w,t,u] ,
                         -HD['Haa'][r,t] * HD['Daaaa'][p,u,v,w] ,
                         +HD['Haa'][r,u] * HD['Daaaa'][p,t,v,w] ,
                         -HD['Haa'][r,w] * HD['Daaaa'][p,v,t,u] ,
                         +HD['Haa'][r,v] * HD['Daaaa'][p,w,t,u] ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,:,t,:], HD['Daaaaaa'][r,u,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,:,u,:], HD['Daaaaaa'][r,t,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,:,w,:], HD['Daaaaaa'][r,v,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,:,v,:], HD['Daaaaaa'][r,w,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,:,t,:], HD['Daaaaaa'][p,u,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,:,u,:], HD['Daaaaaa'][p,t,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,:,w,:], HD['Daaaaaa'][p,v,:,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,:,v,:], HD['Daaaaaa'][p,w,:,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][t,u,p,:], HD['Daaaa'][v,w,r,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][v,w,r,:], HD['Daaaa'][t,u,p,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][v,w,p,:], HD['Daaaa'][t,u,r,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][t,u,r,:], HD['Daaaa'][v,w,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][p,:,t,:], HD['Daabaab'][r,u,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][p,:,u,:], HD['Daabaab'][r,t,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][p,:,w,:], HD['Daabaab'][r,v,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][p,:,v,:], HD['Daabaab'][r,w,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][r,:,t,:], HD['Daabaab'][p,u,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][r,:,u,:], HD['Daabaab'][p,t,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][r,:,w,:], HD['Daabaab'][p,v,:,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][r,:,v,:], HD['Daabaab'][p,w,:,t,u,:] ) ))
    if r==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][t,u,:,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,v,:,:], HD['Daaaa'][t,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][t,u,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][t,u,:,v,:,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][t,u,:,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,w,:,:], HD['Daaaa'][t,u,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][t,u,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][t,u,:,w,:,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][v,w,:,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,u,:,:], HD['Daaaa'][v,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][v,w,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][v,w,:,u,:,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][v,w,:,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,t,:,:], HD['Daaaa'][v,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][v,w,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][v,w,:,t,:,:] ) ))
    if p==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][t,u,:,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,v,:,:], HD['Daaaa'][t,u,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][t,u,v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][t,u,:,v,:,:] ) ))
    if p==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][t,u,:,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,w,:,:], HD['Daaaa'][t,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][t,u,w,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][t,u,:,w,:,:] ) ))
    if p==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][v,w,:,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,u,:,:], HD['Daaaa'][v,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][v,w,u,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][v,w,:,u,:,:] ) ))
    if p==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][v,w,:,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,t,:,:], HD['Daaaa'][v,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][v,w,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][v,w,:,t,:,:] ) ))
    return result


def lucc_AAaa_AAAAbaba(actfloor, actceil, HD, *e):
    (p,r),(t,u,v,w) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Haaaa'][r,w,:,:], HD['Dbaabaa'][t,p,u,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][r,u,:,:], HD['Dbaabaa'][v,p,w,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][p,w,:,:], HD['Dbaabaa'][t,r,u,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][p,u,:,:], HD['Dbaabaa'][v,r,w,t,:,:] ) ))
    result += 2 * fsum(( -HD['Haa'][p,u] * HD['Dbaab'][t,r,w,v] ,
                         +HD['Haa'][p,w] * HD['Dbaab'][v,r,u,t] ,
                         +HD['Haa'][r,u] * HD['Dbaab'][t,p,w,v] ,
                         -HD['Haa'][r,w] * HD['Dbaab'][v,p,u,t] ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,:,u,:], HD['Dbaaaba'][t,r,:,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,:,w,:], HD['Dbaaaba'][v,r,:,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,:,u,:], HD['Dbaaaba'][t,p,:,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,:,w,:], HD['Dbaaaba'][v,p,:,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][r,:,w,:], HD['Dbababb'][v,p,:,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][p,:,u,:], HD['Dbababb'][t,r,:,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][r,:,u,:], HD['Dbababb'][t,p,:,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][p,:,w,:], HD['Dbababb'][v,r,:,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][p,:,t,:], HD['Daababa'][r,u,:,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][r,:,v,:], HD['Daababa'][p,w,:,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][p,:,v,:], HD['Daababa'][r,w,:,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][r,:,t,:], HD['Daababa'][p,u,:,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbaaaab'][t,p,u,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbaaaab'][t,r,u,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbaaaab'][v,p,w,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbaaaab'][v,r,w,u,:,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][t,u,p,:], HD['Dbaab'][v,w,r,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][t,u,r,:], HD['Dbaab'][v,w,p,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][v,w,p,:], HD['Dbaab'][t,u,r,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][v,w,r,:], HD['Dbaab'][t,u,p,:] ) ))
    if r==w:
        result += -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Dbaabaa'][t,u,:,v,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Dbaba'][t,u,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dbabbab'][t,u,:,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbaab'][t,u,:,:] ) ))
    if r==u:
        result += +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Dbaabaa'][v,w,:,t,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Dbaba'][v,w,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dbabbab'][v,w,:,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbaab'][v,w,:,:] ) ))
    if p==w:
        result += +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Dbaabaa'][t,u,:,v,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][r,:], HD['Dbaba'][t,u,v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dbabbab'][t,u,:,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbaab'][t,u,:,:] ) ))
    if p==u:
        result += -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Dbaabaa'][v,w,:,t,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][r,:], HD['Dbaba'][v,w,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dbabbab'][v,w,:,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbaab'][v,w,:,:] ) ))
    return result


def lucc_AAaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(t,u,v,w) = e
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Habba'][p,:,t,:], HD['Dbabbba'][u,r,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][p,:,u,:], HD['Dbabbba'][t,r,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][p,:,w,:], HD['Dbabbba'][v,r,:,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][p,:,v,:], HD['Dbabbba'][w,r,:,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][r,:,t,:], HD['Dbabbba'][u,p,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][r,:,u,:], HD['Dbabbba'][t,p,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][r,:,w,:], HD['Dbabbba'][v,p,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][r,:,v,:], HD['Dbabbba'][w,p,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][w,p,:,:], HD['Dbbabab'][t,u,r,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbbabab'][t,u,r,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbbabab'][v,w,r,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][u,p,:,:], HD['Dbbabab'][v,w,r,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][w,r,:,:], HD['Dbbabab'][t,u,p,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbbabab'][t,u,p,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbbabab'][v,w,p,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][u,r,:,:], HD['Dbbabab'][v,w,p,t,:,:] ) ))
    return result


def lucc_AAbb(actfloor, actceil, HD, *e):
    (p,r) = e
    result = 0
    result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbb'][r,:,:,:] ) ,
                     +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbb'][p,:,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaab'][r,:,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaab'][p,:,:,:] ) ,
                         +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbb'][r,:] ) ,
                         -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbb'][p,:] ) ))
    return result


def lucc_AAbb_AAaa(actfloor, actceil, HD, *e):
    (p,r),(t,v) = e
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Hbaab'][p,:,t,:], HD['Dbaab'][r,:,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,v,:], HD['Dbaab'][r,:,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,t,:], HD['Dbaab'][p,:,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,v,:], HD['Dbaab'][p,:,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,v,:,:], HD['Dbaab'][r,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,t,:,:], HD['Dbaab'][r,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,v,:,:], HD['Dbaab'][p,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,t,:,:], HD['Dbaab'][p,v,:,:] ) ))
    return result


def lucc_AAbb_AAbb(actfloor, actceil, HD, *e):
    (p,r),(t,v) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbb'][r,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbb'][r,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbb'][p,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbb'][p,v,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbaba'][r,:,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbaba'][r,:,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbaba'][p,:,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbaba'][p,:,t,:] ) ,
                         +HD['Hbb'][p,t] * HD['Dbb'][r,v] ,
                         -HD['Hbb'][p,v] * HD['Dbb'][r,t] ,
                         -HD['Hbb'][r,t] * HD['Dbb'][p,v] ,
                         +HD['Hbb'][r,v] * HD['Dbb'][p,t] ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbbbb'][r,:,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbbbb'][r,:,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbbbb'][p,:,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbbbb'][p,:,t,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbb'][t,:,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaab'][t,:,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbb'][t,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbb'][v,:,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaab'][v,:,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbb'][v,:] ) ))
    if p==v:
        result += -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbb'][t,:,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaab'][t,:,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbb'][t,:] ) ))
    if p==t:
        result += +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbb'][v,:,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaab'][v,:,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbb'][v,:] ) ))
    return result


def lucc_AAbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(t,u,v,w) = e
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['Hbaab'][p,:,t,:], HD['Dbaaaab'][r,u,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,u,:], HD['Dbaaaab'][r,t,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,w,:], HD['Dbaaaab'][r,v,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,v,:], HD['Dbaaaab'][r,w,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,t,:], HD['Dbaaaab'][p,u,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,u,:], HD['Dbaaaab'][p,t,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,w,:], HD['Dbaaaab'][p,v,:,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,v,:], HD['Dbaaaab'][p,w,:,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbaaaab'][r,t,u,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,v,:,:], HD['Dbaaaab'][r,t,u,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,t,:,:], HD['Dbaaaab'][r,v,w,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbaaaab'][r,v,w,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbaaaab'][p,t,u,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,v,:,:], HD['Dbaaaab'][p,t,u,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,t,:,:], HD['Dbaaaab'][p,v,w,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbaaaab'][p,v,w,t,:,:] ) ))
    return result


def lucc_AAbb_AAAAbaba(actfloor, actceil, HD, *e):
    (p,r),(t,u,v,w) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbaabb'][p,t,u,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbaabb'][p,v,w,u,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbaabb'][r,t,u,w,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbaabb'][r,v,w,u,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Hbaab'][p,:,w,:], HD['Dbbaabb'][r,v,:,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,w,:], HD['Dbbaabb'][p,v,:,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,u,:], HD['Dbbaabb'][r,t,:,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,u,:], HD['Dbbaabb'][p,t,:,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbbabab'][p,v,w,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbbabab'][r,v,w,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbbabab'][p,t,u,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbbabab'][r,t,u,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbaaaba'][p,w,:,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbaaaba'][r,w,:,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbaaaba'][p,u,:,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbaaaba'][r,u,:,w,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][v,w,p,:], HD['Dbaba'][t,u,r,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][v,w,r,:], HD['Dbaba'][t,u,p,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][t,u,p,:], HD['Dbaba'][v,w,r,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][t,u,r,:], HD['Dbaba'][v,w,p,:] ) ,
                         -HD['Hbb'][p,t] * HD['Dbaab'][r,u,w,v] ,
                         +HD['Hbb'][p,v] * HD['Dbaab'][r,w,u,t] ,
                         +HD['Hbb'][r,t] * HD['Dbaab'][p,u,w,v] ,
                         -HD['Hbb'][r,v] * HD['Dbaab'][p,w,u,t] ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbababb'][r,u,:,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbababb'][r,w,:,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbababb'][p,u,:,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbababb'][p,w,:,u,t,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][t,u,:,w,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][t,u,:,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbaab'][t,u,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][t,u,w,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][v,w,:,u,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][v,w,:,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbaab'][v,w,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][v,w,u,:] ) ))
    if p==v:
        result += -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][t,u,:,w,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][t,u,:,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbaab'][t,u,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][t,u,w,:] ) ))
    if p==t:
        result += +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][v,w,:,u,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][v,w,:,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbaab'][v,w,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][v,w,u,:] ) ))
    return result


def lucc_AAbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(t,u,v,w) = e
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbbbb'][p,v,w,u,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,u,:,:], HD['Dbbbbbb'][p,v,w,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,w,:,:], HD['Dbbbbbb'][r,t,u,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbbbb'][r,t,u,w,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbbbb'][r,v,w,u,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,u,:,:], HD['Dbbbbbb'][r,v,w,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,w,:,:], HD['Dbbbbbb'][p,t,u,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbbbb'][p,t,u,w,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbbabba'][r,u,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,u,:], HD['Dbbabba'][r,t,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,w,:], HD['Dbbabba'][r,v,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbbabba'][r,w,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbbabba'][p,u,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,u,:], HD['Dbbabba'][p,t,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,w,:], HD['Dbbabba'][p,v,:,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbbabba'][p,w,:,t,u,:] ) ,
                         +HD['Hbb'][p,t] * HD['Dbbbb'][r,u,v,w] ,
                         -HD['Hbb'][p,u] * HD['Dbbbb'][r,t,v,w] ,
                         +HD['Hbb'][p,w] * HD['Dbbbb'][r,v,t,u] ,
                         -HD['Hbb'][p,v] * HD['Dbbbb'][r,w,t,u] ,
                         -HD['Hbb'][r,t] * HD['Dbbbb'][p,u,v,w] ,
                         +HD['Hbb'][r,u] * HD['Dbbbb'][p,t,v,w] ,
                         -HD['Hbb'][r,w] * HD['Dbbbb'][p,v,t,u] ,
                         +HD['Hbb'][r,v] * HD['Dbbbb'][p,w,t,u] ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbbbbbb'][r,u,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,u,:], HD['Dbbbbbb'][r,t,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,w,:], HD['Dbbbbbb'][r,v,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbbbbbb'][r,w,:,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbbbbbb'][p,u,:,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,u,:], HD['Dbbbbbb'][p,t,:,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,w,:], HD['Dbbbbbb'][p,v,:,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbbbbbb'][p,w,:,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][t,u,p,:], HD['Dbbbb'][v,w,r,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][v,w,r,:], HD['Dbbbb'][t,u,p,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][v,w,p,:], HD['Dbbbb'][t,u,r,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][t,u,r,:], HD['Dbbbb'][v,w,p,:] ) ))
    if r==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][t,u,:,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbb'][t,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][t,u,:,v,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][t,u,v,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][t,u,:,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,w,:,:], HD['Dbbbb'][t,u,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][t,u,:,w,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][t,u,w,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][v,w,:,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,u,:,:], HD['Dbbbb'][v,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][v,w,:,u,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][v,w,u,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][v,w,:,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbb'][v,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][v,w,:,t,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][v,w,t,:] ) ))
    if p==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][t,u,:,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbb'][t,u,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][t,u,:,v,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][t,u,v,:] ) ))
    if p==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][t,u,:,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,w,:,:], HD['Dbbbb'][t,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][t,u,:,w,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][t,u,w,:] ) ))
    if p==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][v,w,:,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,u,:,:], HD['Dbbbb'][v,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][v,w,:,u,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][v,w,u,:] ) ))
    if p==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][v,w,:,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbb'][v,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][v,w,:,t,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][v,w,t,:] ) ))
    return result


def lucc_AAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s) = e
    result = 0
    result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][r,s,:,q,:,:] ) ,
                     +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][r,s,:,p,:,:] ) ,
                     -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][p,q,:,r,:,:] ) ,
                     +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][p,q,:,s,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][r,s,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][p,q,:,:] ) ))
    result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][r,s,q,:] ) ,
                         +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][r,s,p,:] ) ,
                         -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][p,q,r,:] ) ,
                         +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][p,q,s,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][r,s,:,q,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][r,s,:,p,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][p,q,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][p,q,:,s,:,:] ) ))
    return result


def lucc_AAAAaaaa_AAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,v) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Haaaa'][p,v,:,:], HD['Daaaaaa'][r,s,t,q,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][p,t,:,:], HD['Daaaaaa'][r,s,v,q,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][q,v,:,:], HD['Daaaaaa'][r,s,t,p,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][q,t,:,:], HD['Daaaaaa'][r,s,v,p,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][s,v,:,:], HD['Daaaaaa'][p,q,t,r,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][s,t,:,:], HD['Daaaaaa'][p,q,v,r,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][r,v,:,:], HD['Daaaaaa'][p,q,t,s,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][r,t,:,:], HD['Daaaaaa'][p,q,v,s,:,:] ) ))
    result += 2 * fsum(( -HD['Haa'][p,t] * HD['Daaaa'][q,v,r,s] ,
                         +HD['Haa'][p,v] * HD['Daaaa'][q,t,r,s] ,
                         +HD['Haa'][q,t] * HD['Daaaa'][p,v,r,s] ,
                         -HD['Haa'][q,v] * HD['Daaaa'][p,t,r,s] ,
                         -HD['Haa'][s,t] * HD['Daaaa'][p,q,r,v] ,
                         +HD['Haa'][s,v] * HD['Daaaa'][p,q,r,t] ,
                         +HD['Haa'][r,t] * HD['Daaaa'][p,q,s,v] ,
                         -HD['Haa'][r,v] * HD['Daaaa'][p,q,s,t] ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,:,t,:], HD['Daaaaaa'][r,s,:,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,:,v,:], HD['Daaaaaa'][r,s,:,q,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,:,t,:], HD['Daaaaaa'][r,s,:,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,:,v,:], HD['Daaaaaa'][r,s,:,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,:,t,:], HD['Daaaaaa'][p,q,:,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,:,v,:], HD['Daaaaaa'][p,q,:,r,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,:,t,:], HD['Daaaaaa'][p,q,:,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,:,v,:], HD['Daaaaaa'][p,q,:,s,t,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][p,q,t,:], HD['Daaaa'][r,s,v,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][p,q,v,:], HD['Daaaa'][r,s,t,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][r,s,t,:], HD['Daaaa'][p,q,v,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][r,s,v,:], HD['Daaaa'][p,q,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][p,:,t,:], HD['Daabaab'][r,s,:,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][p,:,v,:], HD['Daabaab'][r,s,:,q,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][q,:,t,:], HD['Daabaab'][r,s,:,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][q,:,v,:], HD['Daabaab'][r,s,:,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][s,:,t,:], HD['Daabaab'][p,q,:,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][s,:,v,:], HD['Daabaab'][p,q,:,r,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][r,:,t,:], HD['Daabaab'][p,q,:,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][r,:,v,:], HD['Daabaab'][p,q,:,s,t,:] ) ))
    if q==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][r,s,:,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][p,v,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][p,v,:,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][p,v,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][r,s,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][p,v,r,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][p,v,s,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][p,v,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][p,v,:,s,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][r,s,:,v,:,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][p,q,:,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][s,t,:,q,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][s,t,:,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][s,t,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][s,t,q,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][s,t,p,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][p,q,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][p,q,:,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][s,t,:,q,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][s,t,:,p,:,:] ) ))
    if s==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][r,t,:,q,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][p,q,:,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][r,t,:,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][r,t,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][r,t,q,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][r,t,p,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][p,q,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][p,q,:,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][r,t,:,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][r,t,:,p,:,:] ) ))
    if q==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][p,t,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][r,s,:,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][p,t,:,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][p,t,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][r,s,t,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][p,t,r,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][p,t,s,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][p,t,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][p,t,:,s,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][r,s,:,t,:,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][p,q,:,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][s,v,:,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][s,v,:,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][s,v,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][s,v,q,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][s,v,p,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][p,q,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][s,v,:,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][p,q,:,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][s,v,:,q,:,:] ) ))
    if s==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][p,q,:,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][r,v,:,q,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][r,v,:,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][r,v,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][r,v,q,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][r,v,p,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][p,q,v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][r,v,:,p,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][p,q,:,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][r,v,:,q,:,:] ) ))
    if p==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][q,v,:,r,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][q,v,:,s,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][r,s,:,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][q,v,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][r,s,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][q,v,r,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][q,v,s,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][q,v,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][q,v,:,s,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][r,s,:,v,:,:] ) ))
    if p==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][q,t,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][q,t,:,s,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][r,s,:,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][q,t,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][r,s,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][q,t,r,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][q,t,s,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][r,s,:,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][q,t,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][q,t,:,s,:,:] ) ))
    return result


def lucc_AAAAaaaa_AAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,v) = e
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Habba'][p,:,t,:], HD['Daababa'][r,s,:,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][p,:,v,:], HD['Daababa'][r,s,:,q,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][q,:,t,:], HD['Daababa'][r,s,:,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][q,:,v,:], HD['Daababa'][r,s,:,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][s,:,t,:], HD['Daababa'][p,q,:,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][s,:,v,:], HD['Daababa'][p,q,:,r,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][r,:,t,:], HD['Daababa'][p,q,:,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][r,:,v,:], HD['Daababa'][p,q,:,s,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbaaaab'][t,r,s,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbaaaab'][v,r,s,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbaaaab'][t,r,s,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbaaaab'][v,r,s,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbaaaab'][t,p,q,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbaaaab'][v,p,q,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbaaaab'][t,p,q,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbaaaab'][v,p,q,s,:,:] ) ))
    return result


def lucc_AAAAaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Haaaa'][r,t,:,:], HD['Daaaaaaaa'][p,q,v,w,s,u,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][q,w,:,:], HD['Daaaaaaaa'][r,s,t,u,p,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][q,v,:,:], HD['Daaaaaaaa'][r,s,t,u,p,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][r,u,:,:], HD['Daaaaaaaa'][p,q,v,w,s,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][q,t,:,:], HD['Daaaaaaaa'][r,s,v,w,p,u,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][q,u,:,:], HD['Daaaaaaaa'][r,s,v,w,p,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][s,w,:,:], HD['Daaaaaaaa'][p,q,t,u,r,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][s,v,:,:], HD['Daaaaaaaa'][p,q,t,u,r,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][r,v,:,:], HD['Daaaaaaaa'][p,q,t,u,s,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][s,t,:,:], HD['Daaaaaaaa'][p,q,v,w,r,u,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][p,w,:,:], HD['Daaaaaaaa'][r,s,t,u,q,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][p,v,:,:], HD['Daaaaaaaa'][r,s,t,u,q,w,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][s,u,:,:], HD['Daaaaaaaa'][p,q,v,w,r,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][r,w,:,:], HD['Daaaaaaaa'][p,q,t,u,s,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][p,t,:,:], HD['Daaaaaaaa'][r,s,v,w,q,u,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][p,u,:,:], HD['Daaaaaaaa'][r,s,v,w,q,t,:,:] ) ))
    result += 2 * fsum(( +HD['Haa'][p,t] * HD['Daaaaaa'][q,v,w,r,s,u] ,
                         -HD['Haa'][p,u] * HD['Daaaaaa'][q,v,w,r,s,t] ,
                         +HD['Haa'][p,w] * HD['Daaaaaa'][q,t,u,r,s,v] ,
                         -HD['Haa'][p,v] * HD['Daaaaaa'][q,t,u,r,s,w] ,
                         -HD['Haa'][q,t] * HD['Daaaaaa'][p,v,w,r,s,u] ,
                         +HD['Haa'][q,u] * HD['Daaaaaa'][p,v,w,r,s,t] ,
                         -HD['Haa'][q,w] * HD['Daaaaaa'][p,t,u,r,s,v] ,
                         +HD['Haa'][q,v] * HD['Daaaaaa'][p,t,u,r,s,w] ,
                         +HD['Haa'][s,t] * HD['Daaaaaa'][p,q,u,r,v,w] ,
                         -HD['Haa'][s,u] * HD['Daaaaaa'][p,q,t,r,v,w] ,
                         +HD['Haa'][s,w] * HD['Daaaaaa'][p,q,v,r,t,u] ,
                         -HD['Haa'][s,v] * HD['Daaaaaa'][p,q,w,r,t,u] ,
                         -HD['Haa'][r,t] * HD['Daaaaaa'][p,q,u,s,v,w] ,
                         +HD['Haa'][r,u] * HD['Daaaaaa'][p,q,t,s,v,w] ,
                         -HD['Haa'][r,w] * HD['Daaaaaa'][p,q,v,s,t,u] ,
                         +HD['Haa'][r,v] * HD['Daaaaaa'][p,q,w,s,t,u] ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,:,w,:], HD['Daaaaaaaa'][r,s,v,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,:,v,:], HD['Daaaaaaaa'][r,s,w,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,:,t,:], HD['Daaaaaaaa'][p,q,u,:,r,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,:,u,:], HD['Daaaaaaaa'][p,q,t,:,r,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,:,w,:], HD['Daaaaaaaa'][p,q,v,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,:,v,:], HD['Daaaaaaaa'][p,q,w,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,:,t,:], HD['Daaaaaaaa'][p,q,u,:,s,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,:,u,:], HD['Daaaaaaaa'][p,q,t,:,s,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,:,w,:], HD['Daaaaaaaa'][p,q,v,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,:,v,:], HD['Daaaaaaaa'][p,q,w,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,:,t,:], HD['Daaaaaaaa'][r,s,u,:,q,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,:,u,:], HD['Daaaaaaaa'][r,s,t,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,:,w,:], HD['Daaaaaaaa'][r,s,v,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,:,v,:], HD['Daaaaaaaa'][r,s,w,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,:,t,:], HD['Daaaaaaaa'][r,s,u,:,p,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,:,u,:], HD['Daaaaaaaa'][r,s,t,:,p,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][r,s,t,:], HD['Daaaaaa'][p,q,u,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][r,s,u,:], HD['Daaaaaa'][p,q,t,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][r,s,w,:], HD['Daaaaaa'][p,q,v,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][r,s,v,:], HD['Daaaaaa'][p,q,w,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][t,u,s,:], HD['Daaaaaa'][r,v,w,p,q,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][v,w,s,:], HD['Daaaaaa'][r,t,u,p,q,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][t,u,r,:], HD['Daaaaaa'][s,v,w,p,q,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][p,q,t,:], HD['Daaaaaa'][r,s,u,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][p,q,u,:], HD['Daaaaaa'][r,s,t,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][v,w,r,:], HD['Daaaaaa'][s,t,u,p,q,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][p,q,w,:], HD['Daaaaaa'][r,s,v,t,u,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][p,q,v,:], HD['Daaaaaa'][r,s,w,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][t,u,p,:], HD['Daaaaaa'][q,v,w,r,s,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][v,w,p,:], HD['Daaaaaa'][q,t,u,r,s,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][t,u,q,:], HD['Daaaaaa'][p,v,w,r,s,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][v,w,q,:], HD['Daaaaaa'][p,t,u,r,s,:] ) ,
                         -HD['Haaaa'][p,q,t,u] * HD['Daaaa'][r,s,v,w] ,
                         +HD['Haaaa'][r,s,t,u] * HD['Daaaa'][p,q,v,w] ,
                         +HD['Haaaa'][p,q,v,w] * HD['Daaaa'][r,s,t,u] ,
                         -HD['Haaaa'][r,s,v,w] * HD['Daaaa'][p,q,t,u] ,
                         +einsum( 'ij,ij->', HD['Habab'][r,:,t,:], HD['Daaabaaab'][p,q,u,:,s,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][r,:,u,:], HD['Daaabaaab'][p,q,t,:,s,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][r,:,w,:], HD['Daaabaaab'][p,q,v,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][r,:,v,:], HD['Daaabaaab'][p,q,w,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][p,:,t,:], HD['Daaabaaab'][r,s,u,:,q,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][p,:,u,:], HD['Daaabaaab'][r,s,t,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][p,:,w,:], HD['Daaabaaab'][r,s,v,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][p,:,v,:], HD['Daaabaaab'][r,s,w,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][q,:,t,:], HD['Daaabaaab'][r,s,u,:,p,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][q,:,u,:], HD['Daaabaaab'][r,s,t,:,p,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][q,:,w,:], HD['Daaabaaab'][r,s,v,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][q,:,v,:], HD['Daaabaaab'][r,s,w,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][s,:,t,:], HD['Daaabaaab'][p,q,u,:,r,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][s,:,u,:], HD['Daaabaaab'][p,q,t,:,r,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][s,:,w,:], HD['Daaabaaab'][p,q,v,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][s,:,v,:], HD['Daaabaaab'][p,q,w,:,r,t,u,:] ) ))
    if q==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][r,s,t,:,v,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][p,v,w,:,r,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][p,v,w,:,s,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaaaa'][p,v,w,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,t,:,:], HD['Daaaaaa'][p,v,w,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,t,:,:], HD['Daaaaaa'][p,v,w,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][p,v,w,s,t,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][r,s,t,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][p,v,w,r,t,:] ) ,
                             -HD['Haa'][p,t] * HD['Daaaa'][r,s,v,w] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][p,:,t,:], HD['Daaaaaa'][r,s,:,v,w,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][r,s,t,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][p,v,w,:,r,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][p,v,w,:,s,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][p,:,t,:], HD['Daabaab'][r,s,:,v,w,:] ) ))
        if p==t:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][v,w,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][v,w,:,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][v,w,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][v,w,r,:] ) ,
                                 -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][v,w,s,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][v,w,:,s,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][v,w,:,r,:,:] ) ))
    if q==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][p,v,w,:,r,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][p,v,w,:,s,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][r,s,u,:,v,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaaaa'][p,v,w,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,u,:,:], HD['Daaaaaa'][p,v,w,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,u,:,:], HD['Daaaaaa'][p,v,w,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][r,s,u,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][p,v,w,r,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][p,v,w,s,u,:] ) ,
                             +HD['Haa'][p,u] * HD['Daaaa'][r,s,v,w] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][p,:,u,:], HD['Daaaaaa'][r,s,:,v,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][r,s,u,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][p,v,w,:,r,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][p,v,w,:,s,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][p,:,u,:], HD['Daabaab'][r,s,:,v,w,:] ) ))
        if p==u:
            result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][v,w,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][v,w,:,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][v,w,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][v,w,r,:] ) ,
                                 +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][v,w,s,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][v,w,:,r,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][v,w,:,s,:,:] ) ))
    if s==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][r,t,u,:,q,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][r,t,u,:,p,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][p,q,w,:,t,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,w,:,:], HD['Daaaaaa'][r,t,u,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,w,:,:], HD['Daaaaaa'][r,t,u,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaaaa'][r,t,u,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][r,t,u,p,w,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][r,t,u,q,w,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][p,q,w,t,u,:] ) ,
                             +HD['Haa'][r,w] * HD['Daaaa'][p,q,t,u] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][r,:,w,:], HD['Daaaaaa'][p,q,:,t,u,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][r,t,u,:,p,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][r,t,u,:,q,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][p,q,w,:,t,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][r,:,w,:], HD['Daabaab'][p,q,:,t,u,:] ) ))
        if r==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][t,u,:,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][t,u,:,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][t,u,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][t,u,q,:] ) ,
                                 -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][t,u,p,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][t,u,:,q,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][t,u,:,p,:,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][s,t,u,:,p,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][p,q,v,:,t,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][s,t,u,:,q,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,v,:,:], HD['Daaaaaa'][s,t,u,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaaaa'][s,t,u,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,v,:,:], HD['Daaaaaa'][s,t,u,q,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][p,q,v,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][s,t,u,q,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][s,t,u,p,v,:] ) ,
                             +HD['Haa'][s,v] * HD['Daaaa'][p,q,t,u] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][s,:,v,:], HD['Daaaaaa'][p,q,:,t,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][s,t,u,:,q,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][p,q,v,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][s,t,u,:,p,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][s,:,v,:], HD['Daabaab'][p,q,:,t,u,:] ) ))
    if s==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][r,t,u,:,q,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][r,t,u,:,p,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][p,q,v,:,t,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,v,:,:], HD['Daaaaaa'][r,t,u,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaaaa'][r,t,u,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,v,:,:], HD['Daaaaaa'][r,t,u,q,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][r,t,u,p,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][r,t,u,q,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][p,q,v,t,u,:] ) ,
                             -HD['Haa'][r,v] * HD['Daaaa'][p,q,t,u] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][r,:,v,:], HD['Daaaaaa'][p,q,:,t,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][r,t,u,:,p,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][r,t,u,:,q,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][p,q,v,:,t,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][r,:,v,:], HD['Daabaab'][p,q,:,t,u,:] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][t,u,:,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][t,u,:,q,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][t,u,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][t,u,p,:] ) ,
                                 -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][t,u,q,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][t,u,:,q,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][t,u,:,p,:,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][s,t,u,:,p,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][p,q,w,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][s,t,u,:,q,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,w,:,:], HD['Daaaaaa'][s,t,u,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaaaa'][s,t,u,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,w,:,:], HD['Daaaaaa'][s,t,u,q,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][p,q,w,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][s,t,u,p,w,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][s,t,u,q,w,:] ) ,
                             -HD['Haa'][s,w] * HD['Daaaa'][p,q,t,u] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][s,:,w,:], HD['Daaaaaa'][p,q,:,t,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][p,q,w,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][s,t,u,:,q,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][s,t,u,:,p,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][s,:,w,:], HD['Daabaab'][p,q,:,t,u,:] ) ))
    if q==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][p,t,u,:,r,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][p,t,u,:,s,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][r,s,w,:,t,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,w,:,:], HD['Daaaaaa'][p,t,u,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaaaa'][p,t,u,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,w,:,:], HD['Daaaaaa'][p,t,u,r,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][p,t,u,r,w,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][r,s,w,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][p,t,u,s,w,:] ) ,
                             -HD['Haa'][p,w] * HD['Daaaa'][r,s,t,u] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][p,:,w,:], HD['Daaaaaa'][r,s,:,t,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][r,s,w,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][p,t,u,:,s,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][p,t,u,:,r,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][p,:,w,:], HD['Daabaab'][r,s,:,t,u,:] ) ))
        if p==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][t,u,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][t,u,:,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][t,u,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][t,u,s,:] ) ,
                                 +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][t,u,r,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][t,u,:,s,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][t,u,:,r,:,:] ) ))
    if q==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][p,t,u,:,s,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][r,s,v,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][p,t,u,:,r,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,v,:,:], HD['Daaaaaa'][p,t,u,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaaaa'][p,t,u,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,v,:,:], HD['Daaaaaa'][p,t,u,r,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][p,t,u,r,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][r,s,v,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][p,t,u,s,v,:] ) ,
                             +HD['Haa'][p,v] * HD['Daaaa'][r,s,t,u] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][p,:,v,:], HD['Daaaaaa'][r,s,:,t,u,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][r,s,v,:,t,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][p,t,u,:,s,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][p,t,u,:,r,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][p,:,v,:], HD['Daabaab'][r,s,:,t,u,:] ) ))
        if p==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaa'][t,u,:,s,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaa'][t,u,:,r,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaa'][t,u,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaa'][t,u,s,:] ) ,
                                 -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaa'][t,u,r,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daabaab'][t,u,:,s,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daabaab'][t,u,:,r,:,:] ) ))
    if s==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][r,v,w,:,q,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][r,v,w,:,p,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][p,q,t,:,v,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaaaa'][r,v,w,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,t,:,:], HD['Daaaaaa'][r,v,w,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,t,:,:], HD['Daaaaaa'][r,v,w,p,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][r,v,w,q,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][p,q,t,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][r,v,w,p,t,:] ) ,
                             +HD['Haa'][r,t] * HD['Daaaa'][p,q,v,w] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][r,:,t,:], HD['Daaaaaa'][p,q,:,v,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][p,q,t,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][r,v,w,:,p,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][r,v,w,:,q,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][r,:,t,:], HD['Daabaab'][p,q,:,v,w,:] ) ))
        if r==t:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][v,w,:,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][v,w,:,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][v,w,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][v,w,p,:] ) ,
                                 +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][v,w,q,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][v,w,:,p,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][v,w,:,q,:,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][s,v,w,:,q,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][s,v,w,:,p,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][p,q,u,:,v,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaaaa'][s,v,w,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,u,:,:], HD['Daaaaaa'][s,v,w,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,u,:,:], HD['Daaaaaa'][s,v,w,p,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][s,v,w,p,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][s,v,w,q,u,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][p,q,u,v,w,:] ) ,
                             +HD['Haa'][s,u] * HD['Daaaa'][p,q,v,w] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][s,:,u,:], HD['Daaaaaa'][p,q,:,v,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][s,v,w,:,p,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][p,q,u,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][s,v,w,:,q,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][s,:,u,:], HD['Daabaab'][p,q,:,v,w,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][s,v,w,:,q,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][s,v,w,:,p,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][p,q,t,:,v,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaaaa'][s,v,w,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,t,:,:], HD['Daaaaaa'][s,v,w,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,t,:,:], HD['Daaaaaa'][s,v,w,p,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][s,v,w,p,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][s,v,w,q,t,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][p,q,t,v,w,:] ) ,
                             -HD['Haa'][s,t] * HD['Daaaa'][p,q,v,w] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][s,:,t,:], HD['Daaaaaa'][p,q,:,v,w,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][s,v,w,:,p,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][p,q,t,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][s,v,w,:,q,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][s,:,t,:], HD['Daabaab'][p,q,:,v,w,:] ) ))
        if s==t:
            result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaa'][v,w,:,q,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaa'][v,w,:,p,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaa'][v,w,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaa'][v,w,p,:] ) ,
                                 -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaa'][v,w,q,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daabaab'][v,w,:,p,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daabaab'][v,w,:,q,:,:] ) ))
    if s==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][r,v,w,:,p,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Daaaaaaaa'][r,v,w,:,q,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][p,q,u,:,v,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Daaaaaa'][r,v,w,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,u,:,:], HD['Daaaaaa'][r,v,w,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,u,:,:], HD['Daaaaaa'][r,v,w,p,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][p,q,u,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][r,v,w,p,u,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][p,:], HD['Daaaaaa'][r,v,w,q,u,:] ) ,
                             -HD['Haa'][r,u] * HD['Daaaa'][p,q,v,w] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][r,:,u,:], HD['Daaaaaa'][p,q,:,v,w,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][p,q,u,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][r,v,w,:,p,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Daaabaaab'][r,v,w,:,q,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][r,:,u,:], HD['Daabaab'][p,q,:,v,w,:] ) ))
    if p==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][q,v,w,:,r,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][q,v,w,:,s,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][r,s,t,:,v,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaaaa'][q,v,w,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,t,:,:], HD['Daaaaaa'][q,v,w,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,t,:,:], HD['Daaaaaa'][q,v,w,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][r,s,t,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][q,v,w,r,t,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][q,v,w,s,t,:] ) ,
                             +HD['Haa'][q,t] * HD['Daaaa'][r,s,v,w] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][q,:,t,:], HD['Daaaaaa'][r,s,:,v,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][q,v,w,:,r,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][r,s,t,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][q,v,w,:,s,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][q,:,t,:], HD['Daabaab'][r,s,:,v,w,:] ) ))
    if p==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][q,v,w,:,r,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][q,v,w,:,s,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][r,s,u,:,v,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaaaa'][q,v,w,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,u,:,:], HD['Daaaaaa'][q,v,w,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,u,:,:], HD['Daaaaaa'][q,v,w,s,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][q,v,w,r,u,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][q,v,w,s,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][r,s,u,v,w,:] ) ,
                             -HD['Haa'][q,u] * HD['Daaaa'][r,s,v,w] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][q,:,u,:], HD['Daaaaaa'][r,s,:,v,w,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][q,v,w,:,r,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][q,v,w,:,s,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][r,s,u,:,v,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][q,:,u,:], HD['Daabaab'][r,s,:,v,w,:] ) ))
    if p==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][q,t,u,:,s,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][r,s,w,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][q,t,u,:,r,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,w,:,:], HD['Daaaaaa'][q,t,u,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaaaa'][q,t,u,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,w,:,:], HD['Daaaaaa'][q,t,u,r,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][q,t,u,r,w,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][r,s,w,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][q,t,u,s,w,:] ) ,
                             +HD['Haa'][q,w] * HD['Daaaa'][r,s,t,u] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][q,:,w,:], HD['Daaaaaa'][r,s,:,t,u,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][r,s,w,:,t,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][q,t,u,:,s,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][q,t,u,:,r,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][q,:,w,:], HD['Daabaab'][r,s,:,t,u,:] ) ))
    if p==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Daaaaaaaa'][r,s,v,:,t,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Daaaaaaaa'][q,t,u,:,r,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Daaaaaaaa'][q,t,u,:,s,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Daaaaaa'][q,t,u,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,v,:,:], HD['Daaaaaa'][q,t,u,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,v,:,:], HD['Daaaaaa'][q,t,u,s,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Daaaaaa'][q,t,u,r,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][q,:], HD['Daaaaaa'][r,s,v,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Daaaaaa'][q,t,u,s,v,:] ) ,
                             -HD['Haa'][q,v] * HD['Daaaa'][r,s,t,u] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][q,:,v,:], HD['Daaaaaa'][r,s,:,t,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Daaabaaab'][r,s,v,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Daaabaaab'][q,t,u,:,s,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Daaabaaab'][q,t,u,:,r,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][q,:,v,:], HD['Daabaab'][r,s,:,t,u,:] ) ))
    return result


def lucc_AAAAaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['Haaaa'][s,w,:,:], HD['Dbaaaabaa'][t,p,q,u,r,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][s,u,:,:], HD['Dbaaaabaa'][v,p,q,w,r,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][r,w,:,:], HD['Dbaaaabaa'][t,p,q,u,s,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][r,u,:,:], HD['Dbaaaabaa'][v,p,q,w,s,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][p,w,:,:], HD['Dbaaaabaa'][t,r,s,u,q,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][p,u,:,:], HD['Dbaaaabaa'][v,r,s,w,q,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][q,w,:,:], HD['Dbaaaabaa'][t,r,s,u,p,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][q,u,:,:], HD['Dbaaaabaa'][v,r,s,w,p,t,:,:] ) ))
    result += 2 * fsum(( +HD['Haa'][p,u] * HD['Dbaaaab'][v,q,w,r,s,t] ,
                         -HD['Haa'][p,w] * HD['Dbaaaab'][t,q,u,r,s,v] ,
                         -HD['Haa'][q,u] * HD['Dbaaaab'][v,p,w,r,s,t] ,
                         +HD['Haa'][q,w] * HD['Dbaaaab'][t,p,u,r,s,v] ,
                         +HD['Haa'][s,u] * HD['Dbaaaab'][t,p,q,r,w,v] ,
                         -HD['Haa'][s,w] * HD['Dbaaaab'][v,p,q,r,u,t] ,
                         -HD['Haa'][r,u] * HD['Dbaaaab'][t,p,q,s,w,v] ,
                         +HD['Haa'][r,w] * HD['Dbaaaab'][v,p,q,s,u,t] ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,:,w,:], HD['Dbaaaaaba'][v,p,q,:,s,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,:,u,:], HD['Dbaaaaaba'][t,r,s,:,q,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,:,w,:], HD['Dbaaaaaba'][v,r,s,:,q,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,:,u,:], HD['Dbaaaaaba'][t,r,s,:,p,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,:,w,:], HD['Dbaaaaaba'][v,r,s,:,p,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,:,u,:], HD['Dbaaaaaba'][t,p,q,:,r,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,:,w,:], HD['Dbaaaaaba'][v,p,q,:,r,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,:,u,:], HD['Dbaaaaaba'][t,p,q,:,s,w,v,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][r,s,w,:], HD['Dbaaaba'][v,p,q,u,t,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][r,s,u,:], HD['Dbaaaba'][t,p,q,w,v,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][p,q,u,:], HD['Dbaaaba'][t,r,s,w,v,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][p,q,w,:], HD['Dbaaaba'][v,r,s,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][p,:,u,:], HD['Dbaabaabb'][t,r,s,:,q,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][s,:,w,:], HD['Dbaabaabb'][v,p,q,:,r,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][p,:,w,:], HD['Dbaabaabb'][v,r,s,:,q,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][q,:,u,:], HD['Dbaabaabb'][t,r,s,:,p,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][r,:,u,:], HD['Dbaabaabb'][t,p,q,:,s,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][q,:,w,:], HD['Dbaabaabb'][v,r,s,:,p,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][r,:,w,:], HD['Dbaabaabb'][v,p,q,:,s,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][s,:,u,:], HD['Dbaabaabb'][t,p,q,:,r,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][p,:,t,:], HD['Daaabaaba'][r,s,u,:,q,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][s,:,v,:], HD['Daaabaaba'][p,q,w,:,r,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][p,:,v,:], HD['Daaabaaba'][r,s,w,:,q,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][q,:,t,:], HD['Daaabaaba'][r,s,u,:,p,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][r,:,t,:], HD['Daaabaaba'][p,q,u,:,s,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][q,:,v,:], HD['Daaabaaba'][r,s,w,:,p,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][s,:,t,:], HD['Daaabaaba'][p,q,u,:,r,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][r,:,v,:], HD['Daaabaaba'][p,q,w,:,s,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbaaaaaab'][t,p,q,u,r,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbaaaaaab'][t,r,s,u,q,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbaaaaaab'][v,p,q,w,r,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbaaaaaab'][v,r,s,w,q,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbaaaaaab'][t,r,s,u,p,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbaaaaaab'][t,p,q,u,s,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbaaaaaab'][v,r,s,w,p,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbaaaaaab'][v,p,q,w,s,u,:,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][t,u,p,:], HD['Dbaaaab'][v,q,w,r,s,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][v,w,s,:], HD['Dbaaaab'][t,r,u,p,q,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][v,w,p,:], HD['Dbaaaab'][t,q,u,r,s,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][t,u,q,:], HD['Dbaaaab'][v,p,w,r,s,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][t,u,r,:], HD['Dbaaaab'][v,s,w,p,q,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][v,w,q,:], HD['Dbaaaab'][t,p,u,r,s,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][v,w,r,:], HD['Dbaaaab'][t,s,u,p,q,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][t,u,s,:], HD['Dbaaaab'][v,r,w,p,q,:] ) ))
    if q==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Dbaaaabaa'][t,r,s,:,w,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][v,p,w,:,r,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Dbaaaabaa'][v,p,w,:,s,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Dbaabaa'][v,p,w,t,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Dbaaaba'][t,r,s,w,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][r,:], HD['Dbaaaba'][v,p,w,s,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][v,p,w,r,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dbaababab'][v,p,w,:,s,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][v,p,w,:,r,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dbaababab'][t,r,s,:,w,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habba'][p,:,t,:], HD['Daababa'][r,s,:,w,v,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbaaaab'][v,p,w,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbaaaab'][v,p,w,r,:,:] ) ))
    if r==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][t,s,u,:,p,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][v,p,q,:,u,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Dbaaaabaa'][t,s,u,:,q,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Dbaabaa'][t,s,u,v,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][p,:], HD['Dbaaaba'][t,s,u,q,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][t,s,u,p,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][v,p,q,u,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dbaababab'][t,s,u,:,q,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][v,p,q,:,u,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][t,s,u,:,p,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habba'][s,:,v,:], HD['Daababa'][p,q,:,u,t,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbaaaab'][t,s,u,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbaaaab'][t,s,u,q,:,:] ) ))
    if s==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][t,r,u,:,p,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Dbaaaabaa'][t,r,u,:,q,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Dbaaaabaa'][v,p,q,:,u,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Dbaabaa'][t,r,u,v,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Dbaaaba'][t,r,u,q,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][t,r,u,p,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Dbaaaba'][v,p,q,u,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dbaababab'][v,p,q,:,u,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][t,r,u,:,p,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dbaababab'][t,r,u,:,q,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habba'][r,:,v,:], HD['Daababa'][p,q,:,u,t,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbaaaab'][t,r,u,p,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbaaaab'][t,r,u,q,:,:] ) ))
    if q==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][t,p,u,:,r,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Dbaaaabaa'][v,r,s,:,u,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Dbaaaabaa'][t,p,u,:,s,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Dbaabaa'][t,p,u,v,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][r,:], HD['Dbaaaba'][t,p,u,s,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][p,:], HD['Dbaaaba'][v,r,s,u,t,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][t,p,u,r,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dbaababab'][v,r,s,:,u,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][t,p,u,:,r,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dbaababab'][t,p,u,:,s,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habba'][p,:,v,:], HD['Daababa'][r,s,:,u,t,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbaaaab'][t,p,u,r,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbaaaab'][t,p,u,s,:,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][t,p,q,:,w,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Dbaaaabaa'][v,s,w,:,q,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][v,s,w,:,p,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Dbaabaa'][v,s,w,t,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][p,:], HD['Dbaaaba'][v,s,w,q,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][v,s,w,p,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][t,p,q,w,v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][t,p,q,:,w,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dbaababab'][v,s,w,:,q,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][v,s,w,:,p,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habba'][s,:,t,:], HD['Daababa'][p,q,:,w,v,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbaaaab'][v,s,w,q,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbaaaab'][v,s,w,p,:,:] ) ))
    if s==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Dbaaaabaa'][t,p,q,:,w,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][p,:,:,:], HD['Dbaaaabaa'][v,r,w,:,q,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][v,r,w,:,p,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][p,q,:,:], HD['Dbaabaa'][v,r,w,t,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][r,:], HD['Dbaaaba'][t,p,q,w,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][p,:], HD['Dbaaaba'][v,r,w,q,t,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][v,r,w,p,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][p,:,:,:], HD['Dbaababab'][v,r,w,:,q,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dbaababab'][t,p,q,:,w,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][v,r,w,:,p,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habba'][r,:,t,:], HD['Daababa'][p,q,:,w,v,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbaaaab'][v,r,w,q,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbaaaab'][v,r,w,p,:,:] ) ))
    if p==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Dbaaaabaa'][v,q,w,:,s,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][v,q,w,:,r,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][t,r,s,:,w,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Dbaabaa'][v,q,w,t,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][t,r,s,w,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][v,q,w,r,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][r,:], HD['Dbaaaba'][v,q,w,s,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dbaababab'][v,q,w,:,s,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][t,r,s,:,w,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][v,q,w,:,r,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habba'][q,:,t,:], HD['Daababa'][r,s,:,w,v,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbaaaab'][v,q,w,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbaaaab'][v,q,w,r,:,:] ) ))
    if p==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][v,r,s,:,u,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][t,q,u,:,r,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][r,:,:,:], HD['Dbaaaabaa'][t,q,u,:,s,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][r,s,:,:], HD['Dbaabaa'][t,q,u,v,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][r,:], HD['Dbaaaba'][t,q,u,s,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][v,r,s,u,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][t,q,u,r,v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][t,q,u,:,r,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][v,r,s,:,u,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][r,:,:,:], HD['Dbaababab'][t,q,u,:,s,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habba'][q,:,v,:], HD['Daababa'][r,s,:,u,t,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbaaaab'][t,q,u,r,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbaaaab'][t,q,u,s,:,:] ) ))
    return result


def lucc_AAAAaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Habba'][p,:,t,:], HD['Dbaababba'][u,r,s,:,q,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][p,:,u,:], HD['Dbaababba'][t,r,s,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][p,:,w,:], HD['Dbaababba'][v,r,s,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][p,:,v,:], HD['Dbaababba'][w,r,s,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][q,:,t,:], HD['Dbaababba'][u,r,s,:,p,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][q,:,u,:], HD['Dbaababba'][t,r,s,:,p,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][q,:,w,:], HD['Dbaababba'][v,r,s,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][q,:,v,:], HD['Dbaababba'][w,r,s,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][s,:,t,:], HD['Dbaababba'][u,p,q,:,r,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][s,:,u,:], HD['Dbaababba'][t,p,q,:,r,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][s,:,w,:], HD['Dbaababba'][v,p,q,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][s,:,v,:], HD['Dbaababba'][w,p,q,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][r,:,t,:], HD['Dbaababba'][u,p,q,:,s,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][r,:,u,:], HD['Dbaababba'][t,p,q,:,s,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][r,:,w,:], HD['Dbaababba'][v,p,q,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][r,:,v,:], HD['Dbaababba'][w,p,q,:,s,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][w,p,:,:], HD['Dbbaaabab'][t,u,r,s,q,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,p,:,:], HD['Dbbaaabab'][t,u,r,s,q,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,p,:,:], HD['Dbbaaabab'][v,w,r,s,q,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][u,p,:,:], HD['Dbbaaabab'][v,w,r,s,q,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][w,q,:,:], HD['Dbbaaabab'][t,u,r,s,p,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbbaaabab'][t,u,r,s,p,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbbaaabab'][v,w,r,s,p,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][u,q,:,:], HD['Dbbaaabab'][v,w,r,s,p,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][w,s,:,:], HD['Dbbaaabab'][t,u,p,q,r,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbbaaabab'][t,u,p,q,r,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbbaaabab'][v,w,p,q,r,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][u,s,:,:], HD['Dbbaaabab'][v,w,p,q,r,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][w,r,:,:], HD['Dbbaaabab'][t,u,p,q,s,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,r,:,:], HD['Dbbaaabab'][t,u,p,q,s,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,r,:,:], HD['Dbbaaabab'][v,w,p,q,s,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][u,r,:,:], HD['Dbbaaabab'][v,w,p,q,s,t,:,:] ) ))
    return result


def lucc_AAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s) = e
    result = 0
    result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][r,s,:,p,:,:] ) ,
                     -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][p,q,:,r,:,:] ) ,
                     -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][r,s,:,q,:,:] ) ,
                     +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][p,q,:,s,:,:] ) ))
    result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][r,s,p,:] ) ,
                         -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][p,q,r,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][p,q,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][r,s,:,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][p,q,:,s,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][r,s,:,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaab'][r,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaab'][p,q,:,:] ) ,
                         -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][r,s,q,:] ) ,
                         +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][p,q,s,:] ) ))
    return result


def lucc_AAAAbaba_AAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,v) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Haaaa'][s,v,:,:], HD['Dbaabaa'][p,q,t,r,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][s,t,:,:], HD['Dbaabaa'][p,q,v,r,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][q,v,:,:], HD['Dbaabaa'][r,s,t,p,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][q,t,:,:], HD['Dbaabaa'][r,s,v,p,:,:] ) ))
    result += 2 * fsum(( -HD['Haa'][q,t] * HD['Dbaab'][p,v,s,r] ,
                         +HD['Haa'][q,v] * HD['Dbaab'][p,t,s,r] ,
                         +HD['Haa'][s,t] * HD['Dbaab'][p,q,v,r] ,
                         -HD['Haa'][s,v] * HD['Dbaab'][p,q,t,r] ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,:,t,:], HD['Dbaaaba'][r,s,:,v,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,:,v,:], HD['Dbaaaba'][r,s,:,t,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,:,t,:], HD['Dbaaaba'][p,q,:,v,r,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,:,v,:], HD['Dbaaaba'][p,q,:,t,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][s,:,t,:], HD['Dbababb'][p,q,:,v,r,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][s,:,v,:], HD['Dbababb'][p,q,:,t,r,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][q,:,t,:], HD['Dbababb'][r,s,:,v,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][q,:,v,:], HD['Dbababb'][r,s,:,t,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,t,:], HD['Dbaaaab'][r,s,:,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,v,:], HD['Dbaaaab'][r,s,:,q,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,t,:], HD['Dbaaaab'][p,q,:,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,v,:], HD['Dbaaaab'][p,q,:,s,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,v,:,:], HD['Dbaaaab'][p,q,t,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,v,:,:], HD['Dbaaaab'][r,s,t,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,t,:,:], HD['Dbaaaab'][r,s,v,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,t,:,:], HD['Dbaaaab'][p,q,v,s,:,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][p,q,t,:], HD['Dbaab'][r,s,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][p,q,v,:], HD['Dbaab'][r,s,t,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][r,s,t,:], HD['Dbaab'][p,q,v,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][r,s,v,:], HD['Dbaab'][p,q,t,:] ) ))
    if s==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][r,t,:,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][r,t,:,q,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][p,q,:,t,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][r,t,p,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][r,t,:,p,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][r,t,:,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][p,q,:,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaab'][r,t,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][r,t,q,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][p,q,t,:] ) ))
    if s==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][r,v,:,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][p,q,:,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][r,v,:,q,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][r,v,p,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][r,v,:,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][r,v,:,q,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][p,q,:,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaab'][r,v,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][r,v,q,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][p,q,v,:] ) ))
    if q==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][p,t,:,r,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][p,t,:,s,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][r,s,:,t,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][p,t,r,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][p,t,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][r,s,:,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][p,t,:,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaab'][p,t,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][r,s,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][p,t,s,:] ) ))
    if q==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][p,v,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][p,v,:,s,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][r,s,:,v,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][p,v,r,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][p,v,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][r,s,:,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][p,v,:,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaab'][p,v,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][r,s,v,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][p,v,s,:] ) ))
    return result


def lucc_AAAAbaba_AAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,v) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbaabb'][p,t,q,s,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbaabb'][p,v,q,s,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbaabb'][r,t,s,q,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbaabb'][r,v,s,q,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['Habba'][q,:,t,:], HD['Dbabbba'][r,s,:,p,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][s,:,v,:], HD['Dbabbba'][p,q,:,r,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][q,:,v,:], HD['Dbabbba'][r,s,:,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][s,:,t,:], HD['Dbabbba'][p,q,:,r,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbbabab'][r,t,s,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbbabab'][r,v,s,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbbabab'][p,v,q,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbbabab'][p,t,q,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbaaaba'][p,q,:,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbaaaba'][p,q,:,s,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbaaaba'][r,s,:,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbaaaba'][r,s,:,q,t,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][r,s,t,:], HD['Dbaba'][p,q,v,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][r,s,v,:], HD['Dbaba'][p,q,t,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][p,q,t,:], HD['Dbaba'][r,s,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][p,q,v,:], HD['Dbaba'][r,s,t,:] ) ,
                         -HD['Hbb'][p,t] * HD['Dbaab'][v,q,s,r] ,
                         +HD['Hbb'][p,v] * HD['Dbaab'][t,q,s,r] ,
                         +HD['Hbb'][r,t] * HD['Dbaab'][p,q,s,v] ,
                         -HD['Hbb'][r,v] * HD['Dbaab'][p,q,s,t] ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbababb'][r,s,:,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbababb'][r,s,:,q,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbababb'][p,q,:,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbababb'][p,q,:,s,t,:] ) ))
    if p==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][v,q,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][r,s,:,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][v,q,:,s,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][r,s,v,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][v,q,r,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][r,s,:,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][v,q,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][v,q,:,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaab'][v,q,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][v,q,s,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][t,s,:,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][p,q,:,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][t,s,:,q,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][t,s,p,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][p,q,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][t,s,:,p,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][p,q,:,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][t,s,:,q,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaab'][t,s,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][t,s,q,:] ) ))
    if p==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][r,s,:,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][t,q,:,r,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][t,q,:,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][r,s,t,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][t,q,r,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][r,s,:,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][t,q,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][t,q,:,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaab'][t,q,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][t,q,s,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][v,s,:,p,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][p,q,:,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][v,s,:,q,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][v,s,p,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][p,q,v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][v,s,:,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][p,q,:,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][v,s,:,q,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaab'][v,s,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][v,s,q,:] ) ))
    return result


def lucc_AAAAbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Haaaa'][s,t,:,:], HD['Dbaaaabaa'][p,q,v,w,u,r,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][s,u,:,:], HD['Dbaaaabaa'][p,q,v,w,t,r,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][q,w,:,:], HD['Dbaaaabaa'][r,s,t,u,v,p,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][q,v,:,:], HD['Dbaaaabaa'][r,s,t,u,w,p,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][q,t,:,:], HD['Dbaaaabaa'][r,s,v,w,u,p,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][q,u,:,:], HD['Dbaaaabaa'][r,s,v,w,t,p,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][s,w,:,:], HD['Dbaaaabaa'][p,q,t,u,v,r,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][s,v,:,:], HD['Dbaaaabaa'][p,q,t,u,w,r,:,:] ) ))
    result += 2 * fsum(( -HD['Haa'][q,t] * HD['Dbaaaab'][p,v,w,s,u,r] ,
                         +HD['Haa'][q,u] * HD['Dbaaaab'][p,v,w,s,t,r] ,
                         -HD['Haa'][q,w] * HD['Dbaaaab'][p,t,u,s,v,r] ,
                         +HD['Haa'][q,v] * HD['Dbaaaab'][p,t,u,s,w,r] ,
                         +HD['Haa'][s,t] * HD['Dbaaaab'][p,q,u,v,w,r] ,
                         -HD['Haa'][s,u] * HD['Dbaaaab'][p,q,t,v,w,r] ,
                         +HD['Haa'][s,w] * HD['Dbaaaab'][p,q,v,t,u,r] ,
                         -HD['Haa'][s,v] * HD['Dbaaaab'][p,q,w,t,u,r] ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,:,t,:], HD['Dbaaaaaba'][r,s,u,:,v,w,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,:,u,:], HD['Dbaaaaaba'][r,s,t,:,v,w,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,:,w,:], HD['Dbaaaaaba'][r,s,v,:,t,u,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,:,v,:], HD['Dbaaaaaba'][r,s,w,:,t,u,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,:,t,:], HD['Dbaaaaaba'][p,q,u,:,v,w,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,:,u,:], HD['Dbaaaaaba'][p,q,t,:,v,w,r,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,:,w,:], HD['Dbaaaaaba'][p,q,v,:,t,u,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,:,v,:], HD['Dbaaaaaba'][p,q,w,:,t,u,r,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][v,w,s,:], HD['Dbaaaba'][r,t,u,q,p,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][v,w,q,:], HD['Dbaaaba'][p,t,u,s,r,:] ) ,
                         -einsum( 'i,i->', HD['Haaaa'][t,u,s,:], HD['Dbaaaba'][r,v,w,q,p,:] ) ,
                         +einsum( 'i,i->', HD['Haaaa'][t,u,q,:], HD['Dbaaaba'][p,v,w,s,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][q,:,t,:], HD['Dbaabaabb'][r,s,u,:,v,w,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][q,:,u,:], HD['Dbaabaabb'][r,s,t,:,v,w,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][q,:,w,:], HD['Dbaabaabb'][r,s,v,:,t,u,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][q,:,v,:], HD['Dbaabaabb'][r,s,w,:,t,u,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][s,:,t,:], HD['Dbaabaabb'][p,q,u,:,v,w,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][s,:,u,:], HD['Dbaabaabb'][p,q,t,:,v,w,r,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][s,:,w,:], HD['Dbaabaabb'][p,q,v,:,t,u,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][s,:,v,:], HD['Dbaabaabb'][p,q,w,:,t,u,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,u,:], HD['Dbaaaaaab'][r,s,t,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,u,:], HD['Dbaaaaaab'][p,q,t,:,s,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,w,:], HD['Dbaaaaaab'][r,s,v,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,v,:], HD['Dbaaaaaab'][r,s,w,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,w,:], HD['Dbaaaaaab'][p,q,v,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,v,:], HD['Dbaaaaaab'][p,q,w,:,s,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,t,:], HD['Dbaaaaaab'][p,q,u,:,s,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,t,:], HD['Dbaaaaaab'][r,s,u,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbaaaaaab'][r,s,t,u,q,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,v,:,:], HD['Dbaaaaaab'][r,s,t,u,q,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbaaaaaab'][p,q,t,u,s,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,v,:,:], HD['Dbaaaaaab'][p,q,t,u,s,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,t,:,:], HD['Dbaaaaaab'][r,s,v,w,q,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbaaaaaab'][r,s,v,w,q,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,t,:,:], HD['Dbaaaaaab'][p,q,v,w,s,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbaaaaaab'][p,q,v,w,s,t,:,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][r,s,t,:], HD['Dbaaaab'][p,q,u,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][r,s,u,:], HD['Dbaaaab'][p,q,t,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][r,s,w,:], HD['Dbaaaab'][p,q,v,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][r,s,v,:], HD['Dbaaaab'][p,q,w,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][p,q,t,:], HD['Dbaaaab'][r,s,u,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][p,q,u,:], HD['Dbaaaab'][r,s,t,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][p,q,w,:], HD['Dbaaaab'][r,s,v,t,u,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][p,q,v,:], HD['Dbaaaab'][r,s,w,t,u,:] ) ))
    if s==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][r,t,u,:,v,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,v,:,:], HD['Dbaabaa'][r,t,u,p,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][p,q,v,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][r,t,u,:,q,v,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][r,t,u,v,p,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][r,t,u,:,v,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][p,q,v,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][r,t,u,:,q,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,:,v,:], HD['Dbaaaab'][p,q,:,t,u,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaaaab'][r,t,u,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,v,:,:], HD['Dbaaaab'][r,t,u,q,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][p,q,v,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][r,t,u,q,v,:] ) ))
    if s==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][r,t,u,:,w,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,w,:,:], HD['Dbaabaa'][r,t,u,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][p,q,w,:,t,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][r,t,u,:,q,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][r,t,u,w,p,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][r,t,u,:,w,p,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][p,q,w,:,t,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][r,t,u,:,q,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,:,w,:], HD['Dbaaaab'][p,q,:,t,u,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaaaab'][r,t,u,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbaaaab'][r,t,u,q,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][p,q,w,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][r,t,u,q,w,:] ) ))
    if s==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][r,v,w,:,u,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,u,:,:], HD['Dbaabaa'][r,v,w,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][r,v,w,:,q,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][p,q,u,:,v,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][r,v,w,u,p,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][r,v,w,:,u,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][p,q,u,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][r,v,w,:,q,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,:,u,:], HD['Dbaaaab'][p,q,:,v,w,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaaaab'][r,v,w,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbaaaab'][r,v,w,q,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][r,v,w,q,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][p,q,u,v,w,:] ) ))
    if s==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][r,v,w,:,t,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,t,:,:], HD['Dbaabaa'][r,v,w,p,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][r,v,w,:,q,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][p,q,t,:,v,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][r,v,w,t,p,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][r,v,w,:,t,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][r,v,w,:,q,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][p,q,t,:,v,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,:,t,:], HD['Dbaaaab'][p,q,:,v,w,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,t,:,:], HD['Dbaaaab'][r,v,w,q,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaaaab'][r,v,w,t,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][r,v,w,q,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][p,q,t,v,w,:] ) ))
    if q==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][p,t,u,:,v,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,v,:,:], HD['Dbaabaa'][p,t,u,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][r,s,v,:,t,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][p,t,u,:,s,v,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][p,t,u,v,r,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][p,t,u,:,v,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][r,s,v,:,t,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][p,t,u,:,s,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,:,v,:], HD['Dbaaaab'][r,s,:,t,u,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,v,:,:], HD['Dbaaaab'][p,t,u,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaaaab'][p,t,u,v,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][p,t,u,s,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][r,s,v,t,u,:] ) ))
    if q==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][p,t,u,:,w,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,w,:,:], HD['Dbaabaa'][p,t,u,r,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][r,s,w,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][p,t,u,:,s,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][p,t,u,w,r,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][p,t,u,:,w,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][r,s,w,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][p,t,u,:,s,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,:,w,:], HD['Dbaaaab'][r,s,:,t,u,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbaaaab'][p,t,u,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaaaab'][p,t,u,w,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][r,s,w,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][p,t,u,s,w,:] ) ))
    if q==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][p,v,w,:,u,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,u,:,:], HD['Dbaabaa'][p,v,w,r,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][p,v,w,:,s,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][r,s,u,:,v,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][p,v,w,u,r,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][p,v,w,:,u,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][r,s,u,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][p,v,w,:,s,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,:,u,:], HD['Dbaaaab'][r,s,:,v,w,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaaaab'][p,v,w,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbaaaab'][p,v,w,s,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][p,v,w,s,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][r,s,u,v,w,:] ) ))
    if q==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][p,v,w,:,t,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,t,:,:], HD['Dbaabaa'][p,v,w,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][p,v,w,:,s,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][r,s,t,:,v,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][p,v,w,t,r,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][p,v,w,:,t,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][r,s,t,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][p,v,w,:,s,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,:,t,:], HD['Dbaaaab'][r,s,:,v,w,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,t,:,:], HD['Dbaaaab'][p,v,w,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaaaab'][p,v,w,t,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][p,v,w,s,t,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][r,s,t,v,w,:] ) ))
    return result


def lucc_AAAAbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Haaaa'][q,u,:,:], HD['Dbbaabbaa'][r,v,s,w,p,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Haaaa'][s,w,:,:], HD['Dbbaabbaa'][p,t,q,u,r,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][s,u,:,:], HD['Dbbaabbaa'][p,v,q,w,r,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Haaaa'][q,w,:,:], HD['Dbbaabbaa'][r,t,s,u,p,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbaaaabb'][r,t,s,u,q,w,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbaaaabb'][r,v,s,w,q,u,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbaaaabb'][p,t,q,u,s,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbaaaabb'][p,v,q,w,s,u,:,:] ) ))
    result += 2 * fsum(( -HD['Haa'][q,u] * HD['Dbbaabb'][p,v,w,s,r,t] ,
                         +HD['Haa'][s,u] * HD['Dbbaabb'][p,t,q,w,r,v] ,
                         -HD['Haa'][s,w] * HD['Dbbaabb'][p,v,q,u,r,t] ,
                         +HD['Haa'][q,w] * HD['Dbbaabb'][p,t,u,s,r,v] ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,:,w,:], HD['Dbbaaabba'][r,v,s,:,u,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,:,u,:], HD['Dbbaaabba'][p,t,q,:,w,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,:,w,:], HD['Dbbaaabba'][p,v,q,:,u,r,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,:,u,:], HD['Dbbaaabba'][r,t,s,:,w,p,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][s,:,w,:], HD['Dbbababbb'][p,v,q,:,u,r,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][q,:,w,:], HD['Dbbababbb'][r,v,s,:,u,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habab'][s,:,u,:], HD['Dbbababbb'][p,t,q,:,w,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habab'][q,:,u,:], HD['Dbbababbb'][r,t,s,:,w,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][q,:,v,:], HD['Dbaababba'][r,s,w,:,u,p,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][s,:,v,:], HD['Dbaababba'][p,q,w,:,u,r,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][s,:,t,:], HD['Dbaababba'][p,q,u,:,w,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][q,:,t,:], HD['Dbaababba'][r,s,u,:,w,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,u,:], HD['Dbbaaaabb'][p,t,q,:,s,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,w,:], HD['Dbbaaaabb'][r,v,s,:,q,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,w,:], HD['Dbbaaaabb'][p,v,q,:,s,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,u,:], HD['Dbbaaaabb'][r,t,s,:,q,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbbaaabab'][r,v,s,w,u,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbbaaabab'][p,t,q,u,w,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbbaaabab'][r,t,s,u,q,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbbaaabab'][p,v,q,w,u,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbbaaabab'][r,v,s,w,q,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbbaaabab'][r,t,s,u,w,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbbaaabab'][p,t,q,u,s,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbbaaabab'][p,v,q,w,s,t,:,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][r,s,u,:], HD['Dbbaabb'][p,t,q,w,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][r,s,w,:], HD['Dbbaabb'][p,v,q,u,t,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][p,q,u,:], HD['Dbbaabb'][r,t,s,w,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][t,u,s,:], HD['Dbbaabb'][r,v,w,q,p,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][p,q,w,:], HD['Dbbaabb'][r,v,s,u,t,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][v,w,s,:], HD['Dbbaabb'][r,t,u,q,p,:] ) ,
                         +einsum( 'i,i->', HD['Hbaab'][t,u,q,:], HD['Dbbaabb'][p,v,w,s,r,:] ) ,
                         -einsum( 'i,i->', HD['Hbaab'][v,w,q,:], HD['Dbbaabb'][p,t,u,s,r,:] ) ,
                         -HD['Hbaab'][p,q,u,t] * HD['Dbaab'][r,s,w,v] ,
                         +HD['Hbaab'][r,s,u,t] * HD['Dbaab'][p,q,w,v] ,
                         +HD['Hbaab'][p,q,w,v] * HD['Dbaab'][r,s,u,t] ,
                         -HD['Hbaab'][r,s,w,v] * HD['Dbaab'][p,q,u,t] ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbaaaaaba'][r,s,u,:,q,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbaaaaaba'][r,s,w,:,q,u,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbaaaaaba'][p,q,w,:,s,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbaaaaaba'][p,q,u,:,s,w,v,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][r,s,t,:], HD['Dbaaaba'][p,q,u,w,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][p,q,t,:], HD['Dbaaaba'][r,s,u,w,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][r,s,v,:], HD['Dbaaaba'][p,q,w,u,t,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][p,q,v,:], HD['Dbaaaba'][r,s,w,u,t,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][t,u,p,:], HD['Dbaaaba'][v,q,w,s,r,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][v,w,p,:], HD['Dbaaaba'][t,q,u,s,r,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][t,u,r,:], HD['Dbaaaba'][v,s,w,q,p,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][v,w,r,:], HD['Dbaaaba'][t,s,u,q,p,:] ) ,
                         -HD['Hbb'][r,v] * HD['Dbaaaab'][p,q,w,s,u,t] ,
                         +HD['Hbb'][p,v] * HD['Dbaaaab'][t,q,u,s,w,r] ,
                         -HD['Hbb'][p,t] * HD['Dbaaaab'][v,q,w,s,u,r] ,
                         +HD['Hbb'][r,t] * HD['Dbaaaab'][p,q,u,s,w,v] ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbaabaabb'][r,s,u,:,q,w,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbaabaabb'][r,s,w,:,q,u,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbaabaabb'][p,q,u,:,s,w,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbaabaabb'][p,q,w,:,s,u,t,:] ) ))
    if p==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][r,s,u,:,w,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][v,q,w,:,u,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][s,u,:,:], HD['Dbaabaa'][v,q,w,r,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][v,q,w,:,s,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][r,s,u,w,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][v,q,w,u,r,:] ) ,
                             +HD['Haa'][q,u] * HD['Dbaab'][r,s,w,v] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][q,:,u,:], HD['Dbaaaba'][r,s,:,w,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][v,q,w,:,u,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][r,s,u,:,w,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][q,:,u,:], HD['Dbababb'][r,s,:,w,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][v,q,w,:,s,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbaaaab'][v,q,w,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaaaab'][v,q,w,u,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][v,q,w,s,u,:] ) ))
        if q==u:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][v,w,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][v,w,:,s,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][v,w,r,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][v,w,:,r,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][v,w,:,s,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaab'][v,w,:,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][v,w,s,:] ) ))
    if s==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][r,t,u,:,p,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][r,t,u,:,q,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][p,v,q,:,u,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbaabb'][r,t,u,q,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][r,t,u,p,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][r,t,u,:,p,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][r,t,u,:,q,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][p,v,q,:,u,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbbabab'][r,t,u,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbbabab'][r,t,u,p,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbaaaba'][p,q,:,u,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][r,t,u,q,v,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][p,v,q,u,t,:] ) ,
                             +HD['Hbb'][r,v] * HD['Dbaab'][p,q,u,t] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbababb'][p,q,:,u,t,:] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][t,u,:,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][t,u,:,q,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][t,u,p,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][t,u,:,p,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][t,u,:,q,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaab'][t,u,:,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][t,u,q,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][t,s,u,:,w,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][p,q,w,:,u,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Haaaa'][q,w,:,:], HD['Dbaabaa'][t,s,u,p,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][t,s,u,:,q,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][t,s,u,w,p,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][p,q,w,u,t,:] ) ,
                             +HD['Haa'][s,w] * HD['Dbaab'][p,q,u,t] ,
                             +einsum( 'ij,ij->', HD['Haaaa'][s,:,w,:], HD['Dbaaaba'][p,q,:,u,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][t,s,u,:,w,p,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][p,q,w,:,u,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habab'][s,:,w,:], HD['Dbababb'][p,q,:,u,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][t,s,u,:,q,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbaaaab'][t,s,u,q,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaaaab'][t,s,u,w,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][t,s,u,q,w,:] ) ))
    if p==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][t,q,u,:,w,r,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][r,s,w,:,u,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][s,w,:,:], HD['Dbaabaa'][t,q,u,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbaabaabb'][t,q,u,:,s,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][r,s,w,u,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][t,q,u,w,r,:] ) ,
                             -HD['Haa'][q,w] * HD['Dbaab'][r,s,u,t] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][q,:,w,:], HD['Dbaaaba'][r,s,:,u,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][r,s,w,:,u,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][t,q,u,:,w,r,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][q,:,w,:], HD['Dbababb'][r,s,:,u,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaaaab'][t,q,u,:,s,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaaaab'][t,q,u,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbaaaab'][t,q,u,s,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaaaab'][t,q,u,s,w,:] ) ))
        if q==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaabaa'][t,u,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbababb'][t,u,:,s,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaba'][t,u,r,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbabbab'][t,u,:,r,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbaaaab'][t,u,:,s,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbaab'][t,u,:,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbaab'][t,u,s,:] ) ))
    if s==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][r,v,w,:,p,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][r,v,w,:,q,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][p,t,q,:,w,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbaabb'][r,v,w,q,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][r,v,w,p,t,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][r,v,w,:,p,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][r,v,w,:,q,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][p,t,q,:,w,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbbabab'][r,v,w,p,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbbabab'][r,v,w,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbaaaba'][p,q,:,w,v,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][r,v,w,q,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][p,t,q,w,v,:] ) ,
                             -HD['Hbb'][r,t] * HD['Dbaab'][p,q,w,v] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbababb'][p,q,:,w,v,:] ) ))
        if r==t:
            result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaabaa'][v,w,:,p,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbababb'][v,w,:,q,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaba'][v,w,p,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbabbab'][v,w,:,p,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaab'][v,w,:,q,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaab'][v,w,:,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaab'][v,w,q,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbaaaabaa'][p,q,u,:,w,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbaaaabaa'][v,s,w,:,u,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Haaaa'][q,u,:,:], HD['Dbaabaa'][v,s,w,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbaabaabb'][v,s,w,:,q,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbaaaba'][v,s,w,u,p,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbaaaba'][p,q,u,w,v,:] ) ,
                             -HD['Haa'][s,u] * HD['Dbaab'][p,q,w,v] ,
                             -einsum( 'ij,ij->', HD['Haaaa'][s,:,u,:], HD['Dbaaaba'][p,q,:,w,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbaababab'][p,q,u,:,w,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbaababab'][v,s,w,:,u,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habab'][s,:,u,:], HD['Dbababb'][p,q,:,w,v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbaaaaaab'][v,s,w,:,q,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbaaaab'][v,s,w,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbaaaab'][v,s,w,q,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbaaaab'][v,s,w,q,u,:] ) ))
    if q==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][p,t,u,:,r,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][r,v,s,:,u,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][p,t,u,:,s,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbaabb'][p,t,u,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][p,t,u,r,v,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][p,t,u,:,r,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][r,v,s,:,u,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][p,t,u,:,s,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbbabab'][p,t,u,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbbabab'][p,t,u,r,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbaaaba'][r,s,:,u,t,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][p,t,u,s,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][r,v,s,u,t,:] ) ,
                             -HD['Hbb'][p,v] * HD['Dbaab'][r,s,u,t] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbababb'][r,s,:,u,t,:] ) ))
    if q==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][p,v,w,:,r,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][p,v,w,:,s,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][r,t,s,:,w,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbaabb'][p,v,w,s,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][p,v,w,r,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][p,v,w,:,r,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][r,t,s,:,w,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][p,v,w,:,s,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbbabab'][p,v,w,r,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbbabab'][p,v,w,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbaaaba'][r,s,:,w,v,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][r,t,s,w,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][p,v,w,s,t,:] ) ,
                             +HD['Hbb'][p,t] * HD['Dbaab'][r,s,w,v] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbababb'][r,s,:,w,v,:] ) ))
    return result


def lucc_AAAAbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['Hbbbb'][p,w,:,:], HD['Dbbbaabbb'][r,t,u,s,q,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbaabbb'][r,t,u,s,q,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbaabbb'][r,v,w,s,q,u,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,u,:,:], HD['Dbbbaabbb'][r,v,w,s,q,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,w,:,:], HD['Dbbbaabbb'][p,t,u,q,s,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbaabbb'][p,t,u,q,s,w,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbaabbb'][p,v,w,q,s,u,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,u,:,:], HD['Dbbbaabbb'][p,v,w,q,s,t,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Habba'][q,:,w,:], HD['Dbbabbbba'][r,v,s,:,p,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][q,:,v,:], HD['Dbbabbbba'][r,w,s,:,p,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][s,:,t,:], HD['Dbbabbbba'][p,u,q,:,r,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][s,:,u,:], HD['Dbbabbbba'][p,t,q,:,r,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][s,:,w,:], HD['Dbbabbbba'][p,v,q,:,r,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][s,:,v,:], HD['Dbbabbbba'][p,w,q,:,r,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Habba'][q,:,t,:], HD['Dbbabbbba'][r,u,s,:,p,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Habba'][q,:,u,:], HD['Dbbabbbba'][r,t,s,:,p,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbbbabbab'][r,v,w,s,p,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][u,q,:,:], HD['Dbbbabbab'][r,v,w,s,p,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][w,s,:,:], HD['Dbbbabbab'][p,t,u,q,r,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbbbabbab'][p,t,u,q,r,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbbbabbab'][p,v,w,q,r,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][u,s,:,:], HD['Dbbbabbab'][p,v,w,q,r,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][w,q,:,:], HD['Dbbbabbab'][r,t,u,s,p,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbbbabbab'][r,t,u,s,p,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbbaaabba'][p,u,q,:,s,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,u,:], HD['Dbbaaabba'][p,t,q,:,s,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,w,:], HD['Dbbaaabba'][p,v,q,:,s,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbbaaabba'][p,w,q,:,s,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbbaaabba'][r,u,s,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,u,:], HD['Dbbaaabba'][r,t,s,:,q,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,w,:], HD['Dbbaaabba'][r,v,s,:,q,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbbaaabba'][r,w,s,:,q,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][r,s,t,:], HD['Dbbabba'][p,u,q,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][r,s,u,:], HD['Dbbabba'][p,t,q,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][r,s,w,:], HD['Dbbabba'][p,v,q,t,u,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][r,s,v,:], HD['Dbbabba'][p,w,q,t,u,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][p,q,t,:], HD['Dbbabba'][r,u,s,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][p,q,u,:], HD['Dbbabba'][r,t,s,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][p,q,w,:], HD['Dbbabba'][r,v,s,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][p,q,v,:], HD['Dbbabba'][r,w,s,t,u,:] ) ,
                         -HD['Hbb'][p,t] * HD['Dbbaabb'][v,w,q,s,r,u] ,
                         +HD['Hbb'][p,u] * HD['Dbbaabb'][v,w,q,s,r,t] ,
                         -HD['Hbb'][p,w] * HD['Dbbaabb'][t,u,q,s,r,v] ,
                         +HD['Hbb'][p,v] * HD['Dbbaabb'][t,u,q,s,r,w] ,
                         +HD['Hbb'][r,t] * HD['Dbbaabb'][p,u,q,s,v,w] ,
                         -HD['Hbb'][r,u] * HD['Dbbaabb'][p,t,q,s,v,w] ,
                         +HD['Hbb'][r,w] * HD['Dbbaabb'][p,v,q,s,t,u] ,
                         -HD['Hbb'][r,v] * HD['Dbbaabb'][p,w,q,s,t,u] ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbbababbb'][r,u,s,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,u,:], HD['Dbbababbb'][r,t,s,:,q,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,w,:], HD['Dbbababbb'][r,v,s,:,q,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbbababbb'][r,w,s,:,q,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbbababbb'][p,u,q,:,s,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,u,:], HD['Dbbababbb'][p,t,q,:,s,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,w,:], HD['Dbbababbb'][p,v,q,:,s,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbbababbb'][p,w,q,:,s,t,u,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][t,u,p,:], HD['Dbbaabb'][v,w,q,s,r,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][v,w,r,:], HD['Dbbaabb'][t,u,s,q,p,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][t,u,r,:], HD['Dbbaabb'][v,w,s,q,p,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][v,w,p,:], HD['Dbbaabb'][t,u,q,s,r,:] ) ))
    if p==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][r,u,s,:,v,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][v,w,q,:,r,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][v,w,q,:,s,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,u,:,:], HD['Dbbaabb'][v,w,q,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][r,u,s,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][v,w,q,r,u,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][r,u,s,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][v,w,q,:,r,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habba'][q,:,u,:], HD['Dbabbba'][r,s,:,v,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][v,w,q,:,s,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbbabab'][v,w,q,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][u,s,:,:], HD['Dbbabab'][v,w,q,r,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][v,w,q,s,u,:] ) ))
    if p==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][r,t,s,:,v,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][v,w,q,:,r,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][v,w,q,:,s,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbaabb'][v,w,q,s,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][r,t,s,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][v,w,q,r,t,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][r,t,s,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][v,w,q,:,r,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habba'][q,:,t,:], HD['Dbabbba'][r,s,:,v,w,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][v,w,q,:,s,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][t,s,:,:], HD['Dbbabab'][v,w,q,r,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbbabab'][v,w,q,t,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][v,w,q,s,t,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][t,u,s,:,p,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][p,v,q,:,t,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][t,u,s,:,q,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbaabb'][t,u,s,q,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][t,u,s,p,v,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][p,v,q,t,u,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][t,u,s,:,p,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][p,v,q,:,t,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habba'][s,:,v,:], HD['Dbabbba'][p,q,:,t,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][t,u,s,:,q,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][v,q,:,:], HD['Dbbabab'][t,u,s,p,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbbabab'][t,u,s,v,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][t,u,s,q,v,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][p,w,q,:,t,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][t,u,s,:,p,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][t,u,s,:,q,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,w,:,:], HD['Dbbaabb'][t,u,s,q,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][t,u,s,p,w,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][p,w,q,t,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][t,u,s,:,p,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][p,w,q,:,t,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habba'][s,:,w,:], HD['Dbabbba'][p,q,:,t,u,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][t,u,s,:,q,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][w,q,:,:], HD['Dbbabab'][t,u,s,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbbabab'][t,u,s,w,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][t,u,s,q,w,:] ) ))
    if p==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][r,v,s,:,t,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][t,u,q,:,r,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][t,u,q,:,s,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbaabb'][t,u,q,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][r,v,s,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][t,u,q,r,v,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][t,u,q,:,r,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][r,v,s,:,t,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habba'][q,:,v,:], HD['Dbabbba'][r,s,:,t,u,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][t,u,q,:,s,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbbabab'][t,u,q,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][v,s,:,:], HD['Dbbabab'][t,u,q,r,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][t,u,q,s,v,:] ) ))
    if p==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][r,w,s,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][t,u,q,:,r,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][t,u,q,:,s,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,w,:,:], HD['Dbbaabb'][t,u,q,s,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][r,w,s,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][t,u,q,r,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][t,u,q,:,r,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][r,w,s,:,t,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habba'][q,:,w,:], HD['Dbabbba'][r,s,:,t,u,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][t,u,q,:,s,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,s,:,:], HD['Dbbabab'][t,u,q,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][w,s,:,:], HD['Dbbabab'][t,u,q,r,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][t,u,q,s,w,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][v,w,s,:,p,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][p,u,q,:,v,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][v,w,s,:,q,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,u,:,:], HD['Dbbaabb'][v,w,s,q,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][v,w,s,p,u,:] ) ,
                             +einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][p,u,q,v,w,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][p,u,q,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][v,w,s,:,p,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Habba'][s,:,u,:], HD['Dbabbba'][p,q,:,v,w,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][v,w,s,:,q,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][u,q,:,:], HD['Dbbabab'][v,w,s,p,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbbabab'][v,w,s,u,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][v,w,s,q,u,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Haaaa'][q,:,:,:], HD['Dbbaabbaa'][v,w,s,:,p,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Haaaa'][s,:,:,:], HD['Dbbaabbaa'][p,t,q,:,v,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][v,w,s,:,q,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbaabb'][v,w,s,q,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['Haa'][q,:], HD['Dbbabba'][v,w,s,p,t,:] ) ,
                             -einsum( 'i,i->', HD['Haa'][s,:], HD['Dbbabba'][p,t,q,v,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Habab'][s,:,:,:], HD['Dbbabbbab'][p,t,q,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Habab'][q,:,:,:], HD['Dbbabbbab'][v,w,s,:,p,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Habba'][s,:,t,:], HD['Dbabbba'][p,q,:,v,w,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][v,w,s,:,q,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][t,q,:,:], HD['Dbbabab'][v,w,s,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,q,:,:], HD['Dbbabab'][v,w,s,t,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][v,w,s,q,t,:] ) ))
    return result


def lucc_AAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s) = e
    result = 0
    result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][r,s,:,q,:,:] ) ,
                     +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][r,s,:,p,:,:] ) ,
                     -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][p,q,:,r,:,:] ) ,
                     +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][p,q,:,s,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][r,s,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][p,q,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][r,s,:,q,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][r,s,:,p,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][p,q,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][p,q,:,s,:,:] ) ,
                         -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][r,s,q,:] ) ,
                         +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][r,s,p,:] ) ,
                         -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][p,q,r,:] ) ,
                         +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][p,q,s,:] ) ))
    return result


def lucc_AAAAbbbb_AAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,v) = e
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['Hbaab'][p,:,t,:], HD['Dbbaabb'][r,s,:,v,q,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,v,:], HD['Dbbaabb'][r,s,:,t,q,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][q,:,t,:], HD['Dbbaabb'][r,s,:,v,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][q,:,v,:], HD['Dbbaabb'][r,s,:,t,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][s,:,t,:], HD['Dbbaabb'][p,q,:,v,r,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][s,:,v,:], HD['Dbbaabb'][p,q,:,t,r,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,t,:], HD['Dbbaabb'][p,q,:,v,s,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,v,:], HD['Dbbaabb'][p,q,:,t,s,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,v,:,:], HD['Dbbabab'][r,s,t,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,t,:,:], HD['Dbbabab'][r,s,v,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][q,v,:,:], HD['Dbbabab'][r,s,t,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][q,t,:,:], HD['Dbbabab'][r,s,v,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][s,v,:,:], HD['Dbbabab'][p,q,t,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][s,t,:,:], HD['Dbbabab'][p,q,v,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,v,:,:], HD['Dbbabab'][p,q,t,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,t,:,:], HD['Dbbabab'][p,q,v,s,:,:] ) ))
    return result


def lucc_AAAAbbbb_AAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,v) = e
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbbbb'][p,q,t,s,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbbbb'][p,q,v,s,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbbbb'][r,s,t,q,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbbbb'][r,s,v,q,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][q,v,:,:], HD['Dbbbbbb'][r,s,t,p,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][q,t,:,:], HD['Dbbbbbb'][r,s,v,p,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][s,v,:,:], HD['Dbbbbbb'][p,q,t,r,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][s,t,:,:], HD['Dbbbbbb'][p,q,v,r,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbbabba'][r,s,:,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbbabba'][r,s,:,q,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][q,:,t,:], HD['Dbbabba'][r,s,:,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][q,:,v,:], HD['Dbbabba'][r,s,:,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][s,:,t,:], HD['Dbbabba'][p,q,:,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][s,:,v,:], HD['Dbbabba'][p,q,:,r,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbbabba'][p,q,:,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbbabba'][p,q,:,s,t,:] ) ,
                         -HD['Hbb'][p,t] * HD['Dbbbb'][q,v,r,s] ,
                         +HD['Hbb'][p,v] * HD['Dbbbb'][q,t,r,s] ,
                         +HD['Hbb'][q,t] * HD['Dbbbb'][p,v,r,s] ,
                         -HD['Hbb'][q,v] * HD['Dbbbb'][p,t,r,s] ,
                         -HD['Hbb'][s,t] * HD['Dbbbb'][p,q,r,v] ,
                         +HD['Hbb'][s,v] * HD['Dbbbb'][p,q,r,t] ,
                         +HD['Hbb'][r,t] * HD['Dbbbb'][p,q,s,v] ,
                         -HD['Hbb'][r,v] * HD['Dbbbb'][p,q,s,t] ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbbbbbb'][r,s,:,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbbbbbb'][r,s,:,q,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][q,:,t,:], HD['Dbbbbbb'][r,s,:,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][q,:,v,:], HD['Dbbbbbb'][r,s,:,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][s,:,t,:], HD['Dbbbbbb'][p,q,:,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][s,:,v,:], HD['Dbbbbbb'][p,q,:,r,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbbbbbb'][p,q,:,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbbbbbb'][p,q,:,s,t,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][p,q,t,:], HD['Dbbbb'][r,s,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][p,q,v,:], HD['Dbbbb'][r,s,t,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][r,s,t,:], HD['Dbbbb'][p,q,v,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][r,s,v,:], HD['Dbbbb'][p,q,t,:] ) ))
    if q==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][r,s,:,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][p,v,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][p,v,:,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][p,v,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][r,s,:,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][p,v,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][p,v,:,s,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][r,s,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][p,v,r,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][p,v,s,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][p,q,:,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][s,t,:,q,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][s,t,:,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][s,t,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][s,t,:,q,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][s,t,:,p,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][p,q,:,t,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][s,t,q,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][s,t,p,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][p,q,t,:] ) ))
    if s==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][r,t,:,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][r,t,:,q,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][p,q,:,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][r,t,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][r,t,:,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][r,t,:,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][p,q,:,t,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][r,t,q,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][r,t,p,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][p,q,t,:] ) ))
    if q==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][p,t,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][r,s,:,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][p,t,:,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][p,t,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][r,s,:,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][p,t,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][p,t,:,s,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][r,s,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][p,t,s,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][p,t,r,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][p,q,:,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][s,v,:,q,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][s,v,:,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][s,v,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][s,v,:,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][s,v,:,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][p,q,:,v,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][s,v,q,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][s,v,p,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][p,q,v,:] ) ))
    if s==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][p,q,:,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][r,v,:,q,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][r,v,:,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][r,v,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][r,v,:,q,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][r,v,:,p,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][p,q,:,v,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][r,v,q,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][r,v,p,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][p,q,v,:] ) ))
    if p==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][q,v,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][r,s,:,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][q,v,:,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][q,v,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][r,s,:,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][q,v,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][q,v,:,s,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][r,s,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][q,v,s,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][q,v,r,:] ) ))
    if p==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][q,t,:,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][q,t,:,s,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][r,s,:,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][q,t,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][r,s,:,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][q,t,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][q,t,:,s,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][q,t,s,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][r,s,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][q,t,r,:] ) ))
    return result


def lucc_AAAAbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Hbaab'][p,:,t,:], HD['Dbbaaaabb'][r,s,u,:,v,w,q,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,u,:], HD['Dbbaaaabb'][r,s,t,:,v,w,q,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,w,:], HD['Dbbaaaabb'][r,s,v,:,t,u,q,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,v,:], HD['Dbbaaaabb'][r,s,w,:,t,u,q,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][q,:,t,:], HD['Dbbaaaabb'][r,s,u,:,v,w,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][q,:,u,:], HD['Dbbaaaabb'][r,s,t,:,v,w,p,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][q,:,w,:], HD['Dbbaaaabb'][r,s,v,:,t,u,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][q,:,v,:], HD['Dbbaaaabb'][r,s,w,:,t,u,p,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][s,:,t,:], HD['Dbbaaaabb'][p,q,u,:,v,w,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][s,:,u,:], HD['Dbbaaaabb'][p,q,t,:,v,w,r,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][s,:,w,:], HD['Dbbaaaabb'][p,q,v,:,t,u,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][s,:,v,:], HD['Dbbaaaabb'][p,q,w,:,t,u,r,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,t,:], HD['Dbbaaaabb'][p,q,u,:,v,w,s,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,u,:], HD['Dbbaaaabb'][p,q,t,:,v,w,s,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,w,:], HD['Dbbaaaabb'][p,q,v,:,t,u,s,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,v,:], HD['Dbbaaaabb'][p,q,w,:,t,u,s,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbbaaabab'][r,s,t,u,v,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,v,:,:], HD['Dbbaaabab'][r,s,t,u,w,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,t,:,:], HD['Dbbaaabab'][r,s,v,w,u,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbbaaabab'][r,s,v,w,t,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][q,w,:,:], HD['Dbbaaabab'][r,s,t,u,v,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][q,v,:,:], HD['Dbbaaabab'][r,s,t,u,w,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][q,t,:,:], HD['Dbbaaabab'][r,s,v,w,u,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][q,u,:,:], HD['Dbbaaabab'][r,s,v,w,t,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][s,w,:,:], HD['Dbbaaabab'][p,q,t,u,v,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][s,v,:,:], HD['Dbbaaabab'][p,q,t,u,w,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][s,t,:,:], HD['Dbbaaabab'][p,q,v,w,u,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][s,u,:,:], HD['Dbbaaabab'][p,q,v,w,t,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbbaaabab'][p,q,t,u,v,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,v,:,:], HD['Dbbaaabab'][p,q,t,u,w,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,t,:,:], HD['Dbbaaabab'][p,q,v,w,u,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbbaaabab'][p,q,v,w,t,s,:,:] ) ))
    return result


def lucc_AAAAbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['Hbbbb'][q,v,:,:], HD['Dbbbaabbb'][r,s,t,u,w,p,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][q,t,:,:], HD['Dbbbaabbb'][r,s,v,w,u,p,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][s,v,:,:], HD['Dbbbaabbb'][p,q,t,u,w,r,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][s,t,:,:], HD['Dbbbaabbb'][p,q,v,w,u,r,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbaabbb'][p,q,t,u,w,s,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbaabbb'][p,q,v,w,u,s,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbaabbb'][r,s,t,u,w,q,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbaabbb'][r,s,v,w,u,q,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['Hbaab'][s,:,u,:], HD['Dbbbaabbb'][p,q,t,:,w,r,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][s,:,w,:], HD['Dbbbaabbb'][p,q,v,:,u,r,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,:,u,:], HD['Dbbbaabbb'][p,q,t,:,w,s,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,:,w,:], HD['Dbbbaabbb'][p,q,v,:,u,s,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,:,u,:], HD['Dbbbaabbb'][r,s,t,:,w,q,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,:,w,:], HD['Dbbbaabbb'][r,s,v,:,u,q,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][q,:,u,:], HD['Dbbbaabbb'][r,s,t,:,w,p,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][q,:,w,:], HD['Dbbbaabbb'][r,s,v,:,u,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][s,w,:,:], HD['Dbbbabbab'][p,q,t,u,r,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][s,u,:,:], HD['Dbbbabbab'][p,q,v,w,r,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbbbabbab'][p,q,t,u,s,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbbbabbab'][p,q,v,w,s,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbbbabbab'][r,s,t,u,q,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbbbabbab'][r,s,v,w,q,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaab'][q,w,:,:], HD['Dbbbabbab'][r,s,t,u,p,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaab'][q,u,:,:], HD['Dbbbabbab'][r,s,v,w,p,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][s,:,t,:], HD['Dbbaaabba'][p,q,u,:,w,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][s,:,v,:], HD['Dbbaaabba'][p,q,w,:,u,r,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbbaaabba'][p,q,u,:,w,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbbaaabba'][p,q,w,:,u,s,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbbaaabba'][r,s,u,:,w,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbbaaabba'][r,s,w,:,u,q,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][q,:,t,:], HD['Dbbaaabba'][r,s,u,:,w,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][q,:,v,:], HD['Dbbaaabba'][r,s,w,:,u,p,t,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][t,u,s,:], HD['Dbbabba'][r,v,w,p,q,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][v,w,s,:], HD['Dbbabba'][r,t,u,p,q,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][t,u,r,:], HD['Dbbabba'][s,v,w,p,q,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][v,w,r,:], HD['Dbbabba'][s,t,u,p,q,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][t,u,p,:], HD['Dbbabba'][q,v,w,r,s,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][v,w,p,:], HD['Dbbabba'][q,t,u,r,s,:] ) ,
                         -einsum( 'i,i->', HD['Hbaba'][t,u,q,:], HD['Dbbabba'][p,v,w,r,s,:] ) ,
                         +einsum( 'i,i->', HD['Hbaba'][v,w,q,:], HD['Dbbabba'][p,t,u,r,s,:] ) ,
                         +HD['Hbb'][p,t] * HD['Dbbaabb'][q,v,w,u,r,s] ,
                         -HD['Hbb'][p,v] * HD['Dbbaabb'][q,t,u,w,r,s] ,
                         -HD['Hbb'][q,t] * HD['Dbbaabb'][p,v,w,u,r,s] ,
                         +HD['Hbb'][q,v] * HD['Dbbaabb'][p,t,u,w,r,s] ,
                         +HD['Hbb'][s,t] * HD['Dbbaabb'][p,q,u,w,r,v] ,
                         -HD['Hbb'][s,v] * HD['Dbbaabb'][p,q,w,u,r,t] ,
                         -HD['Hbb'][r,t] * HD['Dbbaabb'][p,q,u,w,s,v] ,
                         +HD['Hbb'][r,v] * HD['Dbbaabb'][p,q,w,u,s,t] ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][q,:,t,:], HD['Dbbababbb'][r,s,u,:,w,p,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][q,:,v,:], HD['Dbbababbb'][r,s,w,:,u,p,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][s,:,t,:], HD['Dbbababbb'][p,q,u,:,w,r,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][s,:,v,:], HD['Dbbababbb'][p,q,w,:,u,r,t,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbbababbb'][p,q,u,:,w,s,v,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbbababbb'][p,q,w,:,u,s,t,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbbababbb'][r,s,u,:,w,q,v,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbbababbb'][r,s,w,:,u,q,t,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][p,q,t,:], HD['Dbbaabb'][r,s,u,w,v,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][p,q,v,:], HD['Dbbaabb'][r,s,w,u,t,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][r,s,t,:], HD['Dbbaabb'][p,q,u,w,v,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][r,s,v,:], HD['Dbbaabb'][p,q,w,u,t,:] ) ))
    if q==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][r,s,u,:,w,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][p,v,w,:,u,s,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbababbb'][p,v,w,:,u,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbaabb'][p,v,w,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][r,s,u,:,w,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][p,v,w,:,u,s,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbaaabab'][p,v,w,:,u,r,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,:,u,:], HD['Dbbaabb'][r,s,:,w,v,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbbabab'][p,v,w,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][s,u,:,:], HD['Dbbabab'][p,v,w,r,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][r,s,u,w,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][p,v,w,u,s,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbaabb'][p,v,w,u,r,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbababbb'][s,t,u,:,w,p,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][s,t,u,:,w,q,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbababbb'][p,q,w,:,u,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbaabb'][s,t,u,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbaaabab'][s,t,u,:,w,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][s,t,u,:,w,q,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbaaabab'][p,q,w,:,u,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][s,:,w,:], HD['Dbbaabb'][p,q,:,u,t,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbbabab'][s,t,u,q,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][q,w,:,:], HD['Dbbabab'][s,t,u,p,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][s,t,u,w,q,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbaabb'][s,t,u,w,p,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbaabb'][p,q,w,u,t,:] ) ))
    if s==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][p,q,w,:,u,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbababbb'][r,t,u,:,w,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][r,t,u,:,w,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbaabb'][r,t,u,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][r,t,u,:,w,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][p,q,w,:,u,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbaaabab'][r,t,u,:,w,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,:,w,:], HD['Dbbaabb'][p,q,:,u,t,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,w,:,:], HD['Dbbabab'][r,t,u,q,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][q,w,:,:], HD['Dbbabab'][r,t,u,p,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][r,t,u,w,q,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][p,q,w,u,t,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbaabb'][r,t,u,w,p,:] ) ))
    if q==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbababbb'][p,t,u,:,w,r,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][r,s,w,:,u,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][p,t,u,:,w,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbaabb'][p,t,u,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][p,t,u,:,w,s,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][r,s,w,:,u,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbaaabab'][p,t,u,:,w,r,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,:,w,:], HD['Dbbaabb'][r,s,:,u,t,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbbabab'][p,t,u,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][s,w,:,:], HD['Dbbabab'][p,t,u,r,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][p,t,u,w,s,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][r,s,w,u,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbaabb'][p,t,u,w,r,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbababbb'][p,q,u,:,w,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbababbb'][s,v,w,:,u,p,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][s,v,w,:,u,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbaabb'][s,v,w,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbaaabab'][s,v,w,:,u,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbaaabab'][p,q,u,:,w,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][s,v,w,:,u,q,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][s,:,u,:], HD['Dbbaabb'][p,q,:,w,v,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][q,u,:,:], HD['Dbbabab'][s,v,w,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbbabab'][s,v,w,q,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbaabb'][p,q,u,w,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][s,v,w,u,q,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbaabb'][s,v,w,u,p,:] ) ))
    if s==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbababbb'][r,v,w,:,u,q,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][p,q,u,:,w,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbababbb'][r,v,w,:,u,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbaabb'][r,v,w,u,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][p,q,u,:,w,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbaaabab'][r,v,w,:,u,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbaaabab'][r,v,w,:,u,q,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,:,u,:], HD['Dbbaabb'][p,q,:,w,v,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][q,u,:,:], HD['Dbbabab'][r,v,w,p,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][p,u,:,:], HD['Dbbabab'][r,v,w,q,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbaabb'][r,v,w,u,q,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbaabb'][r,v,w,u,p,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][p,q,u,w,v,:] ) ))
    if p==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbababbb'][r,s,u,:,w,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][q,v,w,:,u,s,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbababbb'][q,v,w,:,u,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbaabb'][q,v,w,u,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][q,v,w,:,u,s,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbaaabab'][r,s,u,:,w,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbaaabab'][q,v,w,:,u,r,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][q,:,u,:], HD['Dbbaabb'][r,s,:,w,v,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][r,u,:,:], HD['Dbbabab'][q,v,w,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][s,u,:,:], HD['Dbbabab'][q,v,w,r,:,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbaabb'][r,s,u,w,v,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][q,v,w,u,s,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbaabb'][q,v,w,u,r,:] ) ))
    if p==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbababbb'][q,t,u,:,w,s,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbababbb'][q,t,u,:,w,r,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbababbb'][r,s,w,:,u,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbaabb'][q,t,u,w,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbaaabab'][r,s,w,:,u,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbaaabab'][q,t,u,:,w,s,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbaaabab'][q,t,u,:,w,r,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][q,:,w,:], HD['Dbbaabb'][r,s,:,u,t,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaab'][r,w,:,:], HD['Dbbabab'][q,t,u,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaab'][s,w,:,:], HD['Dbbabab'][q,t,u,r,:,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbaabb'][r,s,w,u,t,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbaabb'][q,t,u,w,r,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbaabb'][q,t,u,w,s,:] ) ))
    return result


def lucc_AAAAbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(t,u,v,w) = e
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['Hbbbb'][s,w,:,:], HD['Dbbbbbbbb'][p,q,t,u,r,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][s,v,:,:], HD['Dbbbbbbbb'][p,q,t,u,r,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][s,t,:,:], HD['Dbbbbbbbb'][p,q,v,w,r,u,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,w,:,:], HD['Dbbbbbbbb'][r,s,t,u,q,v,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbbbbbb'][r,s,t,u,q,w,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][s,u,:,:], HD['Dbbbbbbbb'][p,q,v,w,r,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,w,:,:], HD['Dbbbbbbbb'][p,q,t,u,s,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbbbbbb'][r,s,v,w,q,u,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][p,u,:,:], HD['Dbbbbbbbb'][r,s,v,w,q,t,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbbbbbb'][p,q,t,u,s,w,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbbbbbb'][p,q,v,w,s,u,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][q,w,:,:], HD['Dbbbbbbbb'][r,s,t,u,p,v,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][q,v,:,:], HD['Dbbbbbbbb'][r,s,t,u,p,w,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][r,u,:,:], HD['Dbbbbbbbb'][p,q,v,w,s,t,:,:] ) ,
                     +einsum( 'ij,ij->', HD['Hbbbb'][q,t,:,:], HD['Dbbbbbbbb'][r,s,v,w,p,u,:,:] ) ,
                     -einsum( 'ij,ij->', HD['Hbbbb'][q,u,:,:], HD['Dbbbbbbbb'][r,s,v,w,p,t,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbbbabbba'][r,s,u,:,q,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,u,:], HD['Dbbbabbba'][r,s,t,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][p,:,w,:], HD['Dbbbabbba'][r,s,v,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbbbabbba'][r,s,w,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][q,:,t,:], HD['Dbbbabbba'][r,s,u,:,p,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][q,:,u,:], HD['Dbbbabbba'][r,s,t,:,p,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][q,:,w,:], HD['Dbbbabbba'][r,s,v,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][q,:,v,:], HD['Dbbbabbba'][r,s,w,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][s,:,t,:], HD['Dbbbabbba'][p,q,u,:,r,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][s,:,u,:], HD['Dbbbabbba'][p,q,t,:,r,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][s,:,w,:], HD['Dbbbabbba'][p,q,v,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][s,:,v,:], HD['Dbbbabbba'][p,q,w,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbbbabbba'][p,q,u,:,s,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,u,:], HD['Dbbbabbba'][p,q,t,:,s,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbaba'][r,:,w,:], HD['Dbbbabbba'][p,q,v,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbbbabbba'][p,q,w,:,s,t,u,:] ) ,
                         +HD['Hbb'][p,t] * HD['Dbbbbbb'][q,v,w,r,s,u] ,
                         -HD['Hbb'][p,u] * HD['Dbbbbbb'][q,v,w,r,s,t] ,
                         +HD['Hbb'][p,w] * HD['Dbbbbbb'][q,t,u,r,s,v] ,
                         -HD['Hbb'][p,v] * HD['Dbbbbbb'][q,t,u,r,s,w] ,
                         -HD['Hbb'][q,t] * HD['Dbbbbbb'][p,v,w,r,s,u] ,
                         +HD['Hbb'][q,u] * HD['Dbbbbbb'][p,v,w,r,s,t] ,
                         -HD['Hbb'][q,w] * HD['Dbbbbbb'][p,t,u,r,s,v] ,
                         +HD['Hbb'][q,v] * HD['Dbbbbbb'][p,t,u,r,s,w] ,
                         +HD['Hbb'][s,t] * HD['Dbbbbbb'][p,q,u,r,v,w] ,
                         -HD['Hbb'][s,u] * HD['Dbbbbbb'][p,q,t,r,v,w] ,
                         +HD['Hbb'][s,w] * HD['Dbbbbbb'][p,q,v,r,t,u] ,
                         -HD['Hbb'][s,v] * HD['Dbbbbbb'][p,q,w,r,t,u] ,
                         -HD['Hbb'][r,t] * HD['Dbbbbbb'][p,q,u,s,v,w] ,
                         +HD['Hbb'][r,u] * HD['Dbbbbbb'][p,q,t,s,v,w] ,
                         -HD['Hbb'][r,w] * HD['Dbbbbbb'][p,q,v,s,t,u] ,
                         +HD['Hbb'][r,v] * HD['Dbbbbbb'][p,q,w,s,t,u] ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,u,:], HD['Dbbbbbbbb'][p,q,t,:,s,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,w,:], HD['Dbbbbbbbb'][p,q,v,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbbbbbbbb'][p,q,w,:,s,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbbbbbbbb'][r,s,u,:,q,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,u,:], HD['Dbbbbbbbb'][r,s,t,:,q,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,:,w,:], HD['Dbbbbbbbb'][r,s,v,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbbbbbbbb'][r,s,w,:,q,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][q,:,t,:], HD['Dbbbbbbbb'][r,s,u,:,p,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][q,:,u,:], HD['Dbbbbbbbb'][r,s,t,:,p,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][q,:,w,:], HD['Dbbbbbbbb'][r,s,v,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][q,:,v,:], HD['Dbbbbbbbb'][r,s,w,:,p,t,u,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][s,:,t,:], HD['Dbbbbbbbb'][p,q,u,:,r,v,w,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][s,:,u,:], HD['Dbbbbbbbb'][p,q,t,:,r,v,w,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][s,:,w,:], HD['Dbbbbbbbb'][p,q,v,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][s,:,v,:], HD['Dbbbbbbbb'][p,q,w,:,r,t,u,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbbbbbbbb'][p,q,u,:,s,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][p,q,t,:], HD['Dbbbbbb'][r,s,u,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][p,q,u,:], HD['Dbbbbbb'][r,s,t,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][v,w,r,:], HD['Dbbbbbb'][s,t,u,p,q,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][p,q,w,:], HD['Dbbbbbb'][r,s,v,t,u,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][p,q,v,:], HD['Dbbbbbb'][r,s,w,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][t,u,p,:], HD['Dbbbbbb'][q,v,w,r,s,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][v,w,p,:], HD['Dbbbbbb'][q,t,u,r,s,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][t,u,q,:], HD['Dbbbbbb'][p,v,w,r,s,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][v,w,q,:], HD['Dbbbbbb'][p,t,u,r,s,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][r,s,t,:], HD['Dbbbbbb'][p,q,u,v,w,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][r,s,u,:], HD['Dbbbbbb'][p,q,t,v,w,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][r,s,w,:], HD['Dbbbbbb'][p,q,v,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][r,s,v,:], HD['Dbbbbbb'][p,q,w,t,u,:] ) ,
                         +einsum( 'i,i->', HD['Hbbbb'][t,u,s,:], HD['Dbbbbbb'][r,v,w,p,q,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][v,w,s,:], HD['Dbbbbbb'][r,t,u,p,q,:] ) ,
                         -einsum( 'i,i->', HD['Hbbbb'][t,u,r,:], HD['Dbbbbbb'][s,v,w,p,q,:] ) ,
                         -HD['Hbbbb'][p,q,t,u] * HD['Dbbbb'][r,s,v,w] ,
                         +HD['Hbbbb'][r,s,t,u] * HD['Dbbbb'][p,q,v,w] ,
                         +HD['Hbbbb'][p,q,v,w] * HD['Dbbbb'][r,s,t,u] ,
                         -HD['Hbbbb'][r,s,v,w] * HD['Dbbbb'][p,q,t,u] ))
    if q==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][p,v,w,:,r,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][r,s,t,:,v,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][p,v,w,:,s,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbbbb'][p,v,w,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbbbb'][p,v,w,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][s,t,:,:], HD['Dbbbbbb'][p,v,w,r,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][p,v,w,:,s,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][r,s,t,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][p,v,w,:,r,t,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][p,:,t,:], HD['Dbbabba'][r,s,:,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][r,s,t,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][p,v,w,r,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][p,v,w,s,t,:] ) ,
                             -HD['Hbb'][p,t] * HD['Dbbbb'][r,s,v,w] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][p,:,t,:], HD['Dbbbbbb'][r,s,:,v,w,:] ) ))
        if p==t:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][v,w,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][v,w,:,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][v,w,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][v,w,:,r,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][v,w,:,s,:,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][v,w,r,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][v,w,s,:] ) ))
    if q==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][p,v,w,:,r,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][r,s,u,:,v,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][p,v,w,:,s,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbbbb'][p,v,w,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][s,u,:,:], HD['Dbbbbbb'][p,v,w,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,u,:,:], HD['Dbbbbbb'][p,v,w,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][p,v,w,:,s,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][r,s,u,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][p,v,w,:,r,u,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][p,:,u,:], HD['Dbbabba'][r,s,:,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][r,s,u,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][p,v,w,r,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][p,v,w,s,u,:] ) ,
                             +HD['Hbb'][p,u] * HD['Dbbbb'][r,s,v,w] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][p,:,u,:], HD['Dbbbbbb'][r,s,:,v,w,:] ) ))
        if p==u:
            result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][v,w,:,r,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][v,w,:,s,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][v,w,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][v,w,:,r,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][v,w,:,s,:,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][v,w,r,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][v,w,s,:] ) ))
    if s==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][r,t,u,:,q,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][r,t,u,:,p,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][p,q,w,:,t,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,w,:,:], HD['Dbbbbbb'][r,t,u,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][q,w,:,:], HD['Dbbbbbb'][r,t,u,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbbbb'][r,t,u,w,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][p,q,w,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][r,t,u,:,p,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][r,t,u,:,q,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][r,:,w,:], HD['Dbbabba'][p,q,:,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][p,q,w,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][r,t,u,p,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][r,t,u,q,w,:] ) ,
                             +HD['Hbb'][r,w] * HD['Dbbbb'][p,q,t,u] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][r,:,w,:], HD['Dbbbbbb'][p,q,:,t,u,:] ) ))
        if r==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][t,u,:,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][t,u,:,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][t,u,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][t,u,:,q,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][t,u,:,p,:,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][t,u,q,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][t,u,p,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][s,t,u,:,p,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][p,q,v,:,t,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][s,t,u,:,q,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][q,v,:,:], HD['Dbbbbbb'][s,t,u,p,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbbbb'][s,t,u,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbbbb'][s,t,u,q,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][p,q,v,:,t,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][s,t,u,:,q,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][s,t,u,:,p,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][s,:,v,:], HD['Dbbabba'][p,q,:,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][s,t,u,q,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][s,t,u,p,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][p,q,v,t,u,:] ) ,
                             +HD['Hbb'][s,v] * HD['Dbbbb'][p,q,t,u] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][s,:,v,:], HD['Dbbbbbb'][p,q,:,t,u,:] ) ))
    if s==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][r,t,u,:,q,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][r,t,u,:,p,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][p,q,v,:,t,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][q,v,:,:], HD['Dbbbbbb'][r,t,u,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbbbb'][r,t,u,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,v,:,:], HD['Dbbbbbb'][r,t,u,q,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][r,t,u,:,p,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][r,t,u,:,q,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][p,q,v,:,t,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][r,:,v,:], HD['Dbbabba'][p,q,:,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][p,q,v,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][r,t,u,p,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][r,t,u,q,v,:] ) ,
                             -HD['Hbb'][r,v] * HD['Dbbbb'][p,q,t,u] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][r,:,v,:], HD['Dbbbbbb'][p,q,:,t,u,:] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][t,u,:,p,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][t,u,:,q,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][t,u,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][t,u,:,p,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][t,u,:,q,:,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][t,u,p,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][t,u,q,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][s,t,u,:,p,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][p,q,w,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][s,t,u,:,q,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][q,w,:,:], HD['Dbbbbbb'][s,t,u,p,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbbbb'][s,t,u,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,w,:,:], HD['Dbbbbbb'][s,t,u,q,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][s,t,u,:,p,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][p,q,w,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][s,t,u,:,q,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][s,:,w,:], HD['Dbbabba'][p,q,:,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][p,q,w,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][s,t,u,p,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][s,t,u,q,w,:] ) ,
                             -HD['Hbb'][s,w] * HD['Dbbbb'][p,q,t,u] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][s,:,w,:], HD['Dbbbbbb'][p,q,:,t,u,:] ) ))
    if q==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][p,t,u,:,r,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][p,t,u,:,s,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][r,s,w,:,t,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,w,:,:], HD['Dbbbbbb'][p,t,u,s,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbbbb'][p,t,u,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][s,w,:,:], HD['Dbbbbbb'][p,t,u,r,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][p,t,u,:,r,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][r,s,w,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][p,t,u,:,s,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][p,:,w,:], HD['Dbbabba'][r,s,:,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][p,t,u,r,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][r,s,w,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][p,t,u,s,w,:] ) ,
                             -HD['Hbb'][p,w] * HD['Dbbbb'][r,s,t,u] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][p,:,w,:], HD['Dbbbbbb'][r,s,:,t,u,:] ) ))
        if p==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][t,u,:,r,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][t,u,:,s,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][t,u,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][t,u,:,s,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][t,u,:,r,:,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][t,u,s,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][t,u,r,:] ) ))
    if q==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][p,t,u,:,s,v,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][r,s,v,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][p,t,u,:,r,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbbbb'][p,t,u,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbbbb'][p,t,u,v,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][s,v,:,:], HD['Dbbbbbb'][p,t,u,r,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][p,t,u,:,r,v,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][r,s,v,:,t,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][p,t,u,:,s,v,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][p,:,v,:], HD['Dbbabba'][r,s,:,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][p,t,u,r,v,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][r,s,v,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][p,t,u,s,v,:] ) ,
                             +HD['Hbb'][p,v] * HD['Dbbbb'][r,s,t,u] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][p,:,v,:], HD['Dbbbbbb'][r,s,:,t,u,:] ) ))
        if p==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbb'][t,u,:,s,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbb'][t,u,:,r,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbb'][t,u,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbabab'][t,u,:,s,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbabab'][t,u,:,r,:,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbb'][t,u,s,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbb'][t,u,r,:] ) ))
    if s==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][r,v,w,:,q,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][r,v,w,:,p,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][p,q,t,:,v,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbbbb'][r,v,w,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbbbb'][r,v,w,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][q,t,:,:], HD['Dbbbbbb'][r,v,w,p,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][p,q,t,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][r,v,w,:,p,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][r,v,w,:,q,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][r,:,t,:], HD['Dbbabba'][p,q,:,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][p,q,t,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][r,v,w,p,t,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][r,v,w,q,t,:] ) ,
                             +HD['Hbb'][r,t] * HD['Dbbbb'][p,q,v,w] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][r,:,t,:], HD['Dbbbbbb'][p,q,:,v,w,:] ) ))
        if r==t:
            result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][v,w,:,q,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][v,w,:,p,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][v,w,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][v,w,:,p,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][v,w,:,q,:,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][v,w,p,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][v,w,q,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][s,v,w,:,q,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][s,v,w,:,p,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][p,q,u,:,v,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,u,:,:], HD['Dbbbbbb'][s,v,w,q,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbbbb'][s,v,w,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][q,u,:,:], HD['Dbbbbbb'][s,v,w,p,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][s,v,w,:,p,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][s,v,w,:,q,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][p,q,u,:,v,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][s,:,u,:], HD['Dbbabba'][p,q,:,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][s,v,w,p,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][s,v,w,q,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][p,q,u,v,w,:] ) ,
                             +HD['Hbb'][s,u] * HD['Dbbbb'][p,q,v,w] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][s,:,u,:], HD['Dbbbbbb'][p,q,:,v,w,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][s,v,w,:,q,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][p,q,t,:,v,w,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][s,v,w,:,p,t,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbbbb'][s,v,w,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,t,:,:], HD['Dbbbbbb'][s,v,w,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][q,t,:,:], HD['Dbbbbbb'][s,v,w,p,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][s,v,w,:,p,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][s,v,w,:,q,t,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][p,q,t,:,v,w,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][s,:,t,:], HD['Dbbabba'][p,q,:,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][s,v,w,p,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][s,v,w,q,t,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][p,q,t,v,w,:] ) ,
                             -HD['Hbb'][s,t] * HD['Dbbbb'][p,q,v,w] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][s,:,t,:], HD['Dbbbbbb'][p,q,:,v,w,:] ) ))
        if s==t:
            result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbb'][v,w,:,q,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbb'][v,w,:,p,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbb'][v,w,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbabab'][v,w,:,p,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbabab'][v,w,:,q,:,:] ) ,
                                 +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbb'][v,w,p,:] ) ,
                                 -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbb'][v,w,q,:] ) ))
    if s==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][r,v,w,:,p,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][p,:,:,:], HD['Dbbbbbbbb'][r,v,w,:,q,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][p,q,u,:,v,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][p,q,:,:], HD['Dbbbbbb'][r,v,w,u,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][p,u,:,:], HD['Dbbbbbb'][r,v,w,q,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][q,u,:,:], HD['Dbbbbbb'][r,v,w,p,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][p,q,u,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][r,v,w,:,p,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][p,:,:,:], HD['Dbbbabbab'][r,v,w,:,q,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][r,:,u,:], HD['Dbbabba'][p,q,:,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][p,q,u,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][r,v,w,p,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][p,:], HD['Dbbbbbb'][r,v,w,q,u,:] ) ,
                             -HD['Hbb'][r,u] * HD['Dbbbb'][p,q,v,w] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][r,:,u,:], HD['Dbbbbbb'][p,q,:,v,w,:] ) ))
    if p==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][q,v,w,:,r,t,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][q,v,w,:,s,t,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][r,s,t,:,v,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbbbb'][q,v,w,t,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][s,t,:,:], HD['Dbbbbbb'][q,v,w,r,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,t,:,:], HD['Dbbbbbb'][q,v,w,s,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][q,v,w,:,r,t,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][r,s,t,:,v,w,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][q,v,w,:,s,t,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][q,:,t,:], HD['Dbbabba'][r,s,:,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][q,v,w,r,t,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][r,s,t,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][q,v,w,s,t,:] ) ,
                             +HD['Hbb'][q,t] * HD['Dbbbb'][r,s,v,w] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][q,:,t,:], HD['Dbbbbbb'][r,s,:,v,w,:] ) ))
    if p==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][q,v,w,:,r,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][q,v,w,:,s,u,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][r,s,u,:,v,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbbbb'][q,v,w,u,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][s,u,:,:], HD['Dbbbbbb'][q,v,w,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,u,:,:], HD['Dbbbbbb'][q,v,w,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][q,v,w,:,r,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][r,s,u,:,v,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][q,v,w,:,s,u,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][q,:,u,:], HD['Dbbabba'][r,s,:,v,w,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][q,v,w,r,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][r,s,u,v,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][q,v,w,s,u,:] ) ,
                             -HD['Hbb'][q,u] * HD['Dbbbb'][r,s,v,w] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][q,:,u,:], HD['Dbbbbbb'][r,s,:,v,w,:] ) ))
    if p==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][q,t,u,:,s,w,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][r,s,w,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][q,t,u,:,r,w,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,w,:,:], HD['Dbbbbbb'][q,t,u,s,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbbbb'][q,t,u,w,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][s,w,:,:], HD['Dbbbbbb'][q,t,u,r,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][r,s,w,:,t,u,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][q,t,u,:,s,w,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][q,t,u,:,r,w,:,:] ) ,
                             +einsum( 'ij,ij->', HD['Hbaba'][q,:,w,:], HD['Dbbabba'][r,s,:,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][q,t,u,r,w,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][r,s,w,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][q,t,u,s,w,:] ) ,
                             +HD['Hbb'][q,w] * HD['Dbbbb'][r,s,t,u] ,
                             +einsum( 'ij,ij->', HD['Hbbbb'][q,:,w,:], HD['Dbbbbbb'][r,s,:,t,u,:] ) ))
    if p==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['Hbbbb'][s,:,:,:], HD['Dbbbbbbbb'][q,t,u,:,r,v,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['Hbbbb'][q,:,:,:], HD['Dbbbbbbbb'][r,s,v,:,t,u,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['Hbbbb'][r,:,:,:], HD['Dbbbbbbbb'][q,t,u,:,s,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][r,s,:,:], HD['Dbbbbbb'][q,t,u,v,:,:] ) ,
                         -einsum( 'ij,ij->', HD['Hbbbb'][s,v,:,:], HD['Dbbbbbb'][q,t,u,r,:,:] ) ,
                         +einsum( 'ij,ij->', HD['Hbbbb'][r,v,:,:], HD['Dbbbbbb'][q,t,u,s,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['Hbaab'][s,:,:,:], HD['Dbbbabbab'][q,t,u,:,r,v,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['Hbaab'][q,:,:,:], HD['Dbbbabbab'][r,s,v,:,t,u,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['Hbaab'][r,:,:,:], HD['Dbbbabbab'][q,t,u,:,s,v,:,:] ) ,
                             -einsum( 'ij,ij->', HD['Hbaba'][q,:,v,:], HD['Dbbabba'][r,s,:,t,u,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][q,:], HD['Dbbbbbb'][r,s,v,t,u,:] ) ,
                             -einsum( 'i,i->', HD['Hbb'][r,:], HD['Dbbbbbb'][q,t,u,s,v,:] ) ,
                             +einsum( 'i,i->', HD['Hbb'][s,:], HD['Dbbbbbb'][q,t,u,r,v,:] ) ,
                             -HD['Hbb'][q,v] * HD['Dbbbb'][r,s,t,u] ,
                             -einsum( 'ij,ij->', HD['Hbbbb'][q,:,v,:], HD['Dbbbbbb'][r,s,:,t,u,:] ) ))
    return result


def lucc_AAaa_CAaa(actfloor, actceil, HD, *e):
    (p,r),(T,v) = e
    Dp, Dr, Dv = p-actfloor, r-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][p,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dp,Dv,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][p,T] * HD['Daa'][Dr,Dv] ,
                         -HD['HSaa'][r,T] * HD['Daa'][Dp,Dv] ,
                         -HD['Daa'][Dp,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                         +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dp,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][p,T,v,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,v,T,actfloor:actceil], HD['Daa'][Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,T,v,actfloor:actceil], HD['Daa'][Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][p,v,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                         -HD['Daa'][Dp,Dv] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dp,:,Dv,:] ) ))
    if r==v:
        result += 2 * fsum(( -HD['HSaa'][p,T] ,
                             -einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if p==v:
        result += 2 * fsum(( +HD['HSaa'][r,T] ,
                             +einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                             +einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_AAaa_VAaa(actfloor, actceil, HD, *e):
    (p,r),(T,v) = e
    Dp, Dr, Dv = p-actfloor, r-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][T,p,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dp,Dv,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][p,T] * HD['Daa'][Dr,Dv] ,
                         -HD['HSaa'][r,T] * HD['Daa'][Dp,Dv] ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Daa'][Dp,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dp,:,Dv,:] ) ,
                         +HD['Daa'][Dp,Dv] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][p,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dp,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dr,:,Dv,:] ) ))
    return result


def lucc_AAaa_VCaa(actfloor, actceil, HD, *e):
    (p,r),(T,V) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][p,V,actfloor:actceil,T], HD['Daa'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,p,V,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,V,actfloor:actceil,T], HD['Daa'][Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daa'][Dp,:] ) ))
    return result


def lucc_CAaa_AAaa(actfloor, actceil, HD, *e):
    (P,r),(t,v) = e
    Dr, Dt, Dv = r-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dt,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][t,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][P,t] * HD['Daa'][Dr,Dv] ,
                         -HD['HSaa'][P,v] * HD['Daa'][Dr,Dt] ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daa'][Dr,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,t,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,v,actfloor:actceil], HD['Daaaa'][Dr,:,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,P,r,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,t,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][t,P,r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,v,P,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daa'][Dr,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,t,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,v,actfloor:actceil], HD['Dabab'][Dr,:,Dt,:] ) ))
    if r==v:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,:,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dt,:,:,:] ) ))
    if r==t:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ))
    return result


def lucc_CAaa_CAaa(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dr,Dv] ,
                         +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         +HD['HSaaaa'][P,T,r,v] ,
                         +HD['HSaaaa'][v,P,T,r] ,
                         +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +HD['HSaa'][r,v] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ))
    if r==v:
        result += 2 * fsum(( -HD['HSaa'][P,T] ,
                             -einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_CAaa_VAaa(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dr,Dv] ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,T], HD['Daaaa'][Dr,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,P,r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,r,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,actfloor:actceil,T], HD['Dabab'][Dr,:,Dv,:] ) ))
    return result


def lucc_CAaa_VCaa(actfloor, actceil, HD, *e):
    (P,r),(T,V) = e
    Dr = r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daa'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         -HD['HSaaaa'][T,P,V,r] ,
                         -HD['HSaaaa'][P,V,r,T] ))
    if P==V:
        result += 2 * fsum(( -HD['HSaa'][r,T] ,
                             +einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                             +einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
    return result


def lucc_VAaa_AAaa(actfloor, actceil, HD, *e):
    (P,r),(t,v) = e
    Dr, Dt, Dv = r-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][P,v,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dt,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][P,t,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][P,t] * HD['Daa'][Dr,Dv] ,
                         -HD['HSaa'][P,v] * HD['Daa'][Dr,Dt] ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daa'][Dr,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,t,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dr,:,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,t,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dr,:,Dt,:] ) ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daa'][Dr,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,:,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dt,:,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dt,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_VAaa_CAaa(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dr,Dv] ,
                         +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,v,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
    if r==v:
        result += 2 * fsum(( -HD['HSaa'][P,T] ,
                             -einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_VAaa_VAaa(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dr,Dv] ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dr,:,Dv,:] ) ,
                         -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dr,:,Dv,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_VAaa_VCaa(actfloor, actceil, HD, *e):
    (P,r),(T,V) = e
    Dr = r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daa'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,V,actfloor:actceil], HD['Daa'][Dr,:] ) ))
    if P==T:
        result += 2 * fsum(( -HD['HSaa'][r,V] ,
                             -einsum( 'II->', HD['HSaaaa'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'II->', HD['HSabab'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_VCaa_AAaa(actfloor, actceil, HD, *e):
    (P,R),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][t,R,actfloor:actceil,P], HD['Daa'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,v,R,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,R,actfloor:actceil,P], HD['Daa'][Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,t,R,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_VCaa_CAaa(actfloor, actceil, HD, *e):
    (P,R),(T,v) = e
    Dv = v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][R,T,actfloor:actceil,P], HD['Daa'][Dv,:] ) ,
                         -HD['HSaaaa'][P,v,R,T] ,
                         -HD['HSaaaa'][P,T,R,v] ))
    if R==T:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -HD['HSaa'][P,v] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
    return result


def lucc_VCaa_VAaa(actfloor, actceil, HD, *e):
    (P,R),(T,v) = e
    Dv = v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daa'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    if P==T:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ))
    return result


def lucc_VCaa_VCaa(actfloor, actceil, HD, *e):
    (P,R),(T,V) = e
    result = 0
    result += 2 * fsum(( +HD['HSaaaa'][P,V,R,T] ,
                         +HD['HSaaaa'][P,T,R,V] ))
    if R==V:
        result += 2 * fsum(( +HD['HSaa'][P,T] ,
                             -einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                             -einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
    if P==T:
        result += 2 * fsum(( -HD['HSaa'][R,V] ,
                             -einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_AAaa_CAbb(actfloor, actceil, HD, *e):
    (p,r),(T,v) = e
    Dp, Dr, Dv = p-actfloor, r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dp,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Dp,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][p,T,v,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Daa'][Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Daa'][Dp,:] ) ))
    return result


def lucc_AAaa_VAbb(actfloor, actceil, HD, *e):
    (p,r),(T,v) = e
    Dp, Dr, Dv = p-actfloor, r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dabba'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabba'][Dp,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dp,:,:] ) ))
    return result


def lucc_AAaa_VCbb(actfloor, actceil, HD, *e):
    (p,r),(T,V) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][p,V,actfloor:actceil,T], HD['Daa'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Daa'][Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daa'][Dp,:] ) ))
    return result


def lucc_CAaa_AAbb(actfloor, actceil, HD, *e):
    (P,r),(t,v) = e
    Dr, Dt, Dv = r-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dr,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,P,r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,r,P,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,P,r,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,r,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dabba'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dabba'][Dr,:,Dt,:] ) ))
    return result


def lucc_CAaa_CAbb(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dr,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         -HD['HSbaab'][T,P,r,v] ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabba'][Dr,:,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,v,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         +HD['HSbaba'][v,P,T,r] ))
    return result


def lucc_CAaa_VAbb(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dabba'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dr,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,r,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_CAaa_VCbb(actfloor, actceil, HD, *e):
    (P,r),(T,V) = e
    Dr = r-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][V,P,actfloor:actceil,T], HD['Daa'][Dr,:] ) ,
                         +HD['HSbaab'][V,P,r,T] ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         -HD['HSbaba'][T,P,V,r] ))
    return result


def lucc_VAaa_AAbb(actfloor, actceil, HD, *e):
    (P,r),(t,v) = e
    Dr, Dt, Dv = r-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dabba'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabba'][Dr,:,Dt,:] ) ))
    return result


def lucc_VAaa_CAbb(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Dr,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Daa'][Dr,:] ) ))
    return result


def lucc_VAaa_VAbb(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabba'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dr,:,:] ) ))
    return result


def lucc_VAaa_VCbb(actfloor, actceil, HD, *e):
    (P,r),(T,V) = e
    Dr = r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daa'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daa'][Dr,:] ) ))
    return result


def lucc_VCaa_AAbb(actfloor, actceil, HD, *e):
    (P,R),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,v,R,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][P,t,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][t,R,actfloor:actceil,P], HD['Dbb'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,R,actfloor:actceil,P], HD['Dbb'][Dt,:] ) ))
    return result


def lucc_VCaa_CAbb(actfloor, actceil, HD, *e):
    (P,R),(T,v) = e
    Dv = v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         -HD['HSabab'][P,v,R,T] ,
                         -HD['HSabab'][P,T,R,v] ,
                         +einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_VCaa_VAbb(actfloor, actceil, HD, *e):
    (P,R),(T,v) = e
    Dv = v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,P,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_VCaa_VCbb(actfloor, actceil, HD, *e):
    (P,R),(T,V) = e
    result = 0
    result += 2 * fsum(( +HD['HSabab'][P,V,R,T] ,
                         -HD['HSbaab'][T,P,R,V] ))
    return result


def lucc_AAaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][p,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dv,Dw,Du,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][p,T] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         -HD['HSaa'][r,T] * HD['Daaaa'][Dp,Du,Dv,Dw] ,
                         -HD['Daaaa'][Dp,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                         +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dp,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][p,w,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][p,v,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][p,T,w,actfloor:actceil], HD['Daaaa'][Dr,Dv,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][p,T,v,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,w,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,v,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,T,w,actfloor:actceil], HD['Daaaa'][Dp,Dv,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dw,Du,:] ) ,
                         -HD['HSaaaa'][p,T,v,w] * HD['Daa'][Dr,Du] ,
                         +HD['HSaaaa'][r,T,v,w] * HD['Daa'][Dp,Du] ,
                         +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                         -HD['Daaaa'][Dp,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dp,Du,:,Dv,Dw,:] ) ))
    if r==w:
        result += 2 * fsum(( -HD['HSaa'][p,T] * HD['Daa'][Du,Dv] ,
                             -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][p,v,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['HSaa'][p,T] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][p,w,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if p==w:
        result += 2 * fsum(( +HD['HSaa'][r,T] * HD['Daa'][Du,Dv] ,
                             +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,v,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
    if p==v:
        result += 2 * fsum(( -HD['HSaa'][r,T] * HD['Daa'][Du,Dw] ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,w,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    return result


def lucc_AAaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dp,:] ) ,
                         -HD['HSaaaa'][p,w,T,U] * HD['Daa'][Dr,Dv] ,
                         +HD['HSaaaa'][p,v,T,U] * HD['Daa'][Dr,Dw] ,
                         +HD['HSaaaa'][r,w,T,U] * HD['Daa'][Dp,Dv] ,
                         -HD['HSaaaa'][r,v,T,U] * HD['Daa'][Dp,Dw] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -HD['HSaaaa'][p,v,T,U] ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             +HD['HSaaaa'][p,w,T,U] ))
    if p==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +HD['HSaaaa'][r,v,T,U] ))
    if p==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             -HD['HSaaaa'][r,w,T,U] ))
    return result


def lucc_AAaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dv,Dw,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][T,p,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][p,T] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         -HD['HSaa'][r,T] * HD['Daaaa'][Dp,Du,Dv,Dw] ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaa'][Dp,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dp,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,u,p,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,u,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dp,:] ) ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaa'][Dp,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dp,Du,:,Dv,Dw,:] ) ))
    if p==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][T,p,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    return result


def lucc_AAaa_VACAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,w) = e
    Dp, Dr, Du, Dw = p-actfloor, r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][p,V,actfloor:actceil,T], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,p,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,V,actfloor:actceil,T], HD['Daaaa'][Dp,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daaaa'][Dp,Dw,Du,:] ) ,
                         -HD['HSaaaa'][p,V,u,T] * HD['Daa'][Dr,Dw] ,
                         +HD['HSaaaa'][r,V,u,T] * HD['Daa'][Dp,Dw] ))
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,p,V,actfloor:actceil], HD['Daa'][Dw,:] )
    if p==u:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_AAaa_VACCaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,W) = e
    Dp, Dr, Du = p-actfloor, r-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSaaaa'][T,p,V,W] * HD['Daa'][Dr,Du] ,
                         -HD['HSaaaa'][T,r,V,W] * HD['Daa'][Dp,Du] ))
    if r==u:
        result += 2 * -HD['HSaaaa'][T,p,V,W]
    if p==u:
        result += 2 * +HD['HSaaaa'][T,r,V,W]
    return result


def lucc_AAaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dp,:] ) ))
    return result


def lucc_AAaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,w) = e
    Dp, Dr, Dw = p-actfloor, r-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSaaaa'][p,V,T,U] * HD['Daa'][Dr,Dw] ,
                         -HD['HSaaaa'][r,V,T,U] * HD['Daa'][Dp,Dw] ))
    return result


def lucc_AAaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,W) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    return result


def lucc_CAaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][t,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][u,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dt,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dw,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][P,t] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         -HD['HSaa'][P,u] * HD['Daaaa'][Dr,Dt,Dv,Dw] ,
                         +HD['HSaa'][P,w] * HD['Daaaa'][Dr,Dv,Dt,Du] ,
                         -HD['HSaa'][P,v] * HD['Daaaa'][Dr,Dw,Dt,Du] ,
                         +HD['Daaaa'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Daaaa'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Daaaa'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,u,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,w,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,:,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,v,actfloor:actceil], HD['Daaaaaa'][Dr,Dw,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,t,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][t,u,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,w,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][t,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][u,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,w,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,v,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,P,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,P,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,t,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,u,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                         +HD['Daaaa'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Daaaa'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Daaaa'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,u,actfloor:actceil], HD['Daabaab'][Dr,Dt,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,w,actfloor:actceil], HD['Daabaab'][Dr,Dv,:,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,v,actfloor:actceil], HD['Daabaab'][Dr,Dw,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,t,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dv,:,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dw,:,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][u,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Du,:,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][t,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dt,:,:] ) ))
    return result


def lucc_CAaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,P,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daaaa'][Dr,Dv,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -HD['HSaaaa'][P,T,v,w] * HD['Daa'][Dr,Du] ,
                         +HD['HSaaaa'][P,T,r,w] * HD['Daa'][Du,Dv] ,
                         -HD['HSaaaa'][P,T,r,v] * HD['Daa'][Du,Dw] ,
                         +HD['HSaaaa'][w,P,T,r] * HD['Daa'][Du,Dv] ,
                         -HD['HSaaaa'][v,P,T,r] * HD['Daa'][Du,Dw] ,
                         +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +HD['HSaa'][r,w] * HD['Daa'][Du,Dv] ,
                             -HD['HSaa'][r,v] * HD['Daa'][Du,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,w] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dv,:,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,w,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dv,:,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ,
                             -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,w] ) ))
    if r==w:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Du,Dv] ,
                             -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,P,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    return result


def lucc_CAaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         -HD['HSaaaa'][v,P,T,U] * HD['Daa'][Dr,Dw] ,
                         +HD['HSaaaa'][w,P,T,U] * HD['Daa'][Dr,Dv] ))
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][r,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][r,U,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,U,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             -HD['HSaaaa'][r,U,v,w] ))
    if P==U:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][r,T,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,T,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             +HD['HSaaaa'][r,T,v,w] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +HD['HSaaaa'][v,P,T,U] ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             -HD['HSaaaa'][w,P,T,U] ))
    return result


def lucc_CAaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,T], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,u,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,r,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,actfloor:actceil,T], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ))
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    return result


def lucc_CAaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         -HD['HSaaaa'][P,V,u,T] * HD['Daa'][Dr,Dw] ,
                         +HD['HSaaaa'][T,P,V,r] * HD['Daa'][Du,Dw] ,
                         +HD['HSaaaa'][P,V,r,T] * HD['Daa'][Du,Dw] ))
    if P==V:
        result += 2 * fsum(( +HD['HSaa'][r,T] * HD['Daa'][Du,Dw] ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,u,r,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dw,:] ) ))
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_CAaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][T,P,V,W] * HD['Daa'][Dr,Du]
    if P==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][r,V,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                             +HD['HSaaaa'][r,V,u,T] ))
    if P==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][r,W,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                             -HD['HSaaaa'][r,W,u,T] ))
    if r==u:
        result += 2 * -HD['HSaaaa'][T,P,V,W]
    return result


def lucc_CAaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] )
    return result


def lucc_CAaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,V,T,U] * HD['Daa'][Dr,Dw]
    if P==V:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_CAaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    if P==W:
        result += 2 * -HD['HSaaaa'][r,V,T,U]
    if P==V:
        result += 2 * +HD['HSaaaa'][r,W,T,U]
    return result


def lucc_VAaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][P,t,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][P,u,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dt,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][P,w,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][P,v,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dw,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][P,t] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         -HD['HSaa'][P,u] * HD['Daaaa'][Dr,Dt,Dv,Dw] ,
                         +HD['HSaa'][P,w] * HD['Daaaa'][Dr,Dv,Dt,Du] ,
                         -HD['HSaa'][P,v] * HD['Daaaa'][Dr,Dw,Dt,Du] ,
                         -HD['Daaaa'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Daaaa'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daaaa'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,t,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaa'][Dr,Dw,:,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][t,u,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,w,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dr,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,t,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Daabaab'][Dr,Dt,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Daabaab'][Dr,Dv,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Daabaab'][Dr,Dw,:,Dt,Du,:] ) ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daaaa'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Daaaa'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Daaaa'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
    if r==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,v,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,w,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,u,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,t,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_VAaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,w,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,v,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daaaa'][Dr,Dv,Du,:] ) ,
                         -HD['HSaaaa'][P,T,v,w] * HD['Daa'][Dr,Du] ,
                         +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ))
    if r==w:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Du,Dv] ,
                             -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,v,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,w,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    return result


def lucc_VAaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         -HD['HSaaaa'][P,w,T,U] * HD['Daa'][Dr,Dv] ,
                         +HD['HSaaaa'][P,v,T,U] * HD['Daa'][Dr,Dw] ))
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daa'][Dv,:] ) ,
                             -HD['HSaaaa'][P,v,T,U] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                             +HD['HSaaaa'][P,w,T,U] ))
    return result


def lucc_VAaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,u,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                         -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][r,u,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ))
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    return result


def lucc_VAaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         -HD['HSaaaa'][P,V,u,T] * HD['Daa'][Dr,Dw] ))
    if P==T:
        result += 2 * fsum(( +HD['HSaa'][r,V] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,u,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    if r==u:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,T,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VAaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,T,V,W] * HD['Daa'][Dr,Du]
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][V,W,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +HD['HSaaaa'][r,u,V,W] ))
    if r==u:
        result += 2 * +HD['HSaaaa'][P,T,V,W]
    return result


def lucc_VAaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Dr,:] )
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][U,r,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    if P==U:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    return result


def lucc_VAaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,V,T,U] * HD['Daa'][Dr,Dw]
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][U,r,V,actfloor:actceil], HD['Daa'][Dw,:] )
    if P==U:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VAaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    if P==T:
        result += 2 * -HD['HSaaaa'][U,r,V,W]
    if P==U:
        result += 2 * +HD['HSaaaa'][T,r,V,W]
    return result


def lucc_VCaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][t,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,w,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,v,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,R,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,R,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,t,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,u,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_VCaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][R,T,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -HD['HSaaaa'][P,w,R,T] * HD['Daa'][Du,Dv] ,
                         +HD['HSaaaa'][P,v,R,T] * HD['Daa'][Du,Dw] ,
                         -HD['HSaaaa'][P,T,R,w] * HD['Daa'][Du,Dv] ,
                         +HD['HSaaaa'][P,T,R,v] * HD['Daa'][Du,Dw] ))
    if R==T:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -HD['HSaa'][P,w] * HD['Daa'][Du,Dv] ,
                             +HD['HSaa'][P,v] * HD['Daa'][Du,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                             +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dv,:,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,w,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dv,:,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
    return result


def lucc_VCaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,U,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,U,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             +HD['HSaaaa'][P,U,v,w] ))
    if R==U:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             -HD['HSaaaa'][P,T,v,w] ))
    return result


def lucc_VCaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][u,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Du,:,:] ) ))
    return result


def lucc_VCaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][P,V,R,T] * HD['Daa'][Du,Dw] ,
                         -HD['HSaaaa'][P,T,R,V] * HD['Daa'][Du,Dw] ))
    if R==V:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,u,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( +HD['HSaa'][R,V] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][u,R,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    return result


def lucc_VCaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if R==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                             -HD['HSaaaa'][P,V,u,T] ))
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,W,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                             +HD['HSaaaa'][P,W,u,T] ))
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][V,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             -HD['HSaaaa'][u,R,V,W] ))
    return result


def lucc_VCaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][U,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    if P==U:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][T,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    return result


def lucc_VCaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if R==V:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daa'][Dw,:] )
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][U,R,V,actfloor:actceil], HD['Daa'][Dw,:] )
    if P==U:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,R,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VCaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,W) = e
    result = 0
    if R==W:
        result += 2 * +HD['HSaaaa'][P,V,T,U]
    if R==V:
        result += 2 * -HD['HSaaaa'][P,W,T,U]
    if P==T:
        result += 2 * -HD['HSaaaa'][U,R,V,W]
    if P==U:
        result += 2 * +HD['HSaaaa'][T,R,V,W]
    return result


def lucc_AAaa_CAAAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][r,T,w,actfloor:actceil], HD['Dbaab'][Dv,Dp,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][p,T,w,actfloor:actceil], HD['Dbaab'][Dv,Dr,Du,:] ) ,
                         -HD['HSabab'][r,T,w,v] * HD['Daa'][Dp,Du] ,
                         +HD['HSabab'][p,T,w,v] * HD['Daa'][Dr,Du] ,
                         -einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dp,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][p,T,v,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Dw,:] ) ))
    if p==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Du,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Daa'][Du,:] ) ))
    if r==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Du,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Daa'][Du,:] ) ))
    return result


def lucc_AAaa_CCAAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,p,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,U,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dp,:] ) ,
                         +HD['HSbaab'][v,p,U,T] * HD['Daa'][Dr,Dw] ,
                         -HD['HSbaab'][v,r,U,T] * HD['Daa'][Dp,Dw] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,p,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbaab'][v,p,U,T] ))
    if p==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +HD['HSbaab'][v,r,U,T] ))
    return result


def lucc_AAaa_VAAAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dp,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dw,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,u,p,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,u,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dp,:] ) ))
    if r==u:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    if p==u:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_AAaa_VACAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,w) = e
    Dp, Dr, Du, Dw = p-actfloor, r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][p,V,actfloor:actceil,T], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Daaaa'][Dp,Du,Dw,:] ) ,
                         -HD['HSabab'][p,V,u,T] * HD['Daa'][Dr,Dw] ,
                         +HD['HSabab'][r,V,u,T] * HD['Daa'][Dp,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daaaa'][Dp,Dw,Du,:] ) ))
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Daa'][Dw,:] )
    if p==u:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_AAaa_VACCbaba(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,W) = e
    Dp, Dr, Du = p-actfloor, r-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbaab'][T,p,W,V] * HD['Daa'][Dr,Du] ,
                         +HD['HSbaab'][T,r,W,V] * HD['Daa'][Dp,Du] ))
    if r==u:
        result += 2 * +HD['HSbaab'][T,p,W,V]
    if p==u:
        result += 2 * -HD['HSbaab'][T,r,W,V]
    return result


def lucc_AAaa_VVAAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,p,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,U,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dp,:] ) ))
    return result


def lucc_AAaa_VVCAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,w) = e
    Dp, Dr, Dw = p-actfloor, r-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSabab'][p,V,U,T] * HD['Daa'][Dr,Dw] ,
                         +HD['HSabab'][r,V,U,T] * HD['Daa'][Dp,Dw] ))
    return result


def lucc_AAaa_VVCCbaba(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,W) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    return result


def lucc_CAaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Dr,Du,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dr,Dw,Dt,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][P,u] * HD['Dbaab'][Dt,Dr,Dw,Dv] ,
                         +HD['HSaa'][P,w] * HD['Dbaab'][Dv,Dr,Du,Dt] ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,:,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,:,Dw,Dv,:] ) ,
                         -HD['Dbaab'][Dv,Dr,Du,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Dbaab'][Dt,Dr,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][u,P,r,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,w,P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,P,r,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,u,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                         +HD['Dbaab'][Dt,Dr,Dw,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbaab'][Dv,Dr,Du,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbababb'][Dv,Dr,:,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbababb'][Dt,Dr,:,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Dr,Du,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,u,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,w,P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,r,P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,P,r,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,v,actfloor:actceil], HD['Daababa'][Dr,Dw,:,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,t,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dw,Dv,:] ) ))
    if r==u:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dw,:,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dv,Dw,:,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ))
    if r==w:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Du,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dt,Du,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Du,:,:] ) ))
    return result


def lucc_CAaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,w,actfloor:actceil], HD['Dbaab'][Dv,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -HD['HSbaab'][T,P,w,v] * HD['Daa'][Dr,Du] ,
                         +HD['HSbaab'][T,P,r,v] * HD['Daa'][Du,Dw] ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,v,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         -HD['HSbaba'][v,P,T,r] * HD['Daa'][Du,Dw] ))
    if r==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabba'][Du,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daa'][Du,:] ) ))
    return result


def lucc_CAaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                         +HD['HSbaab'][v,P,U,T] * HD['Daa'][Dr,Dw] ))
    if P==U:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][r,T,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSabab'][r,T,w,v] ,
                             -einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbaab'][v,P,U,T] ))
    return result


def lucc_CAaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,T], HD['Daababa'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,u,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    if r==u:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_CAaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][V,P,actfloor:actceil,T], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         +HD['HSbaab'][V,P,u,T] * HD['Daa'][Dr,Dw] ,
                         -HD['HSbaab'][V,P,r,T] * HD['Daa'][Du,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                         +HD['HSbaba'][T,P,V,r] * HD['Daa'][Du,Dw] ))
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_CAaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][T,P,W,V] * HD['Daa'][Dr,Du]
    if P==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                             +HD['HSabab'][r,V,u,T] ))
    if r==u:
        result += 2 * +HD['HSbaab'][T,P,W,V]
    return result


def lucc_CAaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaab'][T,U,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] )
    return result


def lucc_CAaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbaab'][V,P,U,T] * HD['Daa'][Dr,Dw]
    return result


def lucc_CAaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    if P==W:
        result += 2 * +HD['HSabab'][r,V,U,T]
    return result


def lucc_VAaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Dr,Du,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dr,Dw,Dt,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][P,u] * HD['Dbaab'][Dt,Dr,Dw,Dv] ,
                         +HD['HSaa'][P,w] * HD['Dbaab'][Dv,Dr,Du,Dt] ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,:,Du,Dt,:] ) ,
                         +HD['Dbaab'][Dt,Dr,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbaab'][Dv,Dr,Du,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbababb'][Dt,Dr,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbababb'][Dv,Dr,:,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Dr,Du,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,t,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daababa'][Dr,Dw,:,Du,Dt,:] ) ,
                         +HD['Dbaab'][Dt,Dr,Dw,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbaab'][Dv,Dr,Du,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][t,u,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,w,actfloor:actceil,P], HD['Dbaab'][Dt,Du,Dr,:] ) ))
    if r==w:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Du,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dt,Du,:,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ))
    if r==u:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dw,:,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dv,Dw,:,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_VAaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][P,T,w,actfloor:actceil], HD['Dbaab'][Dv,Dr,Du,:] ) ,
                         +HD['HSabab'][P,T,w,v] * HD['Daa'][Dr,Du] ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ))
    if r==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Du,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Daa'][Du,:] ) ))
    return result


def lucc_VAaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSabab'][P,v,U,T] * HD['Daa'][Dr,Dw] ,
                         +einsum( 'i,i->', HD['HSbaba'][T,U,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Dr,:] ) ))
    if r==w:
        result += 2 * fsum(( +HD['HSabab'][P,v,U,T] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,actfloor:actceil,P], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_VAaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,u,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Dr,:] ) ))
    if r==u:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_VAaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                         -HD['HSabab'][P,V,u,T] * HD['Daa'][Dr,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ))
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VAaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][T,P,W,V] * HD['Daa'][Dr,Du]
    if r==u:
        result += 2 * +HD['HSbaab'][T,P,W,V]
    return result


def lucc_VAaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaba'][T,U,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Dr,:] )
    if P==U:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_VAaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSabab'][P,V,U,T] * HD['Daa'][Dr,Dw]
    if P==U:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VAaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    if P==U:
        result += 2 * -HD['HSbaab'][T,r,W,V]
    return result


def lucc_VCaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,R),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,w,R,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,R,actfloor:actceil,P], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,u,R,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][P,v,R,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][P,t,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][t,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,R,actfloor:actceil,P], HD['Dbaab'][Dt,Du,Dw,:] ) ))
    return result


def lucc_VCaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         +HD['HSabab'][P,v,R,T] * HD['Daa'][Du,Dw] ,
                         +HD['HSabab'][P,T,R,v] * HD['Daa'][Du,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VCaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if R==U:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][P,T,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +HD['HSabab'][P,T,w,v] ,
                             +einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_VCaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,P,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VCaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSabab'][P,V,R,T] * HD['Daa'][Du,Dw] ,
                         +HD['HSbaab'][T,P,R,V] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VCaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if R==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                             -HD['HSabab'][P,V,u,T] ))
    return result


def lucc_VCaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if P==U:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][T,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_VCaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if P==U:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,R,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VCaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,W) = e
    result = 0
    if R==W:
        result += 2 * -HD['HSabab'][P,V,U,T]
    if P==U:
        result += 2 * -HD['HSbaab'][T,R,W,V]
    return result


def lucc_AAaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dp,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Du,Dr,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Du,Dp,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][r,T,w,actfloor:actceil], HD['Dbaba'][Dv,Dp,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Dbaba'][Dw,Dp,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][p,T,w,actfloor:actceil], HD['Dbaba'][Dv,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][p,T,v,actfloor:actceil], HD['Dbaba'][Dw,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Dbaba'][Du,Dp,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][w,p,T,actfloor:actceil], HD['Dbaba'][Du,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Dbaba'][Du,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][w,r,T,actfloor:actceil], HD['Dbaba'][Du,Dp,Dv,:] ) ))
    return result


def lucc_AAaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Du,Dr,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Du,Dp,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dp,Du,:,:] ) ))
    return result


def lucc_AAaa_VACAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,w) = e
    Dp, Dr, Du, Dw = p-actfloor, r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][p,V,actfloor:actceil,T], HD['Dbaba'][Du,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Dbaba'][Du,Dp,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Dbaba'][Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Dbaba'][Dw,Dp,Du,:] ) ))
    return result


def lucc_AAaa_VACCbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,W) = e
    Dp, Dr, Du = p-actfloor, r-actfloor, u-actfloor
    result = 0
    return result


def lucc_AAaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,w) = e
    Dp, Dr, Dw = p-actfloor, r-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,W) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    return result


def lucc_CAaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Dr,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Dr,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Dt,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][u,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][w,r,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,r,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][w,P,r,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,P,r,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,r,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][u,r,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbabbba'][Du,Dr,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbabbba'][Dt,Dr,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbabbba'][Dv,Dr,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbabbba'][Dw,Dr,:,Dt,Du,:] ) ))
    return result


def lucc_CAaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +HD['HSbaab'][T,P,r,v] * HD['Dbb'][Du,Dw] ,
                         -HD['HSbaab'][T,P,r,w] * HD['Dbb'][Du,Dv] ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbabbba'][Du,Dr,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][w,P,T,actfloor:actceil], HD['Dbaba'][Du,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Dbaba'][Du,Dr,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,w,actfloor:actceil], HD['Dbaba'][Dv,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,v,actfloor:actceil], HD['Dbaba'][Dw,Dr,Du,:] ) ,
                         +HD['HSbaba'][w,P,T,r] * HD['Dbb'][Du,Dv] ,
                         -HD['HSbaba'][v,P,T,r] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_CAaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbabbba'][Du,Dr,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,r,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    return result


def lucc_CAaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][V,P,actfloor:actceil,T], HD['Dbaba'][Du,Dr,Dw,:] ) ,
                         -HD['HSbaab'][V,P,r,T] * HD['Dbb'][Du,Dw] ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Dbaba'][Dw,Dr,Du,:] ) ,
                         +HD['HSbaba'][T,P,V,r] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_CAaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    return result


def lucc_CAaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    return result


def lucc_VAaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Dr,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Dr,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbabbba'][Du,Dr,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbabbba'][Dt,Dr,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbabbba'][Dv,Dr,:,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbabbba'][Dw,Dr,:,Dt,Du,:] ) ))
    return result


def lucc_VAaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Du,Dr,:,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,w,T,actfloor:actceil], HD['Dbaba'][Du,Dr,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Dbaba'][Du,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,T,w,actfloor:actceil], HD['Dbaba'][Dv,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Dbaba'][Dw,Dr,Du,:] ) ))
    return result


def lucc_VAaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Du,Dr,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dr,Du,:,:] ) ))
    return result


def lucc_VAaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Dbaba'][Du,Dr,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Dbaba'][Dw,Dr,Du,:] ) ))
    return result


def lucc_VAaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    return result


def lucc_VAaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    return result


def lucc_VCaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,w,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][P,v,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][P,t,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][P,u,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][t,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][u,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][w,R,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,R,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Dw,:] ) ))
    return result


def lucc_VCaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -HD['HSabab'][P,w,R,T] * HD['Dbb'][Du,Dv] ,
                         +HD['HSabab'][P,v,R,T] * HD['Dbb'][Du,Dw] ,
                         -HD['HSabab'][P,T,R,w] * HD['Dbb'][Du,Dv] ,
                         +HD['HSabab'][P,T,R,v] * HD['Dbb'][Du,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VCaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VCaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,P,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VCaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSabab'][P,V,R,T] * HD['Dbb'][Du,Dw] ,
                         +HD['HSbaab'][T,P,R,V] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_VCaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    return result


def lucc_VCaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VCaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    return result


def lucc_VCaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,W) = e
    result = 0
    return result


def lucc_AAbb_CAaa(actfloor, actceil, HD, *e):
    (p,r),(T,v) = e
    Dp, Dr, Dv = p-actfloor, r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaab'][Dp,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dp,Dv,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,v,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,T,v,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,v,T,actfloor:actceil], HD['Dbb'][Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,T,v,actfloor:actceil], HD['Dbb'][Dp,:] ) ))
    return result


def lucc_AAbb_VAaa(actfloor, actceil, HD, *e):
    (p,r),(T,v) = e
    Dp, Dr, Dv = p-actfloor, r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dp,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaab'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaab'][Dp,:,Dv,:] ) ))
    return result


def lucc_AAbb_VCaa(actfloor, actceil, HD, *e):
    (p,r),(T,V) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,p,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][T,r,V,actfloor:actceil], HD['Dbb'][Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][p,V,actfloor:actceil,T], HD['Dbb'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,V,actfloor:actceil,T], HD['Dbb'][Dp,:] ) ))
    return result


def lucc_CAbb_AAaa(actfloor, actceil, HD, *e):
    (P,r),(t,v) = e
    Dr, Dt, Dv = r-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaab'][Dr,:,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][t,P,r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,v,P,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,t,P,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_CAbb_CAaa(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         +HD['HSabab'][v,P,T,r] ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         -HD['HSbaab'][P,T,v,r] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_CAbb_VAaa(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaab'][Dr,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,r,P,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_CAbb_VCaa(actfloor, actceil, HD, *e):
    (P,r),(T,V) = e
    Dr = r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         -HD['HSabab'][T,P,V,r] ,
                         +einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbb'][Dr,:] ) ,
                         -HD['HSbaba'][P,V,r,T] ))
    return result


def lucc_VAbb_AAaa(actfloor, actceil, HD, *e):
    (P,r),(t,v) = e
    Dr, Dt, Dv = r-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaab'][Dr,:,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ))
    return result


def lucc_VAbb_CAaa(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,v,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    return result


def lucc_VAbb_VAaa(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaab'][Dr,:,Dv,:] ) ))
    return result


def lucc_VAbb_VCaa(actfloor, actceil, HD, *e):
    (P,r),(T,V) = e
    Dr = r-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,T,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbb'][Dr,:] ) ))
    return result


def lucc_VCbb_AAaa(actfloor, actceil, HD, *e):
    (P,R),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][t,R,actfloor:actceil,P], HD['Daa'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Daa'][Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,v,R,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,t,R,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_VCbb_CAaa(actfloor, actceil, HD, *e):
    (P,R),(T,v) = e
    Dv = v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Daa'][Dv,:] ) ,
                         +HD['HSbaab'][P,v,T,R] ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                         -HD['HSbaba'][P,T,R,v] ))
    return result


def lucc_VCbb_VAaa(actfloor, actceil, HD, *e):
    (P,R),(T,v) = e
    Dv = v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daa'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_VCbb_VCaa(actfloor, actceil, HD, *e):
    (P,R),(T,V) = e
    result = 0
    result += 2 * fsum(( -HD['HSbaab'][P,T,V,R] ,
                         +HD['HSbaba'][P,V,R,T] ))
    return result


def lucc_AAbb_CAbb(actfloor, actceil, HD, *e):
    (p,r),(T,v) = e
    Dp, Dr, Dv = p-actfloor, r-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dp,Dv,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dp,:,Dv,:] ) ,
                         +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         -HD['Dbb'][Dp,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][p,T] * HD['Dbb'][Dr,Dv] ,
                         -HD['HSbb'][r,T] * HD['Dbb'][Dp,Dv] ,
                         +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         -HD['Dbb'][Dp,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dp,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbb'][Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbb'][Dp,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -HD['HSbb'][p,T] ,
                             -einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if p==v:
        result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                             +HD['HSbb'][r,T] ,
                             +einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_AAbb_VAbb(actfloor, actceil, HD, *e):
    (p,r),(T,v) = e
    Dp, Dr, Dv = p-actfloor, r-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dp,Dv,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Dp,:,Dv,:] ) ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Dbb'][Dp,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][p,T] * HD['Dbb'][Dr,Dv] ,
                         -HD['HSbb'][r,T] * HD['Dbb'][Dp,Dv] ,
                         +HD['Dbb'][Dp,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Dp,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Dr,:,Dv,:] ) ))
    return result


def lucc_AAbb_VCbb(actfloor, actceil, HD, *e):
    (p,r),(T,V) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbb'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbb'][Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbb'][Dp,:] ) ))
    return result


def lucc_CAbb_AAbb(actfloor, actceil, HD, *e):
    (P,r),(t,v) = e
    Dr, Dt, Dv = r-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dt,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaba'][Dr,:,Dt,:] ) ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbb'][Dr,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +HD['HSbb'][P,t] * HD['Dbb'][Dr,Dv] ,
                         -HD['HSbb'][P,v] * HD['Dbb'][Dr,Dt] ,
                         +HD['Dbb'][Dr,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbbb'][Dr,:,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    if r==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,:,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,:,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dt,:] ) ))
    if r==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_CAbb_CAbb(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                         +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][P,T] * HD['Dbb'][Dr,Dv] ,
                         +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         +HD['HSbbbb'][P,T,r,v] ,
                         +HD['HSbbbb'][v,P,T,r] ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +HD['HSbb'][r,v] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] ,
                             -einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_CAbb_VAbb(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaba'][Dr,:,Dv,:] ) ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][P,T] * HD['Dbb'][Dr,Dv] ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_CAbb_VCbb(actfloor, actceil, HD, *e):
    (P,r),(T,V) = e
    Dr = r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbb'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         -HD['HSbbbb'][P,V,r,T] ,
                         -HD['HSbbbb'][T,P,V,r] ))
    if P==V:
        result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                             -HD['HSbb'][r,T] ,
                             +einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
    return result


def lucc_VAbb_AAbb(actfloor, actceil, HD, *e):
    (P,r),(t,v) = e
    Dr, Dt, Dv = r-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dt,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] ) ))
    result += 2 * fsum(( -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbb'][Dr,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dr,:,Dt,:] ) ,
                         +HD['HSbb'][P,t] * HD['Dbb'][Dr,Dv] ,
                         -HD['HSbb'][P,v] * HD['Dbb'][Dr,Dt] ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbb'][Dr,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dr,:,Dt,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,:,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,:,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dt,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_VAbb_CAbb(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                         +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][P,T] * HD['Dbb'][Dr,Dv] ,
                         +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -HD['HSbb'][P,T] ,
                             -einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_VAbb_VAbb(actfloor, actceil, HD, *e):
    (P,r),(T,v) = e
    Dr, Dv = r-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Dr,:,Dv,:] ) ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][P,T] * HD['Dbb'][Dr,Dv] ,
                         -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Dr,:,Dv,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_VAbb_VCbb(actfloor, actceil, HD, *e):
    (P,r),(T,V) = e
    Dr = r-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbb'][Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    if P==T:
        result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -HD['HSbb'][r,V] ,
                             -einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_VCbb_AAbb(actfloor, actceil, HD, *e):
    (P,R),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbb'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbb'][Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbb'][Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_VCbb_CAbb(actfloor, actceil, HD, *e):
    (P,R),(T,v) = e
    Dv = v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbb'][Dv,:] ) ,
                         -HD['HSbbbb'][P,v,R,T] ,
                         -HD['HSbbbb'][P,T,R,v] ))
    if R==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbb'][P,v] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_VCbb_VAbb(actfloor, actceil, HD, *e):
    (P,R),(T,v) = e
    Dv = v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbb'][Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    if P==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_VCbb_VCbb(actfloor, actceil, HD, *e):
    (P,R),(T,V) = e
    result = 0
    result += 2 * fsum(( +HD['HSbbbb'][P,T,R,V] ,
                         +HD['HSbbbb'][P,V,R,T] ))
    if R==V:
        result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                             +HD['HSbb'][P,T] ,
                             -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                             -einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             -HD['HSbb'][R,V] ,
                             -einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
    return result


def lucc_AAbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dp,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dp,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,w,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,v,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,T,w,actfloor:actceil], HD['Dbaab'][Dr,Dv,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,T,v,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,w,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,v,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,T,w,actfloor:actceil], HD['Dbaab'][Dp,Dv,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,T,v,actfloor:actceil], HD['Dbaab'][Dp,Dw,Du,:] ) ))
    return result


def lucc_AAbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dp,Dv,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dp,Du,:,Dv,Dw,:] ) ))
    return result


def lucc_AAbb_VACAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,w) = e
    Dp, Dr, Du, Dw = p-actfloor, r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,p,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][T,r,V,actfloor:actceil], HD['Dbaab'][Dp,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][p,V,actfloor:actceil,T], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,V,actfloor:actceil,T], HD['Dbaab'][Dp,Du,Dw,:] ) ))
    return result


def lucc_AAbb_VACCaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,W) = e
    Dp, Dr, Du = p-actfloor, r-actfloor, u-actfloor
    result = 0
    return result


def lucc_AAbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,w) = e
    Dp, Dr, Dw = p-actfloor, r-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,W) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    return result


def lucc_CAbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,:,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaaaab'][Dr,Dw,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dt,:,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][t,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][u,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,w,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,v,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,t,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,u,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_CAbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][w,P,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         +HD['HSabab'][w,P,T,r] * HD['Daa'][Du,Dv] ,
                         -HD['HSabab'][v,P,T,r] * HD['Daa'][Du,Dw] ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,w,actfloor:actceil], HD['Dbaab'][Dr,Dv,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         +HD['HSbaab'][P,T,v,r] * HD['Daa'][Du,Dw] ,
                         -HD['HSbaab'][P,T,w,r] * HD['Daa'][Du,Dv] ,
                         +einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ))
    return result


def lucc_CAbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][T,r,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ))
    return result


def lucc_CAbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         +HD['HSabab'][T,P,V,r] * HD['Daa'][Du,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         +HD['HSbaba'][P,V,r,T] * HD['Daa'][Du,Dw] ))
    return result


def lucc_CAbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    return result


def lucc_CAbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    return result


def lucc_VAbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaab'][Dr,Dw,:,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dt,:,:] ) ))
    return result


def lucc_VAbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,w,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,v,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,w,actfloor:actceil], HD['Dbaab'][Dr,Dv,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ))
    return result


def lucc_VAbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ))
    return result


def lucc_VAbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,T,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Du,Dw,:] ) ))
    return result


def lucc_VAbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    return result


def lucc_VAbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    return result


def lucc_VCbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][t,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,w,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,v,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,t,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,u,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_VCbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         +HD['HSbaab'][P,w,T,R] * HD['Daa'][Du,Dv] ,
                         -HD['HSbaab'][P,v,T,R] * HD['Daa'][Du,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -HD['HSbaba'][P,T,R,w] * HD['Daa'][Du,Dv] ,
                         +HD['HSbaba'][P,T,R,v] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VCbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VCbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VCbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][P,T,V,R] * HD['Daa'][Du,Dw] ,
                         -HD['HSbaba'][P,V,R,T] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VCbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    return result


def lucc_VCbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VCbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    return result


def lucc_VCbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,W) = e
    result = 0
    return result


def lucc_AAbb_CAAAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dw,Du,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dp,Du,:,Dw,Dv,:] ) ,
                         +HD['Dbaab'][Dp,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,w,T,actfloor:actceil], HD['Dbaba'][Dp,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][p,w,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                         -HD['HSbb'][p,T] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         +HD['HSbb'][r,T] * HD['Dbaab'][Dp,Du,Dw,Dv] ,
                         -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbaab'][Dp,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dp,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbaab'][Dp,Dw,Du,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][p,w,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +HD['HSbb'][p,T] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if p==v:
        result += 2 * fsum(( -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,w,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             -HD['HSbb'][r,T] * HD['Daa'][Du,Dw] ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    return result


def lucc_AAbb_CCAAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][p,w,U,T] * HD['Dbb'][Dr,Dv] ,
                         -HD['HSbaab'][r,w,U,T] * HD['Dbb'][Dp,Dv] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dp,:] ) ))
    if r==v:
        result += 2 * fsum(( -HD['HSbaab'][p,w,U,T] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    if p==v:
        result += 2 * fsum(( +HD['HSbaab'][r,w,U,T] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_AAbb_VAAAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dw,Du,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dp,Du,:,Dw,Dv,:] ) ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         -HD['Dbaab'][Dp,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,u,p,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,u,r,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dp,:] ) ,
                         -HD['HSbb'][p,T] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         +HD['HSbb'][r,T] * HD['Dbaab'][Dp,Du,Dw,Dv] ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         -HD['Dbaab'][Dp,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dp,Du,:,Dw,Dv,:] ) ))
    return result


def lucc_AAbb_VACAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,w) = e
    Dp, Dr, Du, Dw = p-actfloor, r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbaab'][Dp,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbaab'][Dp,Dw,Du,:] ) ))
    return result


def lucc_AAbb_VACCbaba(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,W) = e
    Dp, Dr, Du = p-actfloor, r-actfloor, u-actfloor
    result = 0
    return result


def lucc_AAbb_VVAAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dp,:] ) ))
    return result


def lucc_AAbb_VVCAbaba(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,w) = e
    Dp, Dr, Dw = p-actfloor, r-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAbb_VVCCbaba(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,W) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    return result


def lucc_CAbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,:,Du,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Dw,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,Du,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaaaba'][Dr,Dw,:,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][u,P,r,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                         -HD['Dbaab'][Dr,Dw,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][t,u,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,w,P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,w,P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,u,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         +HD['HSbb'][P,v] * HD['Dbaab'][Dr,Dw,Du,Dt] ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaab'][Dr,Dw,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbababb'][Dr,Dw,:,Du,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    if r==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    if r==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ))
    return result


def lucc_CAbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                         -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         -HD['HSbbbb'][P,T,r,v] * HD['Daa'][Du,Dw] ,
                         -HD['HSbbbb'][v,P,T,r] * HD['Daa'][Du,Dw] ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaab'][Dv,:,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,w,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -HD['HSbb'][r,v] * HD['Daa'][Du,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    return result


def lucc_CAbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSabab'][w,P,U,T] * HD['Dbb'][Dr,Dv] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][r,U,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +HD['HSbaab'][r,U,w,v] ,
                             +einsum( 'i,i->', HD['HSbaba'][r,U,v,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['HSabab'][w,P,U,T] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_CAbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,u,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    return result


def lucc_CAbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                         +HD['HSbbbb'][P,V,r,T] * HD['Daa'][Du,Dw] ,
                         +HD['HSbbbb'][T,P,V,r] * HD['Daa'][Du,Dw] ))
    if P==V:
        result += 2 * fsum(( -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,u,r,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             +HD['HSbb'][r,T] * HD['Daa'][Du,Dw] ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dw,:] ) ))
    return result


def lucc_CAbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][r,W,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                             -HD['HSbaab'][r,W,u,T] ))
    return result


def lucc_CAbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] )
    return result


def lucc_CAbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    if P==V:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_CAbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    if P==V:
        result += 2 * -HD['HSbaab'][r,W,U,T]
    return result


def lucc_VAbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] ) ))
    result += 2 * fsum(( +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaab'][Dr,Dw,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,:,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,:,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,Du,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Dw,Dt,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,u,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,w,actfloor:actceil,P], HD['Dbaba'][Dt,Du,Dr,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaba'][Dr,Dw,:,Du,Dt,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         +HD['HSbb'][P,v] * HD['Dbaab'][Dr,Dw,Du,Dt] ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaab'][Dr,Dw,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbababb'][Dr,Dw,:,Du,Dt,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Du,:,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VAbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                         -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,w,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,w,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                             +HD['HSbb'][P,T] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    return result


def lucc_VAbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                         +HD['HSbaab'][P,w,U,T] * HD['Dbb'][Dr,Dv] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                             -HD['HSbaab'][P,w,U,T] ))
    return result


def lucc_VAbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,u,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,u,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VAbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ))
    if P==T:
        result += 2 * fsum(( +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,u,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             +HD['HSbb'][r,V] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    return result


def lucc_VAbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -HD['HSbaab'][r,u,W,V] ,
                             -einsum( 'i,i->', HD['HSbaba'][V,W,r,actfloor:actceil], HD['Daa'][Du,:] ) ))
    return result


def lucc_VAbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Dr,:] )
    if P==T:
        result += 2 * +einsum( 'ij,ij->', HD['HSabab'][U,r,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_VAbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSabba'][U,r,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VAbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    if P==T:
        result += 2 * +HD['HSabab'][U,r,W,V]
    return result


def lucc_VCbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,R),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,w,R,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,u,R,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbaab'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VCbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         +HD['HSbbbb'][P,v,R,T] * HD['Daa'][Du,Dw] ,
                         +HD['HSbbbb'][P,T,R,v] * HD['Daa'][Du,Dw] ))
    if R==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaab'][Dv,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][v,w,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +HD['HSbb'][P,v] * HD['Daa'][Du,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    return result


def lucc_VCbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,U,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbaab'][P,U,w,v] ,
                             -einsum( 'i,i->', HD['HSbaba'][P,U,v,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_VCbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    if P==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][u,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VCbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,V,R,T] * HD['Daa'][Du,Dw] ,
                         -HD['HSbbbb'][P,T,R,V] * HD['Daa'][Du,Dw] ))
    if R==V:
        result += 2 * fsum(( +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,u,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                             -HD['HSbb'][P,T] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][u,R,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             +HD['HSbb'][R,V] * HD['Daa'][Du,Dw] ,
                             +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    return result


def lucc_VCbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,W,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                             +HD['HSbaab'][P,W,u,T] ))
    if P==T:
        result += 2 * fsum(( +HD['HSabab'][u,R,W,V] ,
                             -einsum( 'i,i->', HD['HSbaba'][V,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ))
    return result


def lucc_VCbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'ij,ij->', HD['HSabab'][U,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_VCbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if R==V:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Daa'][Dw,:] )
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSabba'][U,R,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VCbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,W) = e
    result = 0
    if R==V:
        result += 2 * +HD['HSbaab'][P,W,U,T]
    if P==T:
        result += 2 * +HD['HSabab'][U,R,W,V]
    return result


def lucc_AAbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dv,Dw,Du,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dp,Du,:,Dv,Dw,:] ) ,
                         +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbbb'][Dp,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][p,T] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['HSbb'][r,T] * HD['Dbbbb'][Dp,Du,Dv,Dw] ,
                         +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbbb'][Dp,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,w,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,T,w,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,w,T,actfloor:actceil], HD['Dbbbb'][Dp,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbbbb'][Dp,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,w,actfloor:actceil], HD['Dbbbb'][Dp,Dv,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbbbb'][Dp,Dw,Du,:] ) ,
                         +HD['HSbbbb'][r,T,v,w] * HD['Dbb'][Dp,Du] ,
                         -HD['HSbbbb'][p,T,v,w] * HD['Dbb'][Dr,Du] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                             -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][p,T] * HD['Dbb'][Du,Dv] ,
                             -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][p,T] * HD['Dbb'][Du,Dw] ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,w,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if p==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                             +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][r,T] * HD['Dbb'][Du,Dv] ,
                             +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if p==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                             -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][r,T] * HD['Dbb'][Du,Dw] ,
                             -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,w,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    return result


def lucc_AAbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dp,:] ) ,
                         -HD['HSbbbb'][p,w,T,U] * HD['Dbb'][Dr,Dv] ,
                         +HD['HSbbbb'][p,v,T,U] * HD['Dbb'][Dr,Dw] ,
                         +HD['HSbbbb'][r,w,T,U] * HD['Dbb'][Dp,Dv] ,
                         -HD['HSbbbb'][r,v,T,U] * HD['Dbb'][Dp,Dw] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbbbb'][p,v,T,U] ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                             +HD['HSbbbb'][p,w,T,U] ))
    if p==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +HD['HSbbbb'][r,v,T,U] ))
    if p==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                             -HD['HSbbbb'][r,w,T,U] ))
    return result


def lucc_AAbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,u,v,w) = e
    Dp, Dr, Du, Dv, Dw = p-actfloor, r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dv,Dw,Du,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dp,Du,:,Dv,Dw,:] ) ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbbb'][Dp,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][p,T] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['HSbb'][r,T] * HD['Dbbbb'][Dp,Du,Dv,Dw] ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbbb'][Dp,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dp,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,u,p,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,u,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dp,:] ) ))
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    if p==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    return result


def lucc_AAbb_VACAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,w) = e
    Dp, Dr, Du, Dw = p-actfloor, r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbbbb'][Dp,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbbbb'][Dp,Dw,Du,:] ) ,
                         -HD['HSbbbb'][p,V,u,T] * HD['Dbb'][Dr,Dw] ,
                         +HD['HSbbbb'][r,V,u,T] * HD['Dbb'][Dp,Dw] ))
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    if p==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_AAbb_VACCbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,u,V,W) = e
    Dp, Dr, Du = p-actfloor, r-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbbbb'][T,p,V,W] * HD['Dbb'][Dr,Du] ,
                         -HD['HSbbbb'][T,r,V,W] * HD['Dbb'][Dp,Du] ))
    if r==u:
        result += 2 * -HD['HSbbbb'][T,p,V,W]
    if p==u:
        result += 2 * +HD['HSbbbb'][T,r,V,W]
    return result


def lucc_AAbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,U,v,w) = e
    Dp, Dr, Dv, Dw = p-actfloor, r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dp,:] ) ))
    return result


def lucc_AAbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,w) = e
    Dp, Dr, Dw = p-actfloor, r-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbbbb'][p,V,T,U] * HD['Dbb'][Dr,Dw] ,
                         -HD['HSbbbb'][r,V,T,U] * HD['Dbb'][Dp,Dw] ))
    return result


def lucc_AAbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (p,r),(T,U,V,W) = e
    Dp, Dr = p-actfloor, r-actfloor
    result = 0
    return result


def lucc_CAbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dt,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dw,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbabba'][Dr,Dt,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbabba'][Dr,Dv,:,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbabba'][Dr,Dw,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                         +HD['Dbbbb'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbbbb'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Dbbbb'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +HD['HSbb'][P,t] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['HSbb'][P,u] * HD['Dbbbb'][Dr,Dt,Dv,Dw] ,
                         +HD['HSbb'][P,w] * HD['Dbbbb'][Dr,Dv,Dt,Du] ,
                         -HD['HSbb'][P,v] * HD['Dbbbb'][Dr,Dw,Dt,Du] ,
                         +HD['Dbbbb'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbbbb'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Dbbbb'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,:,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Dw,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][t,u,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,w,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][u,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,w,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][w,P,r,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,u,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,:,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_CAbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                         +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Du,:] ) ,
                         +HD['HSbbbb'][P,T,r,w] * HD['Dbb'][Du,Dv] ,
                         -HD['HSbbbb'][P,T,r,v] * HD['Dbb'][Du,Dw] ,
                         +HD['HSbbbb'][w,P,T,r] * HD['Dbb'][Du,Dv] ,
                         -HD['HSbbbb'][v,P,T,r] * HD['Dbb'][Du,Dw] ,
                         -HD['HSbbbb'][P,T,v,w] * HD['Dbb'][Dr,Du] ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,w] ) ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dw,:,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +HD['HSbb'][r,w] * HD['Dbb'][Du,Dv] ,
                             -HD['HSbb'][r,v] * HD['Dbb'][Du,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,w] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,w,r,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                             -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbb'][Du,Dv] ,
                             -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbb'][Du,Dw] ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    return result


def lucc_CAbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                         -HD['HSbbbb'][v,P,T,U] * HD['Dbb'][Dr,Dw] ,
                         +HD['HSbbbb'][w,P,T,U] * HD['Dbb'][Dr,Dv] ))
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][r,U,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,U,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                             -HD['HSbbbb'][r,U,v,w] ))
    if P==U:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][r,T,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                             +HD['HSbbbb'][r,T,v,w] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +HD['HSbbbb'][v,P,T,U] ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                             -HD['HSbbbb'][w,P,T,U] ))
    return result


def lucc_CAbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,u,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    return result


def lucc_CAbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                         -HD['HSbbbb'][P,V,u,T] * HD['Dbb'][Dr,Dw] ,
                         +HD['HSbbbb'][T,P,V,r] * HD['Dbb'][Du,Dw] ,
                         +HD['HSbbbb'][P,V,r,T] * HD['Dbb'][Du,Dw] ))
    if P==V:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Du,:,Dw,:] ) ,
                             -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             +HD['HSbb'][r,T] * HD['Dbb'][Du,Dw] ,
                             -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,u,r,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_CAbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][T,P,V,W] * HD['Dbb'][Dr,Du]
    if P==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                             +HD['HSbbbb'][r,V,u,T] ))
    if P==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][r,W,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                             -HD['HSbbbb'][r,W,u,T] ))
    if r==u:
        result += 2 * -HD['HSbbbb'][T,P,V,W]
    return result


def lucc_CAbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] )
    return result


def lucc_CAbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,V,T,U] * HD['Dbb'][Dr,Dw]
    if P==V:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_CAbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    if P==W:
        result += 2 * -HD['HSbbbb'][r,V,T,U]
    if P==V:
        result += 2 * +HD['HSbbbb'][r,W,T,U]
    return result


def lucc_VAbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(t,u,v,w) = e
    Dr, Dt, Du, Dv, Dw = r-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dw,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dt,:,:] ) ))
    result += 2 * fsum(( -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbbbb'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbbbb'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Dbbbb'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbabba'][Dr,Dt,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbabba'][Dr,Dv,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbabba'][Dr,Dw,:,Dt,Du,:] ) ,
                         +HD['HSbb'][P,t] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['HSbb'][P,u] * HD['Dbbbb'][Dr,Dt,Dv,Dw] ,
                         +HD['HSbb'][P,w] * HD['Dbbbb'][Dr,Dv,Dt,Du] ,
                         -HD['HSbb'][P,v] * HD['Dbbbb'][Dr,Dw,Dt,Du] ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbbbb'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbbbb'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Dbbbb'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,:,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,:,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Dw,:,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,u,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,w,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Dr,:] ) ))
    if r==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,:,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_VAbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                         +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,w,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                         -HD['HSbbbb'][P,T,v,w] * HD['Dbb'][Dr,Du] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                             -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbb'][Du,Dv] ,
                             -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbb'][Du,Dw] ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,w,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    return result


def lucc_VAbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                         -HD['HSbbbb'][P,w,T,U] * HD['Dbb'][Dr,Dv] ,
                         +HD['HSbbbb'][P,v,T,U] * HD['Dbb'][Dr,Dw] ))
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbbbb'][P,v,T,U] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbb'][Dw,:] ) ,
                             +HD['HSbbbb'][P,w,T,U] ))
    return result


def lucc_VAbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,v,w) = e
    Dr, Du, Dv, Dw = r-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,u,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Dr,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,u,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    return result


def lucc_VAbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,w) = e
    Dr, Du, Dw = r-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                         -HD['HSbbbb'][P,V,u,T] * HD['Dbb'][Dr,Dw] ))
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dw,:,Du,:] ) ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             +HD['HSbb'][r,V] * HD['Dbb'][Du,Dw] ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,u,V,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    if r==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_VAbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,u,V,W) = e
    Dr, Du = r-actfloor, u-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,T,V,W] * HD['Dbb'][Dr,Du]
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][V,W,r,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                             +HD['HSbbbb'][r,u,V,W] ))
    if r==u:
        result += 2 * +HD['HSbbbb'][P,T,V,W]
    return result


def lucc_VAbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,v,w) = e
    Dr, Dv, Dw = r-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Dr,:] )
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][U,r,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    if P==U:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    return result


def lucc_VAbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,w) = e
    Dr, Dw = r-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,V,T,U] * HD['Dbb'][Dr,Dw]
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][U,r,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    if P==U:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_VAbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,r),(T,U,V,W) = e
    Dr = r-actfloor
    result = 0
    if P==T:
        result += 2 * -HD['HSbbbb'][U,r,V,W]
    if P==U:
        result += 2 * +HD['HSbbbb'][T,r,V,W]
    return result


def lucc_VCbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][u,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,w,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][w,R,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,u,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_VCbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -HD['HSbbbb'][P,w,R,T] * HD['Dbb'][Du,Dv] ,
                         +HD['HSbbbb'][P,v,R,T] * HD['Dbb'][Du,Dw] ,
                         -HD['HSbbbb'][P,T,R,w] * HD['Dbb'][Du,Dv] ,
                         +HD['HSbbbb'][P,T,R,v] * HD['Dbb'][Du,Dw] ))
    if R==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                             -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -HD['HSbb'][P,w] * HD['Dbb'][Du,Dv] ,
                             +HD['HSbb'][P,v] * HD['Dbb'][Du,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                             -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,w,actfloor:actceil,P], HD['Dbb'][Du,:] ) ))
    return result


def lucc_VCbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,U,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,U,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                             +HD['HSbbbb'][P,U,v,w] ))
    if R==U:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                             -HD['HSbbbb'][P,T,v,w] ))
    return result


def lucc_VCbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][u,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VCbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,V,R,T] * HD['Dbb'][Du,Dw] ,
                         -HD['HSbbbb'][P,T,R,V] * HD['Dbb'][Du,Dw] ))
    if R==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Du,:,Dw,:] ) ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][P,T] * HD['Dbb'][Du,Dw] ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Du,:,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,u,actfloor:actceil,P], HD['Dbb'][Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbaba'][Dw,:,Du,:] ) ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             +HD['HSbb'][R,V] * HD['Dbb'][Du,Dw] ,
                             +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][u,R,V,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    return result


def lucc_VCbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if R==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                             -HD['HSbbbb'][P,V,u,T] ))
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,W,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                             +HD['HSbbbb'][P,W,u,T] ))
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][V,W,R,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                             -HD['HSbbbb'][u,R,V,W] ))
    return result


def lucc_VCbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][U,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    if P==U:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    return result


def lucc_VCbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if R==V:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbb'][Dw,:] )
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][U,R,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    if P==U:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,R,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_VCbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,R),(T,U,V,W) = e
    result = 0
    if R==W:
        result += 2 * +HD['HSbbbb'][P,V,T,U]
    if R==V:
        result += 2 * -HD['HSbbbb'][P,W,T,U]
    if P==T:
        result += 2 * -HD['HSbbbb'][U,R,V,W]
    if P==U:
        result += 2 * +HD['HSbbbb'][T,R,V,W]
    return result


def lucc_AAAAaaaa_CAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][q,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dp,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dv,Dr,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dv,Ds,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][p,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][p,T] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         +HD['HSaa'][q,T] * HD['Daaaa'][Dp,Dv,Dr,Ds] ,
                         -HD['HSaa'][s,T] * HD['Daaaa'][Dp,Dq,Dr,Dv] ,
                         +HD['HSaa'][r,T] * HD['Daaaa'][Dp,Dq,Ds,Dv] ,
                         +HD['Daaaa'][Dp,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                         -HD['Daaaa'][Dp,Dq,Dr,Dv] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                         -HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Daaaa'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,:,Dr,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,:,Ds,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dp,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daaaa'][Dp,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][p,v,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][p,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,v,T,actfloor:actceil], HD['Daaaa'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,v,T,actfloor:actceil], HD['Daaaa'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dq,Ds,:] ) ,
                         -HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Daaaa'][Dp,Dv,Dr,Ds] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                         -HD['Daaaa'][Dp,Dq,Dr,Dv] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                         +HD['Daaaa'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dp,Dq,:,Dr,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dp,Dq,:,Ds,Dv,:] ) ))
    if r==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dp,Dq,:,:] )
        result += 2 * fsum(( +HD['HSaa'][p,T] * HD['Daa'][Dq,Ds] ,
                             -HD['HSaa'][q,T] * HD['Daa'][Dp,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             -HD['Daa'][Dp,Ds] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             -HD['Daa'][Dp,Ds] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Ds,:,Dp,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Ds,:,Dq,:] ) ))
    if s==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dp,Dq,:,:] )
        result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Daa'][Dp,Dr] ,
                             -HD['HSaa'][p,T] * HD['Daa'][Dq,Dr] ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             +HD['Daa'][Dp,Dr] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             +HD['Daa'][Dp,Dr] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dr,:,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dr,:,Dp,:] ) ))
    if p==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][q,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
        result += 2 * fsum(( -HD['HSaa'][r,T] * HD['Daa'][Dq,Ds] ,
                             +HD['HSaa'][s,T] * HD['Daa'][Dq,Dr] ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             +HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dq,:,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             +HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dq,:,Ds,:] ) ))
    if q==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][p,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
        result += 2 * fsum(( +HD['HSaa'][r,T] * HD['Daa'][Dp,Ds] ,
                             -HD['HSaa'][s,T] * HD['Daa'][Dp,Dr] ,
                             +HD['Daa'][Dp,Ds] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             -HD['Daa'][Dp,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dp,:,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dp,:,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daa'][Dp,:] ) ,
                             -HD['Daa'][Dp,Dr] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             +HD['Daa'][Dp,Ds] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dp,:,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dp,:,Ds,:] ) ))
    return result


def lucc_AAAAaaaa_VAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dv,Ds,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dp,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dv,Dr,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][T,p,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][p,T] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         +HD['HSaa'][q,T] * HD['Daaaa'][Dp,Dv,Dr,Ds] ,
                         -HD['HSaa'][s,T] * HD['Daaaa'][Dp,Dq,Dr,Dv] ,
                         +HD['HSaa'][r,T] * HD['Daaaa'][Dp,Dq,Ds,Dv] ,
                         -HD['Daaaa'][Dp,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaa'][Dp,Dq,Dr,Dv] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                         -HD['Daaaa'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,:,Dr,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dp,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,s,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][p,q,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         -HD['Daaaa'][Dp,Dv,Dr,Ds] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaa'][Dp,Dq,Dr,Dv] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                         -HD['Daaaa'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSabba'][p,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dp,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dp,Dq,:,Dr,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dq,Dv,:] ) ))
    return result


def lucc_AAAAaaaa_VCaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,V) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][p,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,p,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,V,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Daaaa'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,V,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daaaa'][Dp,Dq,Ds,:] ) ))
    return result


def lucc_CAAAaaaa_AAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dq,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][t,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][P,t] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         +HD['HSaa'][P,v] * HD['Daaaa'][Dq,Dt,Dr,Ds] ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Daaaa'][Dq,Dt,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,t,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][t,P,s,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,v,P,actfloor:actceil], HD['Daaaa'][Dq,Dt,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,P,s,actfloor:actceil], HD['Daaaa'][Dr,Dt,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,t,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][t,P,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,v,P,actfloor:actceil], HD['Daaaa'][Dq,Dt,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,P,r,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,t,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         -HD['HSaaaa'][t,P,r,s] * HD['Daa'][Dq,Dv] ,
                         +HD['HSaaaa'][v,P,r,s] * HD['Daa'][Dq,Dt] ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Daaaa'][Dq,Dt,Dr,Ds] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,t,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,v,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dq,Dt,:] ) ))
    if q==t:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -HD['HSaa'][P,s] * HD['Daa'][Dr,Dv] ,
                             +HD['HSaa'][P,r] * HD['Daa'][Ds,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    if q==v:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ,
                             +HD['HSaa'][P,s] * HD['Daa'][Dr,Dt] ,
                             -HD['HSaa'][P,r] * HD['Daa'][Ds,Dt] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ,
                             +HD['Daa'][Ds,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Daa'][Dr,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Ds,:,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaa'][Dr,:,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ,
                             -HD['Daa'][Dr,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Daa'][Ds,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dabab'][Dr,:,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Ds,:,Dt,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                             +HD['HSaa'][P,s] * HD['Daa'][Dq,Dt] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                             -HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaa'][Dt,:,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                             -HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Dt,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dabab'][Dt,:,Dq,:] ) ))
    if s==v:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,:,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Dt,Dq,:] ) ,
                             -HD['HSaa'][P,r] * HD['Daa'][Dq,Dt] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Dt,Dq,:] ) ,
                             +HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Dt,:,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Dt,Dq,:] ) ,
                             +HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Dt,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Dt,:,Dq,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             -HD['HSaa'][P,s] * HD['Daa'][Dq,Dv] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             +HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             +HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ))
    if s==t:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                             +HD['HSaa'][P,r] * HD['Daa'][Dq,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Dv,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ))
    return result


def lucc_CAAAaaaa_CAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,:,:] )
    result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         -HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,s,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +HD['HSaaaa'][P,T,r,s] * HD['Daa'][Dq,Dv] ,
                         +HD['HSaaaa'][P,T,s,v] * HD['Daa'][Dq,Dr] ,
                         +HD['HSaaaa'][v,P,T,s] * HD['Daa'][Dq,Dr] ,
                         -HD['HSaaaa'][P,T,r,v] * HD['Daa'][Dq,Ds] ,
                         -HD['HSaaaa'][v,P,T,r] * HD['Daa'][Dq,Ds] ,
                         -HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dq,Dv,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Dr,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Ds,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][q,v,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             +HD['HSaa'][s,v] * HD['Daa'][Dq,Dr] ,
                             -HD['HSaa'][r,v] * HD['Daa'][Dq,Ds] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,v] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dq,:,Ds,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,v] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ))
        if r==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,:,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dq,:,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ))
        if s==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,:,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,:,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dr,:,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dq,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,T,P,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Ds,:,Dq,:] ) ))
    if s==v:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Dq,Dr] ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Dr,:,Dq,:] ) ))
    if q==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,T,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                             -HD['HSaaaa'][P,T,r,s] ))
    return result


def lucc_CAAAaaaa_VAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,:,:] )
    result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,P,s,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,s,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,P,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,r,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         -HD['HSaaaa'][T,P,r,s] * HD['Daa'][Dq,Dv] ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dq,Dv,:] ) ))
    return result


def lucc_CAAAaaaa_VCaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -HD['HSaaaa'][T,P,V,s] * HD['Daa'][Dq,Dr] ,
                         -HD['HSaaaa'][P,V,s,T] * HD['Daa'][Dq,Dr] ,
                         +HD['HSaaaa'][T,P,V,r] * HD['Daa'][Dq,Ds] ,
                         +HD['HSaaaa'][P,V,r,T] * HD['Daa'][Dq,Ds] ))
    if P==V:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
        result += 2 * fsum(( -HD['HSaa'][s,T] * HD['Daa'][Dq,Dr] ,
                             +HD['HSaa'][r,T] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                             +HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dq,:,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dq,:,Dr,:] ) ))
    return result


def lucc_CCAAaaaa_AAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,t,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,Q,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ,
                         -HD['HSaaaa'][P,Q,s,v] * HD['Daa'][Dr,Dt] ,
                         +HD['HSaaaa'][P,Q,s,t] * HD['Daa'][Dr,Dv] ,
                         +HD['HSaaaa'][P,Q,r,v] * HD['Daa'][Ds,Dt] ,
                         -HD['HSaaaa'][P,Q,r,t] * HD['Daa'][Ds,Dv] ))
    if r==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dt,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,s,actfloor:actceil], HD['Daa'][Dt,:] )
    if s==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dt,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,r,actfloor:actceil], HD['Daa'][Dt,:] )
    if r==t:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dv,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,s,actfloor:actceil], HD['Daa'][Dv,:] )
    if s==t:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,r,actfloor:actceil], HD['Daa'][Dv,:] )
    return result


def lucc_CCAAaaaa_CAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         +HD['HSaaaa'][P,Q,T,r] * HD['Daa'][Ds,Dv] ,
                         -HD['HSaaaa'][P,Q,T,s] * HD['Daa'][Dr,Dv] ))
    if Q==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -HD['HSaa'][P,s] * HD['Daa'][Dr,Dv] ,
                             +HD['HSaa'][P,r] * HD['Daa'][Ds,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,P,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,P,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                             +HD['HSaaaa'][v,P,r,s] ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
        if r==v:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSaa'][P,s] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==v:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,:,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['HSaa'][P,r] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dr,:,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][v,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +HD['HSaa'][Q,s] * HD['Daa'][Dr,Dv] ,
                             -HD['HSaa'][Q,r] * HD['Daa'][Ds,Dv] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                             +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,Q,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,Q,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,Q,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                             -HD['HSaaaa'][v,Q,r,s] ,
                             -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,r] ) ,
                             -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
        if r==v:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaa'][Q,s] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==v:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,:,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['HSaa'][Q,r] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dr,:,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['HSaaaa'][P,Q,T,s] ))
    if s==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                             -HD['HSaaaa'][P,Q,T,r] ))
    return result


def lucc_CCAAaaaa_VAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         +HD['HSaaaa'][P,Q,s,T] * HD['Daa'][Dr,Dv] ,
                         -HD['HSaaaa'][P,Q,r,T] * HD['Daa'][Ds,Dv] ))
    return result


def lucc_CCAAaaaa_VCaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==V:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,P,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,P,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             -HD['HSaaaa'][T,P,r,s] ))
    if P==V:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][T,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,Q,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,Q,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['HSaaaa'][T,Q,r,s] ))
    return result


def lucc_VAAAaaaa_AAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][P,v,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dq,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][P,t,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][P,t] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         +HD['HSaa'][P,v] * HD['Daaaa'][Dq,Dt,Dr,Ds] ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Daaaa'][Dq,Dt,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,t,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,q,t,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,q,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,t,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dq,Dt,:] ) ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Daaaa'][Dq,Dt,Dr,Ds] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,:,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dt,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Dt,:,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ))
    if s==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,:,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dt,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Dt,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Dt,Dq,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Dt,:,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Dt,Dq,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ))
    if s==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,:,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Dv,:,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ))
    if q==t:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ))
    if q==v:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ))
    return result


def lucc_VAAAaaaa_CAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,:,:] )
    result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         -HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,v,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dq,Dv,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Ds,:,Dq,:] ) ))
    if s==v:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Dq,Dr] ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dr,:,Dq,:] ) ))
    if q==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
    return result


def lucc_VAAAaaaa_VAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,:,:] )
    result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,q,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         +HD['Daaaa'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dq,Dv,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Dr,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Ds,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Ds,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ))
    return result


def lucc_VAAAaaaa_VCaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ))
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][q,V,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
        result += 2 * fsum(( -HD['HSaa'][s,V] * HD['Daa'][Dq,Dr] ,
                             +HD['HSaa'][r,V] * HD['Daa'][Dq,Ds] ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dq,:,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             -HD['Daa'][Dq,Dr] * einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabab'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dq,:,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dq,:,Dr,:] ) ))
    return result


def lucc_VACAaaaa_AAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,v) = e
    Dq, Ds, Dt, Dv = q-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][t,R,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,v,R,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,R,actfloor:actceil,P], HD['Daaaa'][Dq,Dt,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,t,R,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         -HD['HSaaaa'][P,q,R,t] * HD['Daa'][Ds,Dv] ,
                         +HD['HSaaaa'][P,q,R,v] * HD['Daa'][Ds,Dt] ))
    if s==v:
        result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Daa'][Dq,Dt] ,
                             +HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dt,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             +HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dt,:,Dq,:] ) ))
    if s==t:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daa'][Dq,Dv] ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ))
    if q==t:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daa'][Ds,Dv] ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    if q==v:
        result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Daa'][Ds,Dt] ,
                             +HD['Daa'][Ds,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Ds,:,Dt,:] ) ,
                             +HD['Daa'][Ds,Dt] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Ds,:,Dt,:] ) ))
    return result


def lucc_VACAaaaa_CAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][R,T,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         -HD['HSaaaa'][P,q,R,T] * HD['Daa'][Ds,Dv] ,
                         +HD['HSaaaa'][P,v,R,T] * HD['Daa'][Dq,Ds] ,
                         +HD['HSaaaa'][P,T,R,v] * HD['Daa'][Dq,Ds] ))
    if R==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             +HD['HSaa'][P,v] * HD['Daa'][Dq,Ds] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,v,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Ds,:,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
        if q==v:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if q==v:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daa'][Ds,:] )
    if s==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][R,T,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             +HD['HSaaaa'][P,q,R,T] ))
    return result


def lucc_VACAaaaa_VAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         -HD['HSaaaa'][P,q,R,T] * HD['Daa'][Ds,Dv] ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             +HD['HSaa'][q,R] * HD['Daa'][Ds,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Ds,:,:] ) ))
    return result


def lucc_VACAaaaa_VCaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,V) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][P,T,R,V] * HD['Daa'][Dq,Ds] ,
                         -HD['HSaaaa'][P,V,R,T] * HD['Daa'][Dq,Ds] ))
    if R==V:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,actfloor:actceil,T], HD['Daa'][Ds,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Ds,:,Dq,:] ) ))
        if P==T:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,:,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dq,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if P==T:
        result += 2 * fsum(( +HD['HSaa'][R,V] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][q,V,R,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dq,:,Ds,:] ) ))
    return result


def lucc_VACCaaaa_AAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,v) = e
    Dq, Dt, Dv = q-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][P,v,R,S] * HD['Daa'][Dq,Dt] ,
                         +HD['HSaaaa'][P,t,R,S] * HD['Daa'][Dq,Dv] ))
    if q==t:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Daa'][Dv,:] )
    if q==v:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Daa'][Dt,:] )
    return result


def lucc_VACCaaaa_CAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,T,R,S] * HD['Daa'][Dq,Dv]
    if S==T:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daa'][Dq,Dv] ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,R,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             +HD['HSaaaa'][P,q,R,v] ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ))
        if q==v:
            result += 2 * fsum(( +HD['HSaa'][P,R] ,
                                 +einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if R==T:
        result += 2 * fsum(( +HD['HSaa'][P,S] * HD['Daa'][Dq,Dv] ,
                             +HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,S,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,S,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,S,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             -HD['HSaaaa'][P,q,S,v] ,
                             +HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,S,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ))
        if q==v:
            result += 2 * fsum(( -HD['HSaa'][P,S] ,
                                 -einsum( 'II->', HD['HSaaaa'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'II->', HD['HSabab'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if q==v:
        result += 2 * -HD['HSaaaa'][P,T,R,S]
    return result


def lucc_VACCaaaa_VAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,T,R,S] * HD['Daa'][Dq,Dv]
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][R,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dv,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][R,S,q,actfloor:actceil], HD['Daa'][Dv,:] )
    return result


def lucc_VACCaaaa_VCaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,V) = e
    Dq = q-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][R,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             -HD['HSaaaa'][q,V,R,S] ))
        if S==V:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,:,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaa'][q,R] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'II->', HD['HSaaaa'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'II->', HD['HSabab'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dq,:,:,:] ) ))
        if R==V:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,:,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaa'][q,S] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'II->', HD['HSaaaa'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'II->', HD['HSabab'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dq,:,:,:] ) ))
    if S==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             -HD['HSaaaa'][P,q,R,T] ))
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,S,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             +HD['HSaaaa'][P,q,S,T] ))
    return result


def lucc_VVAAaaaa_AAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,t,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,Q,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dt,:] ) ))
    if r==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dt,:,:] )
    if s==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dt,:,:] )
    if r==t:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dv,:,:] )
    if s==t:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dv,:,:] )
    return result


def lucc_VVAAaaaa_CAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] )
    if r==v:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daa'][Ds,:] )
    if s==v:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daa'][Dr,:] )
    return result


def lucc_VVAAaaaa_VAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dv,:] )
    if Q==T:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ))
    return result


def lucc_VVAAaaaa_VCaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,V,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][Q,V,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Ds,:,:] )
    return result


def lucc_VVCAaaaa_AAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,v) = e
    Ds, Dt, Dv = s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][P,Q,R,t] * HD['Daa'][Ds,Dv] ,
                         +HD['HSaaaa'][P,Q,R,v] * HD['Daa'][Ds,Dt] ))
    if s==v:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Daa'][Dt,:] )
    if s==t:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Daa'][Dv,:] )
    return result


def lucc_VVCAaaaa_CAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,Q,R,T] * HD['Daa'][Ds,Dv]
    if R==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dv,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,v,actfloor:actceil], HD['Daa'][Ds,:] )
    if s==v:
        result += 2 * +HD['HSaaaa'][P,Q,R,T]
    return result


def lucc_VVCAaaaa_VAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,Q,R,T] * HD['Daa'][Ds,Dv]
    if Q==T:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daa'][Ds,Dv] ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    if P==T:
        result += 2 * fsum(( +HD['HSaa'][Q,R] * HD['Daa'][Ds,Dv] ,
                             +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][Q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    return result


def lucc_VVCAaaaa_VCaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,V) = e
    Ds = s-actfloor
    result = 0
    if R==V:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,actfloor:actceil,T], HD['Daa'][Ds,:] )
        if Q==T:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ))
        if P==T:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if Q==T:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,V,R,actfloor:actceil], HD['Daa'][Ds,:] )
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][Q,V,R,actfloor:actceil], HD['Daa'][Ds,:] )
    return result


def lucc_VVCCaaaa_AAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_CAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    if S==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +HD['HSaaaa'][P,Q,R,v] ))
    if R==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,S,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -HD['HSaaaa'][P,Q,S,v] ))
    return result


def lucc_VVCCaaaa_VAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Daa'][Dv,:] )
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,Q], HD['Daa'][Dv,:] )
    return result


def lucc_VVCCaaaa_VCaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,V) = e
    result = 0
    if Q==T:
        result += 2 * +HD['HSaaaa'][P,V,R,S]
        if S==V:
            result += 2 * fsum(( -HD['HSaa'][P,R] ,
                                 -einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( +HD['HSaa'][P,S] ,
                                 +einsum( 'II->', HD['HSaaaa'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'II->', HD['HSabab'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if S==V:
        result += 2 * -HD['HSaaaa'][P,Q,R,T]
        if P==T:
            result += 2 * fsum(( +HD['HSaa'][Q,R] ,
                                 +einsum( 'II->', HD['HSaaaa'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'II->', HD['HSabab'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if R==V:
        result += 2 * +HD['HSaaaa'][P,Q,S,T]
        if P==T:
            result += 2 * fsum(( -HD['HSaa'][Q,S] ,
                                 -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'II->', HD['HSabab'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if P==T:
        result += 2 * -HD['HSaaaa'][Q,V,R,S]
    return result


def lucc_AAAAaaaa_CAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dp,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dq,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dq,Ds,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dp,Dq,:,Dr,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][q,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][p,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Daaaa'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Daaaa'][Dp,Dq,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dp,:] ) ))
    return result


def lucc_AAAAaaaa_VAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dp,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dp,Dq,:,Dr,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dp,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dq,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dq,Ds,:,:] ) ))
    return result


def lucc_AAAAaaaa_VCbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,V) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][p,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Daaaa'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daaaa'][Dp,Dq,Ds,:] ) ))
    return result


def lucc_CAAAaaaa_AAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Dr,Ds,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,P,s,actfloor:actceil], HD['Dbaab'][Dv,Dr,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,s,P,actfloor:actceil], HD['Dbaab'][Dt,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,P,s,actfloor:actceil], HD['Dbaab'][Dt,Dr,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,s,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,P,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,r,P,actfloor:actceil], HD['Dbaab'][Dt,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,P,r,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,t,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,v,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dq,Dt,:] ) ))
    return result


def lucc_CAAAaaaa_CAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][s,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Dr,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,s,actfloor:actceil], HD['Dbaab'][Dv,Dr,Dq,:] ) ,
                         +HD['HSbaab'][T,P,r,v] * HD['Daa'][Dq,Ds] ,
                         -HD['HSbaab'][T,P,s,v] * HD['Daa'][Dq,Dr] ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -HD['HSbaba'][v,P,T,r] * HD['Daa'][Dq,Ds] ,
                         +HD['HSbaba'][v,P,T,s] * HD['Daa'][Dq,Dr] ))
    return result


def lucc_CAAAaaaa_VAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,s,actfloor:actceil], HD['Dbaab'][Dv,Dr,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,s,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ))
    return result


def lucc_CAAAaaaa_VCbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][V,P,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         +HD['HSbaab'][V,P,s,T] * HD['Daa'][Dq,Dr] ,
                         -HD['HSbaab'][V,P,r,T] * HD['Daa'][Dq,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -HD['HSbaba'][T,P,V,s] * HD['Daa'][Dq,Dr] ,
                         +HD['HSbaba'][T,P,V,r] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_CCAAaaaa_AAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_CAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VCbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VAAAaaaa_AAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Dr,Ds,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,t,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dq,Dt,:] ) ))
    return result


def lucc_VAAAaaaa_CAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ))
    return result


def lucc_VAAAaaaa_VAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,:,:] ) ))
    return result


def lucc_VAAAaaaa_VCbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dq,:] ) ))
    return result


def lucc_VACAaaaa_AAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,v) = e
    Dq, Ds, Dt, Dv = q-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,v,R,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][P,t,R,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][t,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,R,actfloor:actceil,P], HD['Dbaab'][Dt,Dq,Ds,:] ) ))
    return result


def lucc_VACAaaaa_CAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         +HD['HSabab'][P,v,R,T] * HD['Daa'][Dq,Ds] ,
                         +HD['HSabab'][P,T,R,v] * HD['Daa'][Dq,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Ds,:] ) ))
    return result


def lucc_VACAaaaa_VAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,P,R,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Ds,:] ) ))
    return result


def lucc_VACAaaaa_VCbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,V) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSabab'][P,V,R,T] * HD['Daa'][Dq,Ds] ,
                         +HD['HSbaab'][T,P,R,V] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_VACCaaaa_AAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,v) = e
    Dq, Dt, Dv = q-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VACCaaaa_CAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VCbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,V) = e
    Dq = q-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_AAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_CAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VCbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_AAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,v) = e
    Ds, Dt, Dv = s-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_CAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VCbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,V) = e
    Ds = s-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_AAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_CAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VCbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,V) = e
    result = 0
    return result


def lucc_AAAAaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][q,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dp,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dp,Dq,Dv,Dw,Dr,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dp,Dq,Dv,Dw,Ds,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][p,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][p,T] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['HSaa'][q,T] * HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,Du] ,
                         +HD['HSaa'][s,T] * HD['Daaaaaa'][Dp,Dq,Du,Dr,Dv,Dw] ,
                         -HD['HSaa'][r,T] * HD['Daaaaaa'][Dp,Dq,Du,Ds,Dv,Dw] ,
                         -HD['Daaaaaa'][Dp,Dq,Du,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                         -HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                         +HD['Daaaaaa'][Dp,Dq,Du,Dr,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaaaa'][Dp,Dq,Du,:,Dr,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaaaa'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dp,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][q,w,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dp,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dp,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][q,T,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dp,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,T,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dp,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,w,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Du,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,v,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Du,Dr,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,T,w,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dv,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,T,v,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,w,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,v,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,T,w,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dv,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,T,v,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][p,w,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][p,v,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][p,T,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][p,T,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSaaaa'][s,T,v,w] * HD['Daaaa'][Dp,Dq,Dr,Du] ,
                         -HD['HSaaaa'][r,T,v,w] * HD['Daaaa'][Dp,Dq,Ds,Du] ,
                         -HD['HSaaaa'][q,T,v,w] * HD['Daaaa'][Dp,Du,Dr,Ds] ,
                         +HD['HSaaaa'][p,T,v,w] * HD['Daaaa'][Dq,Du,Dr,Ds] ,
                         +HD['Daaaaaa'][Dp,Dq,Du,Dr,Dv,Dw] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                         -HD['Daaaaaa'][Dp,Dq,Du,Ds,Dv,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                         -HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dp,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaab'][Dp,Dq,Du,:,Dr,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaab'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ))
    if s==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Du,:,:] )
        result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Daaaa'][Dp,Dw,Dr,Du] ,
                             -HD['HSaa'][p,T] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dp,Dw,Dr,Du] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dp,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][q,w,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][p,w,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,T,w,actfloor:actceil], HD['Daaaa'][Dp,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dp,Dw,Dr,Du] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dp,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dq,Dw,:] ) ))
        if r==w:
            result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Daa'][Dp,Du] ,
                                 +HD['HSaa'][p,T] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                                 -HD['Daa'][Dp,Du] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dp,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                                 -HD['Daa'][Dp,Du] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dp,:] ) ))
    if r==w:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dv,Du,:,:] )
        result += 2 * fsum(( -HD['HSaa'][p,T] * HD['Daaaa'][Dq,Dv,Ds,Du] ,
                             +HD['HSaa'][q,T] * HD['Daaaa'][Dp,Dv,Ds,Du] ,
                             -HD['Daaaa'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dp,Dv,Ds,Du] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dp,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][p,v,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dp,:] ) ,
                             +HD['Daaaa'][Dp,Dv,Ds,Du] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             -HD['Daaaa'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dp,Dv,:] ) ))
    if s==w:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dv,Du,:,:] )
        result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Daaaa'][Dp,Dv,Dr,Du] ,
                             +HD['HSaa'][p,T] * HD['Daaaa'][Dq,Dv,Dr,Du] ,
                             -HD['Daaaa'][Dp,Dv,Dr,Du] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dp,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][p,v,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                             +HD['Daaaa'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             -HD['Daaaa'][Dp,Dv,Dr,Du] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dp,Dv,:] ) ))
        if r==v:
            result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Daa'][Dp,Du] ,
                                 -HD['HSaa'][p,T] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                                 +HD['Daa'][Dp,Du] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dp,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                                 +HD['Daa'][Dp,Du] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dp,:] ) ))
    if r==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Du,:,:] )
        result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Daaaa'][Dp,Dw,Ds,Du] ,
                             +HD['HSaa'][p,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,T,:actfloor] ) ,
                             -HD['Daaaa'][Dp,Dw,Ds,Du] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dp,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][p,w,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][p,q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][q,w,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,T,w,actfloor:actceil], HD['Daaaa'][Dp,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dp,Dw,Ds,Du] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSabab'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dp,Dw,:] ) ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][p,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -HD['HSaa'][s,T] * HD['Daaaa'][Dp,Du,Dr,Dw] ,
                             +HD['HSaa'][r,T] * HD['Daaaa'][Dp,Du,Ds,Dw] ,
                             +HD['Daaaa'][Dp,Du,Ds,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             -HD['Daaaa'][Dp,Du,Dr,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dp,Du,:,Ds,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dp,Du,:,Dr,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,w,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][p,T,w,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,w,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Dw,:] ) ,
                             -HD['Daaaa'][Dp,Du,Dr,Dw] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dp,Du,Ds,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dp,Du,:,Dr,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dp,Du,:,Ds,Dw,:] ) ))
        if p==w:
            result += 2 * fsum(( -HD['HSaa'][r,T] * HD['Daa'][Ds,Du] ,
                                 +HD['HSaa'][s,T] * HD['Daa'][Dr,Du] ,
                                 -HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                                 +HD['Daa'][Dr,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['Daa'][Dr,Du] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                                 -HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Ds,:] ) ))
    if p==w:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][q,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Du,:,:] )
        result += 2 * fsum(( +HD['HSaa'][r,T] * HD['Daaaa'][Dq,Du,Ds,Dv] ,
                             -HD['HSaa'][s,T] * HD['Daaaa'][Dq,Du,Dr,Dv] ,
                             -HD['Daaaa'][Dq,Du,Dr,Dv] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dq,Du,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dq,Du,:,Dr,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dq,Du,:,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][q,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,v,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,v,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             -HD['Daaaa'][Dq,Du,Dr,Dv] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dq,Du,Ds,Dv] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dq,Du,:,Dr,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dq,Du,:,Ds,Dv,:] ) ))
    if q==w:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][p,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Du,:,:] )
        result += 2 * fsum(( +HD['HSaa'][s,T] * HD['Daaaa'][Dp,Du,Dr,Dv] ,
                             -HD['HSaa'][r,T] * HD['Daaaa'][Dp,Du,Ds,Dv] ,
                             -HD['Daaaa'][Dp,Du,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             +HD['Daaaa'][Dp,Du,Dr,Dv] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dp,Du,:,Ds,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dp,Du,:,Dr,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,v,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][p,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,v,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Ds,:] ) ,
                             +HD['Daaaa'][Dp,Du,Dr,Dv] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Daaaa'][Dp,Du,Ds,Dv] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dp,Du,:,Dr,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dp,Du,:,Ds,Dv,:] ) ))
        if p==v:
            result += 2 * fsum(( -HD['HSaa'][s,T] * HD['Daa'][Dr,Du] ,
                                 +HD['HSaa'][r,T] * HD['Daa'][Ds,Du] ,
                                 -HD['Daa'][Dr,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['Daa'][Dr,Du] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Ds,:] ) ))
    if p==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][q,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( +HD['HSaa'][s,T] * HD['Daaaa'][Dq,Du,Dr,Dw] ,
                             -HD['HSaa'][r,T] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                             +HD['Daaaa'][Dq,Du,Dr,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dq,Du,:,Dr,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dq,Du,:,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,w,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,w,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][q,T,w,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +HD['Daaaa'][Dq,Du,Dr,Dw] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dq,Du,:,Dr,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dq,Du,:,Ds,Dw,:] ) ))
    return result


def lucc_AAAAaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dp,Dq,:] ) ,
                         +HD['HSaaaa'][p,q,T,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         -HD['HSaaaa'][r,s,T,U] * HD['Daaaa'][Dp,Dq,Dv,Dw] ,
                         -HD['HSaaaa'][q,w,T,U] * HD['Daaaa'][Dp,Dv,Dr,Ds] ,
                         +HD['HSaaaa'][q,v,T,U] * HD['Daaaa'][Dp,Dw,Dr,Ds] ,
                         -HD['HSaaaa'][r,w,T,U] * HD['Daaaa'][Dp,Dq,Ds,Dv] ,
                         +HD['HSaaaa'][r,v,T,U] * HD['Daaaa'][Dp,Dq,Ds,Dw] ,
                         +HD['HSaaaa'][s,w,T,U] * HD['Daaaa'][Dp,Dq,Dr,Dv] ,
                         -HD['HSaaaa'][s,v,T,U] * HD['Daaaa'][Dp,Dq,Dr,Dw] ,
                         +HD['HSaaaa'][p,w,T,U] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         -HD['HSaaaa'][p,v,T,U] * HD['Daaaa'][Dq,Dw,Dr,Ds] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Daaaa'][Dp,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             -HD['HSaaaa'][q,w,T,U] * HD['Daa'][Dp,Dr] ,
                             -HD['HSaaaa'][p,q,T,U] * HD['Daa'][Dr,Dw] ,
                             +HD['HSaaaa'][p,w,T,U] * HD['Daa'][Dq,Dr] ))
        if r==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Daa'][Dp,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][p,q,T,U] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Daaaa'][Dp,Dv,Ds,:] ) ,
                             -HD['HSaaaa'][p,q,T,U] * HD['Daa'][Ds,Dv] ,
                             +HD['HSaaaa'][p,v,T,U] * HD['Daa'][Dq,Ds] ,
                             -HD['HSaaaa'][q,v,T,U] * HD['Daa'][Dp,Ds] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Daaaa'][Dp,Dv,Dr,:] ) ,
                             +HD['HSaaaa'][p,q,T,U] * HD['Daa'][Dr,Dv] ,
                             -HD['HSaaaa'][p,v,T,U] * HD['Daa'][Dq,Dr] ,
                             +HD['HSaaaa'][q,v,T,U] * HD['Daa'][Dp,Dr] ))
        if r==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Daa'][Dp,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][p,q,T,U] ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Daaaa'][Dp,Dw,Ds,:] ) ,
                             +HD['HSaaaa'][p,q,T,U] * HD['Daa'][Ds,Dw] ,
                             -HD['HSaaaa'][p,w,T,U] * HD['Daa'][Dq,Ds] ,
                             +HD['HSaaaa'][q,w,T,U] * HD['Daa'][Dp,Ds] ))
    if q==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dp,:] ) ,
                             +HD['HSaaaa'][r,s,T,U] * HD['Daa'][Dp,Dw] ,
                             +HD['HSaaaa'][s,w,T,U] * HD['Daa'][Dp,Dr] ,
                             -HD['HSaaaa'][r,w,T,U] * HD['Daa'][Dp,Ds] ))
        if p==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaaaa'][r,s,T,U] ))
    if p==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             +HD['HSaaaa'][r,s,T,U] * HD['Daa'][Dq,Dv] ,
                             +HD['HSaaaa'][s,v,T,U] * HD['Daa'][Dq,Dr] ,
                             -HD['HSaaaa'][r,v,T,U] * HD['Daa'][Dq,Ds] ))
    if q==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daaaa'][Dr,Dv,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dp,:] ) ,
                             -HD['HSaaaa'][r,s,T,U] * HD['Daa'][Dp,Dv] ,
                             -HD['HSaaaa'][s,v,T,U] * HD['Daa'][Dp,Dr] ,
                             +HD['HSaaaa'][r,v,T,U] * HD['Daa'][Dp,Ds] ))
        if p==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['HSaaaa'][r,s,T,U] ))
    if p==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             -HD['HSaaaa'][r,s,T,U] * HD['Daa'][Dq,Dw] ,
                             -HD['HSaaaa'][s,w,T,U] * HD['Daa'][Dq,Dr] ,
                             +HD['HSaaaa'][r,w,T,U] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_AAAAaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dp,Dq,Dv,Dw,Ds,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][T,p,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dp,Dq,Dv,Dw,Dr,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dp,Du,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][p,T] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['HSaa'][q,T] * HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,Du] ,
                         +HD['HSaa'][s,T] * HD['Daaaaaa'][Dp,Dq,Du,Dr,Dv,Dw] ,
                         -HD['HSaa'][r,T] * HD['Daaaaaa'][Dp,Dq,Du,Ds,Dv,Dw] ,
                         +HD['Daaaaaa'][Dp,Dq,Du,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                         -HD['Daaaaaa'][Dp,Dq,Du,Dr,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaaaa'][Dp,Dq,Du,:,Dr,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaaaa'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dp,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,u,p,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,u,q,actfloor:actceil], HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,u,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,u,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][p,q,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,s,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,Du,Dv,Dw,:] ) ,
                         +HD['HSaaaa'][p,q,u,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         -HD['HSaaaa'][r,s,u,T] * HD['Daaaa'][Dp,Dq,Dv,Dw] ,
                         -HD['Daaaaaa'][Dp,Dq,Du,Dr,Dv,Dw] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaaaa'][Dp,Dq,Du,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabba'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaab'][Dp,Dq,Du,:,Dr,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaab'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaab'][Dr,Ds,Du,:,Dp,Dv,Dw,:] ) ))
    if q==u:
        result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dv,Dw,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dp,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -HD['HSaa'][p,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][p,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][p,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][p,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    if p==u:
        result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][T,p,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dp,:,:] ) ))
        result += 2 * fsum(( -HD['HSaa'][s,T] * HD['Daaaa'][Dp,Dq,Dv,Dw] ,
                             +HD['Daaaa'][Dp,Dq,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,:,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dp,Dq,Dv,Dw] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dp,Dq,:,Dv,Dw,:] ) ))
    if s==u:
        result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][T,p,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dp,:,:] ) ))
        result += 2 * fsum(( +HD['HSaa'][r,T] * HD['Daaaa'][Dp,Dq,Dv,Dw] ,
                             -HD['Daaaa'][Dp,Dq,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,:,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dp,Dq,Dv,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dp,Dq,:,Dv,Dw,:] ) ))
    return result


def lucc_AAAAaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][p,V,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,p,V,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dp,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dp,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,V,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,Du,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,V,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         +HD['HSaaaa'][p,V,u,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         -HD['HSaaaa'][r,V,u,T] * HD['Daaaa'][Dp,Dq,Ds,Dw] ,
                         -HD['HSaaaa'][q,V,u,T] * HD['Daaaa'][Dp,Dw,Dr,Ds] ,
                         +HD['HSaaaa'][s,V,u,T] * HD['Daaaa'][Dp,Dq,Dr,Dw] ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Daaaa'][Dp,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][p,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daaaa'][Dp,Dw,Ds,:] ) ))
    if r==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,p,V,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,V,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Dw,:] ) ))
    if s==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,V,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,p,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] ) ))
    if p==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ))
    return result


def lucc_AAAAaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][T,s,V,W] * HD['Daaaa'][Dp,Dq,Dr,Du] ,
                         -HD['HSaaaa'][T,p,V,W] * HD['Daaaa'][Dq,Du,Dr,Ds] ,
                         +HD['HSaaaa'][T,r,V,W] * HD['Daaaa'][Dp,Dq,Ds,Du] ,
                         +HD['HSaaaa'][T,q,V,W] * HD['Daaaa'][Dp,Du,Dr,Ds] ))
    if r==u:
        result += 2 * fsum(( +HD['HSaaaa'][T,p,V,W] * HD['Daa'][Dq,Ds] ,
                             -HD['HSaaaa'][T,q,V,W] * HD['Daa'][Dp,Ds] ))
    if s==u:
        result += 2 * fsum(( -HD['HSaaaa'][T,p,V,W] * HD['Daa'][Dq,Dr] ,
                             +HD['HSaaaa'][T,q,V,W] * HD['Daa'][Dp,Dr] ))
    if p==u:
        result += 2 * fsum(( -HD['HSaaaa'][T,r,V,W] * HD['Daa'][Dq,Ds] ,
                             +HD['HSaaaa'][T,s,V,W] * HD['Daa'][Dq,Dr] ))
    if q==u:
        result += 2 * fsum(( +HD['HSaaaa'][T,r,V,W] * HD['Daa'][Dp,Ds] ,
                             -HD['HSaaaa'][T,s,V,W] * HD['Daa'][Dp,Dr] ))
    return result


def lucc_AAAAaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,p,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Daaaaaa'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dp,Dq,:] ) ,
                         -HD['HSaaaa'][p,q,T,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         +HD['HSaaaa'][r,s,T,U] * HD['Daaaa'][Dp,Dq,Dv,Dw] ))
    return result


def lucc_AAAAaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][p,V,T,U] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         +HD['HSaaaa'][q,V,T,U] * HD['Daaaa'][Dp,Dw,Dr,Ds] ,
                         -HD['HSaaaa'][s,V,T,U] * HD['Daaaa'][Dp,Dq,Dr,Dw] ,
                         +HD['HSaaaa'][r,V,T,U] * HD['Daaaa'][Dp,Dq,Ds,Dw] ))
    return result


def lucc_AAAAaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dt,Du,Dq,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dt,Du,Dq,Dw,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][t,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][u,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Dt,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][P,t] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['HSaa'][P,u] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Dt] ,
                         +HD['HSaa'][P,w] * HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dv] ,
                         -HD['HSaa'][P,v] * HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dw] ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,w,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,v,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,u,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,t,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,t,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,u,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][t,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][t,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][u,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][t,u,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,w,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,w,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dt,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,v,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dt,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][w,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][u,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,w,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dt,Du,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,t,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,u,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,v,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dt,Du,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dv,:] ) ,
                         -HD['HSaaaa'][t,P,r,s] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                         +HD['HSaaaa'][u,P,r,s] * HD['Daaaa'][Dq,Dt,Dv,Dw] ,
                         -HD['HSaaaa'][w,P,r,s] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                         +HD['HSaaaa'][v,P,r,s] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,w,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,t,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,v,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,u,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ))
    if q==u:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dt,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             -HD['HSaa'][P,t] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['HSaa'][P,s] * HD['Daaaa'][Dr,Dt,Dv,Dw] ,
                             -HD['HSaa'][P,r] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                             +HD['Daaaa'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Daaaa'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,t,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,t,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,t,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Daaaa'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dt,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dr,Dt,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,t,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Dt,:,Dv,Dw,:] ) ))
    if q==t:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSaa'][P,u] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['HSaa'][P,r] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             -HD['HSaa'][P,s] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                             +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,u,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,u,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,u,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,u,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    if q==v:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dw,:,Dt,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             -HD['HSaa'][P,w] * HD['Daaaa'][Dr,Ds,Dt,Du] ,
                             +HD['HSaa'][P,s] * HD['Daaaa'][Dr,Dw,Dt,Du] ,
                             -HD['HSaa'][P,r] * HD['Daaaa'][Ds,Dw,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                             +HD['Daaaa'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Daaaa'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dw,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dw,:,Dt,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,w,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,w,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dr,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                             +HD['Daaaa'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Daaaa'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dw,:,Dt,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Dw,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dr,Dw,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,w,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dt,Du,:] ) ))
    if q==w:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,:,Dt,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             +HD['HSaa'][P,v] * HD['Daaaa'][Dr,Ds,Dt,Du] ,
                             -HD['HSaa'][P,s] * HD['Daaaa'][Dr,Dv,Dt,Du] ,
                             +HD['HSaa'][P,r] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                             -HD['Daaaa'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Daaaa'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,:,Dt,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,v,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,v,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ,
                             -HD['Daaaa'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Daaaa'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dv,:,Dt,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dr,Dv,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,v,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dt,Du,:] ) ))
    if s==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             -HD['HSaa'][P,r] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][w,P,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dw,:] ) ))
        if r==w:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,:,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dt,Du,:,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             -HD['HSaa'][P,s] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             +HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,P,s,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             +HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dt,Du,:,Dq,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dv,:] ) ))
    if s==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +HD['HSaa'][P,r] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,P,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dv,:] ) ))
        if r==v:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,:,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dt,Du,:,Dq,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             +HD['HSaa'][P,s] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             -HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,P,s,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             -HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dt,Du,:,Dq,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dw,:] ) ))
    if s==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][t,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -HD['HSaa'][P,r] * HD['Daaaa'][Dq,Dt,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][t,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Dt,:] ) ))
        if r==t:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,:,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][u,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -HD['HSaa'][P,s] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             +HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][u,P,s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             +HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Du,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][t,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['HSaa'][P,s] * HD['Daaaa'][Dq,Dt,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             -HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][t,P,s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             -HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Dt,:] ) ))
        if s==t:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,:,:] ) ))
    if s==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][u,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             +HD['HSaa'][P,r] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][u,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Du,:] ) ))
    return result


def lucc_CAAAaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,P,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,T,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         +HD['HSaaaa'][w,P,T,r] * HD['Daaaa'][Dq,Dv,Ds,Du] ,
                         -HD['HSaaaa'][v,P,T,r] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         +HD['HSaaaa'][P,T,v,w] * HD['Daaaa'][Dq,Du,Dr,Ds] ,
                         +HD['HSaaaa'][P,T,r,s] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                         -HD['HSaaaa'][P,T,s,w] * HD['Daaaa'][Dq,Du,Dr,Dv] ,
                         +HD['HSaaaa'][P,T,s,v] * HD['Daaaa'][Dq,Du,Dr,Dw] ,
                         -HD['HSaaaa'][w,P,T,s] * HD['Daaaa'][Dq,Dv,Dr,Du] ,
                         +HD['HSaaaa'][v,P,T,s] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                         +HD['HSaaaa'][P,T,r,w] * HD['Daaaa'][Dq,Du,Ds,Dv] ,
                         -HD['HSaaaa'][P,T,r,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dq,Dv,Dw,:,Dr,Du,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][q,w,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][q,v,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -HD['HSaa'][s,w] * HD['Daaaa'][Dq,Dv,Dr,Du] ,
                             +HD['HSaa'][s,v] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                             +HD['HSaa'][r,w] * HD['Daaaa'][Dq,Dv,Ds,Du] ,
                             -HD['HSaa'][r,v] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,v] ) ,
                             -HD['Daaaa'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,w] ) ,
                             +HD['Daaaa'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Dr,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,w,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Ds,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Dr,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,w,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,w,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,w,s,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             +HD['HSaaaa'][r,s,v,w] * HD['Daa'][Dq,Du] ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dq,Dv,Dw,:,Dr,Du,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,v,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Dr,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,w,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Ds,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Ds,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Dr,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,v] ) ,
                             -HD['Daaaa'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,w] ) ))
        if s==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,v,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                                 +HD['HSaa'][r,v] * HD['Daa'][Dq,Du] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Du,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ))
            if r==v:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ))
        if s==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,w,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 -HD['HSaa'][r,w] * HD['Daa'][Dq,Du] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,w] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Du,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,w] ) ))
            if r==w:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ))
        if r==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,:,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,v,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                                 -HD['HSaa'][s,v] * HD['Daa'][Dq,Du] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dv,:,Du,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,v] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Du,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,w,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +HD['HSaa'][s,w] * HD['Daa'][Dq,Du] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Du,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ))
    if s==v:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][w,P,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             -HD['HSaaaa'][w,P,T,r] * HD['Daa'][Dq,Du] ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dq,Dw,:] ) ))
        if r==w:
            result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ))
    if r==w:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dv,Ds,Du] ,
                             -HD['Daaaa'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                             -HD['HSaaaa'][v,P,T,s] * HD['Daa'][Dq,Du] ,
                             -HD['Daaaa'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dv,:] ) ))
    if s==w:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dv,Dr,Du] ,
                             +HD['Daaaa'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             +HD['HSaaaa'][v,P,T,r] * HD['Daa'][Dq,Du] ,
                             +HD['Daaaa'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dq,Dv,:] ) ))
        if r==v:
            result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,P,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +HD['HSaaaa'][w,P,T,s] * HD['Daa'][Dq,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dw,:] ) ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,T,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,T,s,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                             +HD['HSaaaa'][P,T,r,s] * HD['Daa'][Du,Dw] ,
                             -HD['HSaaaa'][P,T,r,w] * HD['Daa'][Ds,Du] ,
                             +HD['HSaaaa'][P,T,s,w] * HD['Daa'][Dr,Du] ))
    if q==w:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,T,s,actfloor:actceil], HD['Daaaa'][Dr,Dv,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             -HD['HSaaaa'][P,T,r,s] * HD['Daa'][Du,Dv] ,
                             +HD['HSaaaa'][P,T,r,v] * HD['Daa'][Ds,Du] ,
                             -HD['HSaaaa'][P,T,s,v] * HD['Daa'][Dr,Du] ))
    return result


def lucc_CAAAaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -HD['HSaaaa'][w,P,T,U] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         +HD['HSaaaa'][v,P,T,U] * HD['Daaaa'][Dq,Dw,Dr,Ds] ))
    if P==U:
        result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,T,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][q,w,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,T,w,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,T,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,T,w,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             -HD['HSaaaa'][r,T,v,w] * HD['Daa'][Dq,Ds] ,
                             +HD['HSaaaa'][s,T,v,w] * HD['Daa'][Dq,Dr] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
        if s==v:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Daa'][Dr,Dw] ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,T,w,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,w,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dr,:,Dw,:] ) ))
            if r==w:
                result += 2 * fsum(( -HD['HSaa'][q,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dv,:,:] )
            result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Daa'][Ds,Dv] ,
                                 +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,T,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
        if s==w:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][r,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dv,:,:] )
            result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Daa'][Dr,Dv] ,
                                 -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,T,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
            if r==v:
                result += 2 * fsum(( +HD['HSaa'][q,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,T,w,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,w,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][s,U,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][r,U,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( +HD['HSaa'][q,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,U,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][q,w,U,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][q,v,U,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,U,w,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,U,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,U,w,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             +HD['HSaaaa'][r,U,v,w] * HD['Daa'][Dq,Ds] ,
                             -HD['HSaaaa'][s,U,v,w] * HD['Daa'][Dq,Dr] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
        if s==v:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][r,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * fsum(( -HD['HSaa'][q,U] * HD['Daa'][Dr,Dw] ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daaaa'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,w,U,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,U,w,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dabab'][Dr,:,Dw,:] ) ))
            if r==w:
                result += 2 * fsum(( +HD['HSaa'][q,U] ,
                                     +einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][s,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dv,:,:] )
            result += 2 * fsum(( -HD['HSaa'][q,U] * HD['Daa'][Ds,Dv] ,
                                 -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,v,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,U,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
        if s==w:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][r,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dv,:,:] )
            result += 2 * fsum(( +HD['HSaa'][q,U] * HD['Daa'][Dr,Dv] ,
                                 +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,v,U,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,U,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
            if r==v:
                result += 2 * fsum(( -HD['HSaa'][q,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][s,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * fsum(( +HD['HSaa'][q,U] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,U,w,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,w,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             -HD['HSaaaa'][w,P,T,U] * HD['Daa'][Dq,Dr] ))
        if r==w:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daa'][Dq,:] )
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             -HD['HSaaaa'][v,P,T,U] * HD['Daa'][Dq,Ds] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             +HD['HSaaaa'][v,P,T,U] * HD['Daa'][Dq,Dr] ))
        if r==v:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daa'][Dq,:] )
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +HD['HSaaaa'][w,P,T,U] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_CAAAaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,T], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,u,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,s,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,r,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         -HD['HSaaaa'][T,P,r,s] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,actfloor:actceil,T], HD['Daaabaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ))
    if q==u:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,s,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,r,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,P,s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] )
    if s==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] )
    return result


def lucc_CAAAaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSaaaa'][P,V,r,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         +HD['HSaaaa'][P,V,u,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         -HD['HSaaaa'][T,P,V,s] * HD['Daaaa'][Dq,Du,Dr,Dw] ,
                         -HD['HSaaaa'][P,V,s,T] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                         +HD['HSaaaa'][T,P,V,r] * HD['Daaaa'][Dq,Du,Ds,Dw] ))
    if P==V:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -HD['HSaa'][s,T] * HD['Daaaa'][Dq,Du,Dr,Dw] ,
                             +HD['HSaa'][r,T] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                             +HD['Daaaa'][Dq,Du,Dr,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dq,Du,:,Dr,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dq,Du,:,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,u,s,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,u,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Dw,:] ) ,
                             +HD['HSaaaa'][r,s,u,T] * HD['Daa'][Dq,Dw] ,
                             +HD['Daaaa'][Dq,Du,Dr,Dw] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dq,Du,:,Dr,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dq,Du,:,Ds,Dw,:] ) ))
        if r==u:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dw,:,:] )
            result += 2 * fsum(( +HD['HSaa'][s,T] * HD['Daa'][Dq,Dw] ,
                                 -HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dq,:,Dw,:] ) ,
                                 -HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dq,:,Dw,:] ) ))
        if s==u:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dw,:,:] )
            result += 2 * fsum(( -HD['HSaa'][r,T] * HD['Daa'][Dq,Dw] ,
                                 +HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dq,:,Dw,:] ) ,
                                 +HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dq,:,Dw,:] ) ))
    if r==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             +HD['HSaaaa'][T,P,V,s] * HD['Daa'][Dq,Dw] ))
    if s==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] ) ,
                             -HD['HSaaaa'][T,P,V,r] * HD['Daa'][Dq,Dw] ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             +HD['HSaaaa'][P,V,s,T] * HD['Daa'][Dr,Dw] ,
                             -HD['HSaaaa'][P,V,r,T] * HD['Daa'][Ds,Dw] ))
    return result


def lucc_CAAAaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][T,P,V,W] * HD['Daaaa'][Dq,Du,Dr,Ds]
    if P==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,V,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,V,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             +HD['HSaaaa'][s,V,u,T] * HD['Daa'][Dq,Dr] ,
                             -HD['HSaaaa'][r,V,u,T] * HD['Daa'][Dq,Ds] ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][s,V,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Daa'][Ds,:] ) ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][r,V,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Daa'][Dr,:] ) ))
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,q,W,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,W,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,W,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             -HD['HSaaaa'][s,W,u,T] * HD['Daa'][Dq,Dr] ,
                             +HD['HSaaaa'][r,W,u,T] * HD['Daa'][Dq,Ds] ))
        if s==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][r,W,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,q,W,actfloor:actceil], HD['Daa'][Dr,:] ) ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,q,W,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,W,actfloor:actceil,T], HD['Daa'][Dq,:] ) ))
    if r==u:
        result += 2 * +HD['HSaaaa'][T,P,V,W] * HD['Daa'][Dq,Ds]
    if s==u:
        result += 2 * -HD['HSaaaa'][T,P,V,W] * HD['Daa'][Dq,Dr]
    return result


def lucc_CAAAaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,U,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] )
    return result


def lucc_CAAAaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,V,T,U] * HD['Daaaa'][Dq,Dw,Dr,Ds]
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             -HD['HSaaaa'][r,s,T,U] * HD['Daa'][Dq,Dw] ))
    return result


def lucc_CAAAaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==W:
        result += 2 * fsum(( -HD['HSaaaa'][s,V,T,U] * HD['Daa'][Dq,Dr] ,
                             +HD['HSaaaa'][r,V,T,U] * HD['Daa'][Dq,Ds] ))
    if P==V:
        result += 2 * fsum(( +HD['HSaaaa'][s,W,T,U] * HD['Daa'][Dq,Dr] ,
                             -HD['HSaaaa'][r,W,T,U] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_CCAAaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,t,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,Q,u,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,Q,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,Q,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                         +HD['HSaaaa'][P,Q,t,u] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         -HD['HSaaaa'][P,Q,r,t] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         +HD['HSaaaa'][P,Q,r,u] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                         -HD['HSaaaa'][P,Q,v,w] * HD['Daaaa'][Dr,Ds,Dt,Du] ,
                         +HD['HSaaaa'][P,Q,s,w] * HD['Daaaa'][Dr,Dv,Dt,Du] ,
                         -HD['HSaaaa'][P,Q,s,v] * HD['Daaaa'][Dr,Dw,Dt,Du] ,
                         +HD['HSaaaa'][P,Q,s,t] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         -HD['HSaaaa'][P,Q,s,u] * HD['Daaaa'][Dr,Dt,Dv,Dw] ,
                         -HD['HSaaaa'][P,Q,r,w] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                         +HD['HSaaaa'][P,Q,r,v] * HD['Daaaa'][Ds,Dw,Dt,Du] ))
    if s==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dw,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] )
        if r==w:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] )
    if r==w:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dv,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,s,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] )
    if s==w:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dv,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] )
        if r==v:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] )
    if r==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dw,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,s,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] )
    if s==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dt,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] )
        if r==t:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    if r==t:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Du,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] )
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dt,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] )
        if s==t:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    if s==t:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] )
    return result


def lucc_CCAAaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +HD['HSaaaa'][P,Q,T,r] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         -HD['HSaaaa'][P,Q,T,s] * HD['Daaaa'][Dr,Du,Dv,Dw] ))
    if Q==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['HSaa'][P,s] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                             +HD['HSaa'][P,r] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][w,P,s,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,P,s,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,P,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,P,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +HD['HSaaaa'][w,P,r,s] * HD['Daa'][Du,Dv] ,
                             -HD['HSaaaa'][v,P,r,s] * HD['Daa'][Du,Dw] ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
        if s==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 +HD['HSaa'][P,r] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,P,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
            if r==w:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ))
        if r==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 +HD['HSaa'][P,s] * HD['Daa'][Du,Dv] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,P,s,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
        if s==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][v,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 -HD['HSaa'][P,r] * HD['Daa'][Du,Dv] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,P,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
            if r==v:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ))
        if r==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['HSaa'][P,s] * HD['Daa'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][w,P,s,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][w,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][v,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSaa'][Q,s] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                             -HD['HSaa'][Q,r] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                             +HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,Q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,Q,s,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,Q,s,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][w,Q,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,Q,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             -HD['HSaaaa'][w,Q,r,s] * HD['Daa'][Du,Dv] ,
                             +HD['HSaaaa'][v,Q,r,s] * HD['Daa'][Du,Dw] ,
                             -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,r] ) ,
                             -HD['Daaaa'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
        if s==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][w,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 -HD['HSaa'][Q,r] * HD['Daa'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][w,Q,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
            if r==w:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ))
        if r==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][v,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 -HD['HSaa'][Q,s] * HD['Daa'][Du,Dv] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,Q,s,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
        if s==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][v,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 +HD['HSaa'][Q,r] * HD['Daa'][Du,Dv] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,Q,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                                 -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dv,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
            if r==v:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][w,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['HSaa'][Q,s] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,Q,s,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                             +HD['HSaaaa'][P,Q,T,r] * HD['Daa'][Du,Dw] ))
        if r==w:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daa'][Du,:] )
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                             +HD['HSaaaa'][P,Q,T,s] * HD['Daa'][Du,Dv] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                             -HD['HSaaaa'][P,Q,T,r] * HD['Daa'][Du,Dv] ))
        if r==v:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daa'][Du,:] )
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             -HD['HSaaaa'][P,Q,T,s] * HD['Daa'][Du,Dw] ))
    return result


def lucc_CCAAaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,Q,T,U] * HD['Daaaa'][Dr,Ds,Dv,Dw]
    if Q==U:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,T,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,P,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +HD['HSaaaa'][v,P,T,s] * HD['Daa'][Dr,Dw] ,
                             +HD['HSaaaa'][w,P,T,r] * HD['Daa'][Ds,Dv] ,
                             -HD['HSaaaa'][v,P,T,r] * HD['Daa'][Ds,Dw] ,
                             -HD['HSaaaa'][w,P,T,s] * HD['Daa'][Dr,Dv] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
        if P==T:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dr,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -HD['HSaa'][s,w] * HD['Daa'][Dr,Dv] ,
                                 +HD['HSaa'][s,v] * HD['Daa'][Dr,Dw] ,
                                 +HD['HSaa'][r,w] * HD['Daa'][Ds,Dv] ,
                                 -HD['HSaa'][r,v] * HD['Daa'][Ds,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,v] ) ,
                                 -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,w] ) ,
                                 +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dv,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dv,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,s,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,w,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,w,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,s,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +HD['HSaaaa'][r,s,v,w] ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dr,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dv,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dv,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ,
                                 -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,w] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,v] ) ))
            if s==v:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -HD['HSaa'][r,w] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,w] ) ))
            if r==v:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +HD['HSaa'][s,w] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ))
            if r==w:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -HD['HSaa'][s,v] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,v] ) ))
            if s==w:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +HD['HSaa'][r,v] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ))
        if r==w:
            result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Ds,Dv] ,
                                 -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,T,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 -HD['HSaaaa'][v,P,T,s] ,
                                 -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
            if s==v:
                result += 2 * fsum(( +HD['HSaa'][P,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==v:
            result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Dr,Dw] ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][w,P,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['HSaaaa'][w,P,T,r] ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Dr,:,Dw,:] ) ))
        if s==w:
            result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dr,Dv] ,
                                 +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,P,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,T,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +HD['HSaaaa'][v,P,T,r] ,
                                 +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
            if r==v:
                result += 2 * fsum(( -HD['HSaa'][P,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,T,P,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,P,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSaaaa'][w,P,T,s] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
    if Q==T:
        result += 2 * fsum(( -HD['HSaa'][P,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,U,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,U,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,P,U,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,U,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][w,P,U,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,U,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             -HD['HSaaaa'][v,P,U,s] * HD['Daa'][Dr,Dw] ,
                             -HD['HSaaaa'][w,P,U,r] * HD['Daa'][Ds,Dv] ,
                             +HD['HSaaaa'][v,P,U,r] * HD['Daa'][Ds,Dw] ,
                             +HD['HSaaaa'][w,P,U,s] * HD['Daa'][Dr,Dv] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,U,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,U,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
        if P==U:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Ds,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +HD['HSaa'][s,w] * HD['Daa'][Dr,Dv] ,
                                 -HD['HSaa'][s,v] * HD['Daa'][Dr,Dw] ,
                                 -HD['HSaa'][r,w] * HD['Daa'][Ds,Dv] ,
                                 +HD['HSaa'][r,v] * HD['Daa'][Ds,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,v] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                                 +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,w] ) ,
                                 -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dv,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dv,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,w,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,w,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,s,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,s,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSaaaa'][r,s,v,w] ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dr,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dv,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dv,:,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ,
                                 +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,w] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,v] ) ))
            if s==v:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +HD['HSaa'][r,w] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,w] ) ))
            if r==v:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -HD['HSaa'][s,w] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ))
            if r==w:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +HD['HSaa'][s,v] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,v] ) ))
            if s==w:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -HD['HSaa'][r,v] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,v] ) ))
        if s==v:
            result += 2 * fsum(( +HD['HSaa'][P,U] * HD['Daa'][Dr,Dw] ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,U,actfloor:actceil], HD['Daaaa'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,U,P,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,P,U,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['HSaaaa'][w,P,U,r] ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dabab'][Dr,:,Dw,:] ) ))
            if r==w:
                result += 2 * fsum(( -HD['HSaa'][P,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][P,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][P,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += 2 * fsum(( +HD['HSaa'][P,U] * HD['Daa'][Ds,Dv] ,
                                 +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,U,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,P,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,U,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +HD['HSaaaa'][v,P,U,s] ,
                                 +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
        if s==w:
            result += 2 * fsum(( -HD['HSaa'][P,U] * HD['Daa'][Dr,Dv] ,
                                 -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,U,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,P,U,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,U,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 -HD['HSaaaa'][v,P,U,r] ,
                                 -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
            if r==v:
                result += 2 * fsum(( +HD['HSaa'][P,U] ,
                                     +einsum( 'II->', HD['HSaaaa'][P,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][P,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( -HD['HSaa'][P,U] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,U,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,U,P,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][w,P,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaaaa'][w,P,U,s] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
    if P==U:
        result += 2 * fsum(( -HD['HSaa'][Q,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,T,Q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][w,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,T,Q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             -HD['HSaaaa'][v,Q,T,s] * HD['Daa'][Dr,Dw] ,
                             -HD['HSaaaa'][w,Q,T,r] * HD['Daa'][Ds,Dv] ,
                             +HD['HSaaaa'][v,Q,T,r] * HD['Daa'][Ds,Dw] ,
                             +HD['HSaaaa'][w,Q,T,s] * HD['Daa'][Dr,Dv] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
        if s==w:
            result += 2 * fsum(( -HD['HSaa'][Q,T] * HD['Daa'][Dr,Dv] ,
                                 -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,Q,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,T,Q,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 -HD['HSaaaa'][v,Q,T,r] ,
                                 -HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][Q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
            if r==v:
                result += 2 * fsum(( +HD['HSaa'][Q,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][Q,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][Q,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( -HD['HSaa'][Q,T] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][w,Q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,T,Q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSaaaa'][w,Q,T,s] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
        if s==v:
            result += 2 * fsum(( +HD['HSaa'][Q,T] * HD['Daa'][Dr,Dw] ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daaaa'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,T,Q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,Q,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['HSaaaa'][w,Q,T,r] ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dabab'][Dr,:,Dw,:] ) ))
            if r==w:
                result += 2 * fsum(( -HD['HSaa'][Q,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][Q,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += 2 * fsum(( +HD['HSaa'][Q,T] * HD['Daa'][Ds,Dv] ,
                                 +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,Q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,T,Q,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +HD['HSaaaa'][v,Q,T,s] ,
                                 +HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][Q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    if P==T:
        result += 2 * fsum(( +HD['HSaa'][Q,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,Q,U,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,Q,U,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,U,Q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,U,Q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                             +HD['HSaaaa'][v,Q,U,s] * HD['Daa'][Dr,Dw] ,
                             +HD['HSaaaa'][w,Q,U,r] * HD['Daa'][Ds,Dv] ,
                             -HD['HSaaaa'][v,Q,U,r] * HD['Daa'][Ds,Dw] ,
                             -HD['HSaaaa'][w,Q,U,s] * HD['Daa'][Dr,Dv] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
        if s==w:
            result += 2 * fsum(( +HD['HSaa'][Q,U] * HD['Daa'][Dr,Dv] ,
                                 +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daaaa'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,Q,U,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,U,Q,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +HD['HSaaaa'][v,Q,U,r] ,
                                 +HD['Daa'][Dr,Dv] * einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dabab'][Dr,:,Dv,:] ) ))
            if r==v:
                result += 2 * fsum(( -HD['HSaa'][Q,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( +HD['HSaa'][Q,U] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,Q,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,U,Q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['HSaaaa'][w,Q,U,s] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
        if s==v:
            result += 2 * fsum(( -HD['HSaa'][Q,U] * HD['Daa'][Dr,Dw] ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daaaa'][Dr,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,U,Q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][w,Q,U,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['HSaaaa'][w,Q,U,r] ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dabab'][Dr,:,Dw,:] ) ))
            if r==w:
                result += 2 * fsum(( +HD['HSaa'][Q,U] ,
                                     +einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += 2 * fsum(( -HD['HSaa'][Q,U] * HD['Daa'][Ds,Dv] ,
                                 -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,U,Q,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,Q,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaaaa'][v,Q,U,s] ,
                                 -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    if r==w:
        result += 2 * +HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Ds,Dv]
        if s==v:
            result += 2 * -HD['HSaaaa'][P,Q,T,U]
    if s==v:
        result += 2 * +HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Dr,Dw]
    if s==w:
        result += 2 * -HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Dr,Dv]
        if r==v:
            result += 2 * +HD['HSaaaa'][P,Q,T,U]
    if r==v:
        result += 2 * -HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Ds,Dw]
    return result


def lucc_CCAAaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -HD['HSaaaa'][P,Q,u,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         +HD['HSaaaa'][P,Q,s,T] * HD['Daaaa'][Dr,Du,Dv,Dw] ,
                         -HD['HSaaaa'][P,Q,r,T] * HD['Daaaa'][Ds,Du,Dv,Dw] ))
    return result


def lucc_CCAAaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==V:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,P,s,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,P,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                             +HD['HSaaaa'][T,P,r,s] * HD['Daa'][Du,Dw] ))
        if r==u:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,P,s,actfloor:actceil], HD['Daa'][Dw,:] )
        if s==u:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][T,P,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,P,r,actfloor:actceil], HD['Daa'][Dw,:] )
    if P==V:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][T,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,Q,s,actfloor:actceil], HD['Daaaa'][Dr,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,Q,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                             -HD['HSaaaa'][T,Q,r,s] * HD['Daa'][Du,Dw] ))
        if r==u:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][T,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,Q,s,actfloor:actceil], HD['Daa'][Dw,:] )
        if s==u:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][T,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dr,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,Q,r,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_CCAAaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    if Q==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,P,W,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             -HD['HSaaaa'][T,P,W,r] * HD['Daa'][Ds,Du] ,
                             +HD['HSaaaa'][T,P,W,s] * HD['Daa'][Dr,Du] ))
        if P==W:
            result += 2 * fsum(( +HD['HSaa'][s,T] * HD['Daa'][Dr,Du] ,
                                 -HD['HSaa'][r,T] * HD['Daa'][Ds,Du] ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                                 -HD['Daa'][Dr,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,s,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,u,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][T,u,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaaaa'][r,s,u,T] ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                                 -HD['Daa'][Dr,Du] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Ds,:] ) ))
            if r==u:
                result += 2 * fsum(( -HD['HSaa'][s,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if s==u:
                result += 2 * fsum(( +HD['HSaa'][r,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if r==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,P,W,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaaaa'][T,P,W,s] ))
        if s==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,P,W,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['HSaaaa'][T,P,W,r] ))
    if P==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,Q,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +HD['HSaaaa'][T,Q,V,s] * HD['Daa'][Dr,Du] ,
                             -HD['HSaaaa'][T,Q,V,r] * HD['Daa'][Ds,Du] ))
        if s==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,Q,V,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['HSaaaa'][T,Q,V,r] ))
        if r==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,Q,V,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaaaa'][T,Q,V,s] ))
    if Q==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +HD['HSaaaa'][T,P,V,r] * HD['Daa'][Ds,Du] ,
                             -HD['HSaaaa'][T,P,V,s] * HD['Daa'][Dr,Du] ))
        if P==V:
            result += 2 * fsum(( -HD['HSaa'][s,T] * HD['Daa'][Dr,Du] ,
                                 +HD['HSaa'][r,T] * HD['Daa'][Ds,Du] ,
                                 -HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                                 +HD['Daa'][Dr,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,s,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][T,u,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,u,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSaaaa'][r,s,u,T] ,
                                 -HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                                 +HD['Daa'][Dr,Du] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Ds,:] ) ))
            if r==u:
                result += 2 * fsum(( +HD['HSaa'][s,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if s==u:
                result += 2 * fsum(( -HD['HSaa'][r,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][r,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][r,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSaaaa'][T,P,V,s] ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,P,V,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['HSaaaa'][T,P,V,r] ))
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,Q,W,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +HD['HSaaaa'][T,Q,W,r] * HD['Daa'][Ds,Du] ,
                             -HD['HSaaaa'][T,Q,W,s] * HD['Daa'][Dr,Du] ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,Q,W,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['HSaaaa'][T,Q,W,r] ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,Q,W,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSaaaa'][T,Q,W,s] ))
    return result


def lucc_CCAAaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,Q,T,U] * HD['Daaaa'][Dr,Ds,Dv,Dw]
    return result


def lucc_CCAAaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==V:
        if P==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSaaaa'][r,s,T,U] ))
    if Q==W:
        if P==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,U,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaaaa'][r,s,T,U] ))
    return result


def lucc_VAAAaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][P,w,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dt,Du,Dq,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][P,v,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dt,Du,Dq,Dw,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][P,t,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][P,u,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Dt,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][P,t] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['HSaa'][P,u] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Dt] ,
                         +HD['HSaa'][P,w] * HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dv] ,
                         -HD['HSaa'][P,v] * HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dw] ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,t,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,q,t,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,q,u,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,q,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,q,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][t,u,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][v,w,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,:] ) ,
                         -HD['HSaaaa'][P,q,t,u] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         +HD['HSaaaa'][P,q,v,w] * HD['Daaaa'][Dr,Ds,Dt,Du] ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,t,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Daaaaaa'][Dq,Dt,Du,Dr,Ds,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
    if s==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,w,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dw,:] ) ))
        if r==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ))
    if r==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dt,Du,:,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,v,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dt,Du,:,Dq,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ))
    if s==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,v,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dv,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dq,Dv,:] ) ))
        if r==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dt,Du,:,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,w,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dt,Du,:,Dq,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ))
    if s==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,t,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Dt,:] ) ))
        if r==t:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,u,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Du,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,t,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dt,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ))
        if s==t:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ))
    if s==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,u,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,Du,:] ) ))
    if q==u:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dt,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             -HD['HSaa'][P,t] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,t] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,t,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dt,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,t,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,t] ) ))
    if q==t:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSaa'][P,u] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ))
    if q==v:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dw,:,Dt,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             -HD['HSaa'][P,w] * HD['Daaaa'][Dr,Ds,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dt,Du,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dw,:,Dt,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dt,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ))
    if q==w:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,:,Dt,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             +HD['HSaa'][P,v] * HD['Daaaa'][Dr,Ds,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dt,Du,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Dv,:,Dt,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dt,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
    return result


def lucc_VAAAaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,w,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,v,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSaaaa'][P,T,v,w] * HD['Daaaa'][Dq,Du,Dr,Ds] ,
                         +HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ))
    if s==v:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,w,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dq,Dw,:] ) ))
        if r==w:
            result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ))
    if r==w:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dv,Ds,Du] ,
                             -HD['Daaaa'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,v,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             -HD['Daaaa'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dv,:] ) ))
    if s==w:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dv,Dr,Du] ,
                             +HD['Daaaa'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,v,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             +HD['Daaaa'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dr,Du,:,Dq,Dv,:] ) ))
        if r==v:
            result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,w,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dw,:] ) ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] )
    if q==w:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] )
    return result


def lucc_VAAAaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +HD['HSaaaa'][P,q,T,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         +HD['HSaaaa'][P,w,T,U] * HD['Daaaa'][Dq,Dv,Dr,Ds] ,
                         -HD['HSaaaa'][P,v,T,U] * HD['Daaaa'][Dq,Dw,Dr,Ds] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             +HD['HSaaaa'][P,w,T,U] * HD['Daa'][Dq,Dr] ,
                             -HD['HSaaaa'][P,q,T,U] * HD['Daa'][Dr,Dw] ))
        if r==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][P,q,T,U] ))
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                             +HD['HSaaaa'][P,v,T,U] * HD['Daa'][Dq,Ds] ,
                             -HD['HSaaaa'][P,q,T,U] * HD['Daa'][Ds,Dv] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Dr,:] ) ,
                             +HD['HSaaaa'][P,q,T,U] * HD['Daa'][Dr,Dv] ,
                             -HD['HSaaaa'][P,v,T,U] * HD['Daa'][Dq,Dr] ))
        if r==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][P,q,T,U] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -HD['HSaaaa'][P,w,T,U] * HD['Daa'][Dq,Ds] ,
                             +HD['HSaaaa'][P,q,T,U] * HD['Daa'][Ds,Dw] ))
    return result


def lucc_VAAAaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Dv,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,q,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,u,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +HD['HSaaaa'][P,q,u,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         -HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dq,Dv,Dw,:,Dr,Du,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][s,u,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][r,u,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -HD['HSaa'][q,u] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,u,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dq,Dv,Dw,:,Dr,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,u,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,u] ) ))
        if q==u:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Ds,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dr,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dr,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ))
    if q==u:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] )
    if s==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dq,:,:] )
    return result


def lucc_VAAAaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,V,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +HD['HSaaaa'][P,V,u,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ))
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][q,V,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dw,:,:] )
        result += 2 * fsum(( -HD['HSaa'][s,V] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                             +HD['HSaa'][r,V] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,V,:actfloor] ) ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Ds,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Dr,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][q,V,u,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,u,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,u,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -HD['Daaaa'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSabab'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Dr,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,V,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Ds,Du,:] ) ))
        if q==u:
            result += 2 * fsum(( +HD['HSaa'][s,V] * HD['Daa'][Dr,Dw] ,
                                 -HD['HSaa'][r,V] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,s,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Dr,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] )
    if r==u:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,T,V,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,T,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] )
    return result


def lucc_VAAAaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,T,V,W] * HD['Daaaa'][Dq,Du,Dr,Ds]
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][V,W,s,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][V,W,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +HD['HSaaaa'][r,s,V,W] * HD['Daa'][Dq,Du] ,
                             +HD['HSaaaa'][s,u,V,W] * HD['Daa'][Dq,Dr] ,
                             -HD['HSaaaa'][r,u,V,W] * HD['Daa'][Dq,Ds] ))
        if q==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][V,W,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][V,W,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['HSaaaa'][r,s,V,W] ))
    if r==u:
        result += 2 * -HD['HSaaaa'][P,T,V,W] * HD['Daa'][Dq,Ds]
    if s==u:
        result += 2 * +HD['HSaaaa'][P,T,V,W] * HD['Daa'][Dq,Dr]
    return result


def lucc_VAAAaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -HD['HSaaaa'][P,q,T,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ))
    if P==U:
        result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][T,r,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][U,s,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][U,r,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -HD['HSaa'][q,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,U] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,U], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,U] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,U], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    return result


def lucc_VAAAaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,V,T,U] * HD['Daaaa'][Dq,Dw,Dr,Ds]
    if P==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,r,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,U], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][U,s,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][U,r,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ))
    return result


def lucc_VAAAaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -HD['HSaaaa'][U,s,V,W] * HD['Daa'][Dq,Dr] ,
                             +HD['HSaaaa'][U,r,V,W] * HD['Daa'][Dq,Ds] ))
    if P==U:
        result += 2 * fsum(( +HD['HSaaaa'][T,s,V,W] * HD['Daa'][Dq,Dr] ,
                             -HD['HSaaaa'][T,r,V,W] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_VACAaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][w,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dt,Du,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][v,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dt,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,t,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,u,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][t,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,w,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,v,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                         -HD['HSaaaa'][P,q,R,t] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         +HD['HSaaaa'][P,q,R,u] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                         -HD['HSaaaa'][P,q,R,w] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                         +HD['HSaaaa'][P,q,R,v] * HD['Daaaa'][Ds,Dw,Dt,Du] ))
    if s==w:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                             -HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,v,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             -HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dv,:] ) ))
    if s==v:
        result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                             +HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,w,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dw,:] ) ))
    if s==t:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,u,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Du,:] ) ))
    if s==u:
        result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Daaaa'][Dq,Dt,Dv,Dw] ,
                             +HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,t,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             +HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Dt,:] ) ))
    if q==t:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
    if q==u:
        result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                             +HD['Daaaa'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][t,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +HD['Daaaa'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Dt,:,Dv,Dw,:] ) ))
    if q==w:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                             -HD['Daaaa'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Dt,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,R,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Ds,:] ) ,
                             -HD['Daaaa'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Dt,Du,:] ) ))
    if q==v:
        result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Daaaa'][Ds,Dw,Dt,Du] ,
                             +HD['Daaaa'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dw,:,Dt,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][w,R,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Ds,:] ) ,
                             +HD['Daaaa'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Dw,:,Dt,Du,:] ) ))
    return result


def lucc_VACAaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][R,T,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         +HD['HSaaaa'][P,T,R,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                         -HD['HSaaaa'][P,q,R,T] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         -HD['HSaaaa'][P,w,R,T] * HD['Daaaa'][Dq,Dv,Ds,Du] ,
                         +HD['HSaaaa'][P,v,R,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         -HD['HSaaaa'][P,T,R,w] * HD['Daaaa'][Dq,Du,Ds,Dv] ))
    if R==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Du,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -HD['HSaa'][P,w] * HD['Daaaa'][Dq,Du,Ds,Dv] ,
                             +HD['HSaa'][P,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             +HD['Daaaa'][Dq,Du,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaa'][Ds,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,w,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,v,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,w,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             -HD['HSaaaa'][P,q,v,w] * HD['Daa'][Ds,Du] ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Daabaab'][Ds,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ,
                             +HD['Daaaa'][Dq,Du,Ds,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ))
        if q==v:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dw,:,Du,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                                 +HD['HSaa'][P,w] * HD['Daa'][Ds,Du] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                                 -HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Ds,:,Du,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Dw,:,Du,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Ds,:,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                                 -HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ))
        if q==w:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Du,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ,
                                 -HD['HSaa'][P,v] * HD['Daa'][Ds,Du] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Ds,:,Du,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Du,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Ds,:,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
    if q==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                             +HD['HSaaaa'][P,T,R,w] * HD['Daa'][Ds,Du] ))
    if q==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ,
                             -HD['HSaaaa'][P,T,R,v] * HD['Daa'][Ds,Du] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][R,T,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                             -HD['HSaaaa'][P,v,R,T] * HD['Daa'][Dq,Du] ,
                             +HD['HSaaaa'][P,q,R,T] * HD['Daa'][Du,Dv] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][R,T,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +HD['HSaaaa'][P,w,R,T] * HD['Daa'][Dq,Du] ,
                             -HD['HSaaaa'][P,q,R,T] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VACAaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,U,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,U,v,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,U,w,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             -HD['HSaaaa'][P,U,v,w] * HD['Daa'][Dq,Ds] ))
        if q==w:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][P,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dv,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,U,v,actfloor:actceil], HD['Daa'][Ds,:] )
        if q==v:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][P,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,U,w,actfloor:actceil], HD['Daa'][Ds,:] )
    if R==U:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                             +HD['HSaaaa'][P,T,v,w] * HD['Daa'][Dq,Ds] ))
        if q==w:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dv,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,T,v,actfloor:actceil], HD['Daa'][Ds,:] )
        if q==v:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][P,T,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,T,w,actfloor:actceil], HD['Daa'][Ds,:] )
    return result


def lucc_VACAaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -HD['HSaaaa'][P,q,R,T] * HD['Daaaa'][Ds,Du,Dv,Dw] ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][u,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             +HD['HSaa'][q,R] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             +HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][u,R,q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ))
        if q==u:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Ds,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Ds,:,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] )
    if s==u:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] )
    return result


def lucc_VACAaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][P,T,R,V] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                         -HD['HSaaaa'][P,V,R,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ))
    if R==V:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,actfloor:actceil,T], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][T,u,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -HD['HSaaaa'][P,q,u,T] * HD['Daa'][Ds,Dw] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Ds,Du,:,Dq,Dw,:] ) ))
        if P==T:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,u,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +HD['HSaa'][q,u] * HD['Daa'][Ds,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,u] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,u,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Du,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,u,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,u] ) ))
            if q==u:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ))
        if q==u:
            result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Ds,:,Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( +HD['HSaa'][R,V] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][u,R,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][q,V,R,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +HD['HSaaaa'][q,V,R,u] * HD['Daa'][Ds,Dw] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Ds,Du,:] ) ))
        if q==u:
            result += 2 * fsum(( -HD['HSaa'][R,V] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ))
    if q==u:
        result += 2 * +HD['HSaaaa'][P,V,R,T] * HD['Daa'][Ds,Dw]
    if s==u:
        result += 2 * +HD['HSaaaa'][P,T,R,V] * HD['Daa'][Dq,Dw]
    return result


def lucc_VACAaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][V,W,R,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +HD['HSaaaa'][u,R,V,W] * HD['Daa'][Dq,Ds] ))
        if R==W:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][q,V,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] )
            result += 2 * fsum(( -HD['HSaa'][s,V] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,V,u,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,u,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if q==u:
                result += 2 * fsum(( +HD['HSaa'][s,V] ,
                                     +einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][q,W,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] )
            result += 2 * fsum(( +HD['HSaa'][s,W] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,W,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,W,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,W,u,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,u,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][s,:actfloor,W,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,W,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if q==u:
                result += 2 * fsum(( -HD['HSaa'][s,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][V,W,R,actfloor:actceil], HD['Daa'][Ds,:] )
    if R==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +HD['HSaaaa'][P,V,u,T] * HD['Daa'][Dq,Ds] ))
        if q==u:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daa'][Ds,:] )
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,W,actfloor:actceil,T], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             -HD['HSaaaa'][P,W,u,T] * HD['Daa'][Dq,Ds] ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,W,actfloor:actceil,T], HD['Daa'][Ds,:] )
    return result


def lucc_VACAaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==U:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][T,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,R,q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] )
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][U,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][U,R,q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] )
    return result


def lucc_VACAaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +HD['HSaaaa'][P,q,T,U] * HD['Daa'][Ds,Dw] ))
        if P==U:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Ds,:,Dw,:] ) ))
        if P==T:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][U,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * fsum(( +HD['HSaa'][q,U] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,U], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,U], HD['Dabab'][Ds,:,Dw,:] ) ))
    if P==U:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,R,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -HD['HSaaaa'][q,V,R,T] * HD['Daa'][Ds,Dw] ))
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][U,R,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +HD['HSaaaa'][q,V,R,U] * HD['Daa'][Ds,Dw] ))
    return result


def lucc_VACAaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    if R==W:
        result += 2 * -HD['HSaaaa'][P,V,T,U] * HD['Daa'][Dq,Ds]
        if P==U:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,T], HD['Daa'][Ds,:] ) ))
        if P==T:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,U], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][U,s,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if R==V:
        result += 2 * +HD['HSaaaa'][P,W,T,U] * HD['Daa'][Dq,Ds]
        if P==U:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,s,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,W,actfloor:actceil,T], HD['Daa'][Ds,:] ) ))
        if P==T:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][q,W,actfloor:actceil,U], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][U,s,W,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if P==U:
        result += 2 * -HD['HSaaaa'][T,R,V,W] * HD['Daa'][Dq,Ds]
    if P==T:
        result += 2 * +HD['HSaaaa'][U,R,V,W] * HD['Daa'][Dq,Ds]
    return result


def lucc_VACCaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSaaaa'][P,w,R,S] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                         -HD['HSaaaa'][P,v,R,S] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                         +HD['HSaaaa'][P,t,R,S] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                         -HD['HSaaaa'][P,u,R,S] * HD['Daaaa'][Dq,Dt,Dv,Dw] ))
    if q==t:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] )
    if q==u:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Dt,:] )
    if q==w:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dv,:] )
    if q==v:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dw,:] )
    return result


def lucc_VACCaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,T,R,S] * HD['Daaaa'][Dq,Du,Dv,Dw]
    if S==T:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][v,R,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,R,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Dv,:] ) ,
                             +HD['HSaaaa'][P,q,R,w] * HD['Daa'][Du,Dv] ,
                             -HD['HSaaaa'][P,q,R,v] * HD['Daa'][Du,Dw] ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Du,:] ) ))
        if q==w:
            result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Daa'][Du,Dv] ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dv,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,R,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dv,:,Du,:] ) ))
        if q==v:
            result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daa'][Du,Dw] ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,R,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    if R==T:
        result += 2 * fsum(( +HD['HSaa'][P,S] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                             +HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,S,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,S,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,S,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][w,S,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][v,S,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Dw,:] ) ,
                             -HD['HSaaaa'][P,q,S,w] * HD['Daa'][Du,Dv] ,
                             +HD['HSaaaa'][P,q,S,v] * HD['Daa'][Du,Dw] ,
                             +HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,S,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,S,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Du,:] ) ))
        if q==w:
            result += 2 * fsum(( -HD['HSaa'][P,S] * HD['Daa'][Du,Dv] ,
                                 -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Dv,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,S,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                                 -HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Dv,:,Du,:] ) ))
        if q==v:
            result += 2 * fsum(( +HD['HSaa'][P,S] * HD['Daa'][Du,Dw] ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][w,S,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    if q==w:
        result += 2 * -HD['HSaaaa'][P,T,R,S] * HD['Daa'][Du,Dv]
    if q==v:
        result += 2 * +HD['HSaaaa'][P,T,R,S] * HD['Daa'][Du,Dw]
    return result


def lucc_VACCaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    if S==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             +HD['HSaaaa'][P,T,R,v] * HD['Daa'][Dq,Dw] ,
                             -HD['HSaaaa'][P,T,R,w] * HD['Daa'][Dq,Dv] ))
        if R==T:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 -HD['HSaa'][P,w] * HD['Daa'][Dq,Dv] ,
                                 +HD['HSaa'][P,v] * HD['Daa'][Dq,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 +HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                                 -HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][P,q,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][P,q,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][v,w,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][P,q,v,w] ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 -HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ,
                                 +HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ))
            if q==v:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +HD['HSaa'][P,w] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ))
            if q==w:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -HD['HSaa'][P,v] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
        if q==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['HSaaaa'][P,T,R,w] ))
        if q==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 -HD['HSaaaa'][P,T,R,v] ))
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,U,S,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             +HD['HSaaaa'][P,U,S,v] * HD['Daa'][Dq,Dw] ,
                             -HD['HSaaaa'][P,U,S,w] * HD['Daa'][Dq,Dv] ))
        if q==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,U,S,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['HSaaaa'][P,U,S,w] ))
        if q==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,U,S,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 -HD['HSaaaa'][P,U,S,v] ))
    if R==U:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,S,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             -HD['HSaaaa'][P,T,S,v] * HD['Daa'][Dq,Dw] ,
                             +HD['HSaaaa'][P,T,S,w] * HD['Daa'][Dq,Dv] ))
        if S==T:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 +HD['HSaa'][P,w] * HD['Daa'][Dq,Dv] ,
                                 -HD['HSaa'][P,v] * HD['Daa'][Dq,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                                 +HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][P,q,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][P,q,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][v,w,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][P,q,v,w] ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                                 +HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ,
                                 -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ))
            if q==v:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -HD['HSaa'][P,w] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ))
            if q==w:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     +HD['HSaa'][P,v] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dv,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,v] ) ))
        if q==v:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,T,S,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSaaaa'][P,T,S,w] ))
        if q==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,T,S,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +HD['HSaaaa'][P,T,S,v] ))
    if S==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,U,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             -HD['HSaaaa'][P,U,R,v] * HD['Daa'][Dq,Dw] ,
                             +HD['HSaaaa'][P,U,R,w] * HD['Daa'][Dq,Dv] ))
        if q==v:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,U,R,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSaaaa'][P,U,R,w] ))
        if q==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,U,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +HD['HSaaaa'][P,U,R,v] ))
    return result


def lucc_VACCaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,T,R,S] * HD['Daaaa'][Dq,Du,Dv,Dw]
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][R,S,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,q,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] )
        if q==u:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][R,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    return result


def lucc_VACCaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][R,S,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +HD['HSaaaa'][q,V,R,S] * HD['Daa'][Du,Dw] ))
        if S==V:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][u,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -HD['HSaa'][q,R] * HD['Daa'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][u,R,q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Du,:,:] ) ))
            if q==u:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ))
        if R==V:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][u,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +HD['HSaa'][q,S] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][u,S,q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Du,:,:] ) ))
            if q==u:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,V,actfloor:actceil], HD['Daa'][Dw,:] )
    if S==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +HD['HSaaaa'][P,q,R,T] * HD['Daa'][Du,Dw] ))
        if q==u:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daa'][Dw,:] )
    if R==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,S,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             -HD['HSaaaa'][P,q,S,T] * HD['Daa'][Du,Dw] ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,S,actfloor:actceil,P], HD['Daa'][Dw,:] )
    return result


def lucc_VACCaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * -HD['HSaaaa'][R,S,V,W] * HD['Daa'][Dq,Du]
        if S==V:
            result += 2 * fsum(( -HD['HSaa'][R,W] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][R,:actfloor,W,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,W,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][u,R,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSaaaa'][q,W,R,u] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][R,:actfloor,W,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,W,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if R==W:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -HD['HSaa'][q,u] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,u] ) ))
            if q==u:
                result += 2 * fsum(( +HD['HSaa'][R,W] ,
                                     +einsum( 'II->', HD['HSaaaa'][R,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][R,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==W:
            result += 2 * fsum(( -HD['HSaa'][S,V] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][S,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,V,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,V,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][u,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][q,V,S,u] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][S,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,V,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if q==u:
                result += 2 * fsum(( +HD['HSaa'][S,V] ,
                                     +einsum( 'II->', HD['HSaaaa'][S,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][S,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if S==W:
            result += 2 * fsum(( +HD['HSaa'][R,V] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][u,R,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,V,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSaaaa'][q,V,R,u] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if R==V:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +HD['HSaa'][q,u] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,u] ) ))
            if q==u:
                result += 2 * fsum(( -HD['HSaa'][R,V] ,
                                     -einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( +HD['HSaa'][S,W] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][S,:actfloor,W,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,W,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,W,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][u,S,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][q,W,S,u] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][S,:actfloor,W,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,W,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if q==u:
                result += 2 * fsum(( -HD['HSaa'][S,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * +HD['HSaaaa'][R,S,V,W]
    if R==W:
        result += 2 * +HD['HSaaaa'][P,V,S,T] * HD['Daa'][Dq,Du]
        if S==V:
            result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][P,q,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][T,u,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][P,q,u,T] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dq,:] ) ))
            if q==u:
                result += 2 * fsum(( -HD['HSaa'][P,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * -HD['HSaaaa'][P,V,S,T]
    if S==V:
        result += 2 * +HD['HSaaaa'][P,W,R,T] * HD['Daa'][Dq,Du]
        if q==u:
            result += 2 * -HD['HSaaaa'][P,W,R,T]
    if S==W:
        result += 2 * -HD['HSaaaa'][P,V,R,T] * HD['Daa'][Dq,Du]
        if R==V:
            result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][P,q,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][T,u,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][P,q,u,T] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dq,:] ) ))
            if q==u:
                result += 2 * fsum(( +HD['HSaa'][P,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * +HD['HSaaaa'][P,V,R,T]
    if R==V:
        result += 2 * -HD['HSaaaa'][P,W,S,T] * HD['Daa'][Dq,Du]
        if q==u:
            result += 2 * +HD['HSaaaa'][P,W,S,T]
    return result


def lucc_VACCaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    if S==V:
        if P==U:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][T,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,R,q,actfloor:actceil], HD['Daa'][Dw,:] )
        if P==T:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][U,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][U,R,q,actfloor:actceil], HD['Daa'][Dw,:] )
    if P==U:
        if R==V:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][T,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,S,q,actfloor:actceil], HD['Daa'][Dw,:] )
    if R==V:
        if P==T:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][U,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][U,S,q,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VACCaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    if P==U:
        if S==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,R,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][q,W,R,T] ))
            if R==W:
                result += 2 * fsum(( +HD['HSaa'][q,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if R==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][q,V,S,T] ))
        if S==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,R,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][q,V,R,T] ))
            if R==V:
                result += 2 * fsum(( -HD['HSaa'][q,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,S,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][q,W,S,T] ))
    if P==T:
        if S==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][U,R,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][q,W,R,U] ))
            if R==W:
                result += 2 * fsum(( -HD['HSaa'][q,U] ,
                                     +einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if R==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][U,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][q,V,S,U] ))
        if S==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][U,R,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][q,V,R,U] ))
            if R==V:
                result += 2 * fsum(( +HD['HSaa'][q,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][U,S,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][q,W,S,U] ))
    if S==V:
        if R==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaaaa'][P,q,T,U] ))
    if S==W:
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][P,q,T,U] ))
    return result


def lucc_VVAAaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,t,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,Q,u,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,Q,w,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,Q,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dt,Du,:] ) ,
                         -HD['HSaaaa'][P,Q,t,u] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                         +HD['HSaaaa'][P,Q,v,w] * HD['Daaaa'][Dr,Ds,Dt,Du] ))
    if s==v:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dw,:,:] )
        if r==w:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] )
    if r==w:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dv,:,:] )
    if s==w:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dt,Du,Dv,:,:] )
        if r==v:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dt,Du,:,:] )
    if r==v:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dw,:,:] )
    if s==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Dt,:,:] )
        if r==t:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    if r==t:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Du,:,:] )
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dt,:,:] )
        if s==t:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    if s==t:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Dv,Dw,Du,:,:] )
    return result


def lucc_VVAAaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] )
    if s==v:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dw,:] )
        if r==w:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daa'][Du,:] )
    if r==w:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] )
    if s==w:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dv,:] )
        if r==v:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daa'][Du,:] )
    if r==v:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] )
    return result


def lucc_VVAAaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSaaaa'][P,Q,T,U] * HD['Daaaa'][Dr,Ds,Dv,Dw]
    if s==v:
        result += 2 * -HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Dr,Dw]
        if r==w:
            result += 2 * +HD['HSaaaa'][P,Q,T,U]
    if r==w:
        result += 2 * -HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Ds,Dv]
    if s==w:
        result += 2 * +HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Dr,Dv]
        if r==v:
            result += 2 * -HD['HSaaaa'][P,Q,T,U]
    if r==v:
        result += 2 * +HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Ds,Dw]
    return result


def lucc_VVAAaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +HD['HSaaaa'][P,Q,u,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ))
    if Q==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSaa'][P,u] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ))
    if P==T:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaaaa'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['HSaa'][Q,u] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaabaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,u] ) ))
    return result


def lucc_VVAAaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,V,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dw,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,V,u,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] )
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][Q,V,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dw,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][Q,V,u,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] )
    return result


def lucc_VVAAaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,Q,T,U] * HD['Daaaa'][Dr,Ds,Dv,Dw]
    if Q==U:
        result += 2 * fsum(( -HD['HSaa'][P,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
        if P==T:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Ds,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dr,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ))
    if Q==T:
        result += 2 * fsum(( +HD['HSaa'][P,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,U] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,U], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,U] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,U], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
        if P==U:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dr,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][r,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dr,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][r,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ))
    if P==U:
        result += 2 * fsum(( +HD['HSaa'][Q,T] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( -HD['HSaa'][Q,U] * HD['Daaaa'][Dr,Ds,Dv,Dw] ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,U] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daaaaaa'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,U] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daabaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    return result


def lucc_VVAAaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][Q,V,actfloor:actceil,U], HD['Daaaa'][Dr,Ds,Dw,:] )
        if Q==U:
            result += 2 * fsum(( +HD['HSaa'][s,V] * HD['Daa'][Dr,Dw] ,
                                 -HD['HSaa'][r,V] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][r,s,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Dr,:] ) ))
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] )
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,U], HD['Daaaa'][Dr,Ds,Dw,:] )
        if P==U:
            result += 2 * fsum(( -HD['HSaa'][s,V] * HD['Daa'][Dr,Dw] ,
                                 +HD['HSaa'][r,V] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][r,s,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['Daa'][Dr,Dw] * einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][r,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Dr,:] ) ))
    if P==U:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][Q,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] )
    return result


def lucc_VVAAaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if P==T:
        if Q==U:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][V,W,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][V,W,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaaaa'][r,s,V,W] ))
    if Q==T:
        if P==U:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][V,W,s,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][V,W,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSaaaa'][r,s,V,W] ))
    return result


def lucc_VVCAaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][P,Q,R,t] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         +HD['HSaaaa'][P,Q,R,u] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                         -HD['HSaaaa'][P,Q,R,w] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                         +HD['HSaaaa'][P,Q,R,v] * HD['Daaaa'][Ds,Dw,Dt,Du] ))
    if s==w:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] )
    if s==v:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] )
    if s==t:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] )
    return result


def lucc_VVCAaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,Q,R,T] * HD['Daaaa'][Ds,Du,Dv,Dw]
    if R==T:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,w,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,Q,v,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                             -HD['HSaaaa'][P,Q,v,w] * HD['Daa'][Ds,Du] ))
    if s==w:
        result += 2 * +HD['HSaaaa'][P,Q,R,T] * HD['Daa'][Du,Dv]
    if s==v:
        result += 2 * -HD['HSaaaa'][P,Q,R,T] * HD['Daa'][Du,Dw]
    return result


def lucc_VVCAaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSaaaa'][P,Q,R,T] * HD['Daaaa'][Ds,Du,Dv,Dw]
    if Q==T:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( +HD['HSaa'][Q,R] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             +HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,Q], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
    return result


def lucc_VVCAaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,actfloor:actceil,T], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             -HD['HSaaaa'][P,Q,u,T] * HD['Daa'][Ds,Dw] ))
        if Q==T:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['HSaa'][P,u] * HD['Daa'][Ds,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ))
        if P==T:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['HSaa'][Q,u] * HD['Daa'][Ds,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,u] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,u] ) ))
    if Q==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,V,R,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             -HD['HSaaaa'][P,V,R,u] * HD['Daa'][Ds,Dw] ))
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][Q,V,R,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +HD['HSaaaa'][Q,V,R,u] * HD['Daa'][Ds,Dw] ))
    return result


def lucc_VVCAaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    if Q==T:
        if R==W:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][P,V,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,V,u,actfloor:actceil], HD['Daa'][Ds,:] )
        if R==V:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][P,W,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,W,u,actfloor:actceil], HD['Daa'][Ds,:] )
    if R==W:
        if P==T:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][Q,V,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][Q,V,u,actfloor:actceil], HD['Daa'][Ds,:] )
    if R==V:
        if P==T:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][Q,W,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][Q,W,u,actfloor:actceil], HD['Daa'][Ds,:] )
    return result


def lucc_VVCAaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][U,R,actfloor:actceil,Q], HD['Daaaa'][Dv,Dw,Ds,:] )
        if Q==U:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Ds,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Ds,:,:] ) ))
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] )
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][U,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] )
        if P==U:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Ds,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Ds,:,:] ) ))
    if P==U:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,Q], HD['Daaaa'][Dv,Dw,Ds,:] )
    return result


def lucc_VVCAaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * +HD['HSaaaa'][P,Q,T,U] * HD['Daa'][Ds,Dw]
        if Q==U:
            result += 2 * fsum(( +HD['HSaa'][P,T] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Ds,:,Dw,:] ) ))
            if P==T:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ))
        if Q==T:
            result += 2 * fsum(( -HD['HSaa'][P,U] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,U] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,U], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,U] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,U], HD['Dabab'][Ds,:,Dw,:] ) ))
            if P==U:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ))
        if P==U:
            result += 2 * fsum(( -HD['HSaa'][Q,T] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Ds,:,Dw,:] ) ))
        if P==T:
            result += 2 * fsum(( +HD['HSaa'][Q,U] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dabab'][Ds,:,Dw,:] ) ))
    if Q==U:
        result += 2 * +HD['HSaaaa'][P,V,R,T] * HD['Daa'][Ds,Dw]
        if P==T:
            result += 2 * fsum(( -HD['HSaa'][R,V] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ))
    if Q==T:
        result += 2 * -HD['HSaaaa'][P,V,R,U] * HD['Daa'][Ds,Dw]
        if P==U:
            result += 2 * fsum(( +HD['HSaa'][R,V] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ))
    if P==U:
        result += 2 * -HD['HSaaaa'][Q,V,R,T] * HD['Daa'][Ds,Dw]
    if P==T:
        result += 2 * +HD['HSaaaa'][Q,V,R,U] * HD['Daa'][Ds,Dw]
    return result


def lucc_VVCAaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    if R==W:
        if P==T:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][Q,V,actfloor:actceil,U], HD['Daa'][Ds,:] )
            if Q==U:
                result += 2 * fsum(( +HD['HSaa'][s,V] ,
                                     +einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if Q==U:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,T], HD['Daa'][Ds,:] )
        if Q==T:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,V,actfloor:actceil,U], HD['Daa'][Ds,:] )
            if P==U:
                result += 2 * fsum(( -HD['HSaa'][s,V] ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][s,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][Q,V,actfloor:actceil,T], HD['Daa'][Ds,:] )
    if R==V:
        if P==T:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][Q,W,actfloor:actceil,U], HD['Daa'][Ds,:] )
            if Q==U:
                result += 2 * fsum(( -HD['HSaa'][s,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,W,actfloor:actceil,T], HD['Daa'][Ds,:] )
        if Q==T:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,W,actfloor:actceil,U], HD['Daa'][Ds,:] )
            if P==U:
                result += 2 * fsum(( +HD['HSaa'][s,W] ,
                                     +einsum( 'II->', HD['HSaaaa'][s,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][s,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][Q,W,actfloor:actceil,T], HD['Daa'][Ds,:] )
    if P==T:
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][V,W,R,actfloor:actceil], HD['Daa'][Ds,:] )
    if Q==T:
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][V,W,R,actfloor:actceil], HD['Daa'][Ds,:] )
    return result


def lucc_VVCCaaaa_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if S==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +HD['HSaaaa'][P,Q,R,w] * HD['Daa'][Du,Dv] ,
                             -HD['HSaaaa'][P,Q,R,v] * HD['Daa'][Du,Dw] ))
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,S,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -HD['HSaaaa'][P,Q,S,w] * HD['Daa'][Du,Dv] ,
                             +HD['HSaaaa'][P,Q,S,v] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VVCCaaaa_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if S==U:
        if R==T:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][P,Q,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSaaaa'][P,Q,v,w] ))
    if R==U:
        if S==T:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,w,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][P,Q,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['HSaaaa'][P,Q,v,w] ))
    return result


def lucc_VVCCaaaa_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] )
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,Q], HD['Daaaa'][Dv,Dw,Du,:] )
    return result


def lucc_VVCCaaaa_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * -HD['HSaaaa'][P,V,R,S] * HD['Daa'][Du,Dw]
        if S==V:
            result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Daa'][Du,Dw] ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
        if R==V:
            result += 2 * fsum(( -HD['HSaa'][P,S] * HD['Daa'][Du,Dw] ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][u,S,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if S==V:
        result += 2 * +HD['HSaaaa'][P,Q,R,T] * HD['Daa'][Du,Dw]
        if P==T:
            result += 2 * fsum(( -HD['HSaa'][Q,R] * HD['Daa'][Du,Dw] ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,Q], HD['Daa'][Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if R==V:
        result += 2 * -HD['HSaaaa'][P,Q,S,T] * HD['Daa'][Du,Dw]
        if P==T:
            result += 2 * fsum(( +HD['HSaa'][Q,S] * HD['Daa'][Du,Dw] ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][u,S,actfloor:actceil,Q], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if P==T:
        result += 2 * +HD['HSaaaa'][Q,V,R,S] * HD['Daa'][Du,Dw]
    return result


def lucc_VVCCaaaa_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if Q==T:
        if S==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSaaaa'][P,W,R,u] ))
            if R==W:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +HD['HSaa'][P,u] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ))
        if R==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,V,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSaaaa'][P,V,S,u] ))
        if S==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,V,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSaaaa'][P,V,R,u] ))
            if R==V:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -HD['HSaa'][P,u] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ))
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,W,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSaaaa'][P,W,S,u] ))
    if P==T:
        if S==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][Q,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSaaaa'][Q,W,R,u] ))
            if R==W:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -HD['HSaa'][Q,u] ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,u] ) ))
        if R==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][Q,V,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSaaaa'][Q,V,S,u] ))
        if S==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][Q,V,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSaaaa'][Q,V,R,u] ))
            if R==V:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +HD['HSaa'][Q,u] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,u] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][Q,W,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSaaaa'][Q,W,S,u] ))
    if S==V:
        if R==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 +HD['HSaaaa'][P,Q,u,T] ))
    if S==W:
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 -HD['HSaaaa'][P,Q,u,T] ))
    return result


def lucc_VVCCaaaa_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if P==T:
        if Q==U:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][R,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    if Q==T:
        if P==U:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][R,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dv,Dw,:,:] )
    return result


def lucc_VVCCaaaa_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if R==V:
        if P==T:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][U,S,actfloor:actceil,Q], HD['Daa'][Dw,:] )
            if Q==U:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ))
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,S,actfloor:actceil,P], HD['Daa'][Dw,:] )
        if Q==T:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][U,S,actfloor:actceil,P], HD['Daa'][Dw,:] )
            if P==U:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ))
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,S,actfloor:actceil,Q], HD['Daa'][Dw,:] )
    if S==V:
        if Q==U:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,P], HD['Daa'][Dw,:] )
            if P==T:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ))
        if P==T:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][U,R,actfloor:actceil,Q], HD['Daa'][Dw,:] )
        if Q==T:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][U,R,actfloor:actceil,P], HD['Daa'][Dw,:] )
            if P==U:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][R,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][R,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ))
        if P==U:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][T,R,actfloor:actceil,Q], HD['Daa'][Dw,:] )
    if P==T:
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,V,actfloor:actceil], HD['Daa'][Dw,:] )
    if Q==T:
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][R,S,V,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VVCCaaaa_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    if R==W:
        if S==V:
            result += 2 * -HD['HSaaaa'][P,Q,T,U]
            if Q==U:
                result += 2 * fsum(( -HD['HSaa'][P,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if Q==T:
                result += 2 * fsum(( +HD['HSaa'][P,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
            if P==U:
                result += 2 * fsum(( +HD['HSaa'][Q,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if P==T:
                result += 2 * fsum(( -HD['HSaa'][Q,U] ,
                                     +einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if Q==U:
            result += 2 * -HD['HSaaaa'][P,V,S,T]
            if P==T:
                result += 2 * fsum(( +HD['HSaa'][S,V] ,
                                     +einsum( 'II->', HD['HSaaaa'][S,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][S,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if Q==T:
            result += 2 * +HD['HSaaaa'][P,V,S,U]
            if P==U:
                result += 2 * fsum(( -HD['HSaa'][S,V] ,
                                     -einsum( 'II->', HD['HSaaaa'][S,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][S,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * +HD['HSaaaa'][Q,V,S,T]
        if P==T:
            result += 2 * -HD['HSaaaa'][Q,V,S,U]
    if S==V:
        if Q==T:
            result += 2 * +HD['HSaaaa'][P,W,R,U]
            if P==U:
                result += 2 * fsum(( -HD['HSaa'][R,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][R,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][R,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * +HD['HSaaaa'][Q,W,R,T]
        if Q==U:
            result += 2 * -HD['HSaaaa'][P,W,R,T]
            if P==T:
                result += 2 * fsum(( +HD['HSaa'][R,W] ,
                                     +einsum( 'II->', HD['HSaaaa'][R,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][R,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==T:
            result += 2 * -HD['HSaaaa'][Q,W,R,U]
    if Q==U:
        if S==W:
            result += 2 * +HD['HSaaaa'][P,V,R,T]
            if R==V:
                result += 2 * fsum(( +HD['HSaa'][P,T] ,
                                     -einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if P==T:
                result += 2 * fsum(( -HD['HSaa'][R,V] ,
                                     -einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * +HD['HSaaaa'][P,W,S,T]
            if P==T:
                result += 2 * fsum(( -HD['HSaa'][S,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==T:
            result += 2 * +HD['HSaaaa'][R,S,V,W]
    if S==W:
        if R==V:
            result += 2 * +HD['HSaaaa'][P,Q,T,U]
            if Q==T:
                result += 2 * fsum(( -HD['HSaa'][P,U] ,
                                     +einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
            if P==U:
                result += 2 * fsum(( -HD['HSaa'][Q,T] ,
                                     +einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if P==T:
                result += 2 * fsum(( +HD['HSaa'][Q,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if Q==T:
            result += 2 * -HD['HSaaaa'][P,V,R,U]
            if P==U:
                result += 2 * fsum(( +HD['HSaa'][R,V] ,
                                     +einsum( 'II->', HD['HSaaaa'][R,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][R,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * -HD['HSaaaa'][Q,V,R,T]
        if P==T:
            result += 2 * +HD['HSaaaa'][Q,V,R,U]
    if R==V:
        if Q==T:
            result += 2 * -HD['HSaaaa'][P,W,S,U]
            if P==U:
                result += 2 * fsum(( +HD['HSaa'][S,W] ,
                                     +einsum( 'II->', HD['HSaaaa'][S,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSabab'][S,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * -HD['HSaaaa'][Q,W,S,T]
        if P==T:
            result += 2 * +HD['HSaaaa'][Q,W,S,U]
    if Q==T:
        if P==U:
            result += 2 * -HD['HSaaaa'][R,S,V,W]
    return result


def lucc_AAAAaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dp,Dq,Dw,Dr,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dp,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dp,Dq,Dw,Ds,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][s,T,w,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dq,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][q,T,w,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dp,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][r,T,w,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dq,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][p,T,w,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,Du,:] ) ,
                         +HD['HSabab'][q,T,w,v] * HD['Daaaa'][Dp,Du,Dr,Ds] ,
                         +HD['HSabab'][r,T,w,v] * HD['Daaaa'][Dp,Dq,Ds,Du] ,
                         -HD['HSabab'][p,T,w,v] * HD['Daaaa'][Dq,Du,Dr,Ds] ,
                         -HD['HSabab'][s,T,w,v] * HD['Daaaa'][Dp,Dq,Dr,Du] ,
                         +einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaba'][Dr,Ds,Du,:,Dp,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaba'][Dp,Dq,Du,:,Dr,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaba'][Dp,Dq,Du,:,Ds,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][q,T,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dp,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][p,T,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dp,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Du,Dr,Dw,:] ) ))
    if r==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dq,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Ds,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Ds,Du,:,Dp,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dp,:] ) ))
    if s==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dq,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dp,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Daaaa'][Dp,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dp,:] ) ))
    if q==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dp,Du,:,Ds,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dp,Du,:,Dr,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][p,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Daaaa'][Dp,Du,Dr,:] ) ))
    if p==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dq,Du,:,Ds,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dq,Du,:,Dr,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][q,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Dr,:] ) ))
    return result


def lucc_AAAAaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,p,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,U,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dp,Dq,:] ) ,
                         -HD['HSbaab'][v,p,U,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         +HD['HSbaab'][v,q,U,T] * HD['Daaaa'][Dp,Dw,Dr,Ds] ,
                         -HD['HSbaab'][v,s,U,T] * HD['Daaaa'][Dp,Dq,Dr,Dw] ,
                         +HD['HSbaab'][v,r,U,T] * HD['Daaaa'][Dp,Dq,Ds,Dw] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbaab'][Dv,Dp,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,U,p,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -HD['HSbaab'][v,q,U,T] * HD['Daa'][Dp,Ds] ,
                             +HD['HSbaab'][v,p,U,T] * HD['Daa'][Dq,Ds] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbaab'][Dv,Dp,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,U,p,actfloor:actceil], HD['Dbaab'][Dv,Dq,Dr,:] ) ,
                             +HD['HSbaab'][v,q,U,T] * HD['Daa'][Dp,Dr] ,
                             -HD['HSbaab'][v,p,U,T] * HD['Daa'][Dq,Dr] ))
    if p==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbaab'][Dv,Dr,Dq,:] ) ,
                             -HD['HSbaab'][v,r,U,T] * HD['Daa'][Dq,Ds] ,
                             +HD['HSbaab'][v,s,U,T] * HD['Daa'][Dq,Dr] ))
    if q==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbaab'][Dv,Dr,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,U,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dp,:] ) ,
                             -HD['HSbaab'][v,s,U,T] * HD['Daa'][Dp,Dr] ,
                             +HD['HSbaab'][v,r,U,T] * HD['Daa'][Dp,Ds] ))
    return result


def lucc_AAAAaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaba'][Dr,Ds,Du,:,Dp,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaba'][Dp,Dq,Du,:,Dr,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaba'][Dp,Dq,Du,:,Ds,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dp,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dp,Dq,Dw,Dr,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dp,Dq,Dw,Ds,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,u,p,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,u,q,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,u,s,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dp,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,u,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dp,Dq,:] ) ))
    if r==u:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dp,Dq,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dp,:,:] ) ))
    if s==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dp,Dq,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dp,:,:] ) ))
    if p==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ))
    if q==u:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dw,Dr,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dw,Ds,:,:] ) ))
    return result


def lucc_AAAAaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][p,V,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dp,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Daaaaaa'][Dp,Dq,Du,Dr,Dw,:] ) ,
                         +HD['HSabab'][p,V,u,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         -HD['HSabab'][r,V,u,T] * HD['Daaaa'][Dp,Dq,Ds,Dw] ,
                         -HD['HSabab'][q,V,u,T] * HD['Daaaa'][Dp,Dw,Dr,Ds] ,
                         +HD['HSabab'][s,V,u,T] * HD['Daaaa'][Dp,Dq,Dr,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daaaaaa'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dp,Du,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][p,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Daaaa'][Dp,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daaaa'][Dp,Dw,Ds,:] ) ))
    if r==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ))
    if s==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Daaaa'][Dp,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] ) ))
    if p==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ))
    return result


def lucc_AAAAaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][T,s,W,V] * HD['Daaaa'][Dp,Dq,Dr,Du] ,
                         +HD['HSbaab'][T,p,W,V] * HD['Daaaa'][Dq,Du,Dr,Ds] ,
                         -HD['HSbaab'][T,r,W,V] * HD['Daaaa'][Dp,Dq,Ds,Du] ,
                         -HD['HSbaab'][T,q,W,V] * HD['Daaaa'][Dp,Du,Dr,Ds] ))
    if r==u:
        result += 2 * fsum(( -HD['HSbaab'][T,p,W,V] * HD['Daa'][Dq,Ds] ,
                             +HD['HSbaab'][T,q,W,V] * HD['Daa'][Dp,Ds] ))
    if s==u:
        result += 2 * fsum(( +HD['HSbaab'][T,p,W,V] * HD['Daa'][Dq,Dr] ,
                             -HD['HSbaab'][T,q,W,V] * HD['Daa'][Dp,Dr] ))
    if p==u:
        result += 2 * fsum(( +HD['HSbaab'][T,r,W,V] * HD['Daa'][Dq,Ds] ,
                             -HD['HSbaab'][T,s,W,V] * HD['Daa'][Dq,Dr] ))
    if q==u:
        result += 2 * fsum(( -HD['HSbaab'][T,r,W,V] * HD['Daa'][Dp,Ds] ,
                             +HD['HSbaab'][T,s,W,V] * HD['Daa'][Dp,Dr] ))
    return result


def lucc_AAAAaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,p,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbaaaab'][Dv,Dp,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dp,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,U,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dp,Dq,:] ) ))
    return result


def lucc_AAAAaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSabab'][p,V,U,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         -HD['HSabab'][q,V,U,T] * HD['Daaaa'][Dp,Dw,Dr,Ds] ,
                         +HD['HSabab'][s,V,U,T] * HD['Daaaa'][Dp,Dq,Dr,Dw] ,
                         -HD['HSabab'][r,V,U,T] * HD['Daaaa'][Dp,Dq,Ds,Dw] ))
    return result


def lucc_AAAAaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dt,Dr,Ds,Du,Dq,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Dr,Ds,Dw,Dq,Dt,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][P,u] * HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,Dt] ,
                         -HD['HSaa'][P,w] * HD['Dbaaaab'][Dt,Dq,Du,Dr,Ds,Dv] ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbaaaaaba'][Dv,Dr,Ds,:,Dq,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbaaaaaba'][Dt,Dr,Ds,:,Dq,Dw,Dv,:] ) ,
                         +HD['Dbaaaab'][Dt,Dq,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][u,P,s,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Dw,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,w,P,actfloor:actceil], HD['Dbaaaba'][Dt,Dq,Du,Dr,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][w,P,s,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,u,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Dr,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][u,P,r,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][r,w,P,actfloor:actceil], HD['Dbaaaba'][Dt,Dq,Du,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,P,r,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][r,u,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dt,:] ) ,
                         +HD['HSaaaa'][u,P,r,s] * HD['Dbaab'][Dt,Dq,Dw,Dv] ,
                         -HD['HSaaaa'][w,P,r,s] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                         +HD['Dbaaaab'][Dt,Dq,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbaabaabb'][Dt,Dr,Ds,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbaabaabb'][Dv,Dr,Ds,:,Dq,Du,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dt,Dr,Ds,Du,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dq,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,P,r,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,r,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,u,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,w,P,actfloor:actceil], HD['Dbaaaab'][Dt,Dq,Du,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,P,s,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,s,P,actfloor:actceil], HD['Dbaaaab'][Dt,Dq,Du,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,P,s,actfloor:actceil], HD['Dbaaaab'][Dt,Dr,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,s,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,P,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,r,P,actfloor:actceil], HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,v,actfloor:actceil], HD['Daaabaaba'][Dr,Ds,Dw,:,Dq,Du,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,t,actfloor:actceil], HD['Daaabaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ))
    if q==u:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dt,Dr,Ds,:,Dw,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                             +HD['HSaa'][P,s] * HD['Dbaab'][Dt,Dr,Dw,Dv] ,
                             -HD['HSaa'][P,r] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,:,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dt,Ds,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Dbaab'][Dt,Dr,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dt,Ds,Dw,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Dbaab'][Dt,Dr,Dw,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dt,Dr,Ds,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dt,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dt,Dr,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][t,s,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][t,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,t,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ))
    if q==w:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Dr,Ds,:,Du,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ,
                             -HD['HSaa'][P,s] * HD['Dbaab'][Dv,Dr,Du,Dt] ,
                             +HD['HSaa'][P,r] * HD['Dbaab'][Dv,Ds,Du,Dt] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,:,Du,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,:,Du,Dt,:] ) ,
                             -HD['Dbaab'][Dv,Ds,Du,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbaab'][Dv,Dr,Du,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][r,s,P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ,
                             -HD['Dbaab'][Dv,Ds,Du,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbaab'][Dv,Dr,Du,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dv,Dr,Ds,:,Du,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Du,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dv,Dr,:,Du,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,s,P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][v,r,P,actfloor:actceil], HD['Dbaab'][Dt,Du,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,v,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Du,Dt,:] ) ))
    if r==w:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dt,Ds,Du,:,Dq,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                             -HD['HSaa'][P,s] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dt,Du,:,Dq,Dv,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dt,Ds,Du,:,Dq,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,P,s,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ))
    if s==w:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dt,Dr,Du,:,Dq,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Du,Dq,Dv,:] ) ,
                             +HD['HSaa'][P,r] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Du,Dq,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dt,Du,:,Dq,Dv,:] ) ,
                             -HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Du,Dq,Dv,:] ) ,
                             -HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dt,Dr,Du,:,Dq,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Dr,Du,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][v,P,r,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ))
    if r==u:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Ds,Dw,:,Dq,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                             +HD['HSaa'][P,s] * HD['Dbaab'][Dt,Dq,Dw,Dv] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Dq,Dt,:] ) ,
                             -HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                             -HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dv,Ds,Dw,:,Dq,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][t,P,s,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
    if s==u:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Dr,Dw,:,Dq,Dt,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Dw,Dq,Dt,:] ) ,
                             -HD['HSaa'][P,r] * HD['Dbaab'][Dt,Dq,Dw,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Dw,Dq,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Dw,Dq,Dt,:] ) ,
                             +HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dv,Dr,Dw,:,Dq,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][t,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
    return result


def lucc_CAAAaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,T,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dq,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,w,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,s,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dq,Du,:] ) ,
                         +HD['HSbaab'][T,P,r,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                         +HD['HSbaab'][T,P,w,v] * HD['Daaaa'][Dq,Du,Dr,Ds] ,
                         -HD['HSbaab'][T,P,s,v] * HD['Daaaa'][Dq,Du,Dr,Dw] ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaabaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSbaba'][v,P,T,s] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                         -HD['HSbaba'][v,P,T,r] * HD['Daaaa'][Dq,Dw,Ds,Du] ))
    if q==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,P,s,actfloor:actceil], HD['Dbaab'][Dv,Dr,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                             +HD['HSbaab'][T,P,s,v] * HD['Daa'][Dr,Du] ,
                             -HD['HSbaab'][T,P,r,v] * HD['Daa'][Ds,Du] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,P,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daababa'][Ds,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             -HD['HSbaba'][v,P,T,s] * HD['Daa'][Dq,Du] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ,
                             +HD['HSbaba'][v,P,T,r] * HD['Daa'][Dq,Du] ))
    return result


def lucc_CAAAaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ,
                         -HD['HSbaab'][v,P,U,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ))
    if P==U:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][s,T,w,actfloor:actceil], HD['Dbaab'][Dv,Dq,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][r,T,w,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -HD['HSabab'][s,T,w,v] * HD['Daa'][Dq,Dr] ,
                             +HD['HSabab'][r,T,w,v] * HD['Daa'][Dq,Ds] ,
                             +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ))
        if r==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dq,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ))
        if s==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dq,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Daa'][Dr,:] ) ))
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             +HD['HSbaab'][v,P,U,T] * HD['Daa'][Dq,Ds] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Dr,:] ) ,
                             -HD['HSbaab'][v,P,U,T] * HD['Daa'][Dq,Dr] ))
    return result


def lucc_CAAAaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,T], HD['Daaabaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dq,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,u,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,s,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,s,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,r,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,s,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if r==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,P,s,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
    if s==u:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
    return result


def lucc_CAAAaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][V,P,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         -HD['HSbaab'][V,P,u,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         +HD['HSbaab'][V,P,s,T] * HD['Daaaa'][Dq,Dw,Dr,Du] ,
                         -HD['HSbaab'][V,P,r,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -HD['HSbaba'][T,P,V,s] * HD['Daaaa'][Dq,Du,Dr,Dw] ,
                         +HD['HSbaba'][T,P,V,r] * HD['Daaaa'][Dq,Du,Ds,Dw] ))
    if q==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][V,P,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -HD['HSbaab'][V,P,s,T] * HD['Daa'][Dr,Dw] ,
                             +HD['HSbaab'][V,P,r,T] * HD['Daa'][Ds,Dw] ))
    if r==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             +HD['HSbaba'][T,P,V,s] * HD['Daa'][Dq,Dw] ))
    if s==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] ) ,
                             -HD['HSbaba'][T,P,V,r] * HD['Daa'][Dq,Dw] ))
    return result


def lucc_CAAAaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * +HD['HSbaab'][T,P,W,V] * HD['Daaaa'][Dq,Du,Dr,Ds]
    if P==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             +HD['HSabab'][s,V,u,T] * HD['Daa'][Dq,Dr] ,
                             -HD['HSabab'][r,V,u,T] * HD['Daa'][Dq,Ds] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Daa'][Dr,:] ) ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if r==u:
        result += 2 * -HD['HSbaab'][T,P,W,V] * HD['Daa'][Dq,Ds]
    if s==u:
        result += 2 * +HD['HSbaab'][T,P,W,V] * HD['Daa'][Dq,Dr]
    return result


def lucc_CAAAaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaab'][T,U,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] )
    return result


def lucc_CAAAaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][V,P,U,T] * HD['Daaaa'][Dq,Dw,Dr,Ds]
    return result


def lucc_CAAAaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==W:
        result += 2 * fsum(( +HD['HSabab'][s,V,U,T] * HD['Daa'][Dq,Dr] ,
                             -HD['HSabab'][r,V,U,T] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_CCAAaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][P,Q,u,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,Q,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ,
                         +HD['HSaaaa'][P,Q,s,w] * HD['Dbaab'][Dv,Dr,Du,Dt] ,
                         -HD['HSaaaa'][P,Q,s,u] * HD['Dbaab'][Dt,Dr,Dw,Dv] ,
                         -HD['HSaaaa'][P,Q,r,w] * HD['Dbaab'][Dv,Ds,Du,Dt] ,
                         +HD['HSaaaa'][P,Q,r,u] * HD['Dbaab'][Dt,Ds,Dw,Dv] ))
    if r==w:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Ds,Du,Dv,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,s,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] )
    if s==w:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Dr,Du,Dv,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,r,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] )
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Ds,Dw,Dt,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,s,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] )
    if s==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dr,Dw,Dt,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,r,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] )
    return result


def lucc_CCAAaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             +HD['HSbaba'][v,P,T,s] * HD['Daa'][Dr,Dw] ,
                             -HD['HSbaba'][v,P,T,r] * HD['Daa'][Ds,Dw] ))
        if r==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,T,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSbaba'][v,P,T,s] ))
        if s==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabba'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['HSbaba'][v,P,T,r] ))
    if P==U:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,T,Q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][r,T,Q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,Q,T,actfloor:actceil], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -HD['HSbaba'][v,Q,T,s] * HD['Daa'][Dr,Dw] ,
                             +HD['HSbaba'][v,Q,T,r] * HD['Daa'][Ds,Dw] ))
        if r==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,T,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][v,Q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSbaba'][v,Q,T,s] ))
        if s==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][r,T,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dabba'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][v,Q,T,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['HSbaba'][v,Q,T,r] ))
    return result


def lucc_CCAAaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    if Q==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             -HD['HSbaba'][T,P,V,s] * HD['Daa'][Dr,Du] ,
                             +HD['HSbaba'][T,P,V,r] * HD['Daa'][Ds,Du] ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSbaba'][T,P,V,s] ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 -HD['HSbaba'][T,P,V,r] ))
    if P==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,Q,V,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ,
                             +HD['HSbaba'][T,Q,V,s] * HD['Daa'][Dr,Du] ,
                             -HD['HSbaba'][T,Q,V,r] * HD['Daa'][Ds,Du] ))
        if s==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][T,Q,V,actfloor:actceil], HD['Daa'][Dr,:] ) ,
                                 +HD['HSbaba'][T,Q,V,r] ))
        if r==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,Q,V,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSbaba'][T,Q,V,s] ))
    return result


def lucc_CCAAaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VAAAaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dt,Dr,Ds,Du,Dq,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Dr,Ds,Dw,Dq,Dt,:,:] ) ))
    result += 2 * fsum(( +HD['HSaa'][P,u] * HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,Dt] ,
                         -HD['HSaa'][P,w] * HD['Dbaaaab'][Dt,Dq,Du,Dr,Ds,Dv] ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaaaaaba'][Dt,Dr,Ds,:,Dq,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaaaba'][Dv,Dr,Ds,:,Dq,Du,Dt,:] ) ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,u] ) ,
                         +HD['Dbaaaab'][Dt,Dq,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,:actfloor,w] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,q,u,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,q,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaabaabb'][Dv,Dr,Ds,:,Dq,Du,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaabaabb'][Dt,Dr,Ds,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dt,Dr,Ds,Du,Dq,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaabaaba'][Dr,Ds,Dw,:,Dq,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,t,actfloor:actceil], HD['Daaabaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +HD['Dbaaaab'][Dt,Dq,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,w] ) ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSabba'][P,:actfloor,:actfloor,u] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][t,u,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,w,actfloor:actceil,P], HD['Dbaaaab'][Dt,Dq,Du,Dr,Ds,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dt,Ds,Du,:,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Ds,Du,Dv,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dt,Ds,Du,:,Dq,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ))
    if s==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dt,Dr,Du,:,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Dr,Du,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Du,Dq,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Du,Dq,Dv,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dt,Dr,Du,:,Dq,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Dr,Du,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Du,Dq,Dv,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Ds,Dw,:,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Ds,Dw,Dt,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dv,Ds,Dw,:,Dq,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ))
    if s==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Dr,Dw,:,Dq,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dr,Dw,Dt,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Dw,Dq,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Dw,Dq,Dt,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dv,Dr,Dw,:,Dq,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Dw,Dq,Dt,:] ) ))
    if q==u:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dt,Dr,Ds,:,Dw,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dt,Dr,Ds,:,Dw,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,t,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ))
    if q==w:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Dr,Ds,:,Du,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][P,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dv,Dr,Ds,:,Du,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daababa'][Dr,Ds,:,Du,Dt,:] ) ))
    return result


def lucc_VAAAaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dq,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][P,T,w,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Dq,Du,:] ) ,
                         -HD['HSabab'][P,T,w,v] * HD['Daaaa'][Dq,Du,Dr,Ds] ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaabaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ))
    if r==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Ds,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ))
    if s==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dr,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Daaaa'][Dr,Du,Dq,:] ) ))
    if q==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Ds,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Daaaa'][Dr,Ds,Du,:] ) ))
    return result


def lucc_VAAAaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSabab'][P,v,U,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ))
    if r==w:
        result += 2 * fsum(( -HD['HSabab'][P,v,U,T] * HD['Daa'][Dq,Ds] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Ds,:] ) ))
    if s==w:
        result += 2 * fsum(( +HD['HSabab'][P,v,U,T] * HD['Daa'][Dq,Dr] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Dr,:] ) ))
    return result


def lucc_VAAAaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaabaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dr,Ds,Dw,Dq,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,u,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] ) ))
    if r==u:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] )
    if s==u:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dr,Dw,Dq,:,:] )
    if q==u:
        result += 2 * -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] )
    return result


def lucc_VAAAaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daaaaaa'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +HD['HSabab'][P,V,u,T] * HD['Daaaa'][Dq,Dw,Dr,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaaaa'][Dr,Ds,Dw,Dq,Du,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] )
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] )
    if s==u:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Daaaa'][Dr,Dw,Dq,:] )
    return result


def lucc_VAAAaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * +HD['HSbaab'][T,P,W,V] * HD['Daaaa'][Dq,Du,Dr,Ds]
    if r==u:
        result += 2 * -HD['HSbaab'][T,P,W,V] * HD['Daa'][Dq,Ds]
    if s==u:
        result += 2 * +HD['HSbaab'][T,P,W,V] * HD['Daa'][Dq,Dr]
    return result


def lucc_VAAAaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,U,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Dr,Ds,:] )
    if P==U:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Dr,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ))
    return result


def lucc_VAAAaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSabab'][P,V,U,T] * HD['Daaaa'][Dq,Dw,Dr,Ds]
    if P==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ))
    return result


def lucc_VAAAaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==U:
        result += 2 * fsum(( -HD['HSbaab'][T,s,W,V] * HD['Daa'][Dq,Dr] ,
                             +HD['HSbaab'][T,r,W,V] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_VACAaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][u,R,actfloor:actceil,P], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,w,R,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][w,R,actfloor:actceil,P], HD['Dbaaaba'][Dt,Dq,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][P,u,R,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                         +HD['HSaaaa'][P,q,R,u] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                         -HD['HSaaaa'][P,q,R,w] * HD['Dbaab'][Dv,Ds,Du,Dt] ,
                         -einsum( 'i,i->', HD['HSabab'][P,t,R,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][P,v,R,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,R,actfloor:actceil,P], HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][t,R,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ))
    if s==w:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dt,Du,:,Dq,Dv,:] ) ,
                             -HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             -HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][P,v,R,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ))
    if s==u:
        result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Dbaab'][Dt,Dq,Dw,Dv] ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][P,q,R,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             +HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][P,t,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
    if q==u:
        result += 2 * fsum(( +HD['HSaa'][P,R] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,:,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dt,Ds,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             +HD['Dbaab'][Dt,Ds,Dw,Dv] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dt,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][t,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if q==w:
        result += 2 * fsum(( -HD['HSaa'][P,R] * HD['Dbaab'][Dv,Ds,Du,Dt] ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,:,Du,Dt,:] ) ,
                             -HD['Dbaab'][Dv,Ds,Du,Dt] * einsum( 'II->', HD['HSaaaa'][P,:actfloor,R,:actfloor] ) ,
                             -HD['Dbaab'][Dv,Ds,Du,Dt] * einsum( 'II->', HD['HSabab'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Du,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,R,actfloor:actceil,P], HD['Dbaab'][Dt,Du,Ds,:] ) ))
    return result


def lucc_VACAaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSabab'][P,v,R,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         +HD['HSabab'][P,T,R,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ))
    if s==w:
        result += 2 * fsum(( -HD['HSabab'][P,v,R,T] * HD['Daa'][Dq,Du] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Du,:] ) ))
    if q==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                             -HD['HSabab'][P,T,R,v] * HD['Daa'][Ds,Du] ))
    return result


def lucc_VACAaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==U:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][P,T,w,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             -HD['HSabab'][P,T,w,v] * HD['Daa'][Dq,Ds] ,
                             +einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ))
        if q==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Ds,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VACAaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,P,R,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Ds,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][T,P,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] )
    return result


def lucc_VACAaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSabab'][P,V,R,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         +HD['HSbaab'][T,P,R,V] * HD['Daaaa'][Dq,Du,Ds,Dw] ))
    if q==u:
        result += 2 * +HD['HSabab'][P,V,R,T] * HD['Daa'][Ds,Dw]
    if s==u:
        result += 2 * -HD['HSbaab'][T,P,R,V] * HD['Daa'][Dq,Dw]
    return result


def lucc_VACAaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    if R==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +HD['HSabab'][P,V,u,T] * HD['Daa'][Dq,Ds] ))
        if q==u:
            result += 2 * -einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daa'][Ds,:] )
    return result


def lucc_VACAaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==U:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][T,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,R,q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    return result


def lucc_VACAaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==U:
        result += 2 * fsum(( -HD['HSabab'][q,V,R,T] * HD['Daa'][Ds,Dw] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,R,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ))
    return result


def lucc_VACAaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    if R==W:
        result += 2 * +HD['HSabab'][P,V,U,T] * HD['Daa'][Dq,Ds]
        if P==U:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if P==U:
        result += 2 * +HD['HSbaab'][T,R,W,V] * HD['Daa'][Dq,Ds]
    return result


def lucc_VACCaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSaaaa'][P,w,R,S] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                         -HD['HSaaaa'][P,u,R,S] * HD['Dbaab'][Dt,Dq,Dw,Dv] ))
    if q==u:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Dt,:] )
    if q==w:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][R,S,actfloor:actceil,P], HD['Dbaba'][Dt,Du,Dv,:] )
    return result


def lucc_VACCaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    if q==w:
        if S==U:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -HD['HSabab'][P,T,R,v] ))
        if R==U:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,T,S,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSabab'][P,T,S,v] ))
    if S==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                             +HD['HSabab'][P,T,R,v] * HD['Daa'][Dq,Dw] ))
    if R==U:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,T,S,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                             -HD['HSabab'][P,T,S,v] * HD['Daa'][Dq,Dw] ))
    return result


def lucc_VACCaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    if S==W:
        result += 2 * -HD['HSabab'][P,V,R,T] * HD['Daa'][Dq,Du]
        if q==u:
            result += 2 * +HD['HSabab'][P,V,R,T]
    if q==u:
        if R==W:
            result += 2 * -HD['HSabab'][P,V,S,T]
    if R==W:
        result += 2 * +HD['HSabab'][P,V,S,T] * HD['Daa'][Dq,Du]
    return result


def lucc_VACCaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    if P==U:
        if S==W:
            result += 2 * fsum(( -HD['HSabab'][q,V,R,T] ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,R,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
        if R==W:
            result += 2 * fsum(( +HD['HSabab'][q,V,S,T] ,
                                 -einsum( 'i,i->', HD['HSbaba'][T,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    return result


def lucc_VVAAaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][P,Q,u,actfloor:actceil], HD['Dbaaaba'][Dt,Dr,Ds,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][P,Q,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Du,Dt,:] ) ))
    if r==w:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Ds,Du,Dv,:,:] )
    if s==w:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dt,Dr,Du,Dv,:,:] )
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Ds,Dw,Dt,:,:] )
    if s==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dr,Dw,Dt,:,:] )
    return result


def lucc_VVAAaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * -einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] )
    if P==U:
        result += 2 * +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dr,Ds,:,Dw,Dv,:] )
    return result


def lucc_VVAAaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] )
    if P==U:
        result += 2 * -einsum( 'i,i->', HD['HSabab'][Q,V,actfloor:actceil,T], HD['Daaaa'][Dr,Ds,Dw,:] )
    return result


def lucc_VVAAaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSaaaa'][P,Q,R,u] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                         -HD['HSaaaa'][P,Q,R,w] * HD['Dbaab'][Dv,Ds,Du,Dt] ))
    if s==w:
        result += 2 * +einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSaaaa'][P,Q,R,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] )
    return result


def lucc_VVCAaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Ds,:] )
    if P==U:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,Q], HD['Dbaab'][Dv,Dw,Ds,:] )
    return result


def lucc_VVCAaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * +HD['HSabab'][P,V,R,T] * HD['Daa'][Ds,Dw]
    if P==U:
        result += 2 * -HD['HSabab'][Q,V,R,T] * HD['Daa'][Ds,Dw]
    return result


def lucc_VVCAaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    if R==W:
        if Q==U:
            result += 2 * -einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Daa'][Ds,:] )
        if P==U:
            result += 2 * +einsum( 'i,i->', HD['HSabab'][Q,V,actfloor:actceil,T], HD['Daa'][Ds,:] )
    return result


def lucc_VVCCaaaa_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    if S==W:
        if Q==U:
            result += 2 * +HD['HSabab'][P,V,R,T]
        if P==U:
            result += 2 * -HD['HSabab'][Q,V,R,T]
    if Q==U:
        if R==W:
            result += 2 * -HD['HSabab'][P,V,S,T]
    if R==W:
        if P==U:
            result += 2 * +HD['HSabab'][Q,V,S,T]
    return result


def lucc_AAAAaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dp,Dq,Dr,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dp,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dp,Dq,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaababba'][Du,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaababba'][Du,Dr,Ds,:,Dp,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaababba'][Du,Dp,Dq,:,Dr,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaababba'][Du,Dp,Dq,:,Ds,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][p,T,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][p,T,v,actfloor:actceil], HD['Dbaaaba'][Dw,Dr,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][q,T,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Dp,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][q,T,v,actfloor:actceil], HD['Dbaaaba'][Dw,Dr,Ds,Dp,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][s,T,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dp,Dq,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Dbaaaba'][Dw,Dp,Dq,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][r,T,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dp,Dq,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][r,T,v,actfloor:actceil], HD['Dbaaaba'][Dw,Dp,Dq,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][w,p,T,actfloor:actceil], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,p,T,actfloor:actceil], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][w,q,T,actfloor:actceil], HD['Dbaaaba'][Du,Dr,Ds,Dp,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Dbaaaba'][Du,Dr,Ds,Dp,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][w,s,T,actfloor:actceil], HD['Dbaaaba'][Du,Dp,Dq,Dr,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Dbaaaba'][Du,Dp,Dq,Dr,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][w,r,T,actfloor:actceil], HD['Dbaaaba'][Du,Dp,Dq,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,r,T,actfloor:actceil], HD['Dbaaaba'][Du,Dp,Dq,Ds,Dw,:] ) ))
    return result


def lucc_AAAAaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAAAaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaababba'][Du,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbaababba'][Du,Dr,Ds,:,Dp,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaababba'][Du,Dp,Dq,:,Dr,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaababba'][Du,Dp,Dq,:,Ds,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dp,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dp,Dq,Dr,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dp,Dq,Ds,Du,:,:] ) ))
    return result


def lucc_AAAAaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][p,V,actfloor:actceil,T], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Dbaaaba'][Du,Dr,Ds,Dp,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Dbaaaba'][Du,Dp,Dq,Dr,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][r,V,actfloor:actceil,T], HD['Dbaaaba'][Du,Dp,Dq,Ds,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,p,V,actfloor:actceil], HD['Dbaaaba'][Dw,Dr,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Dbaaaba'][Dw,Dr,Ds,Dp,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Dbaaaba'][Dw,Dp,Dq,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,r,V,actfloor:actceil], HD['Dbaaaba'][Dw,Dp,Dq,Ds,Du,:] ) ))
    return result


def lucc_AAAAaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_AAAAaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAAAaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAAAaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dt,Du,Dr,Ds,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dt,Du,Dr,Ds,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Dt,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,P,s,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dr,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][u,P,s,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dr,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][w,s,P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dq,Dr,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,s,P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dq,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][w,P,s,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dr,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,P,s,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dr,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,s,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][u,s,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Dr,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,P,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][u,P,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][w,r,P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,r,P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][w,P,r,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][v,P,r,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][t,r,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][u,r,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaababba'][Du,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbaababba'][Dt,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbaababba'][Dv,Dr,Ds,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaababba'][Dw,Dr,Ds,:,Dq,Dt,Du,:] ) ))
    return result


def lucc_CAAAaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][r,T,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][s,T,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Dr,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,s,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dr,Dq,Du,:] ) ,
                         +HD['HSbaab'][T,P,s,v] * HD['Dbaab'][Du,Dq,Dr,Dw] ,
                         +HD['HSbaab'][T,P,r,w] * HD['Dbaab'][Du,Dq,Ds,Dv] ,
                         -HD['HSbaab'][T,P,r,v] * HD['Dbaab'][Du,Dq,Ds,Dw] ,
                         -HD['HSbaab'][T,P,s,w] * HD['Dbaab'][Du,Dq,Dr,Dv] ,
                         +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaababba'][Du,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][w,P,T,actfloor:actceil], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,P,T,actfloor:actceil], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,P,v,actfloor:actceil], HD['Dbaaaba'][Dw,Dr,Ds,Dq,Du,:] ) ,
                         +HD['HSbaba'][v,P,T,r] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                         +HD['HSbaba'][w,P,T,s] * HD['Dbaab'][Dv,Dq,Dr,Du] ,
                         -HD['HSbaba'][v,P,T,s] * HD['Dbaab'][Dw,Dq,Dr,Du] ,
                         -HD['HSbaba'][w,P,T,r] * HD['Dbaab'][Dv,Dq,Ds,Du] ))
    return result


def lucc_CAAAaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaababba'][Du,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,P,s,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dr,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,s,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,P,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,r,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ))
    return result


def lucc_CAAAaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][V,P,actfloor:actceil,T], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dw,:] ) ,
                         -HD['HSbaab'][V,P,s,T] * HD['Dbaab'][Dw,Dq,Dr,Du] ,
                         +HD['HSbaab'][V,P,r,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Dbaaaba'][Dw,Dr,Ds,Dq,Du,:] ) ,
                         +HD['HSbaba'][T,P,V,s] * HD['Dbaab'][Du,Dq,Dr,Dw] ,
                         -HD['HSbaba'][T,P,V,r] * HD['Dbaab'][Du,Dq,Ds,Dw] ))
    return result


def lucc_CAAAaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_CAAAaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VAAAaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dt,Du,Dr,Ds,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dt,Du,Dr,Ds,Dq,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaababba'][Du,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaababba'][Dt,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaababba'][Dv,Dr,Ds,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaababba'][Dw,Dr,Ds,:,Dq,Dt,Du,:] ) ))
    return result


def lucc_VAAAaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaababba'][Du,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][P,w,T,actfloor:actceil], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,v,T,actfloor:actceil], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][P,T,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dr,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][P,T,v,actfloor:actceil], HD['Dbaaaba'][Dw,Dr,Ds,Dq,Du,:] ) ))
    return result


def lucc_VAAAaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaababba'][Du,Dr,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dr,Ds,Dq,Du,:,:] ) ))
    return result


def lucc_VAAAaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][P,V,actfloor:actceil,T], HD['Dbaaaba'][Du,Dr,Ds,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,P,V,actfloor:actceil], HD['Dbaaaba'][Dw,Dr,Ds,Dq,Du,:] ) ))
    return result


def lucc_VAAAaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VAAAaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VACAaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,w,R,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][P,v,R,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][P,t,R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][P,u,R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][t,R,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][u,R,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][w,R,actfloor:actceil,P], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,R,actfloor:actceil,P], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dw,:] ) ))
    return result


def lucc_VACAaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][P,T,R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         +HD['HSabab'][P,w,R,T] * HD['Dbaab'][Dv,Dq,Ds,Du] ,
                         -HD['HSabab'][P,v,R,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                         +HD['HSabab'][P,T,R,w] * HD['Dbaab'][Du,Dq,Ds,Dv] ,
                         -HD['HSabab'][P,T,R,v] * HD['Dbaab'][Du,Dq,Ds,Dw] ,
                         +einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ))
    return result


def lucc_VACAaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,P,R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,R,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ))
    return result


def lucc_VACAaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSabab'][P,V,R,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                         -HD['HSbaab'][T,P,R,V] * HD['Dbaab'][Du,Dq,Ds,Dw] ))
    return result


def lucc_VACAaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VACAaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    return result


def lucc_VACCaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    return result


def lucc_VVCCaaaa_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    return result


def lucc_AAAAbaba_CAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSaaaa'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Ds,Dv,Dp,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dp,Dq,Dv,Dr,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Dbaab'][Dp,Dv,Ds,Dr] ,
                         +HD['HSaa'][s,T] * HD['Dbaab'][Dp,Dq,Dv,Dr] ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dv,Dp,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,:,Dv,Dr,:] ) ,
                         -HD['Dbaab'][Dp,Dv,Ds,Dr] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                         +HD['Dbaab'][Dp,Dq,Dv,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,v,T,actfloor:actceil], HD['Dbaba'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,T,v,actfloor:actceil], HD['Dbaba'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,T,v,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dp,:] ) ,
                         -HD['Dbaab'][Dp,Dv,Ds,Dr] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                         +HD['Dbaab'][Dp,Dq,Dv,Dr] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dp,Dq,:,Dv,Dr,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dv,Dp,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,:,Ds,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dv,Ds,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,q,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,s,T,actfloor:actceil], HD['Dbaab'][Dp,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,v,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,v,T,actfloor:actceil], HD['Dbaab'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,T,v,actfloor:actceil], HD['Dbaab'][Dp,Dq,Ds,:] ) ))
    if s==v:
        result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Dbb'][Dp,Dr] ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dp,:] ) ,
                             +HD['Dbb'][Dp,Dr] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             +HD['Dbb'][Dp,Dr] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dp,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaab'][Dr,:,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dp,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][p,q,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    if q==v:
        result += 2 * fsum(( -HD['HSaa'][s,T] * HD['Dbb'][Dp,Dr] ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dp,:,Dr,:] ) ,
                             -HD['Dbb'][Dp,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Dbb'][Dp,Dr] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dp,:,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaab'][Dp,:,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,s,T,actfloor:actceil], HD['Dbb'][Dp,:] ) ))
    return result


def lucc_AAAAbaba_VAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Ds,Dv,Dp,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dp,Dq,Dv,Dr,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Dbaab'][Dp,Dv,Ds,Dr] ,
                         +HD['HSaa'][s,T] * HD['Dbaab'][Dp,Dq,Dv,Dr] ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,:,Dv,Dp,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dp,Dq,:,Dv,Dr,:] ) ,
                         +HD['Dbaab'][Dp,Dv,Ds,Dr] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                         -HD['Dbaab'][Dp,Dq,Dv,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dv,Ds,:,:] ) ,
                         +HD['Dbaab'][Dp,Dv,Ds,Dr] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                         -HD['Dbaab'][Dp,Dq,Dv,Dr] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dr,Ds,:,Dv,Dp,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dp,Dq,:,Dv,Dr,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,s,actfloor:actceil,T], HD['Dbaab'][Dp,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][p,q,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dv,:] ) ))
    return result


def lucc_AAAAbaba_VCaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,V) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,V,actfloor:actceil,T], HD['Dbaba'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Dbaba'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][T,p,V,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][T,r,V,actfloor:actceil], HD['Dbaab'][Dp,Dq,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][p,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,V,actfloor:actceil,T], HD['Dbaab'][Dp,Dq,Ds,:] ) ))
    return result


def lucc_CAAAbaba_AAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dq,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][t,P,s,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][v,P,s,actfloor:actceil], HD['Dbaab'][Dr,Dt,Dq,:] ) ,
                         -HD['HSabab'][v,P,s,r] * HD['Daa'][Dq,Dt] ,
                         +HD['HSabab'][t,P,s,r] * HD['Daa'][Dq,Dv] ,
                         -einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][t,P,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,v,P,actfloor:actceil], HD['Daaaa'][Dq,Dt,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,t,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ))
    if q==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             +HD['HSbb'][P,r] * HD['Daa'][Ds,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    if q==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dt,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaab'][Dr,:,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Ds,:,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ,
                             +HD['Daa'][Ds,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ,
                             -HD['HSbb'][P,r] * HD['Daa'][Ds,Dt] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ,
                             +HD['Daa'][Ds,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Ds,:,Dt,:] ) ))
    if s==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Dt,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Dt,:,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Dt,Dq,:] ) ,
                             +HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Dt,Dq,:] ) ,
                             -HD['HSbb'][P,r] * HD['Daa'][Dq,Dt] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Dt,Dq,:] ) ,
                             +HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Dt,:,Dq,:] ) ))
    if s==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Dv,:,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ,
                             +HD['HSbb'][P,r] * HD['Daa'][Dq,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ))
    return result


def lucc_CAAAbaba_CAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -HD['HSabab'][v,P,T,r] * HD['Daa'][Dq,Ds] ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,s,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ,
                         -HD['HSbaab'][P,T,s,r] * HD['Daa'][Dq,Dv] ,
                         +HD['HSbaab'][P,T,v,r] * HD['Daa'][Dq,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ))
    if q==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,T,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             +HD['HSbaab'][P,T,s,r] ,
                             +einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if s==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaab'][Dr,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    return result


def lucc_CAAAbaba_VAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][T,P,s,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ,
                         +HD['HSabab'][T,P,s,r] * HD['Daa'][Dq,Dv] ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,r,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Ds,:] ) ))
    return result


def lucc_CAAAbaba_VCaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +HD['HSabab'][T,P,V,r] * HD['Daa'][Dq,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +HD['HSbaba'][P,V,r,T] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_CCAAbaba_AAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,t,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,Q,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ,
                         -HD['HSbaab'][P,Q,v,r] * HD['Daa'][Ds,Dt] ,
                         +HD['HSbaab'][P,Q,t,r] * HD['Daa'][Ds,Dv] ))
    if s==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dt,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,Q,r,actfloor:actceil], HD['Daa'][Dt,:] ) ))
    if s==t:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,Q,r,actfloor:actceil], HD['Daa'][Dv,:] ) ))
    return result


def lucc_CCAAbaba_CAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                         +HD['HSbaab'][P,Q,T,r] * HD['Daa'][Ds,Dv] ))
    if Q==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][v,P,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             -HD['HSabab'][v,P,s,r] ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             +HD['HSbb'][P,r] * HD['Daa'][Ds,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
        if s==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,:,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,:,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbb'][P,r] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             -HD['HSbaab'][P,Q,T,r] ))
    return result


def lucc_CCAAbaba_VAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,Q,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                         -HD['HSbaba'][P,Q,r,T] * HD['Daa'][Ds,Dv] ))
    return result


def lucc_CCAAbaba_VCaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==V:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][T,P,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             +HD['HSabab'][T,P,s,r] ,
                             +einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VAAAbaba_AAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dq,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,q,t,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,q,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ))
    if s==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Dt,:,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,:,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Dt,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dt,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Dt,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Dt,Dq,:] ) ))
    if s==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Dv,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,:,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Dv,Dq,:] ) ))
    if q==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ))
    if q==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ))
    return result


def lucc_VAAAbaba_CAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,q,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,v,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaab'][Dr,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,q,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    if q==v:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] )
    return result


def lucc_VAAAbaba_VAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,q,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dv,:] ) ))
    return result


def lucc_VAAAbaba_VCaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,T,V,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dq,:] ) ))
    return result


def lucc_VACAbaba_AAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,v) = e
    Dq, Ds, Dt, Dv = q-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][t,R,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Daaaa'][Dq,Dt,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,v,R,actfloor:actceil], HD['Daaaa'][Ds,Dt,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,t,R,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         -HD['HSbaba'][P,q,R,t] * HD['Daa'][Ds,Dv] ,
                         +HD['HSbaba'][P,q,R,v] * HD['Daa'][Ds,Dt] ))
    if s==v:
        result += 2 * fsum(( +HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dt,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Daa'][Dt,:] ) ,
                             +HD['HSbb'][P,R] * HD['Daa'][Dq,Dt] ,
                             +HD['Daa'][Dq,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dt,:,Dq,:] ) ))
    if s==t:
        result += 2 * fsum(( -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             -HD['HSbb'][P,R] * HD['Daa'][Dq,Dv] ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ))
    if q==t:
        result += 2 * fsum(( -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             -HD['HSbb'][P,R] * HD['Daa'][Ds,Dv] ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    if q==v:
        result += 2 * fsum(( +HD['Daa'][Ds,Dt] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Ds,:,Dt,:] ) ,
                             +HD['HSbb'][P,R] * HD['Daa'][Ds,Dt] ,
                             +HD['Daa'][Ds,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Ds,:,Dt,:] ) ))
    return result


def lucc_VACAbaba_CAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         +HD['HSbaab'][P,q,T,R] * HD['Daa'][Ds,Dv] ,
                         -HD['HSbaab'][P,v,T,R] * HD['Daa'][Dq,Ds] ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         +HD['HSbaba'][P,T,R,v] * HD['Daa'][Dq,Ds] ))
    if s==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             -HD['HSbaab'][P,q,T,R] ))
    if q==v:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daa'][Ds,:] )
    return result


def lucc_VACAbaba_VAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaa'][Ds,Dv,Dq,:] ) ,
                         -HD['HSbaba'][P,q,R,T] * HD['Daa'][Ds,Dv] ))
    return result


def lucc_VACAbaba_VCaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,V) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][P,T,V,R] * HD['Daa'][Dq,Ds] ,
                         -HD['HSbaba'][P,V,R,T] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_VACCbaba_AAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,v) = e
    Dq, Dt, Dv = q-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][P,v,S,R] * HD['Daa'][Dq,Dt] ,
                         -HD['HSbaab'][P,t,S,R] * HD['Daa'][Dq,Dv] ))
    if q==t:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Daa'][Dv,:] )
    if q==v:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Daa'][Dt,:] )
    return result


def lucc_VACCbaba_CAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][P,T,S,R] * HD['Daa'][Dq,Dv]
    if S==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dv,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +HD['HSbaba'][P,q,R,v] ,
                             -HD['HSbb'][P,R] * HD['Daa'][Dq,Dv] ,
                             -HD['Daa'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dv,:,Dq,:] ) ))
        if q==v:
            result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +HD['HSbb'][P,R] ,
                                 +einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if q==v:
        result += 2 * +HD['HSbaab'][P,T,S,R]
    return result


def lucc_VACCbaba_VAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][P,T,S,R] * HD['Daa'][Dq,Dv]
    return result


def lucc_VACCbaba_VCaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,V) = e
    Dq = q-actfloor
    result = 0
    if S==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             -HD['HSbaba'][P,q,R,T] ))
    return result


def lucc_VVAAbaba_AAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,t,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,Q,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dt,:] ) ))
    if s==v:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dt,:,:] )
    if s==t:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dv,:,:] )
    return result


def lucc_VVAAbaba_CAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] )
    if s==v:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbb'][Dr,:] )
    return result


def lucc_VVAAbaba_VAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dv,:] )
    if Q==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ))
    return result


def lucc_VVAAbaba_VCaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==T:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,V,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] )
    return result


def lucc_VVCAbaba_AAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,v) = e
    Ds, Dt, Dv = s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbaba'][P,Q,R,t] * HD['Daa'][Ds,Dv] ,
                         +HD['HSbaba'][P,Q,R,v] * HD['Daa'][Ds,Dt] ))
    if s==v:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Daa'][Dt,:] )
    if s==t:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Daa'][Dv,:] )
    return result


def lucc_VVCAbaba_CAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    result += 2 * +HD['HSbaab'][P,Q,T,R] * HD['Daa'][Ds,Dv]
    if s==v:
        result += 2 * -HD['HSbaab'][P,Q,T,R]
    return result


def lucc_VVCAbaba_VAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    result += 2 * -HD['HSbaba'][P,Q,R,T] * HD['Daa'][Ds,Dv]
    if Q==T:
        result += 2 * fsum(( -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Ds,:,Dv,:] ) ,
                             -HD['HSbb'][P,R] * HD['Daa'][Ds,Dv] ,
                             -HD['Daa'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Ds,:,Dv,:] ) ))
    return result


def lucc_VVCAbaba_VCaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,V) = e
    Ds = s-actfloor
    result = 0
    if Q==T:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,V,R,actfloor:actceil], HD['Daa'][Ds,:] )
    return result


def lucc_VVCCbaba_AAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCCbaba_CAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    if S==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                             +HD['HSbaba'][P,Q,R,v] ))
    return result


def lucc_VVCCbaba_VAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Daa'][Dv,:] )
    return result


def lucc_VVCCbaba_VCaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,V) = e
    result = 0
    if Q==T:
        result += 2 * -HD['HSbaab'][P,V,S,R]
        if S==V:
            result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -HD['HSbb'][P,R] ,
                                 -einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if S==V:
        result += 2 * -HD['HSbaba'][P,Q,R,T]
    return result


def lucc_AAAAbaba_CAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dq,Ds,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dv,Dq,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Ds,Dp,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Dr,Ds,:,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Dp,Dq,:,Dr,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][q,T,v,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Dbaba'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +HD['Dbaab'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         -HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Dbaba'][Dp,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Dbaba'][Dp,Dq,Dr,:] ) ,
                         -HD['HSbb'][p,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         +HD['HSbb'][r,T] * HD['Dbaab'][Dp,Dq,Ds,Dv] ,
                         -HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbaab'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dp,Dq,:,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbaab'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbaab'][Dp,Dq,Ds,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dp,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Ds,:,Dp,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['HSbb'][p,T] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Ds,:,Dq,:] ) ))
    if p==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Dq,:,Dr,:] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             -HD['HSbb'][r,T] * HD['Daa'][Dq,Ds] ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Dq,:,Ds,:] ) ))
    return result


def lucc_AAAAbaba_VAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dq,Ds,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Dp,Dq,:,Dr,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Dr,Ds,:,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -HD['Dbaab'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Ds,Dp,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dv,Dq,Dr,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,s,actfloor:actceil,T], HD['Dbaba'][Dp,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,q,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         -HD['HSbb'][p,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         +HD['HSbb'][r,T] * HD['Dbaab'][Dp,Dq,Ds,Dv] ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         -HD['Dbaab'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dp,Dq,:,Ds,Dv,:] ) ))
    return result


def lucc_AAAAbaba_VCbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,V) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Dbaba'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Dbaba'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbaab'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbaab'][Dp,Dq,Ds,:] ) ))
    return result


def lucc_CAAAbaba_AAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dq,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dq,Dt,:] ) ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaab'][Dt,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,s,P,actfloor:actceil], HD['Dbaba'][Dt,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][t,s,P,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         +HD['HSbb'][P,v] * HD['Dbaab'][Dt,Dq,Ds,Dr] ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaab'][Dt,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbaab'][Dt,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ))
    if r==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dt,Ds,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaab'][Dt,:,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ))
    if r==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaab'][Dv,:,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ))
    return result


def lucc_CAAAbaba_CAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                         -HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         -HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         -HD['HSbbbb'][v,P,T,r] * HD['Daa'][Dq,Ds] ,
                         -HD['HSbbbb'][P,T,r,v] * HD['Daa'][Dq,Ds] ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Ds,:,Dv,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dq,:,Dr,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dq,:,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dv,Dq,:,Dr,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dabba'][Dq,:,Dr,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,:,Ds,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][v,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -HD['HSbb'][r,v] * HD['Daa'][Dq,Ds] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dq,:,Ds,:] ) ))
        if r==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,:,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dq,:,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Ds,:,Dq,:] ) ))
    return result


def lucc_CAAAbaba_VAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,s,P,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbababb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ))
    return result


def lucc_CAAAbaba_VCbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +HD['HSbbbb'][T,P,V,r] * HD['Daa'][Dq,Ds] ,
                         +HD['HSbbbb'][P,V,r,T] * HD['Daa'][Dq,Ds] ))
    if P==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dabba'][Dq,:,Dr,:] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][r,s,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                             +HD['HSbb'][r,T] * HD['Daa'][Dq,Ds] ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dq,:,Ds,:] ) ))
    return result


def lucc_CCAAbaba_AAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbaab'][P,Q,s,v] * HD['Dbb'][Dr,Dt] ,
                         +HD['HSbaab'][P,Q,s,t] * HD['Dbb'][Dr,Dv] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,Q,t,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dt,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,Q,s,actfloor:actceil], HD['Dbb'][Dt,:] ) ))
    if r==t:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Ds,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,Q,s,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_CCAAbaba_CAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         -HD['HSbaba'][P,Q,T,s] * HD['Dbb'][Dr,Dv] ))
    if P==T:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +HD['HSaa'][Q,s] * HD['Dbb'][Dr,Dv] ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                             -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][r,s,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][v,Q,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             +HD['HSbaab'][v,Q,s,r] ,
                             -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,Q,r,actfloor:actceil], HD['Daa'][Ds,:] ) ))
        if r==v:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSaa'][Q,s] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['HSbaba'][P,Q,T,s] ))
    return result


def lucc_CCAAbaba_VAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         +HD['HSbaab'][P,Q,s,T] * HD['Dbb'][Dr,Dv] ))
    return result


def lucc_CCAAbaba_VCbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,Q,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             -HD['HSbaab'][T,Q,s,r] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,Q,r,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VAAAbaba_AAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dq,:,:] ) ))
    result += 2 * fsum(( +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaab'][Dt,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,q,t,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,q,v,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dt,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         +HD['HSbb'][P,v] * HD['Dbaab'][Dt,Dq,Ds,Dr] ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaab'][Dt,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dq,Dt,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dt,Ds,:,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,:,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Ds,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,:,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ))
    return result


def lucc_VAAAbaba_CAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         -HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['HSbb'][P,T] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Ds,:,Dq,:] ) ))
    return result


def lucc_VAAAbaba_VAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,q,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         +HD['Dbaab'][Dv,Dq,Ds,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dr,Ds,:,Dq,Dv,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Ds,:,Dv,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dq,:,Dr,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dq,:,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dv,Dq,:,Dr,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,:,Ds,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ))
    return result


def lucc_VAAAbaba_VCbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dq,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,V,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabba'][Dq,:,Dr,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                             +HD['HSbb'][r,V] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dq,:,Ds,:] ) ))
    return result


def lucc_VACAbaba_AAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,v) = e
    Dq, Ds, Dt, Dv = q-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbaab'][Dt,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbaab'][Dt,Dq,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ))
    return result


def lucc_VACAbaba_CAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                         +HD['HSbbbb'][P,v,R,T] * HD['Daa'][Dq,Ds] ,
                         +HD['HSbbbb'][P,T,R,v] * HD['Daa'][Dq,Ds] ))
    if R==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,:,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,v,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             +HD['HSbb'][P,v] * HD['Daa'][Dq,Ds] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             -HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Ds,:,Dq,:] ) ))
    return result


def lucc_VACAbaba_VAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ))
    if P==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dq,:,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,:,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,R,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ))
    return result


def lucc_VACAbaba_VCbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,V) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,V,R,T] * HD['Daa'][Dq,Ds] ,
                         -HD['HSbbbb'][P,T,R,V] * HD['Daa'][Dq,Ds] ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][q,V,R,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             +HD['HSbb'][R,V] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dq,:,Ds,:] ) ))
        if R==V:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,:,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dq,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if R==V:
        result += 2 * fsum(( +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,q,actfloor:actceil,T], HD['Daa'][Ds,:] ) ,
                             -HD['HSbb'][P,T] * HD['Daa'][Dq,Ds] ,
                             +HD['Daa'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Ds,:,Dq,:] ) ))
    return result


def lucc_VACCbaba_AAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,v) = e
    Dq, Dt, Dv = q-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VACCbaba_CAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbaab'][Dv,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,S,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,q,S,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbaab'][P,q,S,v] ))
    return result


def lucc_VACCbaba_VAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][R,S,q,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    return result


def lucc_VACCbaba_VCbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,V) = e
    Dq = q-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +HD['HSabab'][q,V,S,R] ,
                             -einsum( 'i,i->', HD['HSbaba'][R,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
        if R==V:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,:,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -HD['HSaa'][q,S] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'II->', HD['HSaaaa'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'II->', HD['HSabab'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dq,:,:,:] ) ))
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,S,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                             +HD['HSbaab'][P,q,S,T] ))
    return result


def lucc_VVAAbaba_AAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,Q,t,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dt,:] ) ))
    if r==v:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Ds,:,:] )
    if r==t:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Ds,:,:] )
    return result


def lucc_VVAAbaba_CAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] )
    if r==v:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Daa'][Ds,:] )
    return result


def lucc_VVAAbaba_VAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dv,:] )
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ))
    return result


def lucc_VVAAbaba_VCbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'ij,ij->', HD['HSabab'][Q,V,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Ds,:,:] )
    return result


def lucc_VVCAbaba_AAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,v) = e
    Ds, Dt, Dv = s-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCAbaba_CAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Ds,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VVCAbaba_VAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    if P==T:
        result += 2 * -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] )
    return result


def lucc_VVCAbaba_VCbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,V) = e
    Ds = s-actfloor
    result = 0
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSabba'][Q,V,R,actfloor:actceil], HD['Daa'][Ds,:] )
        if R==V:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,:,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Ds,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if R==V:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Daa'][Ds,:] )
    return result


def lucc_VVCCbaba_AAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCCbaba_CAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,S,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbaab'][P,Q,S,v] ))
    return result


def lucc_VVCCbaba_VAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][R,S,actfloor:actceil,Q], HD['Dbb'][Dv,:] )
    return result


def lucc_VVCCbaba_VCbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,V) = e
    result = 0
    if P==T:
        result += 2 * +HD['HSabab'][Q,V,S,R]
        if R==V:
            result += 2 * fsum(( -HD['HSaa'][Q,S] ,
                                 -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'II->', HD['HSabab'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if R==V:
        result += 2 * +HD['HSbaab'][P,Q,S,T]
    return result


def lucc_AAAAbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dr,Ds,Dv,Dw,Du,Dp,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dp,Dq,Dv,Dw,Du,Dr,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Dbaaaab'][Dp,Dv,Dw,Ds,Du,Dr] ,
                         +HD['HSaa'][s,T] * HD['Dbaaaab'][Dp,Dq,Du,Dv,Dw,Dr] ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dv,Dw,Dp,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaaaba'][Dp,Dq,Du,:,Dv,Dw,Dr,:] ) ,
                         +HD['Dbaaaab'][Dp,Dq,Du,Dv,Dw,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                         -HD['Dbaaaab'][Dp,Dv,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,w,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dv,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][q,T,w,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Dv,Du,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][q,T,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Dw,Du,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,w,T,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Du,Dv,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,v,T,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Du,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][s,T,w,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Dv,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,T,v,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Dw,Du,Dr,:] ) ,
                         -HD['HSaaaa'][s,T,v,w] * HD['Dbaab'][Dp,Dq,Du,Dr] ,
                         +HD['HSaaaa'][q,T,v,w] * HD['Dbaab'][Dp,Du,Ds,Dr] ,
                         -HD['Dbaaaab'][Dp,Dv,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                         +HD['Dbaaaab'][Dp,Dq,Du,Dv,Dw,Dr] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaabaabb'][Dp,Dq,Du,:,Dv,Dw,Dr,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dv,Dw,Dp,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaaaab'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dp,Dq,Dv,Dw,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,T,w,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dv,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,T,v,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,q,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,s,T,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,w,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,v,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,T,w,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,T,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,w,T,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,v,T,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,:] ) ))
    if s==w:
        result += 2 * fsum(( +HD['HSaa'][q,T] * HD['Dbaab'][Dp,Dv,Du,Dr] ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dv,Dp,:] ) ,
                             +HD['Dbaab'][Dp,Dv,Du,Dr] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][q,v,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dp,:] ) ,
                             +HD['Dbaab'][Dp,Dv,Du,Dr] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dv,Dp,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dv,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][p,q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][p,v,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][r,T,v,actfloor:actceil], HD['Dbaab'][Dp,Dq,Du,:] ) ))
    if s==v:
        result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Dbaab'][Dp,Dw,Du,Dr] ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dp,:] ) ,
                             -HD['Dbaab'][Dp,Dw,Du,Dr] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][q,w,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dp,:] ) ,
                             -HD['Dbaab'][Dp,Dw,Du,Dr] * einsum( 'II->', HD['HSabab'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dp,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dw,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,T,w,actfloor:actceil], HD['Dbaab'][Dp,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][p,q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][p,w,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ))
    if q==w:
        result += 2 * fsum(( -HD['HSaa'][s,T] * HD['Dbaab'][Dp,Du,Dv,Dr] ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dp,Du,:,Dv,Dr,:] ) ,
                             -HD['Dbaab'][Dp,Du,Dv,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][s,v,T,actfloor:actceil], HD['Dbaba'][Dp,Du,Dr,:] ) ,
                             -HD['Dbaab'][Dp,Du,Dv,Dr] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dp,Du,:,Dv,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dp,Du,:,Ds,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,s,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][r,v,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][p,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ))
    if q==v:
        result += 2 * fsum(( +HD['HSaa'][s,T] * HD['Dbaab'][Dp,Du,Dw,Dr] ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dp,Du,:,Dw,Dr,:] ) ,
                             +HD['Dbaab'][Dp,Du,Dw,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,w,T,actfloor:actceil], HD['Dbaba'][Dp,Du,Dr,:] ) ,
                             +HD['Dbaab'][Dp,Du,Dw,Dr] * einsum( 'II->', HD['HSabab'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dp,Du,:,Dw,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dp,Du,:,Ds,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][p,T,w,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][r,s,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,w,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Ds,:] ) ))
    return result


def lucc_AAAAbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Dbaaaba'][Dp,Dv,Dw,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dv,Dw,Dq,Dp,:] ) ,
                         +HD['HSaaaa'][q,w,T,U] * HD['Dbaab'][Dp,Dv,Ds,Dr] ,
                         -HD['HSaaaa'][q,v,T,U] * HD['Dbaab'][Dp,Dw,Ds,Dr] ,
                         -HD['HSaaaa'][s,w,T,U] * HD['Dbaab'][Dp,Dq,Dv,Dr] ,
                         +HD['HSaaaa'][s,v,T,U] * HD['Dbaab'][Dp,Dq,Dw,Dr] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Dbaba'][Dp,Dv,Dr,:] ) ,
                             +HD['HSaaaa'][q,v,T,U] * HD['Dbb'][Dp,Dr] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Dbaba'][Dp,Dw,Dr,:] ) ,
                             -HD['HSaaaa'][q,w,T,U] * HD['Dbb'][Dp,Dr] ))
    if q==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Dbaba'][Dr,Dv,Dp,:] ) ,
                             -HD['HSaaaa'][s,v,T,U] * HD['Dbb'][Dp,Dr] ))
    if q==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Dbaba'][Dr,Dw,Dp,:] ) ,
                             +HD['HSaaaa'][s,w,T,U] * HD['Dbb'][Dp,Dr] ))
    return result


def lucc_AAAAbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dp,Dq,Dv,Dw,Du,Dr,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dr,Ds,Dv,Dw,Du,Dp,:,:] ) ))
    result += 2 * fsum(( -HD['HSaa'][q,T] * HD['Dbaaaab'][Dp,Dv,Dw,Ds,Du,Dr] ,
                         +HD['HSaa'][s,T] * HD['Dbaaaab'][Dp,Dq,Du,Dv,Dw,Dr] ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dv,Dw,Dp,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaaaba'][Dp,Dq,Du,:,Dv,Dw,Dr,:] ) ,
                         +HD['Dbaaaab'][Dp,Dv,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,T] ) ,
                         -HD['Dbaaaab'][Dp,Dq,Du,Dv,Dw,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,T] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,u,q,actfloor:actceil], HD['Dbaaaba'][Dp,Dv,Dw,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,u,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dv,Dw,Dq,Dp,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dp,Dq,Dv,Dw,Ds,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                         +HD['Dbaaaab'][Dp,Dv,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,T] ) ,
                         -HD['Dbaaaab'][Dp,Dq,Du,Dv,Dw,Dr] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbaabaabb'][Dr,Ds,Du,:,Dv,Dw,Dp,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaabaabb'][Dp,Dq,Du,:,Dv,Dw,Dr,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaaaab'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][p,q,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,s,actfloor:actceil,T], HD['Dbaaaab'][Dp,Dq,Du,Dv,Dw,:] ) ))
    if s==u:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Dv,Dw,Dp,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dp,Dq,:,Dv,Dw,:] ) ))
    if q==u:
        result += +einsum( 'ij,ij->', HD['HSaaaa'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dp,Dv,Dw,Dr,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dp,Dv,Dw,Ds,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ))
    return result


def lucc_AAAAbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][q,V,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Dw,Du,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][s,V,actfloor:actceil,T], HD['Dbaaaba'][Dp,Dq,Du,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Dw,Du,Dr,:] ) ,
                         +HD['HSaaaa'][q,V,u,T] * HD['Dbaab'][Dp,Dw,Ds,Dr] ,
                         -HD['HSaaaa'][s,V,u,T] * HD['Dbaab'][Dp,Dq,Dw,Dr] ,
                         +einsum( 'i,i->', HD['HSabab'][T,r,V,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][T,p,V,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,V,actfloor:actceil,T], HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][p,V,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ))
    if s==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][T,q,V,actfloor:actceil], HD['Dbaba'][Dr,Dw,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][T,p,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,V,actfloor:actceil,T], HD['Dbaab'][Dp,Dq,Dw,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,s,V,actfloor:actceil], HD['Dbaba'][Dp,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][T,r,V,actfloor:actceil], HD['Dbaab'][Dp,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][p,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dw,:] ) ))
    return result


def lucc_AAAAbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][T,q,V,W] * HD['Dbaab'][Dp,Du,Ds,Dr] ,
                         +HD['HSaaaa'][T,s,V,W] * HD['Dbaab'][Dp,Dq,Du,Dr] ))
    if s==u:
        result += 2 * +HD['HSaaaa'][T,q,V,W] * HD['Dbb'][Dp,Dr]
    if q==u:
        result += 2 * -HD['HSaaaa'][T,s,V,W] * HD['Dbb'][Dp,Dr]
    return result


def lucc_AAAAbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][T,U,q,actfloor:actceil], HD['Dbaaaba'][Dp,Dv,Dw,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSaaaa'][T,U,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dv,Dw,Dq,Dp,:] ) ))
    return result


def lucc_AAAAbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSaaaa'][q,V,T,U] * HD['Dbaab'][Dp,Dw,Ds,Dr] ,
                         +HD['HSaaaa'][s,V,T,U] * HD['Dbaab'][Dp,Dq,Dw,Dr] ))
    return result


def lucc_AAAAbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dt,Du,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dt,Du,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Dt,:,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][t,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][u,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][w,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][v,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dw,:] ) ,
                         +HD['HSabab'][t,P,s,r] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                         -HD['HSabab'][u,P,s,r] * HD['Daaaa'][Dq,Dt,Dv,Dw] ,
                         +HD['HSabab'][w,P,s,r] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                         -HD['HSabab'][v,P,s,r] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                         +einsum( 'i,i->', HD['HSabba'][t,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][u,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,w,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dt,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,v,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dt,Du,Ds,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,t,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,u,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Dt,:] ) ))
    if q==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,u,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSbb'][P,r] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
    if q==u:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Dt,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dt,:,Dv,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,:,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,t,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             -HD['HSbb'][P,r] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Daaaa'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Dt,:,Dv,Dw,:] ) ))
    if q==w:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Dv,:,Dt,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,:,Dt,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Dt,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Daaaa'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,v,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             +HD['HSbb'][P,r] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Daaaa'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Dt,Du,:] ) ))
    if q==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Dw,:,Dt,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dw,:,Dt,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dw,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dw,:,Dt,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Daaaa'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,w,P,actfloor:actceil], HD['Daaaa'][Dt,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             -HD['HSbb'][P,r] * HD['Daaaa'][Ds,Dw,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Daaaa'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Dw,:,Dt,Du,:] ) ))
    if s==w:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Dt,Du,:,Dq,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +HD['HSbb'][P,r] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dv,:] ) ))
    if s==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Dt,Du,:,Dq,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             -HD['HSbb'][P,r] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dw,:] ) ))
    if s==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Dv,Dw,:,Dq,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][u,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             +HD['HSbb'][P,r] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Du,:] ) ))
    if s==u:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Dv,Dw,:,Dq,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][t,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -HD['HSbb'][P,r] * HD['Daaaa'][Dq,Dt,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Dt,:] ) ))
    return result


def lucc_CAAAbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][w,P,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +HD['HSabab'][w,P,T,r] * HD['Daaaa'][Dq,Dv,Ds,Du] ,
                         -HD['HSabab'][v,P,T,r] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,w,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -HD['HSbaab'][P,T,w,r] * HD['Daaaa'][Dq,Du,Ds,Dv] ,
                         +HD['HSbaab'][P,T,v,r] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                         -HD['HSbaab'][P,T,s,r] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ))
    if q==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,T,w,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,T,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                             -HD['HSbaab'][P,T,s,r] * HD['Daa'][Du,Dw] ,
                             +HD['HSbaab'][P,T,w,r] * HD['Daa'][Ds,Du] ,
                             -einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ))
    if q==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,T,s,actfloor:actceil], HD['Dbaab'][Dr,Dv,Du,:] ) ,
                             +HD['HSbaab'][P,T,s,r] * HD['Daa'][Du,Dv] ,
                             -HD['HSbaab'][P,T,v,r] * HD['Daa'][Ds,Du] ,
                             +einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ))
    if s==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ,
                             +HD['HSabab'][v,P,T,r] * HD['Daa'][Dq,Du] ,
                             +einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dv,Du,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][w,P,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ,
                             -HD['HSabab'][w,P,T,r] * HD['Daa'][Dq,Du] ,
                             -einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ))
    return result


def lucc_CAAAbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][T,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         +HD['HSabab'][T,P,s,r] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,r,P,actfloor:actceil], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ))
    if q==u:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][T,r,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ))
    if s==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ))
    return result


def lucc_CAAAbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSabab'][T,P,V,r] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +HD['HSbaba'][P,V,r,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             -HD['HSbaba'][P,V,r,T] * HD['Daa'][Ds,Dw] ))
    if s==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] ) ,
                             -HD['HSabab'][T,P,V,r] * HD['Daa'][Dq,Dw] ))
    return result


def lucc_CAAAbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_CAAAbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CCAAbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,t,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,Q,u,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,Q,w,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,Q,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ,
                         +HD['HSbaab'][P,Q,w,r] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                         -HD['HSbaab'][P,Q,v,r] * HD['Daaaa'][Ds,Dw,Dt,Du] ,
                         +HD['HSbaab'][P,Q,t,r] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         -HD['HSbaab'][P,Q,u,r] * HD['Daaaa'][Ds,Dt,Dv,Dw] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dv,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,Q,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ))
    if s==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dw,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,Q,r,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ))
    if s==t:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,Q,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ))
    if s==u:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dt,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,Q,r,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_CCAAbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +HD['HSbaab'][P,Q,T,r] * HD['Daaaa'][Ds,Du,Dv,Dw] ))
    if Q==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][w,P,s,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][v,P,s,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                             -HD['HSabab'][w,P,s,r] * HD['Daa'][Du,Dv] ,
                             +HD['HSabab'][v,P,s,r] * HD['Daa'][Du,Dw] ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSbb'][P,r] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
        if s==w:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dv,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dv,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Du,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Du,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                                 -HD['HSbb'][P,r] * HD['Daa'][Du,Dv] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Du,:,Dv,:] ) ))
        if s==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Du,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 +HD['HSbb'][P,r] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                             -HD['HSbaab'][P,Q,T,r] * HD['Daa'][Du,Dv] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                             +HD['HSbaab'][P,Q,T,r] * HD['Daa'][Du,Dw] ))
    return result


def lucc_CCAAbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][w,P,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             +HD['HSabab'][w,P,T,r] * HD['Daa'][Ds,Dv] ,
                             -HD['HSabab'][v,P,T,r] * HD['Daa'][Ds,Dw] ,
                             +einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ))
        if s==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSabab'][v,P,T,r] ,
                                 -einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daa'][Dv,:] ) ))
        if s==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaab'][Dr,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSabab'][w,P,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSabab'][w,P,T,r] ,
                                 +einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    if Q==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][w,P,U,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][v,P,U,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             -HD['HSabab'][w,P,U,r] * HD['Daa'][Ds,Dv] ,
                             +HD['HSabab'][v,P,U,r] * HD['Daa'][Ds,Dw] ,
                             -einsum( 'i,i->', HD['HSbaba'][r,U,P,actfloor:actceil], HD['Daaaa'][Dv,Dw,Ds,:] ) ))
        if s==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaab'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSabab'][v,P,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSabab'][v,P,U,r] ,
                                 +einsum( 'i,i->', HD['HSbaba'][r,U,P,actfloor:actceil], HD['Daa'][Dv,:] ) ))
        if s==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaab'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabab'][w,P,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSabab'][w,P,U,r] ,
                                 -einsum( 'i,i->', HD['HSbaba'][r,U,P,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_CCAAbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,Q,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -HD['HSbaba'][P,Q,r,T] * HD['Daaaa'][Ds,Du,Dv,Dw] ))
    return result


def lucc_CCAAbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][T,P,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                             -HD['HSabab'][T,P,s,r] * HD['Daa'][Du,Dw] ,
                             -einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ))
        if s==u:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_CCAAbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    if Q==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             +HD['HSabab'][T,P,V,r] * HD['Daa'][Ds,Du] ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSabab'][T,P,V,r] ))
    if s==u:
        if Q==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,P,W,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSabab'][T,P,W,r] ))
    if Q==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,P,W,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             -HD['HSabab'][T,P,W,r] * HD['Daa'][Ds,Du] ))
    return result


def lucc_CCAAbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VAAAbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dt,Du,Dq,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dt,Du,Dq,Dv,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,q,t,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,q,u,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,q,w,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,q,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ))
    if s==w:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Dt,Du,:,Dq,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dv,:] ) ))
    if s==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Dt,Du,:,Dq,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dq,Dw,:] ) ))
    if s==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Dv,Dw,:,Dq,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Du,:] ) ))
    if s==u:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Dv,Dw,:,Dq,Dt,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dt,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,Dt,:] ) ))
    if q==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ))
    if q==u:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Dt,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dt,:,Dv,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ))
    if q==w:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Dv,:,Dt,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,:,Dt,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dt,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ))
    if q==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Dw,:,Dt,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dw,:,Dt,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dt,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ))
    return result


def lucc_VAAAbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,q,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,w,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,v,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,w,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ))
    if s==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,v,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ))
    if s==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,w,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ))
    if q==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,T,w,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ))
    if q==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ))
    return result


def lucc_VAAAbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,q,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ))
    if s==u:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dq,:,:] )
    if q==u:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] )
    return result


def lucc_VAAAbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,T,V,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dw,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][P,T,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] )
    return result


def lucc_VAAAbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VAAAbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VACAbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dt,Du,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dt,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][t,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,w,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,v,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,t,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,u,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                         -HD['HSbaba'][P,q,R,t] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         +HD['HSbaba'][P,q,R,u] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                         -HD['HSbaba'][P,q,R,w] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                         +HD['HSbaba'][P,q,R,v] * HD['Daaaa'][Ds,Dw,Dt,Du] ))
    if s==w:
        result += 2 * fsum(( -HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,v,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             -HD['HSbb'][P,R] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                             -HD['Daaaa'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dv,:] ) ))
    if s==v:
        result += 2 * fsum(( +HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dt,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,w,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dq,:] ) ,
                             +HD['HSbb'][P,R] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                             +HD['Daaaa'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dt,Du,:,Dq,Dw,:] ) ))
    if s==t:
        result += 2 * fsum(( -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,u,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             -HD['HSbb'][P,R] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Du,:] ) ))
    if s==u:
        result += 2 * fsum(( +HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,t,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] ) ,
                             +HD['HSbb'][P,R] * HD['Daaaa'][Dq,Dt,Dv,Dw] ,
                             +HD['Daaaa'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Dt,:] ) ))
    if q==t:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             -HD['HSbb'][P,R] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][t,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             +HD['Daaaa'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dt,:,Dv,Dw,:] ) ,
                             +HD['HSbb'][P,R] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                             +HD['Daaaa'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Dt,:,Dv,Dw,:] ) ))
    if q==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Ds,:] ) ,
                             -HD['Daaaa'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,:,Dt,Du,:] ) ,
                             -HD['HSbb'][P,R] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                             -HD['Daaaa'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Dv,:,Dt,Du,:] ) ))
    if q==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Ds,:] ) ,
                             +HD['Daaaa'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dw,:,Dt,Du,:] ) ,
                             +HD['HSbb'][P,R] * HD['Daaaa'][Ds,Dw,Dt,Du] ,
                             +HD['Daaaa'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Dw,:,Dt,Du,:] ) ))
    return result


def lucc_VACAbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         +HD['HSbaab'][P,q,T,R] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         +HD['HSbaab'][P,w,T,R] * HD['Daaaa'][Dq,Dv,Ds,Du] ,
                         -HD['HSbaab'][P,v,T,R] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -HD['HSbaba'][P,T,R,w] * HD['Daaaa'][Dq,Du,Ds,Dv] ,
                         +HD['HSbaba'][P,T,R,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Daaaa'][Dq,Dv,Du,:] ) ,
                             -HD['HSbaab'][P,q,T,R] * HD['Daa'][Du,Dv] ,
                             +HD['HSbaab'][P,v,T,R] * HD['Daa'][Dq,Du] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +HD['HSbaab'][P,q,T,R] * HD['Daa'][Du,Dw] ,
                             -HD['HSbaab'][P,w,T,R] * HD['Daa'][Dq,Du] ))
    if q==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                             +HD['HSbaba'][P,T,R,w] * HD['Daa'][Ds,Du] ))
    if q==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaa'][Ds,Dv,Du,:] ) ,
                             -HD['HSbaba'][P,T,R,v] * HD['Daa'][Ds,Du] ))
    return result


def lucc_VACAbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daaaaaa'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaaaa'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -HD['HSbaba'][P,q,R,T] * HD['Daaaa'][Ds,Du,Dv,Dw] ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] )
    if s==u:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] )
    return result


def lucc_VACAbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][P,T,V,R] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                         -HD['HSbaba'][P,V,R,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ))
    if q==u:
        result += 2 * +HD['HSbaba'][P,V,R,T] * HD['Daa'][Ds,Dw]
    if s==u:
        result += 2 * -HD['HSbaab'][P,T,V,R] * HD['Daa'][Dq,Dw]
    return result


def lucc_VACAbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VACAbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    return result


def lucc_VACCbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbaab'][P,w,S,R] * HD['Daaaa'][Dq,Dv,Dt,Du] ,
                         +HD['HSbaab'][P,v,S,R] * HD['Daaaa'][Dq,Dw,Dt,Du] ,
                         -HD['HSbaab'][P,t,S,R] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                         +HD['HSbaab'][P,u,S,R] * HD['Daaaa'][Dq,Dt,Dv,Dw] ))
    if q==t:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] )
    if q==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Dt,:] )
    if q==w:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dv,:] )
    if q==v:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Daaaa'][Dt,Du,Dw,:] )
    return result


def lucc_VACCbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][P,T,S,R] * HD['Daaaa'][Dq,Du,Dv,Dw]
    if S==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Dw,:] ) ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Dv,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +HD['HSbaba'][P,q,R,w] * HD['Daa'][Du,Dv] ,
                             -HD['HSbaba'][P,q,R,v] * HD['Daa'][Du,Dw] ,
                             -HD['HSbb'][P,R] * HD['Daaaa'][Dq,Du,Dv,Dw] ,
                             -HD['Daaaa'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Dv,Dw,:,Dq,Du,:] ) ))
        if q==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dv,:,Du,:] ) ,
                                 +HD['HSbb'][P,R] * HD['Daa'][Du,Dv] ,
                                 +HD['Daa'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dv,:,Du,:] ) ))
        if q==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                                 -HD['HSbb'][P,R] * HD['Daa'][Du,Dw] ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    if q==w:
        result += 2 * +HD['HSbaab'][P,T,S,R] * HD['Daa'][Du,Dv]
    if q==v:
        result += 2 * -HD['HSbaab'][P,T,S,R] * HD['Daa'][Du,Dw]
    return result


def lucc_VACCbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    if S==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             +HD['HSbaba'][P,T,R,v] * HD['Daa'][Dq,Dw] ,
                             -HD['HSbaba'][P,T,R,w] * HD['Daa'][Dq,Dv] ))
        if q==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['HSbaba'][P,T,R,w] ))
        if q==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 -HD['HSbaba'][P,T,R,v] ))
    if S==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,U,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dq,:] ) ,
                             -HD['HSbaba'][P,U,R,v] * HD['Daa'][Dq,Dw] ,
                             +HD['HSbaba'][P,U,R,w] * HD['Daa'][Dq,Dv] ))
        if q==v:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,U,R,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSbaba'][P,U,R,w] ))
        if q==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,U,R,actfloor:actceil], HD['Daa'][Dv,:] ) ,
                                 +HD['HSbaba'][P,U,R,v] ))
    return result


def lucc_VACCbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][P,T,S,R] * HD['Daaaa'][Dq,Du,Dv,Dw]
    return result


def lucc_VACCbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    if S==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +HD['HSbaba'][P,q,R,T] * HD['Daa'][Du,Dw] ))
        if q==u:
            result += 2 * -einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daa'][Dw,:] )
    return result


def lucc_VACCbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    if S==W:
        result += 2 * -HD['HSbaba'][P,V,R,T] * HD['Daa'][Dq,Du]
        if q==u:
            result += 2 * +HD['HSbaba'][P,V,R,T]
    if q==u:
        if S==V:
            result += 2 * -HD['HSbaba'][P,W,R,T]
    if S==V:
        result += 2 * +HD['HSbaba'][P,W,R,T] * HD['Daa'][Dq,Du]
    return result


def lucc_VACCbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    return result


def lucc_VVAAbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,t,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,Q,u,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,Q,w,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,Q,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dt,Du,:] ) ))
    if s==w:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dv,:,:] )
    if s==v:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dt,Du,Dw,:,:] )
    if s==t:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Du,:,:] )
    if s==u:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Dv,Dw,Dt,:,:] )
    return result


def lucc_VVAAbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] )
    if s==w:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dv,:] )
    if s==v:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][P,Q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] )
    return result


def lucc_VVAAbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] )
    if Q==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dv,Dw,:] ) ))
    return result


def lucc_VVAAbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,V,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,V,u,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dw,:] ) ))
    return result


def lucc_VVAAbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] )
    if Q==T:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbaaaab'][Dr,Ds,:,Dv,Dw,:] )
    return result


def lucc_VVAAbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dw,:] )
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,U], HD['Dbaab'][Dr,Ds,Dw,:] )
    return result


def lucc_VVAAbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VVCAbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbaba'][P,Q,R,t] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                         +HD['HSbaba'][P,Q,R,u] * HD['Daaaa'][Ds,Dt,Dv,Dw] ,
                         -HD['HSbaba'][P,Q,R,w] * HD['Daaaa'][Ds,Dv,Dt,Du] ,
                         +HD['HSbaba'][P,Q,R,v] * HD['Daaaa'][Ds,Dw,Dt,Du] ))
    if s==w:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dv,:] )
    if s==v:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dt,Du,Dw,:] )
    if s==t:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Dt,:] )
    return result


def lucc_VVCAbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbaab'][P,Q,T,R] * HD['Daaaa'][Ds,Du,Dv,Dw]
    if s==w:
        result += 2 * -HD['HSbaab'][P,Q,T,R] * HD['Daa'][Du,Dv]
    if s==v:
        result += 2 * +HD['HSbaab'][P,Q,T,R] * HD['Daa'][Du,Dw]
    return result


def lucc_VVCAbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbaba'][P,Q,R,T] * HD['Daaaa'][Ds,Du,Dv,Dw]
    if Q==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] ) ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dv,Dw,:] ) ,
                             -HD['HSbb'][P,R] * HD['Daaaa'][Ds,Du,Dv,Dw] ,
                             -HD['Daaaa'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dv,Dw,:] ) ))
    return result


def lucc_VVCAbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,V,R,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             -HD['HSbaba'][P,V,R,u] * HD['Daa'][Ds,Dw] ))
    return result


def lucc_VVCAbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVCAbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] )
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSabab'][U,R,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Ds,:] )
    return result


def lucc_VVCAbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    if Q==U:
        result += 2 * +HD['HSbaba'][P,V,R,T] * HD['Daa'][Ds,Dw]
    if Q==T:
        result += 2 * -HD['HSbaba'][P,V,R,U] * HD['Daa'][Ds,Dw]
    return result


def lucc_VVCAbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    return result


def lucc_VVCCbaba_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbaba_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if S==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Daaaa'][Dv,Dw,Du,:] ) ,
                             +HD['HSbaba'][P,Q,R,w] * HD['Daa'][Du,Dv] ,
                             -HD['HSbaba'][P,Q,R,v] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VVCCbaba_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbaba_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Daaaa'][Dv,Dw,Du,:] )
    return result


def lucc_VVCCbaba_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * +HD['HSbaab'][P,V,S,R] * HD['Daa'][Du,Dw]
        if S==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +HD['HSbb'][P,R] * HD['Daa'][Du,Dw] ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if S==V:
        result += 2 * +HD['HSbaba'][P,Q,R,T] * HD['Daa'][Du,Dw]
    return result


def lucc_VVCCbaba_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if Q==T:
        if S==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,V,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSbaba'][P,V,R,u] ))
        if S==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSbaba'][P,W,R,u] ))
    return result


def lucc_VVCCbaba_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbaba_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if S==V:
        if Q==U:
            result += 2 * -einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Daa'][Dw,:] )
        if Q==T:
            result += 2 * +einsum( 'i,i->', HD['HSabab'][U,R,actfloor:actceil,P], HD['Daa'][Dw,:] )
    return result


def lucc_VVCCbaba_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    if S==W:
        if Q==U:
            result += 2 * +HD['HSbaba'][P,V,R,T]
        if Q==T:
            result += 2 * -HD['HSbaba'][P,V,R,U]
    if Q==U:
        if S==V:
            result += 2 * -HD['HSbaba'][P,W,R,T]
    if S==V:
        if Q==T:
            result += 2 * +HD['HSbaba'][P,W,R,U]
    return result


def lucc_AAAAbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,Dw,Dq,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dp,Dv,Dq,Dw,Ds,Du,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Ds,Dw,Du,Dp,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dp,Dv,Dq,Dw,Du,Dr,:,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][s,T,w,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dq,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][q,T,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dp,:] ) ,
                         +HD['HSabab'][s,T,w,v] * HD['Dbaab'][Dp,Dq,Du,Dr] ,
                         -HD['HSabab'][q,T,w,v] * HD['Dbaab'][Dp,Du,Ds,Dr] ,
                         +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaababba'][Dr,Ds,Du,:,Dw,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaababba'][Dp,Dq,Du,:,Dw,Dr,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Dw,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][q,T,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Dw,Du,Dp,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaaaba'][Dp,Dq,Du,:,Ds,Dw,Dv,:] ) ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][p,w,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Du,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,w,T,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Du,Ds,Dv,:] ) ,
                         -HD['HSbb'][p,T] * HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] ,
                         +HD['HSbb'][r,T] * HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,Dv] ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaabaabb'][Dp,Dq,Du,:,Ds,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dw,Ds,Du,:] ) ))
    if s==w:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dq,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Dr,Du,:,Dp,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dq,Dv,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Du,Dr] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                             +HD['HSbb'][p,T] * HD['Dbaab'][Dv,Dq,Du,Dr] ,
                             +HD['Dbaab'][Dv,Dq,Du,Dr] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbaab'][Dp,Dq,Du,:] ) ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Du,:,Dp,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSbb'][p,T] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ))
    if q==w:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Dp,Du,:,Dr,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dp,Du,:,Ds,Dv,:] ) ,
                             -HD['Dbaab'][Dp,Du,Ds,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Dbaba'][Dp,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Dbaba'][Dp,Du,Dr,:] ) ,
                             -HD['HSbb'][r,T] * HD['Dbaab'][Dp,Du,Ds,Dv] ,
                             -HD['Dbaab'][Dp,Du,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dp,Du,:,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Ds,:] ) ))
        if p==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Du,:,Dr,:] ) ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSbb'][r,T] * HD['Daa'][Ds,Du] ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Ds,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][s,T,w,actfloor:actceil], HD['Dbaab'][Dp,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Ds,Du,:,Dw,Dp,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][p,w,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +HD['HSbb'][p,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dw,:] ) ))
    if p==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][q,T,w,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Daababa'][Dq,Du,:,Dw,Dr,:] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Dq,Du,:,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,w,T,actfloor:actceil], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             -HD['HSbb'][r,T] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Dq,Du,:,Ds,Dw,:] ) ))
    return result


def lucc_AAAAbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dw,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dp,:] ) ,
                         +HD['HSbaab'][p,q,U,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         -HD['HSbaab'][r,s,U,T] * HD['Dbaab'][Dp,Dq,Dw,Dv] ,
                         -HD['HSbaab'][p,w,U,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         -HD['HSbaab'][v,q,U,T] * HD['Dbaab'][Dp,Dw,Ds,Dr] ,
                         +HD['HSbaab'][v,s,U,T] * HD['Dbaab'][Dp,Dq,Dw,Dr] ,
                         +HD['HSbaab'][r,w,U,T] * HD['Dbaab'][Dp,Dq,Ds,Dv] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dp,:] ) ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbbbb'][Dp,Dv,Dr,:] ) ,
                             -HD['HSbaab'][p,q,U,T] * HD['Dbb'][Dr,Dv] ,
                             +HD['HSbaab'][v,q,U,T] * HD['Dbb'][Dp,Dr] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ))
        if r==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbb'][Dp,:] ) ,
                                 +HD['HSbaab'][p,q,U,T] ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbaab'][Dp,Dw,Ds,:] ) ,
                             +HD['HSbaab'][p,w,U,T] * HD['Daa'][Dq,Ds] ,
                             -HD['HSbaab'][p,q,U,T] * HD['Daa'][Ds,Dw] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ))
    if q==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dp,:] ) ,
                             -HD['HSbaab'][v,s,U,T] * HD['Dbb'][Dp,Dr] ,
                             +HD['HSbaab'][r,s,U,T] * HD['Dbb'][Dp,Dv] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbaba'][Dv,Ds,Dp,:] ) ))
        if p==v:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbaab'][r,s,U,T] ,
                                 -einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if p==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] ) ,
                             -HD['HSbaab'][r,w,U,T] * HD['Daa'][Dq,Ds] ,
                             +HD['HSbaab'][r,s,U,T] * HD['Daa'][Dq,Dw] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ))
    return result


def lucc_AAAAbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,Dw,Dq,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dp,Dv,Dq,Dw,Ds,Du,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbaababba'][Dr,Ds,Du,:,Dw,Dp,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaababba'][Dp,Dq,Du,:,Dw,Dr,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaaaba'][Dp,Dq,Du,:,Ds,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dp,Dv,Dq,Dw,Du,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Ds,Dw,Du,Dp,:,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,q,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,s,actfloor:actceil,T], HD['Dbaaaba'][Dp,Dq,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][T,u,q,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dw,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,u,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dp,:] ) ,
                         -HD['HSbaab'][p,q,u,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         +HD['HSbaab'][r,s,u,T] * HD['Dbaab'][Dp,Dq,Dw,Dv] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,u,r,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,u,p,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         -HD['HSbb'][p,T] * HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] ,
                         +HD['HSbb'][r,T] * HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,Dv] ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         -HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaabaabb'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaabaabb'][Dp,Dq,Du,:,Ds,Dw,Dv,:] ) ))
    if q==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dw,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dv,Dw,Dr,:,:] ) ,
                             +HD['HSbb'][p,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ))
    if s==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dp,Dq,:,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dp,Dq,Dw,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Dw,Dp,:,:] ) ,
                             -HD['HSbb'][r,T] * HD['Dbaab'][Dp,Dq,Dw,Dv] ,
                             +HD['Dbaab'][Dp,Dq,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dp,Dq,:,Dw,Dv,:] ) ))
    return result


def lucc_AAAAbaba_VACAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Dbaaaba'][Dp,Dq,Du,Dw,Dr,:] ) ,
                         +HD['HSabab'][q,V,u,T] * HD['Dbaab'][Dp,Dw,Ds,Dr] ,
                         -HD['HSabab'][s,V,u,T] * HD['Dbaab'][Dp,Dq,Dw,Dr] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Dw,Du,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Dbaaaba'][Dp,Dq,Dw,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbaaaab'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbaaaab'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ))
    if s==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Dbaba'][Dr,Dw,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbaab'][Dp,Dq,Dw,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Dbaba'][Dp,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbaab'][Dp,Dw,Ds,:] ) ))
    return result


def lucc_AAAAbaba_VACCbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][T,q,W,V] * HD['Dbaab'][Dp,Du,Ds,Dr] ,
                         -HD['HSbaab'][T,s,W,V] * HD['Dbaab'][Dp,Dq,Du,Dr] ))
    if s==u:
        result += 2 * -HD['HSbaab'][T,q,W,V] * HD['Dbb'][Dp,Dr]
    if q==u:
        result += 2 * +HD['HSbaab'][T,s,W,V] * HD['Dbb'][Dp,Dr]
    return result


def lucc_AAAAbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,q,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dw,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dp,:] ) ,
                         -HD['HSbaab'][p,q,U,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         +HD['HSbaab'][r,s,U,T] * HD['Dbaab'][Dp,Dq,Dw,Dv] ,
                         +einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dp,:] ) ))
    return result


def lucc_AAAAbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSabab'][q,V,U,T] * HD['Dbaab'][Dp,Dw,Ds,Dr] ,
                         -HD['HSabab'][s,V,U,T] * HD['Dbaab'][Dp,Dq,Dw,Dr] ))
    return result


def lucc_AAAAbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dt,Ds,Du,Dq,Dw,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,Dw,Dq,Du,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,:,Dq,Du,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dt,Ds,:,Dq,Dw,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Ds,Dw,Dq,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dt,Ds,Du,Dq,Dv,:,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][w,P,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][u,P,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                         -HD['HSabab'][u,P,s,r] * HD['Dbaab'][Dt,Dq,Dw,Dv] ,
                         +HD['HSabab'][w,P,s,r] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaaaaaba'][Dr,Ds,Dw,:,Dq,Du,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][u,P,r,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                         -HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][t,u,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,w,P,actfloor:actceil], HD['Dbaaaba'][Dt,Dq,Du,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,s,P,actfloor:actceil], HD['Dbaaaba'][Dt,Dq,Du,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][t,s,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,w,P,actfloor:actceil], HD['Dbaaaba'][Dt,Dq,Du,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,u,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dt,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] ,
                         +HD['HSbb'][P,v] * HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,Dr] ,
                         -HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Dw,:,Dq,Du,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ))
    if q==u:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dt,Ds,:,Dw,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dt,Ds,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dt,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][t,s,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                             +HD['HSbb'][P,t] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -HD['HSbb'][P,r] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dt,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dt,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if q==w:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dv,Ds,:,Du,Dt,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Ds,:,Du,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,:,Du,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,:,Du,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Du,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                             -HD['Dbaab'][Dv,Ds,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbaab'][Dr,Ds,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,s,P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                             -HD['HSbb'][P,v] * HD['Dbaab'][Dr,Ds,Du,Dt] ,
                             +HD['HSbb'][P,r] * HD['Dbaab'][Dv,Ds,Du,Dt] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                             -HD['Dbaab'][Dv,Ds,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbaab'][Dr,Ds,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Du,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Du,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbaab'][Dt,Du,Ds,:] ) ))
    if s==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dt,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +HD['HSbb'][P,r] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ))
        if r==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dq,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Du,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ))
    if s==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Dq,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -HD['HSbb'][P,r] * HD['Dbaab'][Dt,Dq,Dw,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
        if r==t:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Dq,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dt,Ds,Du,:,Dq,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dt,Ds,Du,:,Dq,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaab'][Dt,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][w,P,s,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dv,Ds,Dw,:,Dq,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Ds,Dw,:,Dq,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][u,P,s,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ))
    return result


def lucc_CAAAbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                         -HD['HSabba'][w,P,T,s] * HD['Dbaab'][Dv,Dq,Du,Dr] ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                         -HD['HSbbbb'][v,P,T,r] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         -HD['HSbbbb'][P,T,r,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Dq,Dw,:,Du,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSaaaa'][q,w,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Ds,Du,Dv,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dv,Dq,Dw,:,Ds,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                             -HD['HSaa'][s,w] * HD['Dbaab'][Dv,Dq,Du,Dr] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,:,Du,Dr,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Du,Dr] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dv,Dq,Dw,:,Du,Dr,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbababb'][Dv,Dq,:,Du,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,v,actfloor:actceil], HD['Daababa'][Dq,Dw,:,Du,Dr,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Du,Dr] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dq,Dw,:,Ds,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,:,Ds,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][v,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,s,w,actfloor:actceil], HD['Dbaab'][Dv,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,w,s,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ,
                             -HD['HSbaab'][r,s,w,v] * HD['Daa'][Dq,Du] ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,w,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                             -HD['HSbb'][r,v] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Ds,Du,:] ) ))
        if s==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Du,:,Dv,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dq,:,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dr,Du,:,Dv,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dq,Du,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][v,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Du,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dv,Dq,Du,:] ) ,
                                 +HD['HSbb'][r,v] * HD['Daa'][Dq,Du] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dq,Du,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if r==v:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Du,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,w,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['HSaa'][s,w] * HD['Daa'][Dq,Du] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Du,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ))
    if s==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dq,Dv,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Du,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dv,Dq,Du,Dr] ,
                             +HD['Dbaab'][Dv,Dq,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ,
                             +HD['HSbbbb'][v,P,T,r] * HD['Daa'][Dq,Du] ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][P,T] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +HD['HSabba'][w,P,T,s] * HD['Daa'][Dq,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dw,:] ) ))
    if q==w:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             +HD['HSbbbb'][P,T,r,v] * HD['Daa'][Ds,Du] ))
    return result


def lucc_CAAAbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSabab'][w,P,U,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ))
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dq,Dw,Dr,:,:] )
        result += 2 * fsum(( -HD['HSaa'][q,U] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSaaaa'][q,w,U,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,U,w,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,q,U,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,U,w,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -HD['HSbaab'][r,U,w,v] * HD['Daa'][Dq,Ds] ,
                             +einsum( 'i,i->', HD['HSbaba'][r,U,v,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ))
        if s==w:
            result += 2 * fsum(( +HD['HSaa'][q,U] * HD['Dbb'][Dr,Dv] ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dq,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][v,q,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][r,U,v,actfloor:actceil], HD['Daa'][Dq,:] ) ))
            if r==v:
                result += 2 * fsum(( -HD['HSaa'][q,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][s,U,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * fsum(( +HD['HSaa'][q,U] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,U,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][q,w,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,U,w,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
    if r==v:
        result += 2 * fsum(( -HD['HSabab'][w,P,U,T] * HD['Daa'][Dq,Ds] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ))
        if s==w:
            result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Daa'][Dq,:] )
    if s==w:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] )
    return result


def lucc_CAAAbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,u,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,s,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaabaabb'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,s,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if s==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] )
    return result


def lucc_CAAAbaba_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +HD['HSbbbb'][P,V,r,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         +HD['HSbbbb'][T,P,V,r] * HD['Daaaa'][Dq,Du,Ds,Dw] ))
    if P==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Daababa'][Dq,Du,:,Dw,Dr,:] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Dq,Du,:,Ds,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,s,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,u,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] ) ,
                             +HD['HSbaab'][r,s,u,T] * HD['Daa'][Dq,Dw] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,u,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ,
                             +HD['HSbb'][r,T] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Dq,Du,:,Ds,Dw,:] ) ))
        if s==u:
            result += 2 * fsum(( +HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Dq,:,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dw,:,:] ) ,
                                 -HD['HSbb'][r,T] * HD['Daa'][Dq,Dw] ,
                                 +HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Dq,:,Dw,:] ) ))
    if s==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] ) ,
                             -HD['HSbbbb'][T,P,V,r] * HD['Daa'][Dq,Dw] ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             -HD['HSbbbb'][P,V,r,T] * HD['Daa'][Ds,Dw] ))
    return result


def lucc_CAAAbaba_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][r,W,actfloor:actceil,T], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,q,W,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             +HD['HSbaab'][r,W,u,T] * HD['Daa'][Dq,Ds] ))
        if s==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][r,W,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][T,q,W,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    return result


def lucc_CAAAbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] )
    return result


def lucc_CAAAbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] ) ,
                             +HD['HSbaab'][r,s,U,T] * HD['Daa'][Dq,Dw] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ))
    return result


def lucc_CAAAbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==V:
        result += 2 * +HD['HSbaab'][r,W,U,T] * HD['Daa'][Dq,Ds]
    return result


def lucc_CCAAbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,u,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,Q,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                         +HD['HSbaab'][P,Q,u,t] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         -HD['HSbaab'][P,Q,w,v] * HD['Dbaab'][Dr,Ds,Du,Dt] ,
                         +HD['HSbaab'][P,Q,s,v] * HD['Dbaab'][Dr,Dw,Du,Dt] ,
                         -HD['HSbaab'][P,Q,s,t] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         +HD['HSbaab'][P,Q,w,r] * HD['Dbaab'][Dv,Ds,Du,Dt] ,
                         -HD['HSbaab'][P,Q,u,r] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                         +einsum( 'i,i->', HD['HSbaba'][P,Q,t,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Dw,Du,Dt,:] ) ))
    if s==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,Du,Dv,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,Q,r,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ))
        if r==v:
            result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Du,:,:] )
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,Q,s,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ))
    if s==u:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Dw,Dt,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,Q,r,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ))
        if r==t:
            result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    if r==t:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,Q,s,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    return result


def lucc_CCAAbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +HD['HSbaba'][P,Q,T,s] * HD['Dbaab'][Dr,Du,Dw,Dv] ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Ds,Du,Dv,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -HD['HSaa'][Q,s] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,Q,s,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,s,Q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,Q,s,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                             -HD['HSbaab'][v,Q,s,r] * HD['Daa'][Du,Dw] ,
                             -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daababa'][Ds,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,Q,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][w,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['HSaa'][Q,s] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,Q,s,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
            if s==w:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ))
        if s==w:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dr,Du,:,Dv,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dr,Du,:,Dv,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Du,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dabba'][Du,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][v,Q,r,actfloor:actceil], HD['Daa'][Du,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             -HD['HSbaba'][P,Q,T,s] * HD['Daa'][Du,Dw] ))
        if s==w:
            result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Daa'][Du,:] )
    if s==w:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] )
    return result


def lucc_CCAAbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][P,Q,U,T] * HD['Dbaab'][Dr,Ds,Dw,Dv]
    if P==T:
        result += 2 * fsum(( -HD['HSaa'][Q,U] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][w,Q,U,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSaaaa'][s,U,Q,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                             -HD['HSaaaa'][w,Q,U,s] * HD['Dbb'][Dr,Dv] ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,Q,U,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,U,Q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                             -HD['HSbaab'][v,Q,U,r] * HD['Daa'][Ds,Dw] ))
        if Q==U:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dw,:,Dr,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Ds,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 -HD['HSaa'][s,w] * HD['Dbb'][Dr,Dv] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Dr,:] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dv,Dw,:,Dr,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dabba'][Dw,:,Dr,:] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaab'][Dv,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][r,s,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][v,w,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbaab'][r,s,w,v] ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][v,w,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][r,s,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 -HD['HSbb'][r,v] * HD['Daa'][Ds,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ))
            if r==v:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +HD['HSaa'][s,w] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][s,:actfloor,:actfloor,w] ) ))
            if s==w:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +HD['HSbb'][r,v] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==w:
            result += 2 * fsum(( +HD['HSaa'][Q,U] * HD['Dbb'][Dr,Dv] ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][r,U,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][v,Q,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbaab'][v,Q,U,r] ))
            if r==v:
                result += 2 * fsum(( -HD['HSaa'][Q,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( +HD['HSaa'][Q,U] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][s,U,Q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][w,Q,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSaaaa'][w,Q,U,s] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
    if Q==U:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                             -HD['HSabba'][w,P,T,s] * HD['Dbb'][Dr,Dv] ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             -HD['HSbbbb'][v,P,T,r] * HD['Daa'][Ds,Dw] ))
        if s==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][P,T] * HD['Dbb'][Dr,Dv] ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSbbbb'][v,P,T,r] ))
            if r==v:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                     -HD['HSbb'][P,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSabba'][w,P,T,s] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][P,T] * HD['Daa'][Ds,Dw] ,
                                 +HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ))
    if s==w:
        result += 2 * +HD['HSbaab'][P,Q,U,T] * HD['Dbb'][Dr,Dv]
        if r==v:
            result += 2 * -HD['HSbaab'][P,Q,U,T]
    if r==v:
        result += 2 * +HD['HSbaab'][P,Q,U,T] * HD['Daa'][Ds,Dw]
    return result


def lucc_CCAAbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +HD['HSbaab'][P,Q,u,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         -HD['HSbaab'][P,Q,s,T] * HD['Dbaab'][Dr,Du,Dw,Dv] ))
    return result


def lucc_CCAAbaba_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,Q,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                             +HD['HSbaab'][T,Q,s,r] * HD['Daa'][Du,Dw] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,Q,r,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ))
        if s==u:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Dw,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,Q,r,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_CCAAbaba_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    if Q==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             +HD['HSbbbb'][T,P,V,r] * HD['Daa'][Ds,Du] ))
        if P==V:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dabba'][Du,:,Dr,:] ) ,
                                 -HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][r,s,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][T,u,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbaab'][r,s,u,T] ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,u,r,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSbb'][r,T] * HD['Daa'][Ds,Du] ,
                                 -HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Ds,:] ) ))
            if s==u:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][r,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][T,P,V,r] ))
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,Q,W,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] ) ,
                             +HD['HSbaab'][T,Q,W,r] * HD['Daa'][Ds,Du] ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,Q,W,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbaab'][T,Q,W,r] ))
    return result


def lucc_CCAAbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbaab'][P,Q,U,T] * HD['Dbaab'][Dr,Ds,Dw,Dv]
    return result


def lucc_CCAAbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==W:
        if P==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbaab'][r,s,U,T] ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VAAAbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,Dw,Dq,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dt,Ds,Du,Dq,Dw,:,:] ) ))
    result += 2 * fsum(( +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dt,Ds,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,:,Dq,Du,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dt,Ds,Du,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Ds,Dw,Dq,Dt,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,u,actfloor:actceil,P], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,w,actfloor:actceil,P], HD['Dbaaaba'][Dt,Dq,Du,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,q,u,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,q,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                         -HD['HSbaab'][P,q,u,t] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         +HD['HSbaab'][P,q,w,v] * HD['Dbaab'][Dr,Ds,Du,Dt] ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaaaba'][Dr,Ds,Dw,:,Dq,Du,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,q,t,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,q,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Dw,Du,Dt,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] ,
                         +HD['HSbb'][P,v] * HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,Dr] ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Dw,:,Dq,Du,Dt,:] ) ))
    if s==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,Du,Dv,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dq,Dv,:] ) ))
        if r==v:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dq,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Du,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Du,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ))
    if r==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dt,Ds,Du,:,Dq,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dt,Ds,Du,:,Dq,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ))
    if s==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Dw,Dt,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,Dt,:] ) ))
        if r==t:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Dq,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
    if r==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dv,Ds,Dw,:,Dq,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Ds,Dw,:,Dq,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ))
    if q==u:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dt,Ds,:,Dw,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dt,Ds,:,Dw,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                             +HD['HSbb'][P,t] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ))
    if q==w:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dv,Ds,:,Du,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Ds,:,Du,Dt,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                             +HD['Dbaab'][Dr,Ds,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Du,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                             -HD['HSbb'][P,v] * HD['Dbaab'][Dr,Ds,Du,Dt] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                             +HD['Dbaab'][Dr,Ds,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Du,Dt,:] ) ))
    return result


def lucc_VAAAbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,w,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] ,
                         -HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaabaabb'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ))
    if s==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dq,Dv,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Du,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dv,Dq,Du,Dr] ,
                             +HD['Dbaab'][Dv,Dq,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ))
        if r==v:
            result += 2 * fsum(( -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSbb'][P,T] * HD['Daa'][Dq,Du] ,
                                 -HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dabab'][Du,:,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,w,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             +HD['HSbb'][P,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dq,Dw,:] ) ))
    if q==w:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaab'][Dr,Ds,Du,:] )
    return result


def lucc_VAAAbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         +HD['HSbaab'][P,q,U,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         -HD['HSbaab'][P,w,U,T] * HD['Dbaab'][Dv,Dq,Ds,Dr] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -HD['HSbaab'][P,q,U,T] * HD['Daa'][Ds,Dw] ,
                             +HD['HSbaab'][P,w,U,T] * HD['Daa'][Dq,Ds] ))
        if s==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 +HD['HSbaab'][P,q,U,T] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             -HD['HSbaab'][P,q,U,T] * HD['Dbb'][Dr,Dv] ))
    return result


def lucc_VAAAbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaaabb'][Dr,Dv,Ds,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaaaba'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,u,actfloor:actceil,P], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,q,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         -HD['HSbaab'][P,q,u,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         -HD['HSbb'][P,T] * HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] ,
                         +HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaabaabb'][Dr,Ds,Du,:,Dq,Dw,Dv,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dv,Dq,Dw,:,Du,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSaaaa'][s,u,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dq,Dw,Dr,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dv,Dq,Dw,:,Ds,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                             +HD['HSaa'][q,u] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dv,Dq,Dw,:,Du,Dr,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,Dw,Du,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dq,Dw,:,Ds,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,u,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ))
        if q==u:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dw,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Ds,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dv,Dw,:,Dr,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if q==u:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ))
    if s==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Dq,:,:] )
    return result


def lucc_VAAAbaba_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaaaab'][Dr,Ds,Du,Dq,Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,V,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dw,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][q,V,u,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,V,actfloor:actceil], HD['Daababa'][Dq,Dw,:,Du,Dr,:] ) ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,u,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbb'][r,V] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Ds,Du,:] ) ))
        if q==u:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabba'][Dw,:,Dr,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][r,s,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSbb'][r,V] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dw,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbaab'][Dr,Dw,Dq,:] )
    return result


def lucc_VAAAbaba_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][V,W,s,actfloor:actceil], HD['Dbaab'][Dr,Du,Dq,:] ) ,
                             -HD['HSbaab'][r,s,W,V] * HD['Daa'][Dq,Du] ,
                             +HD['HSbaab'][r,u,W,V] * HD['Daa'][Dq,Ds] ,
                             -einsum( 'i,i->', HD['HSbaba'][V,W,r,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ))
        if q==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][V,W,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbaab'][r,s,W,V] ,
                                 +einsum( 'i,i->', HD['HSbaba'][V,W,r,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VAAAbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dr,:] ) ,
                         -HD['HSbaab'][P,q,U,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ))
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSaaaa'][U,s,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dq,Dw,Dr,:,:] )
        result += 2 * fsum(( +HD['HSaa'][q,U] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,U] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][U,r,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,U] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ))
    return result


def lucc_VAAAbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabba'][U,r,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][q,V,actfloor:actceil,U], HD['Dbaab'][Dr,Ds,Dw,:] ) ))
    return result


def lucc_VAAAbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==T:
        result += 2 * -HD['HSabab'][U,r,W,V] * HD['Daa'][Dq,Ds]
    return result


def lucc_VACAbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Dbaaaba'][Dv,Dq,Dw,Ds,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Dbaaaba'][Dt,Dq,Du,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,w,R,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,u,R,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,Dw,Dq,Dt,:] ) ,
                         +HD['HSbaba'][P,q,R,u] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                         -HD['HSbaba'][P,q,R,w] * HD['Dbaab'][Dv,Ds,Du,Dt] ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbaaaab'][Dt,Dq,Du,Ds,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ))
    if s==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dt,Du,:,Dq,Dv,:] ) ,
                             -HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] ) ,
                             -HD['HSbb'][P,R] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                             -HD['Dbaab'][Dv,Dq,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbaab'][Dt,Du,Dq,:] ) ))
    if s==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,R,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] ) ,
                             +HD['HSbb'][P,R] * HD['Dbaab'][Dt,Dq,Dw,Dv] ,
                             +HD['Dbaab'][Dt,Dq,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dt,Ds,:,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dt,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                             +HD['Dbaab'][Dt,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dt,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if q==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,:,Du,Dt,:] ) ,
                             -HD['Dbaab'][Dv,Ds,Du,Dt] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbaab'][Dv,Ds,Du,Dt] ,
                             -HD['Dbaab'][Dv,Ds,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Du,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbaab'][Dt,Du,Ds,:] ) ))
    return result


def lucc_VACAbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                         +HD['HSbbbb'][P,v,R,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         +HD['HSbbbb'][P,T,R,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ))
    if R==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dv,Ds,Dw,:,Dq,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Ds,Dw,:,Dq,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,:,Dq,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][v,w,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,q,w,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                             +HD['HSbaab'][P,q,w,v] * HD['Daa'][Ds,Du] ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaaaa'][Ds,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,v,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                             +HD['HSbb'][P,v] * HD['Daaaa'][Dq,Du,Ds,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ,
                             -HD['Daaaa'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Daabaab'][Ds,Dw,:,Dq,Du,:] ) ))
        if q==w:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Du,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,:,Du,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Ds,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                                 -HD['HSbb'][P,v] * HD['Daa'][Ds,Du] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                                 +HD['Daa'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Ds,:,Du,:] ) ))
    if q==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                             -HD['HSbbbb'][P,T,R,v] * HD['Daa'][Ds,Du] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Du,:] ) ,
                             -HD['HSbbbb'][P,v,R,T] * HD['Daa'][Dq,Du] ))
    return result


def lucc_VACAbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,U,w,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             +HD['HSbaab'][P,U,w,v] * HD['Daa'][Dq,Ds] ,
                             -einsum( 'i,i->', HD['HSbaba'][P,U,v,actfloor:actceil], HD['Daaaa'][Ds,Dw,Dq,:] ) ))
        if q==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Ds,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][P,U,v,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VACAbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Dq,Du,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaabaabb'][Dv,Dq,Dw,:,Ds,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaaaab'][Dv,Dq,Dw,:,Ds,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][u,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][u,R,q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,R,actfloor:actceil], HD['Daababa'][Ds,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,Du,:] ) ))
        if q==u:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Ds,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Ds,:] )
    if s==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] )
    return result


def lucc_VACAbaba_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,V,R,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                         -HD['HSbbbb'][P,T,R,V] * HD['Daaaa'][Dq,Du,Ds,Dw] ))
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][u,R,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][q,V,R,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +HD['HSabba'][q,V,R,u] * HD['Daa'][Ds,Dw] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             +HD['HSbb'][R,V] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Ds,Du,:] ) ))
        if R==V:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Du,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][s,u,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +HD['HSaa'][q,u] * HD['Daa'][Ds,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,u] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,u,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Du,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,u,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,u] ) ))
            if q==u:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ))
        if q==u:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                 -HD['HSbb'][R,V] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ))
    if R==V:
        result += 2 * fsum(( +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaaaa'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,q,actfloor:actceil,T], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,u,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -HD['HSbaab'][P,q,u,T] * HD['Daa'][Ds,Dw] ,
                             -HD['HSbb'][P,T] * HD['Daaaa'][Dq,Dw,Ds,Du] ,
                             +HD['Daaaa'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Daabaab'][Ds,Du,:,Dq,Dw,:] ) ))
        if q==u:
            result += 2 * fsum(( -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +HD['HSbb'][P,T] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Ds,:,Dw,:] ) ))
    if q==u:
        result += 2 * +HD['HSbbbb'][P,V,R,T] * HD['Daa'][Ds,Dw]
    if s==u:
        result += 2 * +HD['HSbbbb'][P,T,R,V] * HD['Daa'][Dq,Dw]
    return result


def lucc_VACAbaba_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -HD['HSabab'][u,R,W,V] * HD['Daa'][Dq,Ds] ,
                             -einsum( 'i,i->', HD['HSbaba'][V,W,R,actfloor:actceil], HD['Daaaa'][Ds,Du,Dq,:] ) ))
        if R==V:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][q,W,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] )
            result += 2 * fsum(( +HD['HSaa'][s,W] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][s,:actfloor,W,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,W,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,W,u,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][s,u,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][s,:actfloor,W,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,W,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if q==u:
                result += 2 * fsum(( -HD['HSaa'][s,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSbaba'][V,W,R,actfloor:actceil], HD['Daa'][Ds,:] )
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,W,actfloor:actceil,T], HD['Daaaa'][Ds,Du,Dq,:] ) ,
                             -HD['HSbaab'][P,W,u,T] * HD['Daa'][Dq,Ds] ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSbaab'][P,W,actfloor:actceil,T], HD['Daa'][Ds,:] )
    return result


def lucc_VACAbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][U,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][U,R,q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    return result


def lucc_VACAbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabba'][U,R,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             +HD['HSabba'][q,V,R,U] * HD['Daa'][Ds,Dw] ))
        if R==V:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][U,s,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * fsum(( +HD['HSaa'][q,U] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,U], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,U], HD['Dabab'][Ds,:,Dw,:] ) ))
    if R==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Ds,:] ) ,
                             -HD['HSbaab'][P,q,U,T] * HD['Daa'][Ds,Dw] ))
    return result


def lucc_VACAbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    if P==T:
        result += 2 * -HD['HSabab'][U,R,W,V] * HD['Daa'][Dq,Ds]
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaaaa'][q,W,actfloor:actceil,U], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][U,s,W,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if R==V:
        result += 2 * -HD['HSbaab'][P,W,U,T] * HD['Daa'][Dq,Ds]
    return result


def lucc_VACCbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbaab'][P,w,S,R] * HD['Dbaab'][Dv,Dq,Du,Dt] ,
                         +HD['HSbaab'][P,u,S,R] * HD['Dbaab'][Dt,Dq,Dw,Dv] ))
    if q==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Dt,:] )
    if q==w:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][R,S,actfloor:actceil,P], HD['Dbaba'][Dt,Du,Dv,:] )
    return result


def lucc_VACCbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][v,S,actfloor:actceil,P], HD['Daaaa'][Dq,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,q,S,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +HD['HSbaab'][P,q,S,v] * HD['Daa'][Du,Dw] ))
        if q==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbaab'][Dv,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][v,S,actfloor:actceil,P], HD['Daa'][Du,:] ) ))
    return result


def lucc_VACCbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    if S==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                             +HD['HSbbbb'][P,T,R,v] * HD['Daa'][Dq,Dw] ))
        if R==T:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Dq,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                                 -HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaab'][Dv,:,Dq,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][v,w,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][P,q,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSbaab'][P,q,w,v] ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daaaa'][Dw,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][P,q,v,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                                 +HD['HSbb'][P,v] * HD['Daa'][Dq,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                                 -HD['Daa'][Dq,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dabab'][Dw,:,Dq,:] ) ))
            if q==w:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -HD['HSbb'][P,v] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -HD['HSbbbb'][P,T,R,v] ))
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,U,S,actfloor:actceil], HD['Dbaab'][Dv,Dw,Dq,:] ) ,
                             +HD['HSbaab'][P,U,S,v] * HD['Daa'][Dq,Dw] ))
        if q==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,U,S,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -HD['HSbaab'][P,U,S,v] ))
    return result


def lucc_VACCbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dq,Dw,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][R,S,q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
        if q==u:
            result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_VACCbaba_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -HD['HSabab'][q,V,S,R] * HD['Daa'][Du,Dw] ,
                             +einsum( 'i,i->', HD['HSbaba'][R,S,V,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ))
        if R==V:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Dq,Dw,:,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][u,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +HD['HSaa'][q,S] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][u,S,q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Dq,Dw,:,Du,:,:] ) ))
            if q==u:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSbaba'][R,S,V,actfloor:actceil], HD['Daa'][Dw,:] )
    if R==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,S,actfloor:actceil,P], HD['Daaaa'][Dq,Dw,Du,:] ) ,
                             -HD['HSbaab'][P,q,S,T] * HD['Daa'][Du,Dw] ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSbaab'][T,S,actfloor:actceil,P], HD['Daa'][Dw,:] )
    return result


def lucc_VACCbaba_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * +HD['HSbaab'][R,S,W,V] * HD['Daa'][Dq,Du]
        if S==W:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][q,V,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][u,R,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSabba'][q,V,R,u] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                 +HD['HSbb'][R,V] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if R==V:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +HD['HSaa'][q,u] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,u] ) ))
            if q==u:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                     -HD['HSbb'][R,V] ,
                                     -einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( +HD['HSaa'][S,W] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSaaaa'][S,:actfloor,W,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,W,actfloor:actceil], HD['Daaaa'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][q,W,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSaaaa'][u,S,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][q,W,S,u] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSabab'][S,:actfloor,W,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,W,actfloor:actceil], HD['Dabab'][Dq,:,Du,:] ) ))
            if q==u:
                result += 2 * fsum(( -HD['HSaa'][S,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * -HD['HSbaab'][R,S,W,V]
    if S==W:
        result += 2 * -HD['HSbbbb'][P,V,R,T] * HD['Daa'][Dq,Du]
        if R==V:
            result += 2 * fsum(( +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Du,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][P,q,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][T,u,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 -HD['HSbaab'][P,q,u,T] ,
                                 -HD['HSbb'][P,T] * HD['Daa'][Dq,Du] ,
                                 +HD['Daa'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Du,:,Dq,:] ) ))
            if q==u:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][P,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * +HD['HSbbbb'][P,V,R,T]
    if R==V:
        result += 2 * -HD['HSbaab'][P,W,S,T] * HD['Daa'][Dq,Du]
        if q==u:
            result += 2 * +HD['HSbaab'][P,W,S,T]
    return result


def lucc_VACCbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    if P==T:
        if R==V:
            result += -einsum( 'ij,ij->', HD['HSaaaa'][U,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dq,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][U,S,q,actfloor:actceil], HD['Daa'][Dw,:] )
    return result


def lucc_VACCbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    if P==T:
        if S==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabba'][U,R,V,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSabba'][q,V,R,U] ))
            if R==V:
                result += 2 * fsum(( +HD['HSaa'][q,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][U,S,W,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +HD['HSaaaa'][q,W,S,U] ))
    if S==W:
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Daa'][Dq,:] ) ,
                                 -HD['HSbaab'][P,q,U,T] ))
    return result


def lucc_VVAAbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,u,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Ds,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,Q,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Du,Dt,:] ) ,
                         -HD['HSbaab'][P,Q,u,t] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                         +HD['HSbaab'][P,Q,w,v] * HD['Dbaab'][Dr,Ds,Du,Dt] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,Q,t,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Dw,Du,Dt,:] ) ))
    if s==w:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,Du,Dv,:,:] )
        if r==v:
            result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dt,Du,:,:] )
    if r==v:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dt,Ds,Du,Dw,:,:] )
    if s==u:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Dw,Dt,:,:] )
        if r==t:
            result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    if r==t:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Du,:,:] )
    return result


def lucc_VVAAbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] )
    if s==w:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] )
        if r==v:
            result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Daa'][Du,:] )
    if r==v:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] )
    return result


def lucc_VVAAbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbaab'][P,Q,U,T] * HD['Dbaab'][Dr,Ds,Dw,Dv]
    if s==w:
        result += 2 * -HD['HSbaab'][P,Q,U,T] * HD['Dbb'][Dr,Dv]
        if r==v:
            result += 2 * +HD['HSbaab'][P,Q,U,T]
    if r==v:
        result += 2 * -HD['HSbaab'][P,Q,U,T] * HD['Daa'][Ds,Dw]
    return result


def lucc_VVAAbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         -HD['HSbaab'][P,Q,u,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaabaa'][Dr,Ds,Du,:,Dw,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +HD['HSaa'][Q,u] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,u] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaababab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaaaba'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,u] ) ))
    return result


def lucc_VVAAbaba_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][Q,V,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Ds,Du,Dw,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][Q,V,u,actfloor:actceil], HD['Dbaab'][Dr,Ds,Dw,:] ) ))
    return result


def lucc_VVAAbaba_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbaab'][P,Q,U,T] * HD['Dbaab'][Dr,Ds,Dw,Dv]
    if P==T:
        result += 2 * fsum(( +HD['HSaa'][Q,U] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,U] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,U] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ))
        if Q==U:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dw,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Ds,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dv,Dw,:,Dr,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if Q==U:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dr,Ds,Dw,Dv] ,
                             -HD['Dbaab'][Dr,Ds,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dr,Ds,:,Dw,Dv,:] ) ))
    return result


def lucc_VVAAbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSabba'][Q,V,actfloor:actceil,U], HD['Dbaab'][Dr,Ds,Dw,:] )
        if Q==U:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabba'][Dw,:,Dr,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][r,s,V,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSbb'][r,V] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ))
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaab'][Dr,Ds,Dw,:] )
    return result


def lucc_VVAAbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if P==T:
        if Q==U:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][V,W,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbaab'][r,s,W,V] ,
                                 +einsum( 'i,i->', HD['HSbaba'][V,W,r,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VVCAbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaba'][P,Q,R,u] * HD['Dbaab'][Dt,Ds,Dw,Dv] ,
                         -HD['HSbaba'][P,Q,R,w] * HD['Dbaab'][Dv,Ds,Du,Dt] ))
    if s==w:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Dbaba'][Dt,Du,Dv,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,R,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dt,:] )
    return result


def lucc_VVCAbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Ds,Dw,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,Q,w,actfloor:actceil], HD['Dbaab'][Dv,Ds,Du,:] ) ,
                             +HD['HSbaab'][P,Q,w,v] * HD['Daa'][Ds,Du] ,
                             -einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Daaaa'][Ds,Dw,Du,:] ) ))
    return result


def lucc_VVCAbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Daababa'][Ds,Du,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][u,R,actfloor:actceil,Q], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    return result


def lucc_VVCAbaba_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabba'][Q,V,R,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             +HD['HSabba'][Q,V,R,u] * HD['Daa'][Ds,Dw] ))
        if R==V:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaaaa'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 +HD['HSaa'][Q,u] * HD['Daa'][Ds,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,u] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daabaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dabab'][Ds,:,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,u] ) ))
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Daaaa'][Ds,Du,Dw,:] ) ,
                             -HD['HSbaab'][P,Q,u,T] * HD['Daa'][Ds,Dw] ))
    return result


def lucc_VVCAbaba_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    if P==T:
        if R==V:
            result += +einsum( 'ij,ij->', HD['HSaaaa'][Q,W,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Ds,Du,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSaaaa'][Q,W,u,actfloor:actceil], HD['Daa'][Ds,:] )
    return result


def lucc_VVCAbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSabba'][U,R,actfloor:actceil,Q], HD['Dbaab'][Dv,Dw,Ds,:] )
        if Q==U:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Ds,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dv,Dw,Ds,:] ) ))
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Ds,:] )
    return result


def lucc_VVCAbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * +HD['HSabba'][Q,V,R,U] * HD['Daa'][Ds,Dw]
        if R==V:
            result += 2 * fsum(( +HD['HSaa'][Q,U] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dabab'][Ds,:,Dw,:] ) ))
            if Q==U:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ))
        if Q==U:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daaaa'][Dw,:,Ds,:] ) ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                 -HD['HSbb'][R,V] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dabab'][Dw,:,Ds,:] ) ))
    if R==V:
        result += 2 * -HD['HSbaab'][P,Q,U,T] * HD['Daa'][Ds,Dw]
        if Q==U:
            result += 2 * fsum(( -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daaaa'][Ds,:,Dw,:] ) ,
                                 +HD['HSbb'][P,T] * HD['Daa'][Ds,Dw] ,
                                 -HD['Daa'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dabab'][Ds,:,Dw,:] ) ))
    if Q==U:
        result += 2 * +HD['HSbbbb'][P,V,R,T] * HD['Daa'][Ds,Dw]
    return result


def lucc_VVCAbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    if P==T:
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSbaba'][V,W,R,actfloor:actceil], HD['Daa'][Ds,:] )
            if R==V:
                result += 2 * fsum(( -HD['HSaa'][s,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][s,actfloor:actceil,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][Q,W,actfloor:actceil,U], HD['Daa'][Ds,:] )
    if Q==U:
        if R==V:
            result += 2 * +einsum( 'i,i->', HD['HSbaab'][P,W,actfloor:actceil,T], HD['Daa'][Ds,:] )
    return result


def lucc_VVCCbaba_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbaba_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,S,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +HD['HSbaab'][P,Q,S,v] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VVCCbaba_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if S==U:
        if R==T:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][P,Q,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSbaab'][P,Q,w,v] ,
                                 +einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_VVCCbaba_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][R,S,actfloor:actceil,Q], HD['Dbaab'][Dv,Dw,Du,:] )
    return result


def lucc_VVCCbaba_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * -HD['HSabab'][Q,V,S,R] * HD['Daa'][Du,Dw]
        if R==V:
            result += 2 * fsum(( +HD['HSaa'][Q,S] * HD['Daa'][Du,Dw] ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaaaa'][u,S,actfloor:actceil,Q], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if R==V:
        result += 2 * -HD['HSbaab'][P,Q,S,T] * HD['Daa'][Du,Dw]
    return result


def lucc_VVCCbaba_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if P==T:
        if S==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabba'][Q,V,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSabba'][Q,V,R,u] ))
            if R==V:
                result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     +HD['HSaa'][Q,u] ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dabab'][Du,:,:,:] ) ,
                                     +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,u] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaaaa'][Q,W,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSaaaa'][Q,W,S,u] ))
    if S==W:
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Daa'][Du,:] ) ,
                                 -HD['HSbaab'][P,Q,u,T] ))
    return result


def lucc_VVCCbaba_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if P==T:
        if Q==U:
            result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dw,:,:] )
    return result


def lucc_VVCCbaba_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if P==T:
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSbaba'][R,S,V,actfloor:actceil], HD['Daa'][Dw,:] )
            if R==V:
                result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Daaaa'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                     -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dabab'][Dw,:,:,:] ) ))
        if R==V:
            result += 2 * +einsum( 'i,i->', HD['HSaaaa'][U,S,actfloor:actceil,Q], HD['Daa'][Dw,:] )
    if Q==U:
        if R==V:
            result += 2 * +einsum( 'i,i->', HD['HSbaab'][T,S,actfloor:actceil,P], HD['Daa'][Dw,:] )
    return result


def lucc_VVCCbaba_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    if P==T:
        if S==W:
            result += 2 * +HD['HSabba'][Q,V,R,U]
            if R==V:
                result += 2 * fsum(( +HD['HSaa'][Q,U] ,
                                     -einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
            if Q==U:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                     -HD['HSbb'][R,V] ,
                                     -einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * +HD['HSaaaa'][Q,W,S,U]
            if Q==U:
                result += 2 * fsum(( -HD['HSaa'][S,W] ,
                                     -einsum( 'II->', HD['HSaaaa'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,S,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSabab'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if Q==U:
            result += 2 * -HD['HSbaab'][R,S,W,V]
    if S==W:
        if Q==U:
            result += 2 * +HD['HSbbbb'][P,V,R,T]
            if R==V:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][P,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * -HD['HSbaab'][P,Q,U,T]
    if R==V:
        if Q==U:
            result += 2 * +HD['HSbaab'][P,W,S,T]
    return result


def lucc_AAAAbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dp,Dv,Dw,Dq,Ds,Du,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dp,Dv,Dw,Dq,Dr,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dv,Dw,Ds,Dp,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbabbbba'][Dr,Du,Ds,:,Dp,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbabbbba'][Dp,Du,Dq,:,Dr,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][s,T,w,actfloor:actceil], HD['Dbbabba'][Dp,Dv,Dq,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Dbbabba'][Dp,Dw,Dq,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][q,T,w,actfloor:actceil], HD['Dbbabba'][Dr,Dv,Ds,Dp,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][q,T,v,actfloor:actceil], HD['Dbbabba'][Dr,Dw,Ds,Dp,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaabba'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaabba'][Dp,Du,Dq,:,Ds,Dv,Dw,:] ) ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbaabb'][Dp,Du,Dq,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Dbbabba'][Dp,Du,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][w,q,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dp,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dp,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][w,s,T,actfloor:actceil], HD['Dbbabba'][Dp,Du,Dq,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Dbbabba'][Dp,Du,Dq,Dr,Dw,:] ) ,
                         -HD['HSbb'][p,T] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] ,
                         +HD['HSbb'][r,T] * HD['Dbbaabb'][Dp,Du,Dq,Ds,Dv,Dw] ,
                         +HD['Dbbaabb'][Dp,Du,Dq,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbababbb'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbababbb'][Dp,Du,Dq,:,Ds,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,w,actfloor:actceil], HD['Dbbaabb'][Dp,Dv,Dq,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbbaabb'][Dp,Dw,Dq,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,w,T,actfloor:actceil], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,T,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Dw,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,w,T,actfloor:actceil], HD['Dbbaabb'][Dp,Du,Dq,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbbaabb'][Dp,Du,Dq,Ds,Dw,:] ) ,
                         +HD['HSbbbb'][p,T,v,w] * HD['Dbaab'][Du,Dq,Ds,Dr] ,
                         -HD['HSbbbb'][r,T,v,w] * HD['Dbaab'][Dp,Dq,Ds,Du] ))
    if r==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dv,Dq,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Du,Ds,:,Dp,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Dbaba'][Dp,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Du,Ds,:,Dq,Dv,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Ds,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dp,:] ) ,
                             +HD['HSbb'][p,T] * HD['Dbaab'][Dv,Dq,Ds,Du] ,
                             +HD['Dbaab'][Dv,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Du,Ds,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dw,Dq,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Du,Ds,:,Dp,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][s,T,w,actfloor:actceil], HD['Dbaba'][Dp,Dq,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Du,Ds,:,Dq,Dw,:] ) ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][p,q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][w,q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dp,:] ) ,
                             -HD['HSbb'][p,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Du,Ds,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,w,T,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ))
    if p==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Ds,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Du,Dq,:,Dr,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][q,T,v,actfloor:actceil], HD['Dbaba'][Dr,Ds,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Du,Dq,:,Ds,Dv,:] ) ,
                             -HD['Dbaab'][Du,Dq,Ds,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Dbaba'][Du,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,s,T,actfloor:actceil], HD['Dbaba'][Du,Dq,Dr,:] ) ,
                             -HD['HSbb'][r,T] * HD['Dbaab'][Du,Dq,Ds,Dv] ,
                             -HD['Dbaab'][Du,Dq,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Du,Dq,:,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbaab'][Du,Dq,Ds,:] ) ))
    if p==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dw,Ds,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Du,Dq,:,Dr,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][q,T,w,actfloor:actceil], HD['Dbaba'][Dr,Ds,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Du,Dq,:,Ds,Dw,:] ) ,
                             +HD['Dbaab'][Du,Dq,Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,T,actfloor:actceil], HD['Dbaba'][Du,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][w,s,T,actfloor:actceil], HD['Dbaba'][Du,Dq,Dr,:] ) ,
                             +HD['HSbb'][r,T] * HD['Dbaab'][Du,Dq,Ds,Dw] ,
                             +HD['Dbaab'][Du,Dq,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Du,Dq,:,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,w,T,actfloor:actceil], HD['Dbaab'][Du,Dq,Ds,:] ) ))
    return result


def lucc_AAAAbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dp,:] ) ,
                         +HD['HSbbbb'][p,w,T,U] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         -HD['HSbbbb'][p,v,T,U] * HD['Dbaab'][Dw,Dq,Ds,Dr] ,
                         -HD['HSbbbb'][r,w,T,U] * HD['Dbaab'][Dp,Dq,Ds,Dv] ,
                         +HD['HSbbbb'][r,v,T,U] * HD['Dbaab'][Dp,Dq,Ds,Dw] ))
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             +HD['HSbbbb'][p,v,T,U] * HD['Daa'][Dq,Ds] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ,
                             -HD['HSbbbb'][p,w,T,U] * HD['Daa'][Dq,Ds] ))
    if p==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             -HD['HSbbbb'][r,v,T,U] * HD['Daa'][Dq,Ds] ))
    if p==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbaab'][Dw,Ds,Dq,:] ) ,
                             +HD['HSbbbb'][r,w,T,U] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_AAAAbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dp,Dv,Dw,Dq,Ds,Du,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbabbbba'][Dr,Du,Ds,:,Dp,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbabbbba'][Dp,Du,Dq,:,Dr,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaabba'][Dp,Du,Dq,:,Ds,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaabba'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbaabb'][Dp,Du,Dq,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dv,Dw,Ds,Dp,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dp,Dv,Dw,Dq,Dr,Du,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,s,actfloor:actceil,T], HD['Dbbabba'][Dp,Du,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,q,actfloor:actceil,T], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         -HD['HSbb'][p,T] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] ,
                         +HD['HSbb'][r,T] * HD['Dbbaabb'][Dp,Du,Dq,Ds,Dv,Dw] ,
                         -HD['Dbbaabb'][Dp,Du,Dq,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbababbb'][Dp,Du,Dq,:,Ds,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbababbb'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,u,p,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,u,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dp,:] ) ))
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Dp,Dq,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Dp,:,:] ) ))
    if p==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Dr,:,:] ) ))
    return result


def lucc_AAAAbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Dbbabba'][Dr,Du,Ds,Dp,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Dbbabba'][Dp,Du,Dq,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Dbbabba'][Dr,Dw,Ds,Dp,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Dbbabba'][Dp,Dw,Dq,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbbaabb'][Dp,Du,Dq,Ds,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbbaabb'][Dp,Dw,Dq,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbbaabb'][Dr,Dw,Ds,Dq,Du,:] ) ,
                         +HD['HSbbbb'][p,V,u,T] * HD['Dbaab'][Dw,Dq,Ds,Dr] ,
                         -HD['HSbbbb'][r,V,u,T] * HD['Dbaab'][Dp,Dq,Ds,Dw] ))
    if p==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Dbaba'][Dw,Dq,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ))
    if r==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Dbaba'][Dp,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Dbaba'][Dw,Ds,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbaab'][Dw,Ds,Dq,:] ) ))
    return result


def lucc_AAAAbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][T,p,V,W] * HD['Dbaab'][Du,Dq,Ds,Dr] ,
                         +HD['HSbbbb'][T,r,V,W] * HD['Dbaab'][Dp,Dq,Ds,Du] ))
    if r==u:
        result += 2 * +HD['HSbbbb'][T,p,V,W] * HD['Daa'][Dq,Ds]
    if p==u:
        result += 2 * -HD['HSbbbb'][T,r,V,W] * HD['Daa'][Dq,Ds]
    return result


def lucc_AAAAbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dp,:] ) ))
    return result


def lucc_AAAAbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][p,V,T,U] * HD['Dbaab'][Dw,Dq,Ds,Dr] ,
                         +HD['HSbbbb'][r,V,T,U] * HD['Dbaab'][Dp,Dq,Ds,Dw] ))
    return result


def lucc_AAAAbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Dt,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dt,Du,Ds,Dq,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dt,Du,Ds,Dq,Dw,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbaaabba'][Dr,Dt,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbaaabba'][Dr,Dv,Ds,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbaaabba'][Dr,Dw,Ds,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbaaabba'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                         +HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                         -HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][t,s,P,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][u,s,P,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][w,s,P,actfloor:actceil], HD['Dbbabba'][Dt,Du,Dq,Dr,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][v,s,P,actfloor:actceil], HD['Dbbabba'][Dt,Du,Dq,Dr,Dw,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] ,
                         +HD['HSbb'][P,u] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Dt] ,
                         -HD['HSbb'][P,w] * HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dv] ,
                         +HD['HSbb'][P,v] * HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dw] ,
                         -HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                         +HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbababbb'][Dr,Dw,Ds,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbababbb'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbababbb'][Dr,Dt,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbababbb'][Dr,Dv,Ds,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,u,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,u,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,w,P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][u,P,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,w,P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][w,P,r,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dt,Du,Ds,:,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dt,Du,Ds,:,Dq,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbaabb'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dt,Du,Ds,:,Dq,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dt,Du,Ds,:,Dq,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbaabb'][Dt,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dv,Dw,Ds,:,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Ds,:,Dq,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dv,Dw,Ds,:,Dq,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Ds,:,Dq,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ))
    return result


def lucc_CAAAbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbaaabba'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         -HD['HSbb'][P,T] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbababbb'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Dw,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         +HD['HSbbbb'][P,T,v,w] * HD['Dbaab'][Du,Dq,Ds,Dr] ,
                         -HD['HSbbbb'][P,T,r,w] * HD['Dbaab'][Du,Dq,Ds,Dv] ,
                         +HD['HSbbbb'][P,T,r,v] * HD['Dbaab'][Du,Dq,Ds,Dw] ,
                         -HD['HSbbbb'][w,P,T,r] * HD['Dbaab'][Dv,Dq,Ds,Du] ,
                         +HD['HSbbbb'][v,P,T,r] * HD['Dbaab'][Dw,Dq,Ds,Du] ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaabbaa'][Dr,Du,Ds,:,Dv,Dw,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaabbaa'][Dv,Dw,Dq,:,Dr,Du,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dv,Dw,Dq,:,Ds,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabbbab'][Dr,Du,Ds,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabbbab'][Dv,Dw,Dq,:,Dr,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbabbba'][Dv,Dq,:,Dr,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbabbba'][Dw,Dq,:,Dr,Du,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dq,:,Ds,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Ds,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,w] ) ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][v,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,Ds,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][w,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,Ds,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaba'][Dv,Dq,:,Ds,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaba'][Dw,Dq,:,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,w,actfloor:actceil], HD['Dbaba'][Dv,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,s,v,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                             +HD['HSbb'][r,v] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                             -HD['HSbb'][r,w] * HD['Dbaab'][Dv,Dq,Ds,Du] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,w] ) ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbababb'][Dv,Dq,:,Ds,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbababb'][Dw,Dq,:,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,w,r,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ))
        if r==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Du,Ds,:,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dv,Dq,:,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaba'][Dv,Dq,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dq,Du,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Du,Ds,:,Dv,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dv,Dq,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dv,Dq,Du,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dabba'][Dq,:,Du,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][v,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,Ds,:,:] ) ))
        if r==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dw,Dq,:,Du,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Du,Ds,:,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Du,Ds,:,Dw,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dw,Dq,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,w,actfloor:actceil], HD['Dabba'][Dq,:,Du,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][w,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,Ds,:,:] ) ))
    if r==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaba'][Du,Ds,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Dbaba'][Dv,Dq,Du,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dv,Dq,Ds,Du] ,
                             +HD['Dbaab'][Dv,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbababb'][Du,Ds,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaba'][Du,Ds,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][s,T,P,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbababb'][Du,Ds,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ))
    return result


def lucc_CAAAbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ,
                         -HD['HSbbbb'][w,P,T,U] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         +HD['HSbbbb'][v,P,T,U] * HD['Dbaab'][Dw,Dq,Ds,Dr] ))
    if P==U:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Dr,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][s,T,w,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Dbaba'][Dw,Dq,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][w,q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,w,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ,
                             -HD['HSbbbb'][r,T,v,w] * HD['Daa'][Dq,Ds] ))
        if r==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dq,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][s,T,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][v,q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ))
        if r==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Dq,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dabba'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][s,T,w,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][w,q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Dr,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][s,U,w,actfloor:actceil], HD['Dbaba'][Dv,Dq,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][s,U,v,actfloor:actceil], HD['Dbaba'][Dw,Dq,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][w,q,U,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,q,U,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,U,w,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,U,v,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ,
                             +HD['HSbbbb'][r,U,v,w] * HD['Daa'][Dq,Ds] ))
        if r==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,Dq,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,U,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][s,U,v,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][v,q,U,actfloor:actceil], HD['Daa'][Ds,:] ) ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Dq,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,U,actfloor:actceil], HD['Dabba'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][s,U,w,actfloor:actceil], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][w,q,U,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             -HD['HSbbbb'][v,P,T,U] * HD['Daa'][Dq,Ds] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ,
                             +HD['HSbbbb'][w,P,T,U] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_CAAAbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbaaabba'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,s,P,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbababbb'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,u,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ))
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] )
    return result


def lucc_CAAAbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbbaabb'][Dr,Dw,Ds,Dq,Du,:] ) ,
                         +HD['HSbbbb'][P,V,u,T] * HD['Dbaab'][Dw,Dq,Ds,Dr] ,
                         -HD['HSbbbb'][T,P,V,r] * HD['Dbaab'][Du,Dq,Ds,Dw] ,
                         -HD['HSbbbb'][P,V,r,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ))
    if P==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Du,Dq,:,Dr,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Du,Dq,:,Ds,Dw,:] ) ,
                             +HD['Dbaab'][Du,Dq,Ds,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dw,Ds,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][r,s,actfloor:actceil,T], HD['Dbaba'][Du,Dq,Dw,:] ) ,
                             -HD['HSbb'][r,T] * HD['Dbaab'][Du,Dq,Ds,Dw] ,
                             +HD['Dbaab'][Du,Dq,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Du,Dq,:,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,u,r,actfloor:actceil], HD['Dbaab'][Dw,Ds,Dq,:] ) ))
        if r==u:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dabba'][Dq,:,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Ds,:,:] ) ))
    if r==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbaab'][Dw,Ds,Dq,:] )
    return result


def lucc_CAAAbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][T,P,V,W] * HD['Dbaab'][Du,Dq,Ds,Dr]
    if P==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Dbaba'][Du,Dq,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Dbaba'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbaab'][Du,Dq,Ds,:] ) ,
                             -HD['HSbbbb'][r,V,u,T] * HD['Daa'][Dq,Ds] ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,V,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,q,V,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if P==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,W,actfloor:actceil,T], HD['Dbaba'][Du,Dq,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,q,W,actfloor:actceil], HD['Dbaba'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,W,actfloor:actceil,T], HD['Dbaab'][Du,Dq,Ds,:] ) ,
                             +HD['HSbbbb'][r,W,u,T] * HD['Daa'][Dq,Ds] ))
        if r==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,W,actfloor:actceil,T], HD['Daa'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][T,q,W,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    if r==u:
        result += 2 * +HD['HSbbbb'][T,P,V,W] * HD['Daa'][Dq,Ds]
    return result


def lucc_CAAAbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] )
    return result


def lucc_CAAAbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,V,T,U] * HD['Dbaab'][Dw,Dq,Ds,Dr]
    if P==V:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbaab'][Dw,Ds,Dq,:] )
    return result


def lucc_CAAAbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==W:
        result += 2 * +HD['HSbbbb'][r,V,T,U] * HD['Daa'][Dq,Ds]
    if P==V:
        result += 2 * -HD['HSbbbb'][r,W,T,U] * HD['Daa'][Dq,Ds]
    return result


def lucc_CCAAbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][P,Q,s,w] * HD['Dbbbb'][Dr,Dv,Dt,Du] ,
                         -HD['HSbaab'][P,Q,s,v] * HD['Dbbbb'][Dr,Dw,Dt,Du] ,
                         +HD['HSbaab'][P,Q,s,t] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['HSbaab'][P,Q,s,u] * HD['Dbbbb'][Dr,Dt,Dv,Dw] ,
                         +einsum( 'i,i->', HD['HSbaba'][P,Q,t,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,Q,u,actfloor:actceil], HD['Dbbabba'][Dr,Dt,Ds,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,Q,w,actfloor:actceil], HD['Dbbabba'][Dr,Dv,Ds,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Dbbabba'][Dr,Dw,Ds,Dt,Du,:] ) ))
    if r==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Ds,Dv,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,Q,s,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Ds,Dw,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,Q,s,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ))
    if r==t:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,Q,s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    if r==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Dt,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,Q,s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ))
    return result


def lucc_CCAAbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         -HD['HSbaba'][P,Q,T,s] * HD['Dbbbb'][Dr,Du,Dv,Dw] ))
    if P==T:
        result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabbaa'][Dr,Du,Ds,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             +HD['HSaa'][Q,s] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabbbab'][Dr,Du,Ds,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,Ds,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,Ds,Dv,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,s,Q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][w,Q,s,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,Q,s,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                             +HD['HSbaab'][w,Q,s,r] * HD['Dbb'][Du,Dv] ,
                             -HD['HSbaab'][v,Q,s,r] * HD['Dbb'][Du,Dw] ,
                             -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbabbba'][Du,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][w,Q,r,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,Q,r,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ))
        if r==w:
            result += +einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Du,Ds,:,Dv,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                                 -HD['HSaa'][Q,s] * HD['Dbb'][Du,Dv] ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                                 +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                                 +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Du,Ds,:,Dv,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,Ds,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][v,Q,s,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if r==v:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Du,Ds,:,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 +HD['HSaa'][Q,s] * HD['Dbb'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSaaaa'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSabba'][Q,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Du,Ds,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,Ds,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][w,Q,s,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                             +HD['HSbaba'][P,Q,T,s] * HD['Dbb'][Du,Dv] ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                             -HD['HSbaba'][P,Q,T,s] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_CCAAbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==U:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,T,Q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][w,Q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,Q,T,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dw,:] ) ,
                             +HD['HSbaba'][w,Q,T,s] * HD['Dbb'][Dr,Dv] ,
                             -HD['HSbaba'][v,Q,T,s] * HD['Dbb'][Dr,Dw] ))
        if r==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,T,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][v,Q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSbaba'][v,Q,T,s] ))
        if r==v:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,T,Q,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dabba'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][w,Q,T,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSbaba'][w,Q,T,s] ))
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,U,Q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][w,Q,U,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,Q,U,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dw,:] ) ,
                             -HD['HSbaba'][w,Q,U,s] * HD['Dbb'][Dr,Dv] ,
                             +HD['HSbaba'][v,Q,U,s] * HD['Dbb'][Dr,Dw] ))
        if r==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][s,U,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dabba'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][v,Q,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSbaba'][v,Q,U,s] ))
        if r==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][s,U,Q,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dabba'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][w,Q,U,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSbaba'][w,Q,U,s] ))
    return result


def lucc_CCAAbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         +HD['HSbaab'][P,Q,s,T] * HD['Dbbbb'][Dr,Du,Dv,Dw] ))
    return result


def lucc_CCAAbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dw,Ds,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][T,Q,s,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                             +HD['HSbaab'][T,Q,s,r] * HD['Dbb'][Du,Dw] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,Q,r,actfloor:actceil], HD['Dbaba'][Dw,Ds,Du,:] ) ))
        if r==u:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Ds,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][T,Q,s,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    return result


def lucc_CCAAbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    if r==u:
        if P==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,Q,V,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -HD['HSbaba'][T,Q,V,s] ))
        if P==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][T,Q,W,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +HD['HSbaba'][T,Q,W,s] ))
    if P==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,Q,V,actfloor:actceil], HD['Dbaba'][Dr,Ds,Du,:] ) ,
                             +HD['HSbaba'][T,Q,V,s] * HD['Dbb'][Dr,Du] ))
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][T,Q,W,actfloor:actceil], HD['Dbaba'][Dr,Ds,Du,:] ) ,
                             -HD['HSbaba'][T,Q,W,s] * HD['Dbb'][Dr,Du] ))
    return result


def lucc_CCAAbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VAAAbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Dt,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dt,Du,Ds,Dq,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dt,Du,Ds,Dq,Dw,:,:] ) ))
    result += 2 * fsum(( +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                         +HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                         -HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbaaabba'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbaaabba'][Dr,Dt,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbaaabba'][Dr,Dv,Ds,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbaaabba'][Dr,Dw,Ds,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,q,t,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,q,u,actfloor:actceil], HD['Dbbabba'][Dr,Dt,Ds,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,q,w,actfloor:actceil], HD['Dbbabba'][Dr,Dv,Ds,Dt,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,q,v,actfloor:actceil], HD['Dbbabba'][Dr,Dw,Ds,Dt,Du,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] ,
                         +HD['HSbb'][P,u] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Dt] ,
                         -HD['HSbb'][P,w] * HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dv] ,
                         +HD['HSbb'][P,v] * HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dw] ,
                         +HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                         -HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbababbb'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbababbb'][Dr,Dt,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbababbb'][Dr,Dv,Ds,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbababbb'][Dr,Dw,Ds,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][t,u,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,w,actfloor:actceil,P], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dr,:] ) ))
    if r==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dt,Du,Ds,:,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dt,Du,Ds,:,Dq,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Ds,Dv,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dt,Du,Ds,:,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dt,Du,Ds,:,Dq,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Ds,Dw,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dv,Dw,Ds,:,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Ds,:,Dq,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dv,Dw,Ds,:,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Ds,:,Dq,Dt,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Dt,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ))
    return result


def lucc_VAAAbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaabba'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] ,
                         -HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbababbb'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Ds,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Dw,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,w,T,actfloor:actceil], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dw,:] ) ,
                         +HD['HSbbbb'][P,T,v,w] * HD['Dbaab'][Du,Dq,Ds,Dr] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Du,Ds,:,Dq,Dv,:] ) ,
                             +HD['Dbaab'][Dv,Dq,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dv,Dq,Ds,Du] ,
                             +HD['Dbaab'][Dv,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Du,Ds,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Du,Ds,:,Dq,Dw,:] ) ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                             -HD['HSbb'][P,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Du,Ds,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,w,T,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ))
    return result


def lucc_VAAAbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ,
                         +HD['HSbbbb'][P,w,T,U] * HD['Dbaab'][Dv,Dq,Ds,Dr] ,
                         -HD['HSbbbb'][P,v,T,U] * HD['Dbaab'][Dw,Dq,Ds,Dr] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbaab'][Dv,Dq,Ds,:] ) ,
                             +HD['HSbbbb'][P,v,T,U] * HD['Daa'][Dq,Ds] ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbaab'][Dw,Dq,Ds,:] ) ,
                             -HD['HSbbbb'][P,w,T,U] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_VAAAbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Dv,Dw,Ds,Dq,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaabba'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,q,actfloor:actceil,T], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         -HD['HSbb'][P,T] * HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] ,
                         +HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbababbb'][Dr,Du,Ds,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,u,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaabbaa'][Dr,Du,Ds,:,Dv,Dw,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaabbaa'][Dv,Dw,Dq,:,Dr,Du,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dv,Dw,Dq,:,Ds,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,u,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabbbab'][Dr,Du,Ds,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabbbab'][Dv,Dw,Dq,:,Dr,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dv,Dw,Dq,Dr,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dq,:,Ds,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][u,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Dr,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ))
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] )
    return result


def lucc_VAAAbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Du,Ds,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbbaabb'][Dr,Dw,Ds,Dq,Du,:] ) ,
                         +HD['HSbbbb'][P,V,u,T] * HD['Dbaab'][Dw,Dq,Ds,Dr] ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,V,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,Ds,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbabbba'][Dw,Dq,:,Dr,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][q,V,u,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbaaaba'][Dw,Dq,:,Ds,Du,:] ) ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,s,V,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][u,s,V,actfloor:actceil], HD['Dbaba'][Dw,Dq,Dr,:] ) ,
                             -HD['HSbb'][r,V] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbababb'][Dw,Dq,:,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,u,V,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ))
    if r==u:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbaab'][Dw,Ds,Dq,:] )
    return result


def lucc_VAAAbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,T,V,W] * HD['Dbaab'][Du,Dq,Ds,Dr]
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][V,W,r,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ,
                             -HD['HSbbbb'][r,u,V,W] * HD['Daa'][Dq,Ds] ))
    if r==u:
        result += 2 * -HD['HSbbbb'][P,T,V,W] * HD['Daa'][Dq,Ds]
    return result


def lucc_VAAAbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dr,:] )
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][U,r,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][U,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Dr,:,:] ) ))
    if P==U:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Dr,:,:] ) ))
    return result


def lucc_VAAAbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,V,T,U] * HD['Dbaab'][Dw,Dq,Ds,Dr]
    if P==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Dbaba'][Dw,Dq,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,U], HD['Dbaba'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][U,s,V,actfloor:actceil], HD['Dbaba'][Dw,Dq,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][U,r,V,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ))
    return result


def lucc_VAAAbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==T:
        result += 2 * +HD['HSbbbb'][U,r,V,W] * HD['Daa'][Dq,Ds]
    if P==U:
        result += 2 * -HD['HSbbbb'][T,r,V,W] * HD['Daa'][Dq,Ds]
    return result


def lucc_VACAbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][u,R,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,w,R,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbbaabb'][Dt,Du,Ds,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][w,R,actfloor:actceil,P], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbbaabb'][Dt,Du,Dq,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,u,R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Dt,:] ) ))
    return result


def lucc_VACAbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                         +HD['HSbbbb'][P,w,R,T] * HD['Dbaab'][Dv,Dq,Ds,Du] ,
                         -HD['HSbbbb'][P,v,R,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                         +HD['HSbbbb'][P,T,R,w] * HD['Dbaab'][Du,Dq,Ds,Dv] ,
                         -HD['HSbbbb'][P,T,R,v] * HD['Dbaab'][Du,Dq,Ds,Dw] ))
    if R==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dv,Dw,Ds,:,Dq,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Ds,:,Dq,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                             -HD['Dbaab'][Du,Dq,Ds,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                             +HD['Dbaab'][Du,Dq,Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaba'][Dw,Ds,:,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaaaba'][Dv,Ds,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,q,w,actfloor:actceil], HD['Dbaba'][Dv,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,q,v,actfloor:actceil], HD['Dbaba'][Dw,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                             +HD['HSbb'][P,w] * HD['Dbaab'][Du,Dq,Ds,Dv] ,
                             -HD['HSbb'][P,v] * HD['Dbaab'][Du,Dq,Ds,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ,
                             +HD['Dbaab'][Du,Dq,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             -HD['Dbaab'][Du,Dq,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbababb'][Dv,Ds,:,Dq,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbababb'][Dw,Ds,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,w,actfloor:actceil,P], HD['Dbaab'][Du,Dq,Ds,:] ) ))
    return result


def lucc_VACAbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,U,w,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,U,v,actfloor:actceil], HD['Dbaab'][Dw,Ds,Dq,:] ) ,
                             -HD['HSbbbb'][P,U,v,w] * HD['Daa'][Dq,Ds] ))
    if R==U:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbaab'][Dv,Ds,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbaab'][Dw,Ds,Dq,:] ) ,
                             +HD['HSbbbb'][P,T,v,w] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_VACAbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Ds,Dq,Du,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dv,Dw,Dq,:,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][u,R,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dv,Dw,Dq,:,Ds,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbabbba'][Du,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,Du,:] ) ))
    return result


def lucc_VACAbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbbbb'][P,T,R,V] * HD['Dbaab'][Du,Dq,Ds,Dw] ,
                         +HD['HSbbbb'][P,V,R,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbaaaba'][Dw,Dq,:,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][q,V,R,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             -HD['HSbb'][R,V] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbababb'][Dw,Dq,:,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][u,R,V,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] ) ))
        if R==V:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSaaaa'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Du,Ds,:,Dw,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSaaaa'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dw,Dq,:,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][q,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSaa'][s,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSabab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dw,Dq,:,Du,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Du,Ds,:,Dw,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][q,actfloor:actceil,u,actfloor:actceil], HD['Dabba'][Ds,:,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][u,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Dq,:,:] ) ))
    if R==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Du,Ds,:,Dq,Dw,:] ) ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,q,actfloor:actceil,T], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dw,Dq,Ds,Du] ,
                             -HD['Dbaab'][Dw,Dq,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Du,Ds,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,u,actfloor:actceil,P], HD['Dbaab'][Dw,Dq,Ds,:] ) ))
    return result


def lucc_VACAbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][V,W,R,actfloor:actceil], HD['Dbaab'][Du,Ds,Dq,:] ) ,
                             +HD['HSbbbb'][u,R,V,W] * HD['Daa'][Dq,Ds] ))
        if R==W:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,V,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,Ds,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dabba'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][q,V,u,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][u,s,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,W,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,Ds,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][s,actfloor:actceil,W,actfloor:actceil], HD['Dabba'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][q,W,u,actfloor:actceil], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][u,s,W,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if R==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbaab'][Du,Ds,Dq,:] ) ,
                             +HD['HSbbbb'][P,V,u,T] * HD['Daa'][Dq,Ds] ))
    if R==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,W,actfloor:actceil,T], HD['Dbaab'][Du,Ds,Dq,:] ) ,
                             -HD['HSbbbb'][P,W,u,T] * HD['Daa'][Dq,Ds] ))
    return result


def lucc_VACAbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][U,R,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] )
    if P==U:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,R,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,Dq,Ds,:,:] )
    return result


def lucc_VACAbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbaab'][Dw,Dq,Ds,:] )
        if P==U:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dabba'][Ds,:,Dw,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Dq,:,:] ) ))
        if P==T:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,actfloor:actceil,U], HD['Dabba'][Ds,:,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][U,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Dq,:,:] ) ))
    if P==U:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,R,V,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] )
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][U,R,V,actfloor:actceil], HD['Dbaab'][Dw,Dq,Ds,:] )
    return result


def lucc_VACAbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    if P==U:
        result += 2 * -HD['HSbbbb'][T,R,V,W] * HD['Daa'][Dq,Ds]
        if R==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,T], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][T,s,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,W,actfloor:actceil,T], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,s,W,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if R==W:
        result += 2 * -HD['HSbbbb'][P,V,T,U] * HD['Daa'][Dq,Ds]
        if P==T:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,V,actfloor:actceil,U], HD['Daa'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][U,s,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if R==V:
        result += 2 * +HD['HSbbbb'][P,W,T,U] * HD['Daa'][Dq,Ds]
        if P==T:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][q,W,actfloor:actceil,U], HD['Daa'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][U,s,W,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if P==T:
        result += 2 * +HD['HSbbbb'][U,R,V,W] * HD['Daa'][Dq,Ds]
    return result


def lucc_VACCbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbbaabb'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][w,S,actfloor:actceil,P], HD['Dbaba'][Du,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][v,S,actfloor:actceil,P], HD['Dbaba'][Du,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][P,q,S,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -HD['HSbaab'][P,q,S,w] * HD['Dbb'][Du,Dv] ,
                             +HD['HSbaab'][P,q,S,v] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_VACCbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Dq,Du,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][R,S,q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    return result


def lucc_VACCbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -HD['HSabab'][q,V,S,R] * HD['Dbb'][Du,Dw] ,
                             -einsum( 'i,i->', HD['HSbaba'][R,S,V,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ))
        if R==V:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Dw,Dq,:,Du,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSaa'][S,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 +HD['HSaa'][q,S] * HD['Dbb'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSaaaa'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][q,actfloor:actceil,S,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][q,:actfloor,S,:actfloor] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSabab'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][q,actfloor:actceil,S,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSabba'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Dw,Dq,:,Du,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][u,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Dq,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][u,S,q,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,S,actfloor:actceil,P], HD['Dbaba'][Dw,Dq,Du,:] ) ,
                             -HD['HSbaab'][P,q,S,T] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_VACCbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    if P==T:
        if R==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][q,V,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 -HD['HSabab'][q,V,S,u] ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,S,V,actfloor:actceil], HD['Dabba'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][u,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][q,W,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 +HD['HSabab'][q,W,S,u] ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][actfloor:actceil,S,W,actfloor:actceil], HD['Dabba'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][u,S,W,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    return result


def lucc_VACCbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    if R==V:
        if P==U:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][T,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Dq,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][T,S,q,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if P==T:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][U,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,Dq,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][U,S,q,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    return result


def lucc_VACCbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    if P==U:
        if R==W:
            result += 2 * fsum(( +HD['HSabab'][q,V,S,T] ,
                                 -einsum( 'i,i->', HD['HSbaba'][T,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
        if R==V:
            result += 2 * fsum(( -HD['HSabab'][q,W,S,T] ,
                                 +einsum( 'i,i->', HD['HSbaba'][T,S,W,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if R==W:
        if P==T:
            result += 2 * fsum(( -HD['HSabab'][q,V,S,U] ,
                                 +einsum( 'i,i->', HD['HSbaba'][U,S,V,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    if R==V:
        if P==T:
            result += 2 * fsum(( +HD['HSabab'][q,W,S,U] ,
                                 -einsum( 'i,i->', HD['HSbaba'][U,S,W,actfloor:actceil], HD['Daa'][Dq,:] ) ))
    return result


def lucc_VVAAbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,Q,t,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,Q,u,actfloor:actceil], HD['Dbbabba'][Dr,Dt,Ds,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,Q,w,actfloor:actceil], HD['Dbbabba'][Dr,Dv,Ds,Dt,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Dbbabba'][Dr,Dw,Ds,Dt,Du,:] ) ))
    if r==w:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Ds,Dv,:,:] )
    if r==v:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,Ds,Dw,:,:] )
    if r==t:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Du,:,:] )
    if r==u:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Dt,:,:] )
    return result


def lucc_VVAAbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] )
    if r==w:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dv,:] )
    if r==v:
        result += 2 * +einsum( 'i,i->', HD['HSbaba'][P,Q,T,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] )
    return result


def lucc_VVAAbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] )
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaabbaa'][Dr,Du,Ds,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabbbab'][Dr,Du,Ds,:,Dv,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbabba'][Dr,Du,Ds,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] ) ))
    return result


def lucc_VVAAbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][Q,V,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,Ds,Dw,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][Q,V,u,actfloor:actceil], HD['Dbaba'][Dr,Ds,Dw,:] ) ))
    return result


def lucc_VVAAbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==U:
        result += 2 * -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] )
    if P==T:
        result += 2 * +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbabbba'][Dr,Ds,:,Dv,Dw,:] )
    return result


def lucc_VVAAbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==U:
        result += 2 * -einsum( 'i,i->', HD['HSabab'][Q,V,actfloor:actceil,T], HD['Dbaba'][Dr,Ds,Dw,:] )
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSabab'][Q,V,actfloor:actceil,U], HD['Dbaba'][Dr,Ds,Dw,:] )
    return result


def lucc_VVAAbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VVCAbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,Ds,Du,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,Q,w,actfloor:actceil], HD['Dbaba'][Dv,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,Q,v,actfloor:actceil], HD['Dbaba'][Dw,Ds,Du,:] ) ))
    return result


def lucc_VVCAbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbabbba'][Du,Ds,:,Dv,Dw,:] )
    return result


def lucc_VVCAbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSabba'][Q,V,R,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] )
        if R==V:
            result += -einsum( 'ijk,ijk->', HD['HSaaaa'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaabaa'][Du,Ds,:,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSaa'][Q,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSaaaa'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbabbab'][Du,Ds,:,Dw,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSabba'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaba'][Du,Ds,Dw,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dabba'][Ds,:,Dw,:] ) ))
    if R==V:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][P,Q,actfloor:actceil,T], HD['Dbaba'][Du,Ds,Dw,:] )
    return result


def lucc_VVCAbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    if P==T:
        if R==W:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][Q,V,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,Ds,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][Q,V,u,actfloor:actceil], HD['Daa'][Ds,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][Q,W,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,Ds,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][Q,W,u,actfloor:actceil], HD['Daa'][Ds,:] ) ))
    return result


def lucc_VVCAbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    if R==V:
        if P==U:
            result += 2 * -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dabba'][Ds,:,Dw,:] )
        if P==T:
            result += 2 * +einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dabba'][Ds,:,Dw,:] )
    return result


def lucc_VVCAbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    if P==U:
        if R==W:
            result += 2 * +einsum( 'i,i->', HD['HSabab'][Q,V,actfloor:actceil,T], HD['Daa'][Ds,:] )
        if R==V:
            result += 2 * -einsum( 'i,i->', HD['HSabab'][Q,W,actfloor:actceil,T], HD['Daa'][Ds,:] )
    if R==W:
        if P==T:
            result += 2 * -einsum( 'i,i->', HD['HSabab'][Q,V,actfloor:actceil,U], HD['Daa'][Ds,:] )
    if R==V:
        if P==T:
            result += 2 * +einsum( 'i,i->', HD['HSabab'][Q,W,actfloor:actceil,U], HD['Daa'][Ds,:] )
    return result


def lucc_VVCCbaba_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbaba_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,Q,S,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -HD['HSbaab'][P,Q,S,w] * HD['Dbb'][Du,Dv] ,
                             +HD['HSbaab'][P,Q,S,v] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_VVCCbaba_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbaba_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSbaba'][R,S,actfloor:actceil,Q], HD['Dbbbb'][Dv,Dw,Du,:] )
    return result


def lucc_VVCCbaba_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * -HD['HSabab'][Q,V,S,R] * HD['Dbb'][Du,Dw]
        if R==V:
            result += 2 * fsum(( +HD['HSaa'][Q,S] * HD['Dbb'][Du,Dw] ,
                                 -einsum( 'ij,ij->', HD['HSaaaa'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSaaaa'][Q,:actfloor,S,:actfloor] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSabab'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][u,S,actfloor:actceil,Q], HD['Dbb'][Dw,:] ) ))
    if R==V:
        result += 2 * -HD['HSbaab'][P,Q,S,T] * HD['Dbb'][Du,Dw]
    return result


def lucc_VVCCbaba_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if P==T:
        if R==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][Q,V,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 -HD['HSabab'][Q,V,S,u] ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][Q,W,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 +HD['HSabab'][Q,W,S,u] ))
    return result


def lucc_VVCCbaba_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbaba_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if R==V:
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSbaba'][T,S,actfloor:actceil,Q], HD['Dbb'][Dw,:] )
        if P==T:
            result += 2 * +einsum( 'i,i->', HD['HSbaba'][U,S,actfloor:actceil,Q], HD['Dbb'][Dw,:] )
    return result


def lucc_VVCCbaba_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    if P==U:
        if R==W:
            result += 2 * +HD['HSabab'][Q,V,S,T]
        if R==V:
            result += 2 * -HD['HSabab'][Q,W,S,T]
    if R==W:
        if P==T:
            result += 2 * -HD['HSabab'][Q,V,S,U]
    if R==V:
        if P==T:
            result += 2 * +HD['HSabab'][Q,W,S,U]
    return result


def lucc_AAAAbbbb_CAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dv,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dv,Dp,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,:,Dv,Dr,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,:,Dv,Ds,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dp,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dq,Dv,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dq,Dv,Ds,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][q,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][q,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][s,v,T,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][s,T,v,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,v,T,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,T,v,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Ds,:] ) ))
    return result


def lucc_AAAAbbbb_VAaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dp,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dq,Dv,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dp,Dq,Dv,Ds,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,:,Dv,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,:,Dv,Dp,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbaabb'][Dp,Dq,:,Dv,Dr,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbaabb'][Dp,Dq,:,Dv,Ds,:] ) ))
    return result


def lucc_AAAAbbbb_VCaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,V) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,p,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][T,q,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][T,s,V,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][T,r,V,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][p,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][q,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][s,V,actfloor:actceil,T], HD['Dbbbb'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,V,actfloor:actceil,T], HD['Dbbbb'][Dp,Dq,Ds,:] ) ))
    return result


def lucc_CAAAbbbb_AAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dv,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dt,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dt,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][t,P,r,actfloor:actceil], HD['Dbaba'][Ds,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Dbaba'][Ds,Dt,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][t,P,s,actfloor:actceil], HD['Dbaba'][Dr,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][v,P,s,actfloor:actceil], HD['Dbaba'][Dr,Dt,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,v,P,actfloor:actceil], HD['Dbaba'][Dq,Dt,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,t,P,actfloor:actceil], HD['Dbaba'][Dq,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][s,v,P,actfloor:actceil], HD['Dbaba'][Dq,Dt,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][s,t,P,actfloor:actceil], HD['Dbaba'][Dq,Dv,Dr,:] ) ))
    return result


def lucc_CAAAbbbb_CAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -HD['HSabab'][v,P,T,r] * HD['Dbb'][Dq,Ds] ,
                         +HD['HSabab'][v,P,T,s] * HD['Dbb'][Dq,Dr] ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         +HD['HSbaab'][P,T,v,r] * HD['Dbb'][Dq,Ds] ,
                         -HD['HSbaab'][P,T,v,s] * HD['Dbb'][Dq,Dr] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Dbaba'][Ds,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Dbaba'][Dq,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,s,actfloor:actceil], HD['Dbaba'][Dr,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][s,T,P,actfloor:actceil], HD['Dbaba'][Dq,Dv,Dr,:] ) ))
    return result


def lucc_CAAAbbbb_VAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,:,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][T,P,s,actfloor:actceil], HD['Dbaba'][Dr,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][T,s,P,actfloor:actceil], HD['Dbaba'][Dq,Dv,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Dbaba'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,r,P,actfloor:actceil], HD['Dbaba'][Dq,Dv,Ds,:] ) ))
    return result


def lucc_CAAAbbbb_VCaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -HD['HSabab'][T,P,V,s] * HD['Dbb'][Dq,Dr] ,
                         +HD['HSabab'][T,P,V,r] * HD['Dbb'][Dq,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -HD['HSbaba'][P,V,s,T] * HD['Dbb'][Dq,Dr] ,
                         +HD['HSbaba'][P,V,r,T] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_CCAAbbbb_AAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_CAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VCaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VAAAbbbb_AAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dv,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dt,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dt,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dq,:,:] ) ))
    return result


def lucc_VAAAbbbb_CAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dv,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ))
    return result


def lucc_VAAAbbbb_VAaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Dv,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,:,Dv,Dq,:] ) ))
    return result


def lucc_VAAAbbbb_VCaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][P,T,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dq,:] ) ))
    return result


def lucc_VACAbbbb_AAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,v) = e
    Dq, Ds, Dt, Dv = q-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][t,R,actfloor:actceil,P], HD['Dbaba'][Dq,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Dbaba'][Dq,Dt,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,v,R,actfloor:actceil], HD['Dbaba'][Ds,Dt,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,t,R,actfloor:actceil], HD['Dbaba'][Ds,Dv,Dq,:] ) ))
    return result


def lucc_VACAbbbb_CAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Dbaba'][Dq,Dv,Ds,:] ) ,
                         -HD['HSbaab'][P,v,T,R] * HD['Dbb'][Dq,Ds] ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Dbaba'][Ds,Dv,Dq,:] ) ,
                         +HD['HSbaba'][P,T,R,v] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_VACAbbbb_VAaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Dbaba'][Dq,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Dbaba'][Ds,Dv,Dq,:] ) ))
    return result


def lucc_VACAbbbb_VCaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,V) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbaab'][P,T,V,R] * HD['Dbb'][Dq,Ds] ,
                         -HD['HSbaba'][P,V,R,T] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_VACCbbbb_AAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,v) = e
    Dq, Dt, Dv = q-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VACCbbbb_CAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VAaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VCaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,V) = e
    Dq = q-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_AAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_CAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VAaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VCaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_AAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,v) = e
    Ds, Dt, Dv = s-actfloor, t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_CAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VAaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VCaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,V) = e
    Ds = s-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_AAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_CAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VAaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VCaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,V) = e
    result = 0
    return result


def lucc_AAAAbbbb_CAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dv,Ds,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dp,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dv,Dr,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dp,Dq,:,Dr,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dp,Dq,:,Ds,Dv,:] ) ,
                         -HD['Dbbbb'][Dp,Dq,Dr,Dv] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbbb'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbbb'][Dp,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                         -HD['HSbb'][p,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         +HD['HSbb'][q,T] * HD['Dbbbb'][Dp,Dv,Dr,Ds] ,
                         -HD['HSbb'][s,T] * HD['Dbbbb'][Dp,Dq,Dr,Dv] ,
                         +HD['HSbb'][r,T] * HD['Dbbbb'][Dp,Dq,Ds,Dv] ,
                         -HD['Dbbbb'][Dp,Dq,Dr,Dv] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbbb'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbbb'][Dp,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,:,Dr,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][q,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][q,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,v,T,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,T,v,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Ds,:] ) ))
    if r==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dp,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dp,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dq,:] ) ,
                             -HD['Dbb'][Dp,Ds] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][p,T] * HD['Dbb'][Dq,Ds] ,
                             -HD['HSbb'][q,T] * HD['Dbb'][Dp,Ds] ,
                             -HD['Dbb'][Dp,Ds] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dq,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    if s==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dp,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dp,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dq,:] ) ,
                             +HD['Dbb'][Dp,Dr] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][p,T] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbb'][q,T] * HD['Dbb'][Dp,Dr] ,
                             +HD['Dbb'][Dp,Dr] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    if p==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dq,:,Ds,:] ) ,
                             +HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][s,T] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbb'][r,T] * HD['Dbb'][Dq,Ds] ,
                             -HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             +HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    if q==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dp,:,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dp,:,Ds,:] ) ,
                             -HD['Dbb'][Dp,Dr] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                             +HD['Dbb'][Dp,Ds] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][s,T] * HD['Dbb'][Dp,Dr] ,
                             +HD['HSbb'][r,T] * HD['Dbb'][Dp,Ds] ,
                             +HD['Dbb'][Dp,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -HD['Dbb'][Dp,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dp,:,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dp,:,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbb'][Dp,:] ) ))
    return result


def lucc_AAAAbbbb_VAbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,v) = e
    Dp, Dq, Dr, Ds, Dv = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dv,Ds,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dp,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dv,Dr,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dp,Dq,:,Dr,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dp,Dv,:] ) ,
                         +HD['Dbbbb'][Dp,Dq,Dr,Dv] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbbb'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbbb'][Dp,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,T] ) ,
                         -HD['HSbb'][p,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         +HD['HSbb'][q,T] * HD['Dbbbb'][Dp,Dv,Dr,Ds] ,
                         -HD['HSbb'][s,T] * HD['Dbbbb'][Dp,Dq,Dr,Dv] ,
                         +HD['HSbb'][r,T] * HD['Dbbbb'][Dp,Dq,Ds,Dv] ,
                         -HD['Dbbbb'][Dp,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbbb'][Dp,Dq,Dr,Dv] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbbb'][Dp,Dq,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dp,Dq,:,Dr,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dp,Dq,:,Ds,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dp,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,s,actfloor:actceil,T], HD['Dbbbb'][Dp,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,q,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dv,:] ) ))
    return result


def lucc_AAAAbbbb_VCbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,V) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][q,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,q,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,V,actfloor:actceil,T], HD['Dbbbb'][Dp,Dq,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,s,V,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbbbb'][Dp,Dq,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Ds,:] ) ))
    return result


def lucc_CAAAbbbb_AAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dq,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dq,Dt,:] ) ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbbbb'][Dq,Dt,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -HD['HSbb'][P,t] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         +HD['HSbb'][P,v] * HD['Dbbbb'][Dq,Dt,Dr,Ds] ,
                         -HD['Dbbbb'][Dq,Dt,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,P,s,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,v,P,actfloor:actceil], HD['Dbbbb'][Dq,Dt,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,s,actfloor:actceil], HD['Dbbbb'][Dr,Dt,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,t,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbbbb'][Dq,Dt,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbbbb'][Ds,Dt,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                         -HD['HSbbbb'][t,P,r,s] * HD['Dbb'][Dq,Dv] ,
                         +HD['HSbbbb'][v,P,r,s] * HD['Dbb'][Dq,Dt] ))
    if q==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -HD['HSbb'][P,s] * HD['Dbb'][Dr,Dv] ,
                             +HD['HSbb'][P,r] * HD['Dbb'][Ds,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    if q==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dt,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaba'][Dr,:,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaba'][Ds,:,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ,
                             -HD['Dbb'][Dr,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Dbb'][Ds,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ,
                             -HD['HSbb'][P,r] * HD['Dbb'][Ds,Dt] ,
                             +HD['HSbb'][P,s] * HD['Dbb'][Dr,Dt] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ,
                             -HD['Dbb'][Dr,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Dbb'][Ds,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbb'][Dr,:,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbb'][Ds,:,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbb'][Dt,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,:,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dt,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaba'][Dt,:,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dt,Dq,:] ) ,
                             -HD['Dbb'][Dq,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Dt,Dq,:] ) ,
                             +HD['HSbb'][P,s] * HD['Dbb'][Dq,Dt] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dt,Dq,:] ) ,
                             -HD['Dbb'][Dq,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbb'][Dt,:,Dq,:] ) ))
    if s==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaba'][Dt,:,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Dt,Dq,:] ) ,
                             +HD['Dbb'][Dq,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Dt,Dq,:] ) ,
                             -HD['HSbb'][P,r] * HD['Dbb'][Dq,Dt] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Dt,Dq,:] ) ,
                             +HD['Dbb'][Dq,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbb'][Dt,:,Dq,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,:,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dv,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaba'][Dv,:,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             +HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             -HD['HSbb'][P,s] * HD['Dbb'][Dq,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             +HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbb'][Dv,:,Dq,:] ) ))
    if s==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,:,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaba'][Dv,:,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                             -HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                             +HD['HSbb'][P,r] * HD['Dbb'][Dq,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                             -HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbb'][Dv,:,Dq,:] ) ))
    return result


def lucc_CAAAbbbb_CAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         -HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,s,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                         -HD['HSbbbb'][P,T,r,v] * HD['Dbb'][Dq,Ds] ,
                         -HD['HSbbbb'][v,P,T,r] * HD['Dbb'][Dq,Ds] ,
                         +HD['HSbbbb'][P,T,r,s] * HD['Dbb'][Dq,Dv] ,
                         +HD['HSbbbb'][P,T,s,v] * HD['Dbb'][Dq,Dr] ,
                         +HD['HSbbbb'][v,P,T,s] * HD['Dbb'][Dq,Dr] ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Dr,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Ds,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][q,v,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,:,Ds,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,v] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dq,:,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             +HD['HSbb'][s,v] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbb'][r,v] * HD['Dbb'][Dq,Ds] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,v] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,v,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,:,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,:,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,:,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
        if s==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,:,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,:,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,:,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,:,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dq,:] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbb'][Dq,Ds] ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    if s==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dq,:] ) ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbb'][Dq,Dr] ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    if q==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                             -HD['HSbbbb'][P,T,r,s] ))
    return result


def lucc_CAAAbbbb_VAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,s,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,s,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                         -HD['HSbbbb'][T,P,r,s] * HD['Dbb'][Dq,Dv] ))
    return result


def lucc_CAAAbbbb_VCbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -HD['HSbbbb'][T,P,V,s] * HD['Dbb'][Dq,Dr] ,
                         -HD['HSbbbb'][P,V,s,T] * HD['Dbb'][Dq,Dr] ,
                         +HD['HSbbbb'][T,P,V,r] * HD['Dbb'][Dq,Ds] ,
                         +HD['HSbbbb'][P,V,r,T] * HD['Dbb'][Dq,Ds] ))
    if P==V:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Dq,:,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Dq,:,Ds,:] ) ,
                             +HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                             -HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][s,T] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbb'][r,T] * HD['Dbb'][Dq,Ds] ,
                             +HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                             -HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Dq,:,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Dq,:,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,actfloor:actceil,T], HD['Dbb'][Dq,:] ) ))
    return result


def lucc_CCAAbbbb_AAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,t,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ,
                         -HD['HSbbbb'][P,Q,s,v] * HD['Dbb'][Dr,Dt] ,
                         +HD['HSbbbb'][P,Q,s,t] * HD['Dbb'][Dr,Dv] ,
                         +HD['HSbbbb'][P,Q,r,v] * HD['Dbb'][Ds,Dt] ,
                         -HD['HSbbbb'][P,Q,r,t] * HD['Dbb'][Ds,Dv] ))
    if r==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dt,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,s,actfloor:actceil], HD['Dbb'][Dt,:] )
    if s==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dt,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,r,actfloor:actceil], HD['Dbb'][Dt,:] )
    if r==t:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dv,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,s,actfloor:actceil], HD['Dbb'][Dv,:] )
    if s==t:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,r,actfloor:actceil], HD['Dbb'][Dv,:] )
    return result


def lucc_CCAAbbbb_CAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                         -HD['HSbbbb'][P,Q,T,s] * HD['Dbb'][Dr,Dv] ,
                         +HD['HSbbbb'][P,Q,T,r] * HD['Dbb'][Ds,Dv] ))
    if Q==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -HD['HSbb'][P,s] * HD['Dbb'][Dr,Dv] ,
                             +HD['HSbb'][P,r] * HD['Dbb'][Ds,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,P,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                             +HD['HSbbbb'][v,P,r,s] ))
        if r==v:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,:,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,:,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +HD['HSbb'][P,s] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,:,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,:,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbb'][P,r] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,r] ) ,
                             -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,s] ) ,
                             +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +HD['HSbb'][Q,s] * HD['Dbb'][Dr,Dv] ,
                             -HD['HSbb'][Q,r] * HD['Dbb'][Ds,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,r] ) ,
                             -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,Q,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,Q,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                             -HD['HSbbbb'][v,Q,r,s] ))
        if r==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,:,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,:,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -HD['HSbb'][Q,s] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==v:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,:,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,:,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbb'][Q,r] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                             +HD['HSbbbb'][P,Q,T,s] ))
    if s==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             -HD['HSbbbb'][P,Q,T,r] ))
    return result


def lucc_CCAAbbbb_VAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                         +HD['HSbbbb'][P,Q,s,T] * HD['Dbb'][Dr,Dv] ,
                         -HD['HSbbbb'][P,Q,r,T] * HD['Dbb'][Ds,Dv] ))
    return result


def lucc_CCAAbbbb_VCbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==V:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,P,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                             -HD['HSbbbb'][T,P,r,s] ))
    if P==V:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,Q,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,Q,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                             +HD['HSbbbb'][T,Q,r,s] ))
    return result


def lucc_VAAAbbbb_AAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,v) = e
    Dq, Dr, Ds, Dt, Dv = q-actfloor, r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dq,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,:,:] ) ))
    result += 2 * fsum(( +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbbbb'][Dq,Dt,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dq,Dt,:] ) ,
                         -HD['HSbb'][P,t] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         +HD['HSbb'][P,v] * HD['Dbbbb'][Dq,Dt,Dr,Ds] ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         -HD['Dbbbb'][Dq,Dt,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,q,t,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,q,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,:,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dt,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dt,:,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dt,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Dt,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dt,Dq,:] ) ))
    if s==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,:,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dt,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,:,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Dt,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Dt,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Dt,Dq,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,:,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dv,:,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ))
    if s==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,:,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,:,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ))
    if q==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ))
    if q==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ))
    return result


def lucc_VAAAbbbb_CAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         -HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dq,:] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbb'][Dq,Ds] ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dq,:] ) ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbb'][Dq,Dr] ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    if q==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
    return result


def lucc_VAAAbbbb_VAbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,v) = e
    Dq, Dr, Ds, Dv = q-actfloor, r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dq,Dv,:] ) ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         +HD['Dbbbb'][Dq,Dv,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,q,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dv,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Dr,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Ds,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,:,Ds,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ))
    return result


def lucc_VAAAbbbb_VCbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,V) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dq,:] ) ))
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][q,V,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dq,:,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dq,:,Ds,:] ) ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             -HD['HSbb'][s,V] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbb'][r,V] * HD['Dbb'][Dq,Ds] ,
                             -HD['Dbb'][Dq,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dq,:,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dq,:,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    return result


def lucc_VACAbbbb_AAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,v) = e
    Dq, Ds, Dt, Dv = q-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbbbb'][Ds,Dt,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbbbb'][Dq,Dt,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                         -HD['HSbbbb'][P,q,R,t] * HD['Dbb'][Ds,Dv] ,
                         +HD['HSbbbb'][P,q,R,v] * HD['Dbb'][Ds,Dt] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Dt,:,Dq,:] ) ,
                             +HD['Dbb'][Dq,Dt] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbb'][Dq,Dt] ,
                             +HD['Dbb'][Dq,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Dt,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbb'][Dt,:] ) ))
    if s==t:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Dv,:,Dq,:] ) ,
                             -HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbb'][Dq,Dv] ,
                             -HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Dv,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ))
    if q==t:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                             -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbb'][Ds,Dv] ,
                             -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ))
    if q==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Ds,:,Dt,:] ) ,
                             +HD['Dbb'][Ds,Dt] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbb'][Ds,Dt] ,
                             +HD['Dbb'][Ds,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Ds,:,Dt,:] ) ))
    return result


def lucc_VACAbbbb_CAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                         -HD['HSbbbb'][P,q,R,T] * HD['Dbb'][Ds,Dv] ,
                         +HD['HSbbbb'][P,v,R,T] * HD['Dbb'][Dq,Ds] ,
                         +HD['HSbbbb'][P,T,R,v] * HD['Dbb'][Dq,Ds] ))
    if R==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,:,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dv,:,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             -HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             +HD['HSbb'][P,v] * HD['Dbb'][Dq,Ds] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             -HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,v,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
        if q==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,:,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    if q==v:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbb'][Ds,:] )
    if s==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                             +HD['HSbbbb'][P,q,R,T] ))
    return result


def lucc_VACAbbbb_VAbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,v) = e
    Dq, Ds, Dv = q-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                         -HD['HSbbbb'][P,q,R,T] * HD['Dbb'][Ds,Dv] ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,:,Ds,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                             +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             +HD['HSbb'][q,R] * HD['Dbb'][Ds,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ))
    return result


def lucc_VACAbbbb_VCbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,V) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,T,R,V] * HD['Dbb'][Dq,Ds] ,
                         -HD['HSbbbb'][P,V,R,T] * HD['Dbb'][Dq,Ds] ))
    if R==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Ds,:,Dq,:] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][P,T] * HD['Dbb'][Dq,Ds] ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Ds,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,actfloor:actceil,T], HD['Dbb'][Ds,:] ) ))
        if P==T:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,:,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,:,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,:,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbaba'][Dq,:,Ds,:] ) ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             +HD['HSbb'][R,V] * HD['Dbb'][Dq,Ds] ,
                             +HD['Dbb'][Dq,Ds] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbbbb'][Dq,:,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][q,V,R,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    return result


def lucc_VACCbbbb_AAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,v) = e
    Dq, Dt, Dv = q-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,v,R,S] * HD['Dbb'][Dq,Dt] ,
                         +HD['HSbbbb'][P,t,R,S] * HD['Dbb'][Dq,Dv] ))
    if q==t:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbb'][Dv,:] )
    if q==v:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbb'][Dt,:] )
    return result


def lucc_VACCbbbb_CAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,T,R,S] * HD['Dbb'][Dq,Dv]
    if S==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Dv,:,Dq,:] ) ,
                             -HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbb'][Dq,Dv] ,
                             -HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Dv,:,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                             +HD['HSbbbb'][P,q,R,v] ))
        if q==v:
            result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +HD['HSbb'][P,R] ,
                                 +einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if R==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbaba'][Dv,:,Dq,:] ) ,
                             +HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                             +HD['HSbb'][P,S] * HD['Dbb'][Dq,Dv] ,
                             +HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbbbb'][Dv,:,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,S,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,S,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                             -HD['HSbbbb'][P,q,S,v] ))
        if q==v:
            result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -HD['HSbb'][P,S] ,
                                 -einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if q==v:
        result += 2 * -HD['HSbbbb'][P,T,R,S]
    return result


def lucc_VACCbbbb_VAbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,v) = e
    Dq, Dv = q-actfloor, v-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,T,R,S] * HD['Dbb'][Dq,Dv]
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dv,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,q,actfloor:actceil], HD['Dbb'][Dv,:] )
    return result


def lucc_VACCbbbb_VCbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,V) = e
    Dq = q-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][R,S,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                             -HD['HSbbbb'][q,V,R,S] ))
        if S==V:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,:,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'II->', HD['HSbaba'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbb'][q,R] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'II->', HD['HSbbbb'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,:,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,:,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'II->', HD['HSbaba'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][S,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbb'][q,S] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'II->', HD['HSbbbb'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if S==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                             -HD['HSbbbb'][P,q,R,T] ))
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,S,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                             +HD['HSbbbb'][P,q,S,T] ))
    return result


def lucc_VVAAbbbb_AAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,v) = e
    Dr, Ds, Dt, Dv = r-actfloor, s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,t,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dt,:] ) ))
    if r==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dt,:,:] )
    if s==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dt,:,:] )
    if r==t:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dv,:,:] )
    if s==t:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dv,:,:] )
    return result


def lucc_VVAAbbbb_CAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] )
    if r==v:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbb'][Ds,:] )
    if s==v:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbb'][Dr,:] )
    return result


def lucc_VVAAbbbb_VAbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,v) = e
    Dr, Ds, Dv = r-actfloor, s-actfloor, v-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dv,:] )
    if Q==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,:,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ))
    return result


def lucc_VVAAbbbb_VCbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,V) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,V,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][Q,V,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Ds,:,:] )
    return result


def lucc_VVCAbbbb_AAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,v) = e
    Ds, Dt, Dv = s-actfloor, t-actfloor, v-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,Q,R,t] * HD['Dbb'][Ds,Dv] ,
                         +HD['HSbbbb'][P,Q,R,v] * HD['Dbb'][Ds,Dt] ))
    if s==v:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbb'][Dt,:] )
    if s==t:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbb'][Dv,:] )
    return result


def lucc_VVCAbbbb_CAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,Q,R,T] * HD['Dbb'][Ds,Dv]
    if R==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dv,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbb'][Ds,:] )
    if s==v:
        result += 2 * +HD['HSbbbb'][P,Q,R,T]
    return result


def lucc_VVCAbbbb_VAbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,v) = e
    Ds, Dv = s-actfloor, v-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,Q,R,T] * HD['Dbb'][Ds,Dv]
    if Q==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                             -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbb'][Ds,Dv] ,
                             -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ))
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                             +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][Q,R] * HD['Dbb'][Ds,Dv] ,
                             +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ))
    return result


def lucc_VVCAbbbb_VCbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,V) = e
    Ds = s-actfloor
    result = 0
    if R==V:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbb'][Ds,:] )
        if Q==T:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,:,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,:,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
        if P==T:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,:,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,:,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    if Q==T:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,V,R,actfloor:actceil], HD['Dbb'][Ds,:] )
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][Q,V,R,actfloor:actceil], HD['Dbb'][Ds,:] )
    return result


def lucc_VVCCbbbb_AAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,v) = e
    Dt, Dv = t-actfloor, v-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_CAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    if S==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             +HD['HSbbbb'][P,Q,R,v] ))
    if R==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,S,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                             -HD['HSbbbb'][P,Q,S,v] ))
    return result


def lucc_VVCCbbbb_VAbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,v) = e
    Dv = v-actfloor
    result = 0
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbb'][Dv,:] )
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,Q], HD['Dbb'][Dv,:] )
    return result


def lucc_VVCCbbbb_VCbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,V) = e
    result = 0
    if Q==T:
        result += 2 * +HD['HSbbbb'][P,V,R,S]
        if S==V:
            result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -HD['HSbb'][P,R] ,
                                 -einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +HD['HSbb'][P,S] ,
                                 +einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if S==V:
        result += 2 * -HD['HSbbbb'][P,Q,R,T]
        if P==T:
            result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 +HD['HSbb'][Q,R] ,
                                 +einsum( 'II->', HD['HSbbbb'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if R==V:
        result += 2 * +HD['HSbbbb'][P,Q,S,T]
        if P==T:
            result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,S,actfloor:actceil], HD['Daa'][:,:] ) ,
                                 -HD['HSbb'][Q,S] ,
                                 -einsum( 'II->', HD['HSbbbb'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dbb'][:,:] ) ))
    if P==T:
        result += 2 * -HD['HSbbbb'][Q,V,R,S]
    return result


def lucc_AAAAbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dp,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaaabb'][Dp,Dq,Du,:,Dv,Dw,Dr,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaaabb'][Dp,Dq,Du,:,Dv,Dw,Ds,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dp,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dp,Dq,Dv,Dw,Du,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dp,Dq,Dv,Dw,Du,Ds,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,w,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,v,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][p,T,w,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dv,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][p,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][q,w,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dv,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][q,v,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][q,T,w,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dv,Du,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][q,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][s,w,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Du,Dv,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][s,v,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][s,T,w,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dv,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][s,T,v,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,w,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Du,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,v,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][r,T,w,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dv,Du,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][r,T,v,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,Ds,:] ) ))
    return result


def lucc_AAAAbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAAAbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dp,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dp,Dq,Dv,Dw,Du,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dp,Dq,Dv,Dw,Du,Ds,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dp,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaaabb'][Dp,Dq,Du,:,Dv,Dw,Dr,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaaabb'][Dp,Dq,Du,:,Dv,Dw,Ds,:] ) ))
    return result


def lucc_AAAAbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,p,V,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][T,q,V,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][T,s,V,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][T,r,V,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][p,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][q,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][s,V,actfloor:actceil,T], HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,V,actfloor:actceil,T], HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,:] ) ))
    return result


def lucc_AAAAbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_AAAAbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAAAbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAAAbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Dt,:,Dv,Dw,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Dv,:,Dt,Du,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Dw,:,Dt,Du,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dt,Du,Dv,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dt,Du,Dw,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Dt,Dq,:,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][t,P,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dv,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][u,P,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dv,Dw,Dt,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][w,P,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dt,Du,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][v,P,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dt,Du,Dw,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][t,P,r,actfloor:actceil], HD['Dbaaaba'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][u,P,r,actfloor:actceil], HD['Dbaaaba'][Ds,Dv,Dw,Dt,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Dbaaaba'][Ds,Dt,Du,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][v,P,r,actfloor:actceil], HD['Dbaaaba'][Ds,Dt,Du,Dw,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][s,w,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dt,Du,Dv,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][s,v,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dt,Du,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][s,t,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dv,Dw,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][s,u,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dv,Dw,Dt,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,w,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dt,Du,Dv,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,v,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dt,Du,Dw,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,t,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,u,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dv,Dw,Dt,Ds,:] ) ))
    return result


def lucc_CAAAbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][w,P,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dv,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][v,P,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         +HD['HSabab'][v,P,T,r] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                         +HD['HSabab'][w,P,T,s] * HD['Dbaab'][Dq,Dv,Du,Dr] ,
                         -HD['HSabab'][v,P,T,s] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                         -HD['HSabab'][w,P,T,r] * HD['Dbaab'][Dq,Dv,Du,Ds] ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,w,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dv,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         +HD['HSbaab'][P,T,v,s] * HD['Dbaab'][Dq,Du,Dw,Dr] ,
                         +HD['HSbaab'][P,T,w,r] * HD['Dbaab'][Dq,Du,Dv,Ds] ,
                         -HD['HSbaab'][P,T,v,r] * HD['Dbaab'][Dq,Du,Dw,Ds] ,
                         -HD['HSbaab'][P,T,w,s] * HD['Dbaab'][Dq,Du,Dv,Dr] ,
                         +einsum( 'i,i->', HD['HSbaba'][r,T,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][s,T,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dv,Dw,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,T,r,actfloor:actceil], HD['Dbaaaba'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dv,Dw,Du,Dq,:] ) ))
    return result


def lucc_CAAAbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,P,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dv,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][T,s,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dv,Dw,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][T,P,r,actfloor:actceil], HD['Dbaaaba'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][T,r,P,actfloor:actceil], HD['Dbaaaba'][Dq,Dv,Dw,Du,Ds,:] ) ))
    return result


def lucc_CAAAbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][T,P,V,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         +HD['HSabab'][T,P,V,s] * HD['Dbaab'][Dq,Du,Dw,Dr] ,
                         -HD['HSabab'][T,P,V,r] * HD['Dbaab'][Dq,Du,Dw,Ds] ,
                         +einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         +HD['HSbaba'][P,V,s,T] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                         -HD['HSbaba'][P,V,r,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ))
    return result


def lucc_CAAAbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_CAAAbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CAAAbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VAAAbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Dt,:,Dv,Dw,Dq,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Dv,:,Dt,Du,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Dw,:,Dt,Du,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dt,Du,Dv,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dt,Du,Dw,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Dt,Dq,:,:] ) ))
    return result


def lucc_VAAAbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dq,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,w,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,v,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][P,T,w,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dv,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][P,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ))
    return result


def lucc_VAAAbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaaabb'][Dr,Ds,Du,:,Dv,Dw,Dq,:] ) ))
    return result


def lucc_VAAAbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,T,V,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ))
    return result


def lucc_VAAAbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VAAAbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VAAAbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VACAbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][t,R,actfloor:actceil,P], HD['Dbaaaba'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Dbaaaba'][Dq,Dv,Dw,Dt,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Dbaaaba'][Dq,Dt,Du,Dv,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][v,R,actfloor:actceil,P], HD['Dbaaaba'][Dq,Dt,Du,Dw,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,w,R,actfloor:actceil], HD['Dbaaaba'][Ds,Dt,Du,Dv,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,v,R,actfloor:actceil], HD['Dbaaaba'][Ds,Dt,Du,Dw,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,t,R,actfloor:actceil], HD['Dbaaaba'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,u,R,actfloor:actceil], HD['Dbaaaba'][Ds,Dv,Dw,Dt,Dq,:] ) ))
    return result


def lucc_VACAbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][R,T,actfloor:actceil,P], HD['Dbaaaba'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         -HD['HSbaab'][P,w,T,R] * HD['Dbaab'][Dq,Dv,Du,Ds] ,
                         +HD['HSbaab'][P,v,T,R] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Dbaaaba'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         +HD['HSbaba'][P,T,R,w] * HD['Dbaab'][Dq,Du,Dv,Ds] ,
                         -HD['HSbaba'][P,T,R,v] * HD['Dbaab'][Dq,Du,Dw,Ds] ))
    return result


def lucc_VACAbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][T,R,actfloor:actceil,P], HD['Dbaaaba'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,T,R,actfloor:actceil], HD['Dbaaaba'][Ds,Dv,Dw,Du,Dq,:] ) ))
    return result


def lucc_VACAbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbaab'][P,T,V,R] * HD['Dbaab'][Dq,Du,Dw,Ds] ,
                         +HD['HSbaba'][P,V,R,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ))
    return result


def lucc_VACAbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VACAbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACAbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    return result


def lucc_VACCbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_AAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_CAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_CCAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VAAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VACAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VACCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VVAAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VVCAaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VVCCaaaa(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    return result


def lucc_AAAAbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dp,Dq,Dv,Dw,Du,Ds,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dp,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dp,Dq,Dv,Dw,Du,Dr,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaabba'][Dp,Dq,Du,:,Dw,Dr,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaabba'][Dp,Dq,Du,:,Dw,Ds,Dv,:] ) ,
                         -HD['Dbbaabb'][Dp,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,Dv] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][q,w,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,Du,Dp,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][s,w,T,actfloor:actceil], HD['Dbbabba'][Dp,Dq,Du,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,w,T,actfloor:actceil], HD['Dbbabba'][Dp,Dq,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][p,w,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         +HD['HSbb'][p,T] * HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] ,
                         -HD['HSbb'][q,T] * HD['Dbbaabb'][Dp,Dv,Dw,Du,Dr,Ds] ,
                         +HD['HSbb'][s,T] * HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,Dv] ,
                         -HD['HSbb'][r,T] * HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,Dv] ,
                         -HD['Dbbaabb'][Dp,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,Dv] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dp,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbababbb'][Dp,Dq,Du,:,Dw,Dr,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbababbb'][Dp,Dq,Du,:,Dw,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][q,v,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][q,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,v,T,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,T,v,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,Dr,:] ) ))
    if r==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dp,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dq,:] ) ,
                             +HD['Dbaab'][Dp,Dw,Du,Ds] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][q,w,T,actfloor:actceil], HD['Dbaba'][Ds,Du,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][p,w,T,actfloor:actceil], HD['Dbaba'][Ds,Du,Dq,:] ) ,
                             -HD['HSbb'][p,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                             +HD['HSbb'][q,T] * HD['Dbaab'][Dp,Dw,Du,Ds] ,
                             +HD['Dbaab'][Dp,Dw,Du,Ds] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dp,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ))
    if s==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dp,:] ) ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -HD['Dbaab'][Dp,Dw,Du,Dr] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][q,w,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][p,w,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dq,:] ) ,
                             -HD['HSbb'][q,T] * HD['Dbaab'][Dp,Dw,Du,Dr] ,
                             +HD['HSbb'][p,T] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -HD['Dbaab'][Dp,Dw,Du,Dr] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ))
    if p==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dq,Du,:,Dw,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dq,Du,:,Dw,Ds,:] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Ds] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             -HD['Dbaab'][Dq,Du,Dw,Dr] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][s,w,T,actfloor:actceil], HD['Dbaba'][Dq,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,w,T,actfloor:actceil], HD['Dbaba'][Dq,Du,Ds,:] ) ,
                             -HD['HSbb'][s,T] * HD['Dbaab'][Dq,Du,Dw,Dr] ,
                             +HD['HSbb'][r,T] * HD['Dbaab'][Dq,Du,Dw,Ds] ,
                             +HD['Dbaab'][Dq,Du,Dw,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -HD['Dbaab'][Dq,Du,Dw,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dq,Du,:,Dw,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dq,Du,:,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbaab'][Dq,Du,Dw,:] ) ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dp,Du,:,Dw,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dp,Du,:,Dw,Dr,:] ) ,
                             -HD['Dbaab'][Dp,Du,Dw,Ds] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +HD['Dbaab'][Dp,Du,Dw,Dr] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][s,w,T,actfloor:actceil], HD['Dbaba'][Dp,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,w,T,actfloor:actceil], HD['Dbaba'][Dp,Du,Ds,:] ) ,
                             -HD['HSbb'][r,T] * HD['Dbaab'][Dp,Du,Dw,Ds] ,
                             +HD['HSbb'][s,T] * HD['Dbaab'][Dp,Du,Dw,Dr] ,
                             -HD['Dbaab'][Dp,Du,Dw,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             +HD['Dbaab'][Dp,Du,Dw,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dp,Du,:,Dw,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dp,Du,:,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbaab'][Dp,Du,Dw,:] ) ))
    return result


def lucc_AAAAbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbaab'][p,w,U,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         +HD['HSbaab'][q,w,U,T] * HD['Dbbbb'][Dp,Dv,Dr,Ds] ,
                         -HD['HSbaab'][s,w,U,T] * HD['Dbbbb'][Dp,Dq,Dr,Dv] ,
                         +HD['HSbaab'][r,w,U,T] * HD['Dbbbb'][Dp,Dq,Ds,Dv] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,U,q,actfloor:actceil], HD['Dbbabba'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,s,actfloor:actceil], HD['Dbbabba'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbbabba'][Ds,Dv,Dw,Dp,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( -HD['HSbaab'][q,w,U,T] * HD['Dbb'][Dp,Ds] ,
                             +HD['HSbaab'][p,w,U,T] * HD['Dbb'][Dq,Ds] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,q,actfloor:actceil], HD['Dbaba'][Dp,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbaba'][Dq,Dw,Ds,:] ) ))
    if s==v:
        result += 2 * fsum(( +HD['HSbaab'][q,w,U,T] * HD['Dbb'][Dp,Dr] ,
                             -HD['HSbaab'][p,w,U,T] * HD['Dbb'][Dq,Dr] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,q,actfloor:actceil], HD['Dbaba'][Dp,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbaba'][Dq,Dw,Dr,:] ) ))
    if p==v:
        result += 2 * fsum(( -HD['HSbaab'][r,w,U,T] * HD['Dbb'][Dq,Ds] ,
                             +HD['HSbaab'][s,w,U,T] * HD['Dbb'][Dq,Dr] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbaba'][Ds,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,s,actfloor:actceil], HD['Dbaba'][Dr,Dw,Dq,:] ) ))
    if q==v:
        result += 2 * fsum(( -HD['HSbaab'][s,w,U,T] * HD['Dbb'][Dp,Dr] ,
                             +HD['HSbaab'][r,w,U,T] * HD['Dbb'][Dp,Ds] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,s,actfloor:actceil], HD['Dbaba'][Dr,Dw,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbaba'][Ds,Dw,Dp,:] ) ))
    return result


def lucc_AAAAbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dp,Dq,Dv,Dw,Du,Dr,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dp,Dq,Dv,Dw,Du,Ds,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dp,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dp,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaabba'][Dp,Dq,Du,:,Dw,Dr,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaabba'][Dp,Dq,Du,:,Dw,Ds,Dv,:] ) ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbaabb'][Dp,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,Dv] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,u,p,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,u,q,actfloor:actceil], HD['Dbbabba'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,u,s,actfloor:actceil], HD['Dbbabba'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,u,r,actfloor:actceil], HD['Dbbabba'][Ds,Dv,Dw,Dp,Dq,:] ) ,
                         +HD['HSbb'][p,T] * HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] ,
                         -HD['HSbb'][q,T] * HD['Dbbaabb'][Dp,Dv,Dw,Du,Dr,Ds] ,
                         +HD['HSbb'][s,T] * HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,Dv] ,
                         -HD['HSbb'][r,T] * HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,Dv] ,
                         +HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbaabb'][Dp,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,Dv] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbababbb'][Dp,Dq,Du,:,Dw,Ds,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dp,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbababbb'][Dp,Dq,Du,:,Dw,Dr,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,q,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,s,actfloor:actceil,T], HD['Dbbaabb'][Dp,Dq,Du,Dw,Dv,:] ) ))
    return result


def lucc_AAAAbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][q,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dp,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,q,V,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dp,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,V,actfloor:actceil,T], HD['Dbbaabb'][Dp,Dq,Du,Dw,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,s,V,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbbaabb'][Dp,Dq,Du,Dw,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbbaabb'][Dp,Dq,Dw,Du,Ds,:] ) ))
    return result


def lucc_AAAAbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_AAAAbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][T,U,p,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,q,actfloor:actceil], HD['Dbbabba'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,U,s,actfloor:actceil], HD['Dbbabba'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbbabba'][Ds,Dv,Dw,Dp,Dq,:] ) ))
    return result


def lucc_AAAAbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_AAAAbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dt,Du,Dw,Dq,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,:,Du,Dq,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dt,:,Dw,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dv,Dw,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dt,Du,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbaaabba'][Dr,Ds,Dw,:,Du,Dq,Dt,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][u,P,r,actfloor:actceil], HD['Dbbabba'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Dbbabba'][Ds,Dt,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSabba'][u,P,s,actfloor:actceil], HD['Dbbabba'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][w,P,s,actfloor:actceil], HD['Dbbabba'][Dr,Dt,Du,Dq,Dv,:] ) ,
                         +HD['Dbbaabb'][Dq,Dt,Du,Dw,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][t,u,P,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][v,w,P,actfloor:actceil], HD['Dbbabba'][Dq,Dt,Du,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][s,w,P,actfloor:actceil], HD['Dbbabba'][Dq,Dt,Du,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][s,u,P,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Dr,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][r,w,P,actfloor:actceil], HD['Dbbabba'][Dq,Dt,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][r,u,P,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Ds,Dt,:] ) ,
                         +HD['HSbb'][P,t] * HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] ,
                         -HD['HSbb'][P,v] * HD['Dbbaabb'][Dq,Dt,Du,Dw,Dr,Ds] ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbbaabb'][Dq,Dt,Du,Dw,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Dw,:,Du,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][t,P,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,v,P,actfloor:actceil], HD['Dbbaabb'][Dq,Dt,Du,Dw,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,P,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,t,P,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbbaabb'][Dq,Dt,Du,Dw,Ds,:] ) ,
                         +HD['HSbbbb'][t,P,r,s] * HD['Dbaab'][Dq,Du,Dw,Dv] ,
                         -HD['HSbbbb'][v,P,r,s] * HD['Dbaab'][Dq,Dw,Du,Dt] ))
    if q==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,u,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][s,u,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +HD['HSbb'][P,s] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                             -HD['HSbb'][P,r] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    if q==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Dw,:,Du,Dt,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dw,:,Du,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Du,Dt,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Ds,Dw,:,Du,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dr,Dw,:,Du,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ,
                             +HD['Dbaab'][Dr,Dw,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Dbaab'][Ds,Dw,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,w,P,actfloor:actceil], HD['Dbaba'][Dt,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][s,w,P,actfloor:actceil], HD['Dbaba'][Dt,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ,
                             -HD['HSbb'][P,s] * HD['Dbaab'][Dr,Dw,Du,Dt] ,
                             +HD['HSbb'][P,r] * HD['Dbaab'][Ds,Dw,Du,Dt] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ,
                             -HD['Dbaab'][Ds,Dw,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbaab'][Dr,Dw,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Ds,Dw,:,Du,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dr,Dw,:,Du,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ))
    if r==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Ds,Dt,Du,:,Dw,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Ds,Dt,Du,:,Dw,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dt,Du,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dt,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][w,P,s,actfloor:actceil], HD['Dbaba'][Dt,Du,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Dw,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,Dq,:] ) ,
                             -HD['HSbb'][P,s] * HD['Dbaab'][Dq,Dw,Du,Dt] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Dw,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dw,Dq,:] ) ))
    if s==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dt,Du,:,Dw,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dt,Du,:,Dw,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,Du,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dt,Du,:,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Dbaba'][Dt,Du,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,Dq,:] ) ,
                             +HD['HSbb'][P,r] * HD['Dbaab'][Dq,Dw,Du,Dt] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dw,Dq,:] ) ))
    if r==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Ds,Dv,Dw,:,Du,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Ds,Dv,Dw,:,Du,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dv,Dw,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][u,P,s,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                             +HD['HSbb'][P,s] * HD['Dbaab'][Dq,Du,Dw,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,Dq,:] ) ))
    if s==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dv,Dw,:,Du,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Dw,:,Du,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Dw,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][u,P,r,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ,
                             -HD['HSbb'][P,r] * HD['Dbaab'][Dq,Du,Dw,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,Dq,:] ) ))
    return result


def lucc_CAAAbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dq,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         +HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] ,
                         +HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         -HD['HSbbbb'][P,T,r,s] * HD['Dbaab'][Dq,Du,Dw,Dv] ,
                         -HD['HSbbbb'][P,T,s,v] * HD['Dbaab'][Dq,Du,Dw,Dr] ,
                         -HD['HSbbbb'][v,P,T,s] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                         +HD['HSbbbb'][P,T,r,v] * HD['Dbaab'][Dq,Du,Dw,Ds] ,
                         +HD['HSbbbb'][v,P,T,r] * HD['Dbaab'][Dq,Dw,Du,Ds] ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dq,Dv,Dw,:,Du,Dr,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dq,Dv,Dw,:,Du,Ds,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][q,v,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dq,Dv,Dw,:,Du,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dq,Dv,Dw,:,Du,Ds,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,:,Du,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,:,Du,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][q,w,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Du,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaba'][Dq,Dw,:,Du,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaba'][Dq,Dw,:,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][v,w,s,actfloor:actceil], HD['Dbaba'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][v,w,r,actfloor:actceil], HD['Dbaba'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                             -HD['HSbb'][s,v] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                             +HD['HSbb'][r,v] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,v,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ))
        if r==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dq,Dw,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbaab'][Dq,:,Du,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][q,w,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,Du,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ))
        if s==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dq,Dw,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaab'][Dq,:,Du,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][q,w,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Du,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Dbaba'][Ds,Du,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ))
    if s==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][w,P,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] ) ,
                             +HD['HSbbbb'][P,T,r,s] * HD['Daa'][Du,Dw] ))
    return result


def lucc_CAAAbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSabab'][w,P,U,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         -einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ))
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,Dw,Dr,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,Dw,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][r,U,w,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][q,w,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][s,U,w,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +HD['HSbaab'][s,U,w,v] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbaab'][r,U,w,v] * HD['Dbb'][Dq,Ds] ,
                             +einsum( 'i,i->', HD['HSbaba'][r,U,v,actfloor:actceil], HD['Dbaba'][Dq,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][s,U,v,actfloor:actceil], HD['Dbaba'][Dq,Dw,Dr,:] ) ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbaab'][Ds,:,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,Dw,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][q,w,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][s,U,w,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
        if s==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbaab'][Dr,:,Dw,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][q,w,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][r,U,w,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( -HD['HSabab'][w,P,U,T] * HD['Dbb'][Dq,Ds] ,
                             -einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbaba'][Dq,Dw,Ds,:] ) ))
    if s==v:
        result += 2 * fsum(( +HD['HSabab'][w,P,U,T] * HD['Dbb'][Dq,Dr] ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbaba'][Dq,Dw,Dr,:] ) ))
    return result


def lucc_CAAAbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dq,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][T,u,P,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,s,P,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,P,s,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ,
                         +HD['HSbbbb'][T,P,r,s] * HD['Dbaab'][Dq,Du,Dw,Dv] ))
    return result


def lucc_CAAAbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         +HD['HSbbbb'][T,P,V,s] * HD['Dbaab'][Dq,Du,Dw,Dr] ,
                         +HD['HSbbbb'][P,V,s,T] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                         -HD['HSbbbb'][T,P,V,r] * HD['Dbaab'][Dq,Du,Dw,Ds] ,
                         -HD['HSbbbb'][P,V,r,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ))
    if P==V:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dq,Du,:,Dw,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Dq,Du,:,Dw,Ds,:] ) ,
                             -HD['Dbaab'][Dq,Du,Dw,Dr] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Ds] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][T,u,s,actfloor:actceil], HD['Dbaba'][Dr,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,u,r,actfloor:actceil], HD['Dbaba'][Ds,Dw,Dq,:] ) ,
                             +HD['HSbb'][s,T] * HD['Dbaab'][Dq,Du,Dw,Dr] ,
                             -HD['HSbb'][r,T] * HD['Dbaab'][Dq,Du,Dw,Ds] ,
                             -HD['Dbaab'][Dq,Du,Dw,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dq,Du,:,Dw,Dr,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Dq,Du,:,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,actfloor:actceil,T], HD['Dbaab'][Dq,Du,Dw,:] ) ))
    return result


def lucc_CAAAbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][s,W,actfloor:actceil,T], HD['Dbaba'][Dq,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][r,W,actfloor:actceil,T], HD['Dbaba'][Dq,Du,Ds,:] ) ,
                             -HD['HSbaab'][s,W,u,T] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbaab'][r,W,u,T] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_CAAAbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbaba'][T,U,P,actfloor:actceil], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] )
    return result


def lucc_CAAAbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][T,U,s,actfloor:actceil], HD['Dbaba'][Dr,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][T,U,r,actfloor:actceil], HD['Dbaba'][Ds,Dw,Dq,:] ) ))
    return result


def lucc_CAAAbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==V:
        result += 2 * fsum(( -HD['HSbaab'][s,W,U,T] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbaab'][r,W,U,T] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_CCAAbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,t,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ,
                         +HD['HSbbbb'][P,Q,s,v] * HD['Dbaab'][Dr,Dw,Du,Dt] ,
                         -HD['HSbbbb'][P,Q,s,t] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         -HD['HSbbbb'][P,Q,r,v] * HD['Dbaab'][Ds,Dw,Du,Dt] ,
                         +HD['HSbbbb'][P,Q,r,t] * HD['Dbaab'][Ds,Du,Dw,Dv] ))
    if r==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,s,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] )
    if s==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,r,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] )
    if r==t:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,s,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] )
    if s==t:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,r,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] )
    return result


def lucc_CCAAbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +HD['HSbbbb'][P,Q,T,s] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         -HD['HSbbbb'][P,Q,T,r] * HD['Dbaab'][Ds,Du,Dw,Dv] ))
    if Q==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Du,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Dbaba'][Ds,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][w,P,s,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +HD['HSbb'][P,s] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                             -HD['HSbb'][P,r] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,s,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                             -HD['HSbbbb'][v,P,r,s] * HD['Daa'][Du,Dw] ))
        if r==v:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,Du,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][w,P,s,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 -HD['HSbb'][P,s] * HD['Daa'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
        if s==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Du,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][w,P,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 +HD['HSbb'][P,r] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabab'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Ds,Du,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabba'][w,Q,r,actfloor:actceil], HD['Dbaba'][Ds,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][w,Q,s,actfloor:actceil], HD['Dbaba'][Dr,Du,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,s] ) ,
                             -HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -HD['HSbb'][Q,s] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                             +HD['HSbb'][Q,r] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Dr,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,s] ) ,
                             -HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,Q,r,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,Q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,Q,s,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                             +HD['HSbbbb'][v,Q,r,s] * HD['Daa'][Du,Dw] ))
        if r==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,Du,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,s,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][w,Q,s,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 +HD['HSbb'][Q,s] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
        if s==v:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dr,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dr,Du,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][w,Q,r,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 -HD['HSbb'][Q,r] * HD['Daa'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                             -HD['HSbbbb'][P,Q,T,s] * HD['Daa'][Du,Dw] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ,
                             +HD['HSbbbb'][P,Q,T,r] * HD['Daa'][Du,Dw] ))
    return result


def lucc_CCAAbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSabab'][w,P,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +HD['HSabab'][w,P,U,s] * HD['Dbb'][Dr,Dv] ,
                             -HD['HSabab'][w,P,U,r] * HD['Dbb'][Ds,Dv] ,
                             +einsum( 'i,i->', HD['HSbaba'][s,U,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][r,U,P,actfloor:actceil], HD['Dbaba'][Dv,Dw,Ds,:] ) ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaab'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSabab'][w,P,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -HD['HSabab'][w,P,U,s] ,
                                 +einsum( 'i,i->', HD['HSbaba'][s,U,P,actfloor:actceil], HD['Daa'][Dw,:] ) ))
        if s==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaab'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabab'][w,P,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSabab'][w,P,U,r] ,
                                 -einsum( 'i,i->', HD['HSbaba'][r,U,P,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSabab'][w,Q,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -HD['HSabab'][w,Q,U,s] * HD['Dbb'][Dr,Dv] ,
                             +HD['HSabab'][w,Q,U,r] * HD['Dbb'][Ds,Dv] ,
                             -einsum( 'i,i->', HD['HSbaba'][s,U,Q,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,U,Q,actfloor:actceil], HD['Dbaba'][Dv,Dw,Ds,:] ) ))
        if r==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbaab'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSabab'][w,Q,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +HD['HSabab'][w,Q,U,s] ,
                                 -einsum( 'i,i->', HD['HSbaba'][s,U,Q,actfloor:actceil], HD['Daa'][Dw,:] ) ))
        if s==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbaab'][Dr,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSabab'][w,Q,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSabab'][w,Q,U,r] ,
                                 +einsum( 'i,i->', HD['HSbaba'][r,U,Q,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_CCAAbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         -HD['HSbbbb'][P,Q,s,T] * HD['Dbaab'][Dr,Du,Dw,Dv] ,
                         +HD['HSbbbb'][P,Q,r,T] * HD['Dbaab'][Ds,Du,Dw,Dv] ))
    return result


def lucc_CCAAbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==V:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,P,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] ) ,
                             +HD['HSbbbb'][T,P,r,s] * HD['Daa'][Du,Dw] ))
    if P==V:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,Q,s,actfloor:actceil], HD['Dbaab'][Dr,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,Q,r,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] ) ,
                             -HD['HSbbbb'][T,Q,r,s] * HD['Daa'][Du,Dw] ))
    return result


def lucc_CCAAbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VAAAbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dt,Du,Dw,Dq,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dq,:,:] ) ))
    result += 2 * fsum(( -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbbaabb'][Dq,Dt,Du,Dw,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dt,:,Dw,Dq,Dv,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,:,Du,Dq,Dt,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dt,Du,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dv,Dw,Dq,Dt,:,:] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][t,u,actfloor:actceil,P], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbaab'][v,w,actfloor:actceil,P], HD['Dbbabba'][Dq,Dt,Du,Dr,Ds,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbaaabba'][Dr,Ds,Dw,:,Du,Dq,Dt,:] ) ,
                         +HD['HSbb'][P,t] * HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] ,
                         -HD['HSbb'][P,v] * HD['Dbbaabb'][Dq,Dt,Du,Dw,Dr,Ds] ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbbaabb'][Dq,Dt,Du,Dw,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Dw,:,Du,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,q,t,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,q,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Ds,Dt,Du,:,Dw,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Ds,Dt,Du,:,Dw,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,Dq,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dt,Du,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,Dq,:] ) ))
    if s==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dt,Du,:,Dw,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dt,Du,:,Dw,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dt,Du,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,Dq,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Ds,Dv,Dw,:,Du,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Ds,Dv,Dw,:,Du,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dv,Dw,Dq,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ))
    if s==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Dv,Dw,:,Du,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Dv,Dw,:,Du,Dq,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Dv,Dw,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,Dq,:] ) ))
    if q==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ))
    if q==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Dw,:,Du,Dt,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Dw,:,Du,Dt,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Du,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ))
    return result


def lucc_VAAAbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dq,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         +HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,w,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] ,
                         +HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,w,T,actfloor:actceil], HD['Dbaba'][Ds,Du,Dq,:] ) ,
                             -HD['HSbb'][P,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaaaba'][Dr,Du,:,Dw,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,w,T,actfloor:actceil], HD['Dbaba'][Dr,Du,Dq,:] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbababb'][Dr,Du,:,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] ) ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,:,:] )
    return result


def lucc_VAAAbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -HD['HSbaab'][P,w,U,T] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbaba'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbaab'][P,w,U,T] * HD['Dbb'][Dq,Ds] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbaba'][Dq,Dw,Dr,:] ) ,
                             -HD['HSbaab'][P,w,U,T] * HD['Dbb'][Dq,Dr] ))
    return result


def lucc_VAAAbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbaabbb'][Dr,Ds,Dv,Dw,Du,Dq,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbaaabba'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'i,i->', HD['HSbaab'][T,u,actfloor:actceil,P], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] ,
                         -HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,q,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dq,Dv,Dw,:,Du,Dr,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dq,Dv,Dw,:,Du,Ds,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dq,Dv,Dw,:,Du,Ds,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dq,Dv,Dw,:,Du,Dr,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][s,u,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,Dw,Dr,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][r,u,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,Dw,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Dr,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ))
    return result


def lucc_VAAAbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dq,:] ) ))
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][q,V,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbaaaba'][Dq,Dw,:,Du,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbaaaba'][Dq,Dw,:,Du,Ds,:] ) ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][s,u,V,actfloor:actceil], HD['Dbaba'][Dq,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][r,u,V,actfloor:actceil], HD['Dbaba'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbb'][s,V] * HD['Dbaab'][Dq,Dw,Du,Dr] ,
                             -HD['HSbb'][r,V] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                             +HD['Dbaab'][Dq,Dw,Du,Dr] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,Dr,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,V,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ))
    return result


def lucc_VAAAbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -HD['HSbaab'][s,u,W,V] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbaab'][r,u,W,V] * HD['Dbb'][Dq,Ds] ,
                             +einsum( 'i,i->', HD['HSbaba'][V,W,s,actfloor:actceil], HD['Dbaba'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][V,W,r,actfloor:actceil], HD['Dbaba'][Ds,Du,Dq,:] ) ))
    return result


def lucc_VAAAbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbbabba'][Dq,Dv,Dw,Dr,Ds,:] )
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][U,s,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,Dw,Dr,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][U,r,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,Dw,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ))
    return result


def lucc_VAAAbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabba'][U,s,V,actfloor:actceil], HD['Dbaba'][Dq,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][U,r,V,actfloor:actceil], HD['Dbaba'][Dq,Dw,Ds,:] ) ))
    return result


def lucc_VAAAbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +HD['HSabab'][U,s,W,V] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSabab'][U,r,W,V] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_VACAbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Dbbabba'][Dq,Dv,Dw,Ds,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Dbbabba'][Dq,Dt,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbaba'][P,w,R,actfloor:actceil], HD['Dbbabba'][Ds,Dt,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbaba'][P,u,R,actfloor:actceil], HD['Dbbabba'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbbaabb'][Dq,Dt,Du,Dw,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         +HD['HSbbbb'][P,q,R,t] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                         -HD['HSbbbb'][P,q,R,v] * HD['Dbaab'][Ds,Dw,Du,Dt] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dt,Du,:,Dw,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Dt] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbaba'][P,w,R,actfloor:actceil], HD['Dbaba'][Dt,Du,Dq,:] ) ,
                             -HD['HSbb'][P,R] * HD['Dbaab'][Dq,Dw,Du,Dt] ,
                             -HD['Dbaab'][Dq,Dw,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dt,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] ) ))
    if s==t:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Du,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbaba'][P,u,R,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dq,:] ) ,
                             +HD['HSbb'][P,R] * HD['Dbaab'][Dq,Du,Dw,Dv] ,
                             +HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ))
    if q==t:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                             +HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dv,:] ) ))
    if q==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Dbaba'][Dt,Du,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Ds,Dw,:,Du,Dt,:] ) ,
                             -HD['Dbaab'][Ds,Dw,Du,Dt] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbaab'][Ds,Dw,Du,Dt] ,
                             -HD['Dbaab'][Ds,Dw,Du,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Ds,Dw,:,Du,Dt,:] ) ))
    return result


def lucc_VACAbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         +HD['HSbbbb'][P,q,R,T] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                         -HD['HSbbbb'][P,v,R,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                         -HD['HSbbbb'][P,T,R,v] * HD['Dbaab'][Dq,Du,Dw,Ds] ))
    if R==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Ds,Dv,Dw,:,Du,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Ds,Dv,Dw,:,Du,Dq,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,:,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbaab'][v,w,actfloor:actceil,P], HD['Dbaba'][Dq,Du,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaaaba'][Ds,Dw,:,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                             -HD['HSbb'][P,v] * HD['Dbaab'][Dq,Du,Dw,Ds] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbababb'][Ds,Dw,:,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,v,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] ) ))
        if q==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Ds,Dw,:,Du,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Ds,Dw,:,Du,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaab'][Ds,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] ) ))
    if q==v:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] )
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                             -HD['HSbbbb'][P,q,R,T] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VACAbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dv,Dw,Dq,:,:] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][P,U,w,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             +HD['HSbaab'][P,U,w,v] * HD['Dbb'][Dq,Ds] ,
                             -einsum( 'i,i->', HD['HSbaba'][P,U,v,actfloor:actceil], HD['Dbaba'][Ds,Dw,Dq,:] ) ))
        if q==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][P,U,w,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    return result


def lucc_VACAbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,Dq,:] ) ,
                         +HD['HSbbbb'][P,q,R,T] * HD['Dbaab'][Ds,Du,Dw,Dv] ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dq,Dv,Dw,:,Du,Ds,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dq,Dv,Dw,:,Du,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabab'][u,R,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,Dw,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][u,R,q,actfloor:actceil], HD['Dbaba'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][q,:actfloor,R,:actfloor] ) ,
                             +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                             -HD['HSbb'][q,R] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,Ds,:] ) ,
                             -HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dv,:] ) ))
    return result


def lucc_VACAbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbbbb'][P,V,R,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                         +HD['HSbbbb'][P,T,R,V] * HD['Dbaab'][Dq,Du,Dw,Ds] ))
    if R==V:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaaaba'][Ds,Du,:,Dw,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'i,i->', HD['HSbaab'][T,u,actfloor:actceil,P], HD['Dbaba'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbb'][P,T] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbababb'][Ds,Du,:,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,actfloor:actceil,T], HD['Dbaab'][Ds,Du,Dw,:] ) ))
        if P==T:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dq,Dw,:,Du,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbaab'][Ds,:,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][s,u,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,Dw,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbaaaba'][Dq,Dw,:,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][u,R,V,actfloor:actceil], HD['Dbaba'][Dq,Dw,Ds,:] ) ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             -HD['HSbb'][R,V] * HD['Dbaab'][Dq,Dw,Du,Ds] ,
                             -HD['Dbaab'][Dq,Dw,Du,Ds] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][q,V,R,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ))
    return result


def lucc_VACAbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaab'][P,W,actfloor:actceil,T], HD['Dbaba'][Ds,Du,Dq,:] ) ,
                             -HD['HSbaab'][P,W,u,T] * HD['Dbb'][Dq,Ds] ))
        if P==T:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbaab'][Dq,:,Du,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][q,W,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,Du,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][q,W,u,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][s,u,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    if P==T:
        result += 2 * fsum(( -HD['HSabab'][u,R,W,V] * HD['Dbb'][Dq,Ds] ,
                             -einsum( 'i,i->', HD['HSbaba'][V,W,R,actfloor:actceil], HD['Dbaba'][Ds,Du,Dq,:] ) ))
    return result


def lucc_VACAbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][U,R,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,Dw,Ds,:,:] ) ,
                             -einsum( 'i,i->', HD['HSabba'][U,R,q,actfloor:actceil], HD['Dbaba'][Dv,Dw,Ds,:] ) ))
    return result


def lucc_VACAbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * +einsum( 'i,i->', HD['HSbaab'][T,U,actfloor:actceil,P], HD['Dbaba'][Dq,Dw,Ds,:] )
        if P==T:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][U,s,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbaab'][Ds,:,Dw,:] ) ))
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSabba'][U,R,V,actfloor:actceil], HD['Dbaba'][Dq,Dw,Ds,:] )
    return result


def lucc_VACAbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    if R==V:
        result += 2 * -HD['HSbaab'][P,W,U,T] * HD['Dbb'][Dq,Ds]
        if P==T:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][U,s,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][q,W,actfloor:actceil,U], HD['Dbb'][Ds,:] ) ))
    if P==T:
        result += 2 * -HD['HSabab'][U,R,W,V] * HD['Dbb'][Dq,Ds]
    return result


def lucc_VACCbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbbbb'][P,v,R,S] * HD['Dbaab'][Dq,Dw,Du,Dt] ,
                         -HD['HSbbbb'][P,t,R,S] * HD['Dbaab'][Dq,Du,Dw,Dv] ))
    if q==t:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Du,:] )
    if q==v:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbaab'][Dt,Du,Dw,:] )
    return result


def lucc_VACCbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,T,R,S] * HD['Dbaab'][Dq,Du,Dw,Dv]
    if S==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Dbaba'][Dq,Du,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Du,Dq,:] ) ,
                             +HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbaab'][Dq,Du,Dw,Dv] ,
                             +HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbaab'][Dq,Du,Dw,:] ) ,
                             -HD['HSbbbb'][P,q,R,v] * HD['Daa'][Du,Dw] ))
        if q==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][w,R,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                                 -HD['HSbb'][P,R] * HD['Daa'][Du,Dw] ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    if R==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][w,S,actfloor:actceil,P], HD['Dbaba'][Dq,Du,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbaaaba'][Dv,Dw,:,Du,Dq,:] ) ,
                             -HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                             -HD['HSbb'][P,S] * HD['Dbaab'][Dq,Du,Dw,Dv] ,
                             -HD['Dbaab'][Dq,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbababb'][Dv,Dw,:,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,S,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,S,actfloor:actceil,P], HD['Dbaab'][Dq,Du,Dw,:] ) ,
                             +HD['HSbbbb'][P,q,S,v] * HD['Daa'][Du,Dw] ))
        if q==v:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][w,S,actfloor:actceil,P], HD['Daa'][Du,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Dw,:,Du,:] ) ,
                                 +HD['HSbb'][P,S] * HD['Daa'][Du,Dw] ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Dw,:,Du,:] ) ))
    if q==v:
        result += 2 * +HD['HSbbbb'][P,T,R,S] * HD['Daa'][Du,Dw]
    return result


def lucc_VACCbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    if q==v:
        if S==T:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,U,R,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -HD['HSbaba'][P,U,R,w] ))
        if R==T:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,U,S,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +HD['HSbaba'][P,U,S,w] ))
    if S==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,U,R,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dq,:] ) ,
                             +HD['HSbaba'][P,U,R,w] * HD['Dbb'][Dq,Dv] ))
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,U,S,actfloor:actceil], HD['Dbaba'][Dv,Dw,Dq,:] ) ,
                             -HD['HSbaba'][P,U,S,w] * HD['Dbb'][Dq,Dv] ))
    return result


def lucc_VACCbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,T,R,S] * HD['Dbaab'][Dq,Du,Dw,Dv]
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dq,Dv,Dw,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,q,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] )
    return result


def lucc_VACCbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][R,S,V,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                             +HD['HSbbbb'][q,V,R,S] * HD['Daa'][Du,Dw] ))
        if S==V:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dq,Dw,:,Du,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabab'][u,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,Dw,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][u,R,q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 -HD['HSbb'][q,R] * HD['Daa'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
        if R==V:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Dq,Dw,:,Du,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Dq,Dw,:,Du,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabab'][u,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][u,S,q,actfloor:actceil], HD['Daa'][Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][S,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 +HD['HSbb'][q,S] * HD['Daa'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if S==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                             +HD['HSbbbb'][P,q,R,T] * HD['Daa'][Du,Dw] ))
    if R==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,S,actfloor:actceil,P], HD['Dbaab'][Dq,Dw,Du,:] ) ,
                             -HD['HSbbbb'][P,q,S,T] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VACCbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    if P==T:
        if S==V:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbaab'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSabab'][u,R,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaba'][q,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSbaba'][q,W,R,u] ))
        if R==V:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbaab'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSabab'][u,S,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaba'][q,W,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSbaba'][q,W,S,u] ))
    return result


def lucc_VACCbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    if P==T:
        if S==V:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabab'][U,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,Dw,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSabba'][U,R,q,actfloor:actceil], HD['Daa'][Dw,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][U,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dq,Dw,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSabba'][U,S,q,actfloor:actceil], HD['Daa'][Dw,:] ) ))
    return result


def lucc_VACCbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    if P==T:
        if S==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][U,R,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbaba'][q,W,R,U] ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][U,S,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbaba'][q,W,S,U] ))
    return result


def lucc_VVAAbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,t,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Dw,Du,Dt,:] ) ))
    if r==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Ds,Dt,Du,Dw,:,:] )
    if s==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dt,Du,Dw,:,:] )
    if r==t:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,:,:] )
    if s==t:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Dv,Dw,Du,:,:] )
    return result


def lucc_VVAAbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] )
    if r==v:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] )
    if s==v:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbaab'][Dr,Du,Dw,:] )
    return result


def lucc_VVAAbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] )
    if Q==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dv,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ))
    if P==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbababbb'][Dr,Ds,Du,:,Dw,Dv,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbaaabab'][Dr,Ds,Du,:,Dw,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,Dv,:] ) ))
    return result


def lucc_VVAAbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,V,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,:,:] )
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][Q,V,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Dr,Ds,Du,Dw,:,:] )
    return result


def lucc_VVAAbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] )
    if P==T:
        result += 2 * -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbbaabb'][Dr,Ds,:,Dw,Dv,:] )
    return result


def lucc_VVAAbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbbbb'][P,Q,R,t] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                         -HD['HSbbbb'][P,Q,R,v] * HD['Dbaab'][Ds,Dw,Du,Dt] ))
    if s==v:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbaab'][Dt,Du,Dw,:] )
    if s==t:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] )
    return result


def lucc_VVCAbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,Q,R,T] * HD['Dbaab'][Ds,Du,Dw,Dv]
    if R==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbaabb'][Ds,Dv,Dw,Du,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbaab'][Ds,Dw,Du,:] )
    if s==v:
        result += 2 * -HD['HSbbbb'][P,Q,R,T] * HD['Daa'][Du,Dw]
    return result


def lucc_VVCAbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,Q,R,T] * HD['Dbaab'][Ds,Du,Dw,Dv]
    if Q==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Ds,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dv,:] ) ,
                             +HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                             +HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dv,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,Q], HD['Dbaba'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbaaaba'][Ds,Du,:,Dw,Dv,:] ) ,
                             -HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][Q,R] * HD['Dbaab'][Ds,Du,Dw,Dv] ,
                             -HD['Dbaab'][Ds,Du,Dw,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,Dv,:] ) ))
    return result


def lucc_VVCAbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbaab'][Ds,Du,Dw,:] )
        if Q==T:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaab'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ))
        if P==T:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbababb'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaaaab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbaab'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] ) ))
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,V,R,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] )
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][Q,V,R,actfloor:actceil], HD['Dbaab'][Ds,Du,Dw,:] )
    return result


def lucc_VVCAbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    if R==V:
        if Q==T:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,W,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,Du,:,:] ) ,
                                 +einsum( 'i,i->', HD['HSbaab'][P,W,u,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
        if P==T:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][Q,W,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Ds,Du,:,:] ) ,
                                 -einsum( 'i,i->', HD['HSbaab'][Q,W,u,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    return result


def lucc_VVCAbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSabab'][U,R,actfloor:actceil,P], HD['Dbaba'][Dv,Dw,Ds,:] )
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSabab'][U,R,actfloor:actceil,Q], HD['Dbaba'][Dv,Dw,Ds,:] )
    return result


def lucc_VVCAbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    if R==V:
        if Q==T:
            result += 2 * -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbaab'][Ds,:,Dw,:] )
        if P==T:
            result += 2 * +einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbaab'][Ds,:,Dw,:] )
    return result


def lucc_VVCAbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    if R==V:
        if Q==T:
            result += 2 * -einsum( 'i,i->', HD['HSbaba'][P,W,actfloor:actceil,U], HD['Dbb'][Ds,:] )
        if P==T:
            result += 2 * +einsum( 'i,i->', HD['HSbaba'][Q,W,actfloor:actceil,U], HD['Dbb'][Ds,:] )
    return result


def lucc_VVCCbbbb_AAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_CAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if S==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             -HD['HSbbbb'][P,Q,R,v] * HD['Daa'][Du,Dw] ))
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,S,actfloor:actceil], HD['Dbaab'][Dv,Dw,Du,:] ) ,
                             +HD['HSbbbb'][P,Q,S,v] * HD['Daa'][Du,Dw] ))
    return result


def lucc_VVCCbbbb_CCAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VAAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbaab'][Dv,Dw,Du,:] )
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,Q], HD['Dbaab'][Dv,Dw,Du,:] )
    return result


def lucc_VVCCbbbb_VACAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * -HD['HSbbbb'][P,V,R,S] * HD['Daa'][Du,Dw]
        if S==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +HD['HSbb'][P,R] * HD['Daa'][Du,Dw] ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][u,S,actfloor:actceil,P], HD['Daa'][Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -HD['HSbb'][P,S] * HD['Daa'][Du,Dw] ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if S==V:
        result += 2 * +HD['HSbbbb'][P,Q,R,T] * HD['Daa'][Du,Dw]
        if P==T:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSabab'][u,R,actfloor:actceil,Q], HD['Daa'][Dw,:] ) ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 -HD['HSbb'][Q,R] * HD['Daa'][Du,Dw] ,
                                 -HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if R==V:
        result += 2 * -HD['HSbbbb'][P,Q,S,T] * HD['Daa'][Du,Dw]
        if P==T:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSabab'][u,S,actfloor:actceil,Q], HD['Daa'][Dw,:] ) ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,S,actfloor:actceil], HD['Daaaa'][Du,:,Dw,:] ) ,
                                 +HD['HSbb'][Q,S] * HD['Daa'][Du,Dw] ,
                                 +HD['Daa'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dabab'][Du,:,Dw,:] ) ))
    if P==T:
        result += 2 * +HD['HSbbbb'][Q,V,R,S] * HD['Daa'][Du,Dw]
    return result


def lucc_VVCCbbbb_VACCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if Q==T:
        if S==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][P,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSbaba'][P,W,R,u] ))
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][P,W,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSbaba'][P,W,S,u] ))
    if S==V:
        if P==T:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbaba'][Q,W,R,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 -HD['HSbaba'][Q,W,R,u] ))
    if R==V:
        if P==T:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbaba'][Q,W,S,actfloor:actceil], HD['Daa'][Du,:] ) ,
                                 +HD['HSbaba'][Q,W,S,u] ))
    return result


def lucc_VVCCbbbb_VVAAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_VVCAbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if Q==T:
        if S==V:
            result += 2 * +einsum( 'i,i->', HD['HSabab'][U,R,actfloor:actceil,P], HD['Daa'][Dw,:] )
        if R==V:
            result += 2 * -einsum( 'i,i->', HD['HSabab'][U,S,actfloor:actceil,P], HD['Daa'][Dw,:] )
    if S==V:
        if P==T:
            result += 2 * -einsum( 'i,i->', HD['HSabab'][U,R,actfloor:actceil,Q], HD['Daa'][Dw,:] )
    if R==V:
        if P==T:
            result += 2 * +einsum( 'i,i->', HD['HSabab'][U,S,actfloor:actceil,Q], HD['Daa'][Dw,:] )
    return result


def lucc_VVCCbbbb_VVCCbaba(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    if Q==T:
        if S==V:
            result += 2 * +HD['HSbaba'][P,W,R,U]
        if R==V:
            result += 2 * -HD['HSbaba'][P,W,S,U]
    if S==V:
        if P==T:
            result += 2 * -HD['HSbaba'][Q,W,R,U]
    if R==V:
        if P==T:
            result += 2 * +HD['HSbaba'][Q,W,S,U]
    return result


def lucc_AAAAbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dp,Dq,Dv,Dw,Ds,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dp,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dp,Dq,Dv,Dw,Dr,Du,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Du,:,Dp,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbabbba'][Dp,Dq,Du,:,Dr,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbabbba'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         -HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dv,Dw] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][p,T] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['HSbb'][q,T] * HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,Du] ,
                         +HD['HSbb'][s,T] * HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dv,Dw] ,
                         -HD['HSbb'][r,T] * HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dv,Dw] ,
                         -HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                         +HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                         -HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dp,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbbbb'][Dp,Dq,Du,:,Dr,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbbbb'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,w,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dv,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,w,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,T,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][q,w,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dp,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][q,v,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dp,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][q,T,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dp,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][q,T,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dp,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,w,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,v,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,T,w,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dv,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,T,v,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,w,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         -HD['HSbbbb'][q,T,v,w] * HD['Dbbbb'][Dp,Du,Dr,Ds] ,
                         -HD['HSbbbb'][r,T,v,w] * HD['Dbbbb'][Dp,Dq,Ds,Du] ,
                         +HD['HSbbbb'][p,T,v,w] * HD['Dbbbb'][Dq,Du,Dr,Ds] ,
                         +HD['HSbbbb'][s,T,v,w] * HD['Dbbbb'][Dp,Dq,Dr,Du] ))
    if s==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dp,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dq,Dw,:] ) ,
                             +HD['Dbbbb'][Dp,Dw,Dr,Du] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][p,T] * HD['Dbbbb'][Dq,Dw,Dr,Du] ,
                             +HD['HSbb'][q,T] * HD['Dbbbb'][Dp,Dw,Dr,Du] ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             +HD['Dbbbb'][Dp,Dw,Dr,Du] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dp,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][q,w,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,T,w,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,w,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dq,:] ) ))
        if r==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dp,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dq,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                                 -HD['Dbb'][Dp,Du] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][p,T] * HD['Dbb'][Dq,Du] ,
                                 -HD['HSbb'][q,T] * HD['Dbb'][Dp,Du] ,
                                 -HD['Dbb'][Dp,Du] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dq,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dp,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==w:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dv,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dp,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dq,Dv,:] ) ,
                             +HD['Dbbbb'][Dp,Dv,Ds,Du] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][p,T] * HD['Dbbbb'][Dq,Dv,Ds,Du] ,
                             +HD['HSbb'][q,T] * HD['Dbbbb'][Dp,Dv,Ds,Du] ,
                             +HD['Dbbbb'][Dp,Dv,Ds,Du] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dp,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][q,v,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,T,v,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ))
    if s==w:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dv,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dp,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dq,Dv,:] ) ,
                             -HD['Dbbbb'][Dp,Dv,Dr,Du] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             +HD['Dbbbb'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][p,T] * HD['Dbbbb'][Dq,Dv,Dr,Du] ,
                             -HD['HSbb'][q,T] * HD['Dbbbb'][Dp,Dv,Dr,Du] ,
                             +HD['Dbbbb'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dp,Dv,Dr,Du] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dp,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][q,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dq,:] ) ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dp,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dq,:] ) ,
                                 +HD['Dbb'][Dp,Du] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][q,T] * HD['Dbb'][Dp,Du] ,
                                 -HD['HSbb'][p,T] * HD['Dbb'][Dq,Du] ,
                                 +HD['Dbb'][Dp,Du] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dp,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dp,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dq,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][p,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dp,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][p,T] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                             -HD['HSbb'][q,T] * HD['Dbbbb'][Dp,Dw,Ds,Du] ,
                             -HD['Dbbbb'][Dp,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dp,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,q,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][q,w,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,w,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,T,w,actfloor:actceil], HD['Dbbbb'][Dp,Dq,Du,:] ) ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dp,Du,:,Dr,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dp,Du,:,Ds,Dw,:] ) ,
                             -HD['Dbbbb'][Dp,Du,Dr,Dw] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                             +HD['Dbbbb'][Dp,Du,Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][s,T] * HD['Dbbbb'][Dp,Du,Dr,Dw] ,
                             +HD['HSbb'][r,T] * HD['Dbbbb'][Dp,Du,Ds,Dw] ,
                             +HD['Dbbbb'][Dp,Du,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dp,Du,Dr,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Du,:,Ds,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Du,:,Dr,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,w,T,actfloor:actceil], HD['Dbbbb'][Dp,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbbbb'][Dp,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][p,T,w,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,w,T,actfloor:actceil], HD['Dbbbb'][Dp,Du,Dr,:] ) ))
        if p==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Ds,:] ) ,
                                 +HD['Dbb'][Dr,Du] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                                 -HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][r,T] * HD['Dbb'][Ds,Du] ,
                                 +HD['HSbb'][s,T] * HD['Dbb'][Dr,Du] ,
                                 +HD['Dbb'][Dr,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                                 -HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if p==w:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dq,Du,:,Dr,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dq,Du,:,Ds,Dv,:] ) ,
                             -HD['Dbbbb'][Dq,Du,Dr,Dv] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                             +HD['Dbbbb'][Dq,Du,Ds,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][r,T] * HD['Dbbbb'][Dq,Du,Ds,Dv] ,
                             -HD['HSbb'][s,T] * HD['Dbbbb'][Dq,Du,Dr,Dv] ,
                             -HD['Dbbbb'][Dq,Du,Dr,Dv] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                             +HD['Dbbbb'][Dq,Du,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dq,Du,:,Dr,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dq,Du,:,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,v,T,actfloor:actceil], HD['Dbbbb'][Dq,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][q,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbbbb'][Dq,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbbbb'][Dq,Du,Dv,:] ) ))
    if q==w:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][p,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dp,Du,:,Dr,Dv,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dp,Du,:,Ds,Dv,:] ) ,
                             +HD['Dbbbb'][Dp,Du,Dr,Dv] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dp,Du,Ds,Dv] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][s,T] * HD['Dbbbb'][Dp,Du,Dr,Dv] ,
                             -HD['HSbb'][r,T] * HD['Dbbbb'][Dp,Du,Ds,Dv] ,
                             +HD['Dbbbb'][Dp,Du,Dr,Dv] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dp,Du,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Du,:,Ds,Dv,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dp,Du,:,Dr,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,v,T,actfloor:actceil], HD['Dbbbb'][Dp,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbbbb'][Dp,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,v,T,actfloor:actceil], HD['Dbbbb'][Dp,Du,Dr,:] ) ))
        if p==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Ds,:] ) ,
                                 -HD['Dbb'][Dr,Du] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                                 +HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][s,T] * HD['Dbb'][Dr,Du] ,
                                 +HD['HSbb'][r,T] * HD['Dbb'][Ds,Du] ,
                                 -HD['Dbb'][Dr,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                                 +HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if p==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][q,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dq,Du,:,Dr,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dq,Du,:,Ds,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Du,Dr,Dw] * einsum( 'II->', HD['HSbaba'][s,:actfloor,T,:actfloor] ) ,
                             -HD['Dbbbb'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][s,T] * HD['Dbbbb'][Dq,Du,Dr,Dw] ,
                             -HD['HSbb'][r,T] * HD['Dbbbb'][Dq,Du,Ds,Dw] ,
                             -HD['Dbbbb'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,T,:actfloor] ) ,
                             +HD['Dbbbb'][Dq,Du,Dr,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dq,Du,:,Ds,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dq,Du,:,Dr,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,w,T,actfloor:actceil], HD['Dbbbb'][Dq,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][q,T,w,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,w,T,actfloor:actceil], HD['Dbbbb'][Dq,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,T,actfloor:actceil], HD['Dbbbb'][Dq,Du,Dw,:] ) ))
    return result


def lucc_AAAAbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,U,q,actfloor:actceil], HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dp,Dq,:] ) ,
                         +HD['HSbbbb'][p,q,T,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                         -HD['HSbbbb'][r,s,T,U] * HD['Dbbbb'][Dp,Dq,Dv,Dw] ,
                         -HD['HSbbbb'][q,w,T,U] * HD['Dbbbb'][Dp,Dv,Dr,Ds] ,
                         +HD['HSbbbb'][q,v,T,U] * HD['Dbbbb'][Dp,Dw,Dr,Ds] ,
                         -HD['HSbbbb'][r,w,T,U] * HD['Dbbbb'][Dp,Dq,Ds,Dv] ,
                         +HD['HSbbbb'][r,v,T,U] * HD['Dbbbb'][Dp,Dq,Ds,Dw] ,
                         +HD['HSbbbb'][s,w,T,U] * HD['Dbbbb'][Dp,Dq,Dr,Dv] ,
                         -HD['HSbbbb'][s,v,T,U] * HD['Dbbbb'][Dp,Dq,Dr,Dw] ,
                         +HD['HSbbbb'][p,w,T,U] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         -HD['HSbbbb'][p,v,T,U] * HD['Dbbbb'][Dq,Dw,Dr,Ds] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,q,actfloor:actceil], HD['Dbbbb'][Dp,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Dr,:] ) ,
                             -HD['HSbbbb'][q,w,T,U] * HD['Dbb'][Dp,Dr] ,
                             -HD['HSbbbb'][p,q,T,U] * HD['Dbb'][Dr,Dw] ,
                             +HD['HSbbbb'][p,w,T,U] * HD['Dbb'][Dq,Dr] ))
        if r==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,q,actfloor:actceil], HD['Dbb'][Dp,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][p,q,T,U] ))
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,U,q,actfloor:actceil], HD['Dbbbb'][Dp,Dv,Ds,:] ) ,
                             -HD['HSbbbb'][p,q,T,U] * HD['Dbb'][Ds,Dv] ,
                             +HD['HSbbbb'][p,v,T,U] * HD['Dbb'][Dq,Ds] ,
                             -HD['HSbbbb'][q,v,T,U] * HD['Dbb'][Dp,Ds] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,U,q,actfloor:actceil], HD['Dbbbb'][Dp,Dv,Dr,:] ) ,
                             +HD['HSbbbb'][p,q,T,U] * HD['Dbb'][Dr,Dv] ,
                             -HD['HSbbbb'][p,v,T,U] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbbbb'][q,v,T,U] * HD['Dbb'][Dp,Dr] ))
        if r==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,q,actfloor:actceil], HD['Dbb'][Dp,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][p,q,T,U] ))
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,U,q,actfloor:actceil], HD['Dbbbb'][Dp,Dw,Ds,:] ) ,
                             +HD['HSbbbb'][p,q,T,U] * HD['Dbb'][Ds,Dw] ,
                             -HD['HSbbbb'][p,w,T,U] * HD['Dbb'][Dq,Ds] ,
                             +HD['HSbbbb'][q,w,T,U] * HD['Dbb'][Dp,Ds] ))
    if q==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dp,:] ) ,
                             +HD['HSbbbb'][r,s,T,U] * HD['Dbb'][Dp,Dw] ,
                             +HD['HSbbbb'][s,w,T,U] * HD['Dbb'][Dp,Dr] ,
                             -HD['HSbbbb'][r,w,T,U] * HD['Dbb'][Dp,Ds] ))
        if p==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -HD['HSbbbb'][r,s,T,U] ))
    if p==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             +HD['HSbbbb'][r,s,T,U] * HD['Dbb'][Dq,Dv] ,
                             +HD['HSbbbb'][s,v,T,U] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbbbb'][r,v,T,U] * HD['Dbb'][Dq,Ds] ))
    if q==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Dp,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dp,:] ) ,
                             -HD['HSbbbb'][r,s,T,U] * HD['Dbb'][Dp,Dv] ,
                             -HD['HSbbbb'][s,v,T,U] * HD['Dbb'][Dp,Dr] ,
                             +HD['HSbbbb'][r,v,T,U] * HD['Dbb'][Dp,Ds] ))
        if p==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbbbb'][r,s,T,U] ))
    if p==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dq,:] ) ,
                             -HD['HSbbbb'][r,s,T,U] * HD['Dbb'][Dq,Dw] ,
                             -HD['HSbbbb'][s,w,T,U] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbbbb'][r,w,T,U] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_AAAAbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,v,w) = e
    Dp, Dq, Dr, Ds, Du, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dp,Dq,Dv,Dw,Ds,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dp,Dq,Dv,Dw,Dr,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dp,Du,:,:] ) ))
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbbabbba'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbbabbba'][Dr,Ds,Du,:,Dp,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbabbba'][Dp,Dq,Du,:,Dr,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbabbba'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dv,Dw] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][p,T] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['HSbb'][q,T] * HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,Du] ,
                         +HD['HSbb'][s,T] * HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dv,Dw] ,
                         -HD['HSbb'][r,T] * HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dv,Dw] ,
                         +HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                         +HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbbbb'][Dp,Dq,Du,:,Dr,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbbbb'][Dp,Dq,Du,:,Ds,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dp,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,u,p,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,u,q,actfloor:actceil], HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,u,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,u,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][p,q,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,s,actfloor:actceil,T], HD['Dbbbbbb'][Dp,Dq,Du,Dv,Dw,:] ) ,
                         +HD['HSbbbb'][p,q,u,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                         -HD['HSbbbb'][r,s,u,T] * HD['Dbbbb'][Dp,Dq,Dv,Dw] ))
    if q==u:
        result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dv,Dw,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dp,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][p,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][p,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][p,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][p,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    if p==u:
        result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,T] ) ,
                             +HD['HSbb'][q,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dp,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dp,Dq,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dp,Dq,Dv,Dw] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][s,T] * HD['Dbbbb'][Dp,Dq,Dv,Dw] ,
                             +HD['Dbbbb'][Dp,Dq,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dp,Dq,:,Dv,Dw,:] ) ))
    if s==u:
        result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][T,p,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dp,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dp,Dq,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dp,Dq,Dv,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             +HD['HSbb'][r,T] * HD['Dbbbb'][Dp,Dq,Dv,Dw] ,
                             -HD['Dbbbb'][Dp,Dq,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dp,Dq,:,Dv,Dw,:] ) ))
    return result


def lucc_AAAAbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,w) = e
    Dp, Dq, Dr, Ds, Du, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][q,V,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,Du,Dp,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,q,V,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dp,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,V,actfloor:actceil,T], HD['Dbbbbbb'][Dp,Dq,Du,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,s,V,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dw,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbbbbbb'][Dp,Dq,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbbbbbb'][Dp,Dq,Dw,Ds,Du,:] ) ,
                         +HD['HSbbbb'][p,V,u,T] * HD['Dbbbb'][Dq,Dw,Dr,Ds] ,
                         -HD['HSbbbb'][r,V,u,T] * HD['Dbbbb'][Dp,Dq,Ds,Dw] ,
                         -HD['HSbbbb'][q,V,u,T] * HD['Dbbbb'][Dp,Dw,Dr,Ds] ,
                         +HD['HSbbbb'][s,V,u,T] * HD['Dbbbb'][Dp,Dq,Dr,Dw] ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,s,V,actfloor:actceil], HD['Dbbbb'][Dp,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][p,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbbbb'][Dp,Dw,Ds,:] ) ))
    if r==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,q,V,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,V,actfloor:actceil,T], HD['Dbbbb'][Dp,Dq,Dw,:] ) ))
    if s==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,q,V,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Dp,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbbbb'][Dp,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,p,V,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Dq,:] ) ))
    if p==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][q,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,s,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Dr,:] ) ))
    return result


def lucc_AAAAbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,u,V,W) = e
    Dp, Dq, Dr, Ds, Du = p-actfloor, q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][T,s,V,W] * HD['Dbbbb'][Dp,Dq,Dr,Du] ,
                         -HD['HSbbbb'][T,p,V,W] * HD['Dbbbb'][Dq,Du,Dr,Ds] ,
                         +HD['HSbbbb'][T,r,V,W] * HD['Dbbbb'][Dp,Dq,Ds,Du] ,
                         +HD['HSbbbb'][T,q,V,W] * HD['Dbbbb'][Dp,Du,Dr,Ds] ))
    if r==u:
        result += 2 * fsum(( +HD['HSbbbb'][T,p,V,W] * HD['Dbb'][Dq,Ds] ,
                             -HD['HSbbbb'][T,q,V,W] * HD['Dbb'][Dp,Ds] ))
    if s==u:
        result += 2 * fsum(( -HD['HSbbbb'][T,p,V,W] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbbbb'][T,q,V,W] * HD['Dbb'][Dp,Dr] ))
    if p==u:
        result += 2 * fsum(( -HD['HSbbbb'][T,r,V,W] * HD['Dbb'][Dq,Ds] ,
                             +HD['HSbbbb'][T,s,V,W] * HD['Dbb'][Dq,Dr] ))
    if q==u:
        result += 2 * fsum(( +HD['HSbbbb'][T,r,V,W] * HD['Dbb'][Dp,Ds] ,
                             -HD['HSbbbb'][T,s,V,W] * HD['Dbb'][Dp,Dr] ))
    return result


def lucc_AAAAbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,v,w) = e
    Dp, Dq, Dr, Ds, Dv, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,p,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,U,q,actfloor:actceil], HD['Dbbbbbb'][Dp,Dv,Dw,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dp,Dq,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dp,Dq,:] ) ,
                         -HD['HSbbbb'][p,q,T,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                         +HD['HSbbbb'][r,s,T,U] * HD['Dbbbb'][Dp,Dq,Dv,Dw] ))
    return result


def lucc_AAAAbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,w) = e
    Dp, Dq, Dr, Ds, Dw = p-actfloor, q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][p,V,T,U] * HD['Dbbbb'][Dq,Dw,Dr,Ds] ,
                         +HD['HSbbbb'][q,V,T,U] * HD['Dbbbb'][Dp,Dw,Dr,Ds] ,
                         -HD['HSbbbb'][s,V,T,U] * HD['Dbbbb'][Dp,Dq,Dr,Dw] ,
                         +HD['HSbbbb'][r,V,T,U] * HD['Dbbbb'][Dp,Dq,Ds,Dw] ))
    return result


def lucc_AAAAbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (p,q,r,s),(T,U,V,W) = e
    Dp, Dq, Dr, Ds = p-actfloor, q-actfloor, r-actfloor, s-actfloor
    result = 0
    return result


def lucc_CAAAbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Dt,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dt,Du,Dq,Dv,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dt,Du,Dq,Dw,:,:] ) ))
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         +HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                         +HD['HSbb'][P,t] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['HSbb'][P,u] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Dt] ,
                         +HD['HSbb'][P,w] * HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dv] ,
                         -HD['HSbb'][P,v] * HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dw] ,
                         -HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                         +HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][u,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,w,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dt,Du,Ds,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dt,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][w,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][t,u,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,w,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][r,u,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Dt,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][u,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,w,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dt,Du,Dr,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,v,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dt,Du,Dr,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][w,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,t,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][s,u,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Dt,:] ) ,
                         -HD['HSbbbb'][t,P,r,s] * HD['Dbbbb'][Dq,Du,Dv,Dw] ,
                         +HD['HSbbbb'][u,P,r,s] * HD['Dbbbb'][Dq,Dt,Dv,Dw] ,
                         -HD['HSbbbb'][w,P,r,s] * HD['Dbbbb'][Dq,Dv,Dt,Du] ,
                         +HD['HSbbbb'][v,P,r,s] * HD['Dbbbb'][Dq,Dw,Dt,Du] ))
    if q==u:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dt,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dt,:,Dv,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Ds,Dt,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dr,Dt,:,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Dbbbb'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             -HD['HSbb'][P,t] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['HSbb'][P,s] * HD['Dbbbb'][Dr,Dt,Dv,Dw] ,
                             -HD['HSbb'][P,r] * HD['Dbbbb'][Ds,Dt,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                             -HD['Dbbbb'][Dr,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Dbbbb'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,t,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,t,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if q==t:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                             +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSbb'][P,u] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -HD['HSbb'][P,s] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                             +HD['HSbb'][P,r] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,u,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,u,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if q==v:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dw,:,Dt,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dw,:,Dt,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Ds,Dw,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dr,Dw,:,Dt,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             -HD['Dbbbb'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                             +HD['Dbbbb'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             -HD['HSbb'][P,w] * HD['Dbbbb'][Dr,Ds,Dt,Du] ,
                             +HD['HSbb'][P,s] * HD['Dbbbb'][Dr,Dw,Dt,Du] ,
                             -HD['HSbb'][P,r] * HD['Dbbbb'][Ds,Dw,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Dbbbb'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                             -HD['Dbbbb'][Dr,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dw,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dw,:,Dt,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,w,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,w,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ))
    if q==w:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,:,Dt,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dv,:,Dt,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Ds,Dv,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dr,Dv,:,Dt,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             +HD['Dbbbb'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             -HD['Dbbbb'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             +HD['HSbb'][P,v] * HD['Dbbbb'][Dr,Ds,Dt,Du] ,
                             -HD['HSbb'][P,s] * HD['Dbbbb'][Dr,Dv,Dt,Du] ,
                             +HD['HSbb'][P,r] * HD['Dbbbb'][Ds,Dv,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Dbbbb'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             +HD['Dbbbb'][Dr,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,:,Dt,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dt,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,:,Dt,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,v,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,v,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ))
    if s==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Dt,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             -HD['HSbb'][P,r] * HD['Dbbbb'][Dq,Dw,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,P,r,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ))
        if r==w:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ))
    if r==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dt,Du,:,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dt,Du,:,Dq,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             +HD['Dbbbb'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             -HD['HSbb'][P,s] * HD['Dbbbb'][Dq,Dv,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             +HD['Dbbbb'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,P,s,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ))
    if s==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Dt,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -HD['Dbbbb'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +HD['HSbb'][P,r] * HD['Dbbbb'][Dq,Dv,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -HD['Dbbbb'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ))
        if r==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ))
    if r==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dt,Du,:,Dq,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dt,Du,:,Dq,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dt,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             -HD['Dbbbb'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             +HD['HSbb'][P,s] * HD['Dbbbb'][Dq,Dw,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             -HD['Dbbbb'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][w,P,s,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ))
    if s==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Dv,Dw,:,Dq,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['Dbbbb'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -HD['HSbb'][P,r] * HD['Dbbbb'][Dq,Dt,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['Dbbbb'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][t,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ))
        if r==t:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ))
    if r==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             +HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -HD['HSbb'][P,s] * HD['Dbbbb'][Dq,Du,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             +HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][u,P,s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ))
    if r==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][t,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             -HD['Dbbbb'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             +HD['HSbb'][P,s] * HD['Dbbbb'][Dq,Dt,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             -HD['Dbbbb'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][t,P,s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ))
        if s==t:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ))
    if s==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][u,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Dv,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             -HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             +HD['HSbb'][P,r] * HD['Dbbbb'][Dq,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             -HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][u,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ))
    return result


def lucc_CAAAbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSbbbb'][P,T,r,s] * HD['Dbbbb'][Dq,Du,Dv,Dw] ,
                         -HD['HSbbbb'][P,T,s,w] * HD['Dbbbb'][Dq,Du,Dr,Dv] ,
                         +HD['HSbbbb'][P,T,s,v] * HD['Dbbbb'][Dq,Du,Dr,Dw] ,
                         -HD['HSbbbb'][w,P,T,s] * HD['Dbbbb'][Dq,Dv,Dr,Du] ,
                         +HD['HSbbbb'][v,P,T,s] * HD['Dbbbb'][Dq,Dw,Dr,Du] ,
                         +HD['HSbbbb'][P,T,r,w] * HD['Dbbbb'][Dq,Du,Ds,Dv] ,
                         -HD['HSbbbb'][P,T,r,v] * HD['Dbbbb'][Dq,Du,Ds,Dw] ,
                         +HD['HSbbbb'][w,P,T,r] * HD['Dbbbb'][Dq,Dv,Ds,Du] ,
                         -HD['HSbbbb'][v,P,T,r] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                         +HD['HSbbbb'][P,T,v,w] * HD['Dbbbb'][Dq,Du,Dr,Ds] ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dq,Dv,Dw,:,Dr,Du,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][q,w,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][q,v,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dq,Dv,Dw,:,Dr,Du,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             -HD['Dbbbb'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,w] ) ,
                             +HD['Dbbbb'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,w] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbbabba'][Dq,Dv,:,Dr,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbbabba'][Dq,Dw,:,Dr,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbbabba'][Dq,Dw,:,Ds,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbbabba'][Dq,Dv,:,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -HD['HSbb'][r,v] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                             -HD['HSbb'][s,w] * HD['Dbbbb'][Dq,Dv,Dr,Du] ,
                             +HD['HSbb'][s,v] * HD['Dbbbb'][Dq,Dw,Dr,Du] ,
                             +HD['HSbb'][r,w] * HD['Dbbbb'][Dq,Dv,Ds,Du] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,v] ) ,
                             +HD['Dbbbb'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,w] ) ,
                             -HD['Dbbbb'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,w] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Dr,Du,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Ds,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Ds,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Dr,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,v,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,w,s,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,w,r,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,w,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                             +HD['HSbbbb'][r,s,v,w] * HD['Dbb'][Dq,Du] ))
        if s==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,v,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,:,Dv,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                                 +HD['HSbb'][r,v] * HD['Dbb'][Dq,Du] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ))
            if r==v:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if s==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Du,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,w,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dw,:,Du,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,w] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 -HD['HSbb'][r,w] * HD['Dbb'][Dq,Du] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,w] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ))
            if r==w:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if r==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,:,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,v,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dv,:,Du,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dv,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 -HD['HSbb'][s,v] * HD['Dbb'][Dq,Du] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Du,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,w,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dw,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 +HD['HSbb'][s,w] * HD['Dbb'][Dq,Du] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dq,Dw,:] ) ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dw,Dr,Du] ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dq,:] ) ,
                             -HD['HSbbbb'][w,P,T,r] * HD['Dbb'][Dq,Du] ))
        if r==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Du,:,Dq,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][P,T] * HD['Dbb'][Dq,Du] ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dq,:] ) ))
    if r==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dq,Dv,:] ) ,
                             -HD['Dbbbb'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dv,Ds,Du] ,
                             -HD['Dbbbb'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                             -HD['HSbbbb'][v,P,T,s] * HD['Dbb'][Dq,Du] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dq,Dv,:] ) ,
                             +HD['Dbbbb'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dv,Dr,Du] ,
                             +HD['Dbbbb'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                             +HD['HSbbbb'][v,P,T,r] * HD['Dbb'][Dq,Du] ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Du,:,Dq,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][P,T] * HD['Dbb'][Dq,Du] ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dq,:] ) ))
    if r==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dq,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                             +HD['HSbbbb'][w,P,T,s] * HD['Dbb'][Dq,Du] ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,T,s,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                             +HD['HSbbbb'][P,T,r,s] * HD['Dbb'][Du,Dw] ,
                             -HD['HSbbbb'][P,T,r,w] * HD['Dbb'][Ds,Du] ,
                             +HD['HSbbbb'][P,T,s,w] * HD['Dbb'][Dr,Du] ))
    if q==w:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,r,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,T,s,actfloor:actceil], HD['Dbbbb'][Dr,Dv,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             -HD['HSbbbb'][P,T,r,s] * HD['Dbb'][Du,Dv] ,
                             +HD['HSbbbb'][P,T,r,v] * HD['Dbb'][Ds,Du] ,
                             -HD['HSbbbb'][P,T,s,v] * HD['Dbb'][Dr,Du] ))
    return result


def lucc_CAAAbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -HD['HSbbbb'][w,P,T,U] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         +HD['HSbbbb'][v,P,T,U] * HD['Dbbbb'][Dq,Dw,Dr,Ds] ))
    if P==U:
        result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][q,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][q,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,T,w,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,T,v,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,T,w,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][q,w,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +HD['HSbbbb'][s,T,v,w] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbbbb'][r,T,v,w] * HD['Dbb'][Dq,Ds] ))
        if s==v:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dw,:] ) ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][q,T] * HD['Dbb'][Dr,Dw] ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,T,w,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][q,w,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
            if r==w:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][q,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dv,:,:] )
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                                 +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][q,T] * HD['Dbb'][Ds,Dv] ,
                                 +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][q,v,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][s,T,v,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
        if s==w:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][r,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dv,:,:] )
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][q,T] * HD['Dbb'][Dr,Dv] ,
                                 -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][q,v,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,T,v,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
            if r==v:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][q,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][s,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][q,T] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][s,T,w,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][q,w,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    if P==T:
        result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,U,:actfloor] ) ,
                             +HD['HSbb'][q,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,U,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][q,w,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][q,v,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,U,w,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,U,v,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,U,w,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,U,v,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbbbb'][r,U,v,w] * HD['Dbb'][Dq,Ds] ,
                             -HD['HSbbbb'][s,U,v,w] * HD['Dbb'][Dq,Dr] ))
        if s==v:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbaba'][Dr,:,Dw,:] ) ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,U,:actfloor] ) ,
                                 -HD['HSbb'][q,U] * HD['Dbb'][Dr,Dw] ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbbbb'][Dr,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,U,w,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][q,w,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
            if r==w:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][q,U] ,
                                     +einsum( 'II->', HD['HSbbbb'][q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dv,:,:] )
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                                 -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][q,:actfloor,U,:actfloor] ) ,
                                 -HD['HSbb'][q,U] * HD['Dbb'][Ds,Dv] ,
                                 -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][q,v,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][s,U,v,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
        if s==w:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][r,U,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dv,:,:] )
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][q,:actfloor,U,:actfloor] ) ,
                                 +HD['HSbb'][q,U] * HD['Dbb'][Dr,Dv] ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][q,v,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,U,v,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
            if r==v:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][q,U] ,
                                     -einsum( 'II->', HD['HSbbbb'][q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][s,U,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,U,:actfloor] ) ,
                                 +HD['HSbb'][q,U] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,U,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][s,U,w,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][q,w,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Dr,:] ) ,
                             -HD['HSbbbb'][w,P,T,U] * HD['Dbb'][Dq,Dr] ))
        if r==w:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbb'][Dq,:] )
    if r==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             -HD['HSbbbb'][v,P,T,U] * HD['Dbb'][Dq,Ds] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +HD['HSbbbb'][v,P,T,U] * HD['Dbb'][Dq,Dr] ))
        if r==v:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbb'][Dq,:] )
    if r==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbbbb'][w,P,T,U] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_CAAAbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbbabbba'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,u,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,s,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         -HD['HSbbbb'][T,P,r,s] * HD['Dbbbb'][Dq,Du,Dv,Dw] ))
    if q==u:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][P,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,s,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,r,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,P,s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] )
    if s==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] )
    return result


def lucc_CAAAbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSbbbb'][T,P,V,r] * HD['Dbbbb'][Dq,Du,Ds,Dw] ,
                         +HD['HSbbbb'][P,V,r,T] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                         +HD['HSbbbb'][P,V,u,T] * HD['Dbbbb'][Dq,Dw,Dr,Ds] ,
                         -HD['HSbbbb'][T,P,V,s] * HD['Dbbbb'][Dq,Du,Dr,Dw] ,
                         -HD['HSbbbb'][P,V,s,T] * HD['Dbbbb'][Dq,Dw,Dr,Du] ))
    if P==V:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dq,Du,:,Dr,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dq,Du,:,Ds,Dw,:] ) ,
                             -HD['Dbbbb'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                             +HD['Dbbbb'][Dq,Du,Dr,Dw] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][s,T] * HD['Dbbbb'][Dq,Du,Dr,Dw] ,
                             +HD['HSbb'][r,T] * HD['Dbbbb'][Dq,Du,Ds,Dw] ,
                             +HD['Dbbbb'][Dq,Du,Dr,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                             -HD['Dbbbb'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dq,Du,:,Ds,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dq,Du,:,Dr,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,u,r,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,actfloor:actceil,T], HD['Dbbbb'][Dq,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,u,s,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Dq,:] ) ,
                             +HD['HSbbbb'][r,s,u,T] * HD['Dbb'][Dq,Dw] ))
        if r==u:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Dq,:,Dw,:] ) ,
                                 -HD['Dbb'][Dq,Dw] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                                 +HD['HSbb'][s,T] * HD['Dbb'][Dq,Dw] ,
                                 -HD['Dbb'][Dq,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Dq,:,Dw,:] ) ))
        if s==u:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][T,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Dq,:,Dw,:] ) ,
                                 +HD['Dbb'][Dq,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                                 -HD['HSbb'][r,T] * HD['Dbb'][Dq,Dw] ,
                                 +HD['Dbb'][Dq,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Dq,:,Dw,:] ) ))
    if r==u:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dq,:] ) ,
                             +HD['HSbbbb'][T,P,V,s] * HD['Dbb'][Dq,Dw] ))
    if s==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Dq,:] ) ,
                             -HD['HSbbbb'][T,P,V,r] * HD['Dbb'][Dq,Dw] ))
    if q==u:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             +HD['HSbbbb'][P,V,s,T] * HD['Dbb'][Dr,Dw] ,
                             -HD['HSbbbb'][P,V,r,T] * HD['Dbb'][Ds,Dw] ))
    return result


def lucc_CAAAbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][T,P,V,W] * HD['Dbbbb'][Dq,Du,Dr,Ds]
    if P==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,q,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,V,actfloor:actceil,T], HD['Dbbbb'][Dq,Du,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbbbb'][Dq,Du,Ds,:] ) ,
                             +HD['HSbbbb'][s,V,u,T] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbbbb'][r,V,u,T] * HD['Dbb'][Dq,Ds] ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][s,V,actfloor:actceil,T], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,q,V,actfloor:actceil], HD['Dbb'][Ds,:] ) ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][r,V,actfloor:actceil,T], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][T,q,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,q,W,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,W,actfloor:actceil,T], HD['Dbbbb'][Dq,Du,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,W,actfloor:actceil,T], HD['Dbbbb'][Dq,Du,Ds,:] ) ,
                             -HD['HSbbbb'][s,W,u,T] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbbbb'][r,W,u,T] * HD['Dbb'][Dq,Ds] ))
        if s==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][r,W,actfloor:actceil,T], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,q,W,actfloor:actceil], HD['Dbb'][Dr,:] ) ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,q,W,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][s,W,actfloor:actceil,T], HD['Dbb'][Dq,:] ) ))
    if r==u:
        result += 2 * +HD['HSbbbb'][T,P,V,W] * HD['Dbb'][Dq,Ds]
    if s==u:
        result += 2 * -HD['HSbbbb'][T,P,V,W] * HD['Dbb'][Dq,Dr]
    return result


def lucc_CAAAbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,U,P,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] )
    return result


def lucc_CAAAbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,V,T,U] * HD['Dbbbb'][Dq,Dw,Dr,Ds]
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dq,:] ) ,
                             -HD['HSbbbb'][r,s,T,U] * HD['Dbb'][Dq,Dw] ))
    return result


def lucc_CAAAbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==W:
        result += 2 * fsum(( -HD['HSbbbb'][s,V,T,U] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbbbb'][r,V,T,U] * HD['Dbb'][Dq,Ds] ))
    if P==V:
        result += 2 * fsum(( +HD['HSbbbb'][s,W,T,U] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbbbb'][r,W,T,U] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_CCAAbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,Q,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,Q,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                         +HD['HSbbbb'][P,Q,t,u] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                         -HD['HSbbbb'][P,Q,r,t] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                         +HD['HSbbbb'][P,Q,r,u] * HD['Dbbbb'][Ds,Dt,Dv,Dw] ,
                         -HD['HSbbbb'][P,Q,v,w] * HD['Dbbbb'][Dr,Ds,Dt,Du] ,
                         +HD['HSbbbb'][P,Q,s,w] * HD['Dbbbb'][Dr,Dv,Dt,Du] ,
                         -HD['HSbbbb'][P,Q,s,v] * HD['Dbbbb'][Dr,Dw,Dt,Du] ,
                         +HD['HSbbbb'][P,Q,s,t] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['HSbbbb'][P,Q,s,u] * HD['Dbbbb'][Dr,Dt,Dv,Dw] ,
                         -HD['HSbbbb'][P,Q,r,w] * HD['Dbbbb'][Ds,Dv,Dt,Du] ,
                         +HD['HSbbbb'][P,Q,r,v] * HD['Dbbbb'][Ds,Dw,Dt,Du] ))
    if s==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dw,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,r,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] )
        if r==w:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] )
    if r==w:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dv,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,s,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] )
    if s==w:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dv,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,r,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] )
        if r==v:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] )
    if r==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dw,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,s,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] )
    if s==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dt,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] )
        if r==t:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    if r==t:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Du,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] )
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dt,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] )
        if s==t:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    if s==t:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] )
    return result


def lucc_CCAAbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +HD['HSbbbb'][P,Q,T,r] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                         -HD['HSbbbb'][P,Q,T,s] * HD['Dbbbb'][Dr,Du,Dv,Dw] ))
    if Q==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['HSbb'][P,s] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                             +HD['HSbb'][P,r] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                             +HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,P,s,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,s,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][w,P,r,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             +HD['HSbbbb'][w,P,r,s] * HD['Dbb'][Du,Dv] ,
                             -HD['HSbbbb'][v,P,r,s] * HD['Dbb'][Du,Dw] ))
        if s==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 +HD['HSbb'][P,r] * HD['Dbb'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][w,P,r,actfloor:actceil], HD['Dbb'][Du,:] ) ))
            if r==w:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if r==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dv,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 +HD['HSbb'][P,s] * HD['Dbb'][Du,Dv] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,P,s,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if s==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][v,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,:,Dv,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 -HD['HSbb'][P,r] * HD['Dbb'][Du,Dv] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,r,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,P,r,actfloor:actceil], HD['Dbb'][Du,:] ) ))
            if r==v:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if r==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][w,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,P,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -HD['HSbb'][P,s] * HD['Dbb'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,s,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][w,P,s,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,s] ) ,
                             +HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,r] ) ,
                             +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['HSbb'][Q,r] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                             +HD['HSbb'][Q,s] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,r] ) ,
                             -HD['Dbbbb'][Dr,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,s] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,s,Q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][w,Q,s,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,Q,s,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,Q,r,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,Q,r,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             +HD['HSbbbb'][v,Q,r,s] * HD['Dbb'][Du,Dw] ,
                             -HD['HSbbbb'][w,Q,r,s] * HD['Dbb'][Du,Dv] ))
        if r==v:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dw,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 +HD['HSbb'][Q,s] * HD['Dbb'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][w,Q,s,actfloor:actceil], HD['Dbb'][Du,:] ) ))
            if s==w:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if r==w:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dv,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,s] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 -HD['HSbb'][Q,s] * HD['Dbb'][Du,Dv] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                                 +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,s] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,s,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,Q,s,actfloor:actceil], HD['Dbb'][Du,:] ) ))
            if s==v:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if s==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][w,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 -HD['HSbb'][Q,r] * HD['Dbb'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][w,Q,r,actfloor:actceil], HD['Dbb'][Du,:] ) ))
        if s==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dv,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][v,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,Q,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dr,Du,:,Dv,:,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbaba'][Du,:,Dv,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,r] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 +HD['HSbb'][Q,r] * HD['Dbb'][Du,Dv] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                                 -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,r] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,r,actfloor:actceil], HD['Dbbbb'][Du,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,Q,r,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ,
                             +HD['HSbbbb'][P,Q,T,r] * HD['Dbb'][Du,Dw] ))
        if r==w:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbb'][Du,:] )
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ,
                             +HD['HSbbbb'][P,Q,T,s] * HD['Dbb'][Du,Dv] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ,
                             -HD['HSbbbb'][P,Q,T,r] * HD['Dbb'][Du,Dv] ))
        if r==v:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbb'][Du,:] )
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             -HD['HSbbbb'][P,Q,T,s] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_CCAAbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,Q,T,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw]
    if Q==U:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             -HD['HSbbbb'][w,P,T,s] * HD['Dbb'][Dr,Dv] ,
                             -HD['HSbbbb'][v,P,T,r] * HD['Dbb'][Ds,Dw] ,
                             +HD['HSbbbb'][v,P,T,s] * HD['Dbb'][Dr,Dw] ,
                             +HD['HSbbbb'][w,P,T,r] * HD['Dbb'][Ds,Dv] ))
        if P==T:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dr,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Ds,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dr,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Ds,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,w] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,w] ) ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,v] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dw,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dw,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +HD['HSbb'][r,w] * HD['Dbb'][Ds,Dv] ,
                                 -HD['HSbb'][r,v] * HD['Dbb'][Ds,Dw] ,
                                 -HD['HSbb'][s,w] * HD['Dbb'][Dr,Dv] ,
                                 +HD['HSbb'][s,v] * HD['Dbb'][Dr,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,v] ) ,
                                 -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,w] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dw,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dw,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,s,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,w,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,w,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,s,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSbbbb'][r,s,v,w] ))
            if r==w:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -HD['HSbb'][s,v] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if r==v:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +HD['HSbb'][s,w] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if s==v:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -HD['HSbb'][r,w] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if s==w:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +HD['HSbb'][r,v] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                                 -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][P,T] * HD['Dbb'][Ds,Dv] ,
                                 -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -HD['HSbbbb'][v,P,T,s] ))
            if s==v:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                     +HD['HSbb'][P,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dw,:] ) ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][P,T] * HD['Dbb'][Dr,Dw] ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][w,P,T,r] ))
        if s==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][P,T] * HD['Dbb'][Dr,Dv] ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,P,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,T,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSbbbb'][v,P,T,r] ))
            if r==v:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                     -HD['HSbb'][P,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][P,T] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][w,P,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][s,T,P,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +HD['HSbbbb'][w,P,T,s] ))
    if Q==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,U,:actfloor] ) ,
                             -HD['HSbb'][P,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,U,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,U,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,P,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,P,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,U,P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                             +HD['HSbbbb'][w,P,U,s] * HD['Dbb'][Dr,Dv] ,
                             +HD['HSbbbb'][v,P,U,r] * HD['Dbb'][Ds,Dw] ,
                             -HD['HSbbbb'][v,P,U,s] * HD['Dbb'][Dr,Dw] ,
                             -HD['HSbbbb'][w,P,U,r] * HD['Dbb'][Ds,Dv] ))
        if P==U:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Ds,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dr,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,w] ) ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,v] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                                 +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,w] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dw,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dw,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +HD['HSbb'][r,v] * HD['Dbb'][Ds,Dw] ,
                                 +HD['HSbb'][s,w] * HD['Dbb'][Dr,Dv] ,
                                 -HD['HSbb'][s,v] * HD['Dbb'][Dr,Dw] ,
                                 -HD['HSbb'][r,w] * HD['Dbb'][Ds,Dv] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,w] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                                 -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,w] ) ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dw,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dw,:,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,w,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,w,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,s,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,s,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -HD['HSbbbb'][r,s,v,w] ))
            if r==w:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +HD['HSbb'][s,v] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if r==v:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -HD['HSbb'][s,w] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if s==v:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +HD['HSbb'][r,w] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if s==w:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -HD['HSbb'][r,v] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaba'][Dr,:,Dw,:] ) ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,U,:actfloor] ) ,
                                 +HD['HSbb'][P,U] * HD['Dbb'][Dr,Dw] ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbbbb'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,U,P,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][w,P,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbbbb'][w,P,U,r] ))
            if r==w:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][P,:actfloor,U,:actfloor] ) ,
                                     -HD['HSbb'][P,U] ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                                 +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,U,:actfloor] ) ,
                                 +HD['HSbb'][P,U] * HD['Dbb'][Ds,Dv] ,
                                 +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][s,U,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,P,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +HD['HSbbbb'][v,P,U,s] ))
        if s==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,U,:actfloor] ) ,
                                 -HD['HSbb'][P,U] * HD['Dbb'][Dr,Dv] ,
                                 -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,U,P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,P,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][v,P,U,r] ))
            if r==v:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][P,:actfloor,U,:actfloor] ) ,
                                     +HD['HSbb'][P,U] ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,U,:actfloor] ) ,
                                 -HD['HSbb'][P,U] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,P,U,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][w,P,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][s,U,P,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -HD['HSbbbb'][w,P,U,s] ))
    if P==U:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][Q,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][s,T,Q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,T,Q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                             -HD['HSbbbb'][w,Q,T,r] * HD['Dbb'][Ds,Dv] ,
                             +HD['HSbbbb'][w,Q,T,s] * HD['Dbb'][Dr,Dv] ,
                             +HD['HSbbbb'][v,Q,T,r] * HD['Dbb'][Ds,Dw] ,
                             -HD['HSbbbb'][v,Q,T,s] * HD['Dbb'][Dr,Dw] ))
        if r==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][Q,T] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][w,Q,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][s,T,Q,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -HD['HSbbbb'][w,Q,T,s] ))
            if s==w:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][Q,:actfloor,T,:actfloor] ) ,
                                     +HD['HSbb'][Q,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][Q,:actfloor,T,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if s==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dw,:] ) ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][Q,T] * HD['Dbb'][Dr,Dw] ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,T,Q,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][w,Q,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbbbb'][w,Q,T,r] ))
            if r==w:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][Q,:actfloor,T,:actfloor] ) ,
                                     -HD['HSbb'][Q,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][Q,:actfloor,T,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                                 +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][Q,T] * HD['Dbb'][Ds,Dv] ,
                                 +HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,Q,T,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][s,T,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSbbbb'][v,Q,T,s] ))
        if s==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][Q,T] * HD['Dbb'][Dr,Dv] ,
                                 -HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,T,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,Q,T,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][v,Q,T,r] ))
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,U,:actfloor] ) ,
                             +HD['HSbb'][Q,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,U,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,U,Q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][w,Q,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,U,Q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,Q,U,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             +HD['HSbbbb'][w,Q,U,r] * HD['Dbb'][Ds,Dv] ,
                             -HD['HSbbbb'][w,Q,U,s] * HD['Dbb'][Dr,Dv] ,
                             -HD['HSbbbb'][v,Q,U,r] * HD['Dbb'][Ds,Dw] ,
                             +HD['HSbbbb'][v,Q,U,s] * HD['Dbb'][Dr,Dw] ))
        if s==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbaba'][Dr,:,Dw,:] ) ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,U,:actfloor] ) ,
                                 -HD['HSbb'][Q,U] * HD['Dbb'][Dr,Dw] ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbbbb'][Dr,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,U,Q,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][w,Q,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][w,Q,U,r] ))
            if r==w:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][Q,:actfloor,U,:actfloor] ) ,
                                     +HD['HSbb'][Q,U] ,
                                     +einsum( 'II->', HD['HSbbbb'][Q,:actfloor,U,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,U,:actfloor] ) ,
                                 +HD['HSbb'][Q,U] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][w,Q,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][s,U,Q,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +HD['HSbbbb'][w,Q,U,s] ))
            if s==w:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][Q,:actfloor,U,:actfloor] ) ,
                                     -HD['HSbb'][Q,U] ,
                                     -einsum( 'II->', HD['HSbbbb'][Q,:actfloor,U,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if r==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbaba'][Ds,:,Dv,:] ) ,
                                 -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,U,:actfloor] ) ,
                                 -HD['HSbb'][Q,U] * HD['Dbb'][Ds,Dv] ,
                                 -HD['Dbb'][Ds,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,U,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbbbb'][Ds,:,Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,Q,U,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][s,U,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -HD['HSbbbb'][v,Q,U,s] ))
        if s==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbaba'][Dr,:,Dv,:] ) ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,U,:actfloor] ) ,
                                 +HD['HSbb'][Q,U] * HD['Dbb'][Dr,Dv] ,
                                 +HD['Dbb'][Dr,Dv] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,U,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,Q,U,actfloor:actceil], HD['Dbbbb'][Dr,:,Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,U,Q,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,Q,U,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbbbb'][v,Q,U,r] ))
    if r==w:
        result += 2 * +HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Ds,Dv]
        if s==v:
            result += 2 * -HD['HSbbbb'][P,Q,T,U]
    if s==v:
        result += 2 * +HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Dr,Dw]
    if s==w:
        result += 2 * -HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Dr,Dv]
        if r==v:
            result += 2 * +HD['HSbbbb'][P,Q,T,U]
    if r==v:
        result += 2 * -HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Ds,Dw]
    return result


def lucc_CCAAbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -HD['HSbbbb'][P,Q,u,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                         +HD['HSbbbb'][P,Q,s,T] * HD['Dbbbb'][Dr,Du,Dv,Dw] ,
                         -HD['HSbbbb'][P,Q,r,T] * HD['Dbbbb'][Ds,Du,Dv,Dw] ))
    return result


def lucc_CCAAbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==V:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,P,s,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                             +HD['HSbbbb'][T,P,r,s] * HD['Dbb'][Du,Dw] ))
        if r==u:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,P,s,actfloor:actceil], HD['Dbb'][Dw,:] )
        if s==u:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][T,P,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,P,r,actfloor:actceil], HD['Dbb'][Dw,:] )
    if P==V:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,Q,s,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,Q,r,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                             -HD['HSbbbb'][T,Q,r,s] * HD['Dbb'][Du,Dw] ))
        if r==u:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,Q,s,actfloor:actceil], HD['Dbb'][Dw,:] )
        if s==u:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][T,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dr,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,Q,r,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_CCAAbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    if Q==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,P,W,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             -HD['HSbbbb'][T,P,W,r] * HD['Dbb'][Ds,Du] ,
                             +HD['HSbbbb'][T,P,W,s] * HD['Dbb'][Dr,Du] ))
        if P==W:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Du,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Du,:,Dr,:] ) ,
                                 -HD['Dbb'][Dr,Du] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                                 +HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                                 +HD['HSbb'][s,T] * HD['Dbb'][Dr,Du] ,
                                 -HD['HSbb'][r,T] * HD['Dbb'][Ds,Du] ,
                                 -HD['Dbb'][Dr,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                                 +HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Du,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Du,:,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][T,u,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,s,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,u,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][r,s,u,T] ))
            if r==u:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][s,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if s==u:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][r,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if r==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,P,W,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -HD['HSbbbb'][T,P,W,s] ))
        if s==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,P,W,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbbbb'][T,P,W,r] ))
    if P==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,Q,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             +HD['HSbbbb'][T,Q,V,s] * HD['Dbb'][Dr,Du] ,
                             -HD['HSbbbb'][T,Q,V,r] * HD['Dbb'][Ds,Du] ))
        if s==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,Q,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbbbb'][T,Q,V,r] ))
        if r==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,Q,V,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -HD['HSbbbb'][T,Q,V,s] ))
    if Q==W:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             +HD['HSbbbb'][T,P,V,r] * HD['Dbb'][Ds,Du] ,
                             -HD['HSbbbb'][T,P,V,s] * HD['Dbb'][Dr,Du] ))
        if P==V:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Du,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Du,:,Dr,:] ) ,
                                 +HD['Dbb'][Dr,Du] * einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                                 -HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                                 -HD['HSbb'][s,T] * HD['Dbb'][Dr,Du] ,
                                 +HD['HSbb'][r,T] * HD['Dbb'][Ds,Du] ,
                                 +HD['Dbb'][Dr,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                                 -HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Du,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Du,:,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,u,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,s,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][T,u,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +HD['HSbbbb'][r,s,u,T] ))
            if r==u:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][s,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][s,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][s,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if s==u:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][r,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][r,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][r,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +HD['HSbbbb'][T,P,V,s] ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,P,V,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][T,P,V,r] ))
    if P==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,Q,W,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] ) ,
                             +HD['HSbbbb'][T,Q,W,r] * HD['Dbb'][Ds,Du] ,
                             -HD['HSbbbb'][T,Q,W,s] * HD['Dbb'][Dr,Du] ))
        if s==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,Q,W,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][T,Q,W,r] ))
        if r==u:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,Q,W,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +HD['HSbbbb'][T,Q,W,s] ))
    return result


def lucc_CCAAbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,Q,T,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw]
    return result


def lucc_CCAAbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    return result


def lucc_CCAAbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if Q==V:
        if P==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +HD['HSbbbb'][r,s,T,U] ))
    if Q==W:
        if P==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,U,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -HD['HSbbbb'][r,s,T,U] ))
    return result


def lucc_VAAAbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(t,u,v,w) = e
    Dq, Dr, Ds, Dt, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Du,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Dt,:,:] ) ,
                     -einsum( 'ij,ij->', HD['HSbbbb'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dt,Du,Dq,Dv,:,:] ) ,
                     +einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dt,Du,Dq,Dw,:,:] ) ))
    result += 2 * fsum(( +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                         +HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         +HD['HSbb'][P,t] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['HSbb'][P,u] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Dt] ,
                         +HD['HSbb'][P,w] * HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dv] ,
                         -HD['HSbb'][P,v] * HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dw] ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                         +HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Dt] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                         -HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dt,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dw,:,Dq,Dt,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][v,w,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dt,Du,Dr,Ds,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,q,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,q,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,q,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,q,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][t,u,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +HD['HSbbbb'][P,q,v,w] * HD['Dbbbb'][Dr,Ds,Dt,Du] ,
                         -HD['HSbbbb'][P,q,t,u] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ))
    if s==v:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dw,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dt,Du,:,Dq,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dw,:] ) ))
        if r==w:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ))
    if r==w:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dt,Du,:,Dq,Dv,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dv,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dt,Du,:,Dq,Dv,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dv,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dv,:] ) ))
    if s==w:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,v,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dv,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dt,Du,:,Dq,Dv,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dv,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dq,Dv,:] ) ))
        if r==v:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dt,Du,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ))
    if r==v:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dt,Du,:,Dq,Dw,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,w,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dw,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dt,Du,:,Dq,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dw,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dw,:] ) ))
    if s==u:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Dt,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Dt,:] ) ))
        if r==t:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ))
    if r==t:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ))
    if r==u:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dv,Dw,:,Dq,Dt,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dt,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,t,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dv,Dw,:,Dq,Dt,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Dt,:] ) ))
        if s==t:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ))
    if s==t:
        result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,u,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Dv,Dw,:,Dq,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,Du,:] ) ))
    if q==u:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dt,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dt,:,Dv,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,t] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             -HD['HSbb'][P,t] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,t] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    if q==t:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSbb'][P,u] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    if q==v:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dw,:,Dt,Du,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dw,:,Dt,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dt,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             -HD['HSbb'][P,w] * HD['Dbbbb'][Dr,Ds,Dt,Du] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dt,Du,:] ) ))
    if q==w:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,:,Dt,Du,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Dv,:,Dt,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dt,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             +HD['HSbb'][P,v] * HD['Dbbbb'][Dr,Ds,Dt,Du] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dt,Du,:] ) ))
    return result


def lucc_VAAAbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbabbba'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         +HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,w,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         +HD['HSbbbb'][P,T,v,w] * HD['Dbbbb'][Dq,Du,Dr,Ds] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dq,Dw,:] ) ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dw,Dr,Du] ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,w,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] ) ))
        if r==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dq,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 +HD['HSbb'][P,T] * HD['Dbb'][Dq,Du] ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dq,Dv,:] ) ,
                             -HD['Dbbbb'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dv,Ds,Du] ,
                             -HD['Dbbbb'][Dq,Dv,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] ) ))
    if s==w:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Dr,Du,:,Dq,Dv,:] ) ,
                             +HD['Dbbbb'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dv,Dr,Du] ,
                             +HD['Dbbbb'][Dq,Dv,Dr,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Du,:,Dq,Dv,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,v,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] ) ))
        if r==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbaba'][Du,:,Dq,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                                 -HD['HSbb'][P,T] * HD['Dbb'][Dq,Du] ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbb'][Du,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbb'][Du,:] ) ))
    if r==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dq,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,T,:actfloor] ) ,
                             +HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,T,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,T,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,w,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ))
    if q==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Du,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] )
    if q==w:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Du,:] )
    return result


def lucc_VAAAbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +HD['HSbbbb'][P,q,T,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                         +HD['HSbbbb'][P,w,T,U] * HD['Dbbbb'][Dq,Dv,Dr,Ds] ,
                         -HD['HSbbbb'][P,v,T,U] * HD['Dbbbb'][Dq,Dw,Dr,Ds] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbb'][Dq,Dw,Dr,:] ) ,
                             +HD['HSbbbb'][P,w,T,U] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbbbb'][P,q,T,U] * HD['Dbb'][Dr,Dw] ))
        if r==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][P,q,T,U] ))
    if r==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbb'][Dq,Dv,Ds,:] ) ,
                             +HD['HSbbbb'][P,v,T,U] * HD['Dbb'][Dq,Ds] ,
                             -HD['HSbbbb'][P,q,T,U] * HD['Dbb'][Ds,Dv] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbb'][Dq,Dv,Dr,:] ) ,
                             +HD['HSbbbb'][P,q,T,U] * HD['Dbb'][Dr,Dv] ,
                             -HD['HSbbbb'][P,v,T,U] * HD['Dbb'][Dq,Dr] ))
        if r==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][P,q,T,U] ))
    if r==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             -HD['HSbbbb'][P,w,T,U] * HD['Dbb'][Dq,Ds] ,
                             +HD['HSbbbb'][P,q,T,U] * HD['Dbb'][Ds,Dw] ))
    return result


def lucc_VAAAbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,v,w) = e
    Dq, Dr, Ds, Du, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Dv,Dw,Dq,Du,:,:] )
    result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbabbba'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                         +HD['HSbb'][P,T] * HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] ,
                         -HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dq,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,q,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][T,u,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         +HD['HSbbbb'][P,q,u,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                         -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dq,Dv,Dw,:,Dr,Du,:,:] ) ,
                         +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][s,u,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][r,u,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dq,Dv,Dw,:,Dr,Du,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -HD['HSbb'][q,u] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Du,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
        if q==u:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dr,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Ds,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dr,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Ds,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][P,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    if r==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] )
    if s==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dq,:,:] )
    return result


def lucc_VAAAbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,w) = e
    Dq, Dr, Ds, Du, Dw = q-actfloor, r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,Du,Dq,Dw,:] ) ,
                         +HD['HSbbbb'][P,V,u,T] * HD['Dbbbb'][Dq,Dw,Dr,Ds] ))
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][q,V,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbbabba'][Dq,Dw,:,Dr,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbbabba'][Dq,Dw,:,Ds,Du,:] ) ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                             -HD['HSbb'][s,V] * HD['Dbbbb'][Dq,Dw,Dr,Du] ,
                             +HD['HSbb'][r,V] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                             -HD['Dbbbb'][Dq,Dw,Dr,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Dr,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Ds,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][s,u,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][r,u,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][q,V,u,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][r,s,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ))
        if q==u:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dw,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dw,:,Ds,:] ) ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                                 +HD['HSbb'][s,V] * HD['Dbb'][Dr,Dw] ,
                                 -HD['HSbb'][r,V] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,s,V,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dw,:] )
    if r==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dq,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,T,V,actfloor:actceil], HD['Dbbbb'][Dr,Dw,Dq,:] )
    return result


def lucc_VAAAbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,u,V,W) = e
    Dq, Dr, Ds, Du = q-actfloor, r-actfloor, s-actfloor, u-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,T,V,W] * HD['Dbbbb'][Dq,Du,Dr,Ds]
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][V,W,s,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][V,W,r,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             +HD['HSbbbb'][r,s,V,W] * HD['Dbb'][Dq,Du] ,
                             +HD['HSbbbb'][s,u,V,W] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbbbb'][r,u,V,W] * HD['Dbb'][Dq,Ds] ))
        if q==u:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][V,W,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][V,W,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -HD['HSbbbb'][r,s,V,W] ))
    if r==u:
        result += 2 * -HD['HSbbbb'][P,T,V,W] * HD['Dbb'][Dq,Ds]
    if s==u:
        result += 2 * +HD['HSbbbb'][P,T,V,W] * HD['Dbb'][Dq,Dr]
    return result


def lucc_VAAAbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,v,w) = e
    Dq, Dr, Ds, Dv, Dw = q-actfloor, r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,Ds,:] ) ,
                         -HD['HSbbbb'][P,q,T,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ))
    if P==U:
        result += fsum(( -einsum( 'ij,ij->', HD['HSbbbb'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][T,r,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,T] ) ,
                             +HD['HSbb'][q,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    if P==T:
        result += fsum(( +einsum( 'ij,ij->', HD['HSbbbb'][U,s,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Dr,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][U,r,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,U] ) ,
                             -HD['HSbb'][q,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,U] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    return result


def lucc_VAAAbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,w) = e
    Dq, Dr, Ds, Dw = q-actfloor, r-actfloor, s-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,V,T,U] * HD['Dbbbb'][Dq,Dw,Dr,Ds]
    if P==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][q,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][T,s,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Dr,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,r,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][q,V,actfloor:actceil,U], HD['Dbbbb'][Dr,Ds,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][U,s,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Dr,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][U,r,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ))
    return result


def lucc_VAAAbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,r,s),(T,U,V,W) = e
    Dq, Dr, Ds = q-actfloor, r-actfloor, s-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -HD['HSbbbb'][U,s,V,W] * HD['Dbb'][Dq,Dr] ,
                             +HD['HSbbbb'][U,r,V,W] * HD['Dbb'][Dq,Ds] ))
    if P==U:
        result += 2 * fsum(( +HD['HSbbbb'][T,s,V,W] * HD['Dbb'][Dq,Dr] ,
                             -HD['HSbbbb'][T,r,V,W] * HD['Dbb'][Dq,Ds] ))
    return result


def lucc_VACAbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(t,u,v,w) = e
    Dq, Ds, Dt, Du, Dv, Dw = q-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][u,R,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Dt,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,w,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dq,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][w,R,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dt,Du,Ds,Dv,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dt,Du,Ds,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,u,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Dt,:] ) ,
                         -HD['HSbbbb'][P,q,R,w] * HD['Dbbbb'][Ds,Dv,Dt,Du] ,
                         +HD['HSbbbb'][P,q,R,v] * HD['Dbbbb'][Ds,Dw,Dt,Du] ,
                         -HD['HSbbbb'][P,q,R,t] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                         +HD['HSbbbb'][P,q,R,u] * HD['Dbbbb'][Ds,Dt,Dv,Dw] ))
    if s==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Dt,Du,:,Dq,Dv,:] ) ,
                             -HD['Dbbbb'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbbbb'][Dq,Dv,Dt,Du] ,
                             -HD['Dbbbb'][Dq,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,Dv,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,v,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] ) ))
    if s==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Dt,Du,:,Dq,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbbbb'][Dq,Dw,Dt,Du] ,
                             +HD['Dbbbb'][Dq,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Dt,Du,:,Dq,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,w,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] ) ))
    if s==t:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Dv,Dw,:,Dq,Du,:] ) ,
                             -HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbbbb'][Dq,Du,Dv,Dw] ,
                             -HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,u,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ))
    if s==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +HD['Dbbbb'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbbbb'][Dq,Dt,Dv,Dw] ,
                             +HD['Dbbbb'][Dq,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,Dt,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,t,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] ) ))
    if q==t:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                             -HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][u,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if q==u:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Ds,Dt,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbbbb'][Ds,Dt,Dv,Dw] ,
                             +HD['Dbbbb'][Ds,Dt,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][t,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if q==w:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Ds,Dv,:,Dt,Du,:] ) ,
                             -HD['Dbbbb'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbbbb'][Ds,Dv,Dt,Du] ,
                             -HD['Dbbbb'][Ds,Dv,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,:,Dt,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Ds,:] ) ))
    if q==v:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Ds,Dw,:,Dt,Du,:] ) ,
                             +HD['Dbbbb'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][P,R] * HD['Dbbbb'][Ds,Dw,Dt,Du] ,
                             +HD['Dbbbb'][Ds,Dw,Dt,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dw,:,Dt,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,R,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Ds,:] ) ))
    return result


def lucc_VACAbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         -HD['HSbbbb'][P,w,R,T] * HD['Dbbbb'][Dq,Dv,Ds,Du] ,
                         +HD['HSbbbb'][P,v,R,T] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                         -HD['HSbbbb'][P,T,R,w] * HD['Dbbbb'][Dq,Du,Ds,Dv] ,
                         +HD['HSbbbb'][P,T,R,v] * HD['Dbbbb'][Dq,Du,Ds,Dw] ,
                         -HD['HSbbbb'][P,q,R,T] * HD['Dbbbb'][Ds,Du,Dv,Dw] ))
    if R==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                         +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Du,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Ds,Dv,Dw,:,Dq,Du,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             +HD['Dbbbb'][Dq,Du,Ds,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                             -HD['Dbbbb'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbabba'][Ds,Dv,:,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbabba'][Ds,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -HD['HSbb'][P,w] * HD['Dbbbb'][Dq,Du,Ds,Dv] ,
                             +HD['HSbb'][P,v] * HD['Dbbbb'][Dq,Du,Ds,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                             -HD['Dbbbb'][Dq,Du,Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                             +HD['Dbbbb'][Dq,Du,Ds,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,:,Dq,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbbbb'][Ds,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,w,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,v,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,w,actfloor:actceil,P], HD['Dbbbb'][Dq,Du,Ds,:] ) ,
                             -HD['HSbbbb'][P,q,v,w] * HD['Dbb'][Ds,Du] ))
        if q==v:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dw,:,Du,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dw,:,Du,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                                 -HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Ds,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                                 +HD['HSbb'][P,w] * HD['Dbb'][Ds,Du] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                                 -HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Ds,:,Du,:] ) ))
        if q==w:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,:,Du,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Dv,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Du,:] ) ,
                                 +HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Ds,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Du,:] ) ,
                                 -HD['HSbb'][P,v] * HD['Dbb'][Ds,Du] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Du,:] ) ,
                                 +HD['Dbb'][Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Ds,:,Du,:] ) ))
    if q==v:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                             +HD['HSbbbb'][P,T,R,w] * HD['Dbb'][Ds,Du] ))
    if q==w:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Du,:] ) ,
                             -HD['HSbbbb'][P,T,R,v] * HD['Dbb'][Ds,Du] ))
    if s==w:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbbbb'][Dq,Dv,Du,:] ) ,
                             +HD['HSbbbb'][P,q,R,T] * HD['Dbb'][Du,Dv] ,
                             -HD['HSbbbb'][P,v,R,T] * HD['Dbb'][Dq,Du] ))
    if s==v:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][R,T,actfloor:actceil,P], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                             +HD['HSbbbb'][P,w,R,T] * HD['Dbb'][Dq,Du] ,
                             -HD['HSbbbb'][P,q,R,T] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_VACAbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if R==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] )
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,U,v,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dq,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,U,w,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             -HD['HSbbbb'][P,U,v,w] * HD['Dbb'][Dq,Ds] ))
        if q==w:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dv,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,U,v,actfloor:actceil], HD['Dbb'][Ds,:] )
        if q==v:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][P,U,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,U,w,actfloor:actceil], HD['Dbb'][Ds,:] )
    if R==U:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Dq,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Dq,:] ) ,
                             +HD['HSbbbb'][P,T,v,w] * HD['Dbb'][Dq,Ds] ))
        if q==w:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dv,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,T,v,actfloor:actceil], HD['Dbb'][Ds,:] )
        if q==v:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][P,T,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,T,w,actfloor:actceil], HD['Dbb'][Ds,:] )
    return result


def lucc_VACAbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,v,w) = e
    Dq, Ds, Du, Dv, Dw = q-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dq,Du,:] ) ,
                         -HD['HSbbbb'][P,q,R,T] * HD['Dbbbb'][Ds,Du,Dv,Dw] ))
    if P==T:
        result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                         -einsum( 'ij,ij->', HD['HSbbbb'][u,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] ) ))
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dq,Dv,Dw,:,Ds,Du,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,R,:actfloor] ) ,
                             -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             +HD['HSbb'][q,R] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,Du,:] ) ,
                             +HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][u,R,q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
        if q==u:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Ds,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if q==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Ds,:] )
    if s==u:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] )
    return result


def lucc_VACAbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,w) = e
    Dq, Ds, Du, Dw = q-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,T,R,V] * HD['Dbbbb'][Dq,Du,Ds,Dw] ,
                         -HD['HSbbbb'][P,V,R,T] * HD['Dbbbb'][Dq,Dw,Ds,Du] ))
    if R==V:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Ds,Du,:,Dq,Dw,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][P,T] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Ds,Du,:,Dq,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,actfloor:actceil,T], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][T,u,actfloor:actceil,P], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             -HD['HSbbbb'][P,q,u,T] * HD['Dbb'][Ds,Dw] ))
        if P==T:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Du,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dw,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][s,u,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dw,:,Du,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,u] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 +HD['HSbb'][q,u] * HD['Dbb'][Ds,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,u] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ))
            if q==u:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if q==u:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                 +HD['HSbb'][P,T] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Ds,:,Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbbabba'][Dq,Dw,:,Ds,Du,:] ) ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                             +HD['HSbb'][R,V] * HD['Dbbbb'][Dq,Dw,Ds,Du] ,
                             +HD['Dbbbb'][Dq,Dw,Ds,Du] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Ds,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][q,V,R,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][u,R,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbbbb'][q,V,R,u] * HD['Dbb'][Ds,Dw] ))
        if q==u:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbaba'][Dw,:,Ds,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                 -HD['HSbb'][R,V] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Ds,:] ) ))
    if q==u:
        result += 2 * +HD['HSbbbb'][P,V,R,T] * HD['Dbb'][Ds,Dw]
    if s==u:
        result += 2 * +HD['HSbbbb'][P,T,R,V] * HD['Dbb'][Dq,Dw]
    return result


def lucc_VACAbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,u,V,W) = e
    Dq, Ds, Du = q-actfloor, s-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][V,W,R,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             +HD['HSbbbb'][u,R,V,W] * HD['Dbb'][Dq,Ds] ))
        if R==W:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][q,V,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] )
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['HSbb'][s,V] * HD['Dbb'][Dq,Du] ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][q,V,u,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][s,u,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
            if q==u:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][s,V] ,
                                     +einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][q,W,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] )
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][s,:actfloor,W,:actfloor] ) ,
                                 +HD['HSbb'][s,W] * HD['Dbb'][Dq,Du] ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,W,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][q,W,u,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][s,u,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
            if q==u:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][s,W] ,
                                     -einsum( 'II->', HD['HSbbbb'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][V,W,R,actfloor:actceil], HD['Dbb'][Ds,:] )
    if R==W:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             +HD['HSbbbb'][P,V,u,T] * HD['Dbb'][Dq,Ds] ))
        if q==u:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbb'][Ds,:] )
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,W,actfloor:actceil,T], HD['Dbbbb'][Ds,Du,Dq,:] ) ,
                             -HD['HSbbbb'][P,W,u,T] * HD['Dbb'][Dq,Ds] ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,W,actfloor:actceil,T], HD['Dbb'][Ds,:] )
    return result


def lucc_VACAbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,v,w) = e
    Dq, Ds, Dv, Dw = q-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==U:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][T,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,R,q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] )
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][U,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Ds,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][U,R,q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] )
    return result


def lucc_VACAbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,w) = e
    Dq, Ds, Dw = q-actfloor, s-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbbbb'][P,q,T,U] * HD['Dbb'][Ds,Dw] ))
        if P==U:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][T,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,T] ) ,
                                 -HD['HSbb'][q,T] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Ds,:,Dw,:] ) ))
        if P==T:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][U,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,U] ) ,
                                 +HD['HSbb'][q,U] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbbbb'][Ds,:,Dw,:] ) ))
    if P==U:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,R,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             -HD['HSbbbb'][q,V,R,T] * HD['Dbb'][Ds,Dw] ))
    if P==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][U,R,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Ds,:] ) ,
                             +HD['HSbbbb'][q,V,R,U] * HD['Dbb'][Ds,Dw] ))
    return result


def lucc_VACAbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,s),(T,U,V,W) = e
    Dq, Ds = q-actfloor, s-actfloor
    result = 0
    if R==W:
        result += 2 * -HD['HSbbbb'][P,V,T,U] * HD['Dbb'][Dq,Ds]
        if P==U:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,s,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][q,V,actfloor:actceil,T], HD['Dbb'][Ds,:] ) ))
        if P==T:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][q,V,actfloor:actceil,U], HD['Dbb'][Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][U,s,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    if R==V:
        result += 2 * +HD['HSbbbb'][P,W,T,U] * HD['Dbb'][Dq,Ds]
        if P==U:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,s,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][q,W,actfloor:actceil,T], HD['Dbb'][Ds,:] ) ))
        if P==T:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][q,W,actfloor:actceil,U], HD['Dbb'][Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][U,s,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ))
    if P==U:
        result += 2 * -HD['HSbbbb'][T,R,V,W] * HD['Dbb'][Dq,Ds]
    if P==T:
        result += 2 * +HD['HSbbbb'][U,R,V,W] * HD['Dbb'][Dq,Ds]
    return result


def lucc_VACCbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(t,u,v,w) = e
    Dq, Dt, Du, Dv, Dw = q-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +HD['HSbbbb'][P,w,R,S] * HD['Dbbbb'][Dq,Dv,Dt,Du] ,
                         -HD['HSbbbb'][P,v,R,S] * HD['Dbbbb'][Dq,Dw,Dt,Du] ,
                         +HD['HSbbbb'][P,t,R,S] * HD['Dbbbb'][Dq,Du,Dv,Dw] ,
                         -HD['HSbbbb'][P,u,R,S] * HD['Dbbbb'][Dq,Dt,Dv,Dw] ))
    if q==t:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Du,:] )
    if q==u:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Dt,:] )
    if q==w:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Dv,:] )
    if q==v:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbbbb'][Dt,Du,Dw,:] )
    return result


def lucc_VACCbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,T,R,S] * HD['Dbbbb'][Dq,Du,Dv,Dw]
    if S==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Dv,Dw,:,Dq,Du,:] ) ,
                             -HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbbbb'][Dq,Du,Dv,Dw] ,
                             -HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,Du,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbbbb'][Dq,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][P,q,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][w,R,actfloor:actceil,P], HD['Dbbbb'][Dq,Du,Dv,:] ) ,
                             +HD['HSbbbb'][P,q,R,w] * HD['Dbb'][Du,Dv] ,
                             -HD['HSbbbb'][P,q,R,v] * HD['Dbb'][Du,Dw] ))
        if q==w:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Dv,:,Du,:] ) ,
                                 +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 +HD['HSbb'][P,R] * HD['Dbb'][Du,Dv] ,
                                 +HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Dv,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,R,actfloor:actceil,P], HD['Dbb'][Du,:] ) ))
        if q==v:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Dw,:,Du,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 -HD['HSbb'][P,R] * HD['Dbb'][Du,Dw] ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Dw,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][w,R,actfloor:actceil,P], HD['Dbb'][Du,:] ) ))
    if R==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbbabba'][Dv,Dw,:,Dq,Du,:] ) ,
                             +HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                             +HD['HSbb'][P,S] * HD['Dbbbb'][Dq,Du,Dv,Dw] ,
                             +HD['Dbbbb'][Dq,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,q,S,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][v,S,actfloor:actceil,P], HD['Dbbbb'][Dq,Du,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][w,S,actfloor:actceil,P], HD['Dbbbb'][Dq,Du,Dv,:] ) ,
                             -HD['HSbbbb'][P,q,S,w] * HD['Dbb'][Du,Dv] ,
                             +HD['HSbbbb'][P,q,S,v] * HD['Dbb'][Du,Dw] ))
        if q==w:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbaba'][Dv,:,Du,:] ) ,
                                 -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                                 -HD['HSbb'][P,S] * HD['Dbb'][Du,Dv] ,
                                 -HD['Dbb'][Du,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbbbb'][Dv,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,S,actfloor:actceil,P], HD['Dbb'][Du,:] ) ))
        if q==v:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbaba'][Dw,:,Du,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                                 +HD['HSbb'][P,S] * HD['Dbb'][Du,Dw] ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbbbb'][Dw,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][w,S,actfloor:actceil,P], HD['Dbb'][Du,:] ) ))
    if q==w:
        result += 2 * -HD['HSbbbb'][P,T,R,S] * HD['Dbb'][Du,Dv]
    if q==v:
        result += 2 * +HD['HSbbbb'][P,T,R,S] * HD['Dbb'][Du,Dw]
    return result


def lucc_VACCbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    if S==U:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                             -HD['HSbbbb'][P,T,R,w] * HD['Dbb'][Dq,Dv] ,
                             +HD['HSbbbb'][P,T,R,v] * HD['Dbb'][Dq,Dw] ))
        if R==T:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dq,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 +HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                                 -HD['Dbb'][Dq,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Dq,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dw,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 -HD['HSbb'][P,w] * HD['Dbb'][Dq,Dv] ,
                                 +HD['HSbb'][P,v] * HD['Dbb'][Dq,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 -HD['Dbb'][Dq,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                                 +HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Dq,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dw,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][P,q,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][P,q,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][v,w,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][P,q,v,w] ))
            if q==v:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +HD['HSbb'][P,w] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if q==w:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -HD['HSbb'][P,v] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +HD['HSbbbb'][P,T,R,w] ))
        if q==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -HD['HSbbbb'][P,T,R,v] ))
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,U,S,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                             +HD['HSbbbb'][P,U,S,v] * HD['Dbb'][Dq,Dw] ,
                             -HD['HSbbbb'][P,U,S,w] * HD['Dbb'][Dq,Dv] ))
        if q==w:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,U,S,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -HD['HSbbbb'][P,U,S,v] ))
        if q==v:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,U,S,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +HD['HSbbbb'][P,U,S,w] ))
    if R==U:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,S,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                             -HD['HSbbbb'][P,T,S,v] * HD['Dbb'][Dq,Dw] ,
                             +HD['HSbbbb'][P,T,S,w] * HD['Dbb'][Dq,Dv] ))
        if S==T:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dq,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dq,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 -HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                                 +HD['Dbb'][Dq,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbaba'][Dv,:,Dq,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbaba'][Dw,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 +HD['HSbb'][P,w] * HD['Dbb'][Dq,Dv] ,
                                 -HD['HSbb'][P,v] * HD['Dbb'][Dq,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                                 +HD['Dbb'][Dq,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                                 -HD['Dbb'][Dq,Dv] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbbbb'][Dv,:,Dq,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbbbb'][Dw,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][P,q,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][P,q,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][v,w,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][P,q,v,w] ))
            if q==v:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,w,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -HD['HSbb'][P,w] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,w] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,w,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if q==w:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dv,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,v,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     +HD['HSbb'][P,v] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,v] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,v,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==v:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,T,S,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -HD['HSbbbb'][P,T,S,w] ))
        if q==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,T,S,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSbbbb'][P,T,S,v] ))
    if S==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,U,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dq,:] ) ,
                             +HD['HSbbbb'][P,U,R,w] * HD['Dbb'][Dq,Dv] ,
                             -HD['HSbbbb'][P,U,R,v] * HD['Dbb'][Dq,Dw] ))
        if q==v:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,U,R,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -HD['HSbbbb'][P,U,R,w] ))
        if q==w:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,U,R,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +HD['HSbbbb'][P,U,R,v] ))
    return result


def lucc_VACCbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,v,w) = e
    Dq, Du, Dv, Dw = q-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,T,R,S] * HD['Dbbbb'][Dq,Du,Dv,Dw]
    if P==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dv,Dw,Du,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,q,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] )
        if q==u:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    return result


def lucc_VACCbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,w) = e
    Dq, Du, Dw = q-actfloor, u-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][R,S,V,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                             +HD['HSbbbb'][q,V,R,S] * HD['Dbb'][Du,Dw] ))
        if S==V:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Du,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][u,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dw,:,Du,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 -HD['HSbb'][q,R] * HD['Dbb'][Du,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][u,R,q,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
            if q==u:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if R==V:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dq,Dw,:,Du,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][u,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dq,Dw,:,Du,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,S,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][S,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 +HD['HSbb'][q,S] * HD['Dbb'][Du,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,S,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][u,S,q,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
            if q==u:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][S,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    if S==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                             +HD['HSbbbb'][P,q,R,T] * HD['Dbb'][Du,Dw] ))
        if q==u:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbb'][Dw,:] )
    if R==V:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,S,actfloor:actceil,P], HD['Dbbbb'][Dq,Dw,Du,:] ) ,
                             -HD['HSbbbb'][P,q,S,T] * HD['Dbb'][Du,Dw] ))
        if q==u:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,S,actfloor:actceil,P], HD['Dbb'][Dw,:] )
    return result


def lucc_VACCbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,u,V,W) = e
    Dq, Du = q-actfloor, u-actfloor
    result = 0
    if P==T:
        result += 2 * -HD['HSbbbb'][R,S,V,W] * HD['Dbb'][Dq,Du]
        if S==V:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][R,:actfloor,W,:actfloor] ) ,
                                 -HD['HSbb'][R,W] * HD['Dbb'][Dq,Du] ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,W,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][u,R,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][q,W,R,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 -HD['HSbbbb'][q,W,R,u] ))
            if R==W:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -HD['HSbb'][q,u] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if q==u:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][R,:actfloor,W,:actfloor] ) ,
                                     +HD['HSbb'][R,W] ,
                                     +einsum( 'II->', HD['HSbbbb'][R,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==W:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,S,V,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][S,:actfloor,V,:actfloor] ) ,
                                 -HD['HSbb'][S,V] * HD['Dbb'][Dq,Du] ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][S,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,S,V,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][q,V,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][u,S,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][q,V,S,u] ))
            if q==u:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,S,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][S,:actfloor,V,:actfloor] ) ,
                                     +HD['HSbb'][S,V] ,
                                     +einsum( 'II->', HD['HSbbbb'][S,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,S,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if S==W:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                 +HD['HSbb'][R,V] * HD['Dbb'][Dq,Du] ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][u,R,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][q,V,R,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 +HD['HSbbbb'][q,V,R,u] ))
            if R==V:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][q,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +HD['HSbb'][q,u] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ))
            if q==u:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                     -HD['HSbb'][R,V] ,
                                     -einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbaba'][Dq,:,Du,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaba'][S,:actfloor,W,:actfloor] ) ,
                                 +HD['HSbb'][S,W] * HD['Dbb'][Dq,Du] ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][S,:actfloor,W,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbbbb'][Dq,:,Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][q,W,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][u,S,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][q,W,S,u] ))
            if q==u:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,S,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][S,:actfloor,W,:actfloor] ) ,
                                     -HD['HSbb'][S,W] ,
                                     -einsum( 'II->', HD['HSbbbb'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * +HD['HSbbbb'][R,S,V,W]
    if R==W:
        result += 2 * +HD['HSbbbb'][P,V,S,T] * HD['Dbb'][Dq,Du]
        if S==V:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Du,:,Dq,:] ) ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                 +HD['HSbb'][P,T] * HD['Dbb'][Dq,Du] ,
                                 -HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Du,:,Dq,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][P,q,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][T,u,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][P,q,u,T] ))
            if q==u:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][P,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * -HD['HSbbbb'][P,V,S,T]
    if S==V:
        result += 2 * +HD['HSbbbb'][P,W,R,T] * HD['Dbb'][Dq,Du]
        if q==u:
            result += 2 * -HD['HSbbbb'][P,W,R,T]
    if S==W:
        result += 2 * -HD['HSbbbb'][P,V,R,T] * HD['Dbb'][Dq,Du]
        if R==V:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Du,:,Dq,:] ) ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                 -HD['HSbb'][P,T] * HD['Dbb'][Dq,Du] ,
                                 +HD['Dbb'][Dq,Du] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Du,:,Dq,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][P,q,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][T,u,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][P,q,u,T] ))
            if q==u:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][P,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if q==u:
            result += 2 * +HD['HSbbbb'][P,V,R,T]
    if R==V:
        result += 2 * -HD['HSbbbb'][P,W,S,T] * HD['Dbb'][Dq,Du]
        if q==u:
            result += 2 * +HD['HSbbbb'][P,W,S,T]
    return result


def lucc_VACCbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,v,w) = e
    Dq, Dv, Dw = q-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VACCbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,w) = e
    Dq, Dw = q-actfloor, w-actfloor
    result = 0
    if S==V:
        if P==U:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][T,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,R,q,actfloor:actceil], HD['Dbb'][Dw,:] )
        if P==T:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][U,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][U,R,q,actfloor:actceil], HD['Dbb'][Dw,:] )
    if P==U:
        if R==V:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][T,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,S,q,actfloor:actceil], HD['Dbb'][Dw,:] )
    if R==V:
        if P==T:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][U,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dq,Dw,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][U,S,q,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_VACCbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,q,R,S),(T,U,V,W) = e
    Dq = q-actfloor
    result = 0
    if P==U:
        if S==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,R,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][q,W,R,T] ))
            if R==W:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][q,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if R==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,S,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][q,V,S,T] ))
        if S==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,R,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][q,V,R,T] ))
            if R==V:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][q,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,S,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][q,W,S,T] ))
    if P==T:
        if S==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][U,R,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][q,W,R,U] ))
            if R==W:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][q,U] ,
                                     +einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if R==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][U,S,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][q,V,S,U] ))
        if S==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][U,R,V,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][q,V,R,U] ))
            if R==V:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][q,U] ,
                                     -einsum( 'II->', HD['HSbbbb'][q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][U,S,W,actfloor:actceil], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][q,W,S,U] ))
    if S==V:
        if R==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                                 -HD['HSbbbb'][P,q,T,U] ))
    if S==W:
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][T,U,actfloor:actceil,P], HD['Dbb'][Dq,:] ) ,
                                 +HD['HSbbbb'][P,q,T,U] ))
    return result


def lucc_VVAAbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(t,u,v,w) = e
    Dr, Ds, Dt, Du, Dv, Dw = r-actfloor, s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,t,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,Q,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dt,Dv,Dw,:] ) ,
                         +einsum( 'i,i->', HD['HSbbbb'][P,Q,w,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dv,Dt,Du,:] ) ,
                         -einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Dw,Dt,Du,:] ) ,
                         -HD['HSbbbb'][P,Q,t,u] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                         +HD['HSbbbb'][P,Q,v,w] * HD['Dbbbb'][Dr,Ds,Dt,Du] ))
    if s==v:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dw,:,:] )
        if r==w:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] )
    if r==w:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dv,:,:] )
    if s==w:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dt,Du,Dv,:,:] )
        if r==v:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dt,Du,:,:] )
    if r==v:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dt,Du,Dw,:,:] )
    if s==u:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Dt,:,:] )
        if r==t:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    if r==t:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Du,:,:] )
    if r==u:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Dt,:,:] )
        if s==t:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    if s==t:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Dv,Dw,Du,:,:] )
    return result


def lucc_VVAAbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] )
    if s==v:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dw,:] )
        if r==w:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbb'][Du,:] )
    if r==w:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dv,:] )
    if s==w:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Dr,Du,Dv,:] )
        if r==v:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbb'][Du,:] )
    if r==v:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,T,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] )
    return result


def lucc_VVAAbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * +HD['HSbbbb'][P,Q,T,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw]
    if s==v:
        result += 2 * -HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Dr,Dw]
        if r==w:
            result += 2 * +HD['HSbbbb'][P,Q,T,U]
    if r==w:
        result += 2 * -HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Ds,Dv]
    if s==w:
        result += 2 * +HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Dr,Dv]
        if r==v:
            result += 2 * -HD['HSbbbb'][P,Q,T,U]
    if r==v:
        result += 2 * +HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Ds,Dw]
    return result


def lucc_VVAAbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,v,w) = e
    Dr, Ds, Du, Dv, Dw = r-actfloor, s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                         +HD['HSbbbb'][P,Q,u,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ))
    if Q==T:
        result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                             +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['HSbb'][P,u] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    if P==T:
        result += -einsum( 'ijk,ijk->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbbbb'][Dr,Ds,Du,:,Dv,Dw,:,:] )
        result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbabbab'][Dr,Ds,Du,:,Dv,Dw,:,:] ) ,
                             -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             -HD['HSbb'][Q,u] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,u] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    return result


def lucc_VVAAbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,w) = e
    Dr, Ds, Du, Dw = r-actfloor, s-actfloor, u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,V,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dw,:,:] )
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,V,u,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] )
    if P==T:
        result += -einsum( 'ij,ij->', HD['HSbbbb'][Q,V,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dr,Ds,Du,Dw,:,:] )
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][Q,V,u,actfloor:actceil], HD['Dbbbb'][Dr,Ds,Dw,:] )
    return result


def lucc_VVAAbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,u,V,W) = e
    Dr, Ds, Du = r-actfloor, s-actfloor, u-actfloor
    result = 0
    return result


def lucc_VVAAbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,v,w) = e
    Dr, Ds, Dv, Dw = r-actfloor, s-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,Q,T,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw]
    if Q==U:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                             -HD['HSbb'][P,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
        if P==T:
            result += fsum(( -einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Ds,:,:] ) ,
                             +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dr,:,:] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dr,:,:] ) ,
                                 -einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Ds,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if Q==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,U] ) ,
                             +HD['HSbb'][P,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,U] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
        if P==U:
            result += fsum(( +einsum( 'ijk,ijk->', HD['HSbbbb'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Ds,:,:] ) ,
                             -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Dr,:,:] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][r,s,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] ) ))
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Dr,:,:] ) ,
                                 +einsum( 'ijk,ijk->', HD['HSbaab'][r,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][r,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dr,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][r,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if P==U:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,T] ) ,
                             +HD['HSbb'][Q,T] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             -HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,T] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbbabba'][Dr,Ds,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,U] ) ,
                             -HD['HSbb'][Q,U] * HD['Dbbbb'][Dr,Ds,Dv,Dw] ,
                             +HD['Dbbbb'][Dr,Ds,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,U] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbbbbbb'][Dr,Ds,:,Dv,Dw,:] ) ))
    return result


def lucc_VVAAbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,w) = e
    Dr, Ds, Dw = r-actfloor, s-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][Q,V,actfloor:actceil,U], HD['Dbbbb'][Dr,Ds,Dw,:] )
        if Q==U:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dw,:,Dr,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dw,:,Ds,:] ) ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                                 +HD['HSbb'][s,V] * HD['Dbb'][Dr,Dw] ,
                                 -HD['HSbb'][r,V] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Ds,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][r,s,V,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dw,:] )
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,U], HD['Dbbbb'][Dr,Ds,Dw,:] )
        if P==U:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dw,:,Dr,:] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbaba'][Dw,:,Ds,:] ) ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][r,:actfloor,V,:actfloor] ) ,
                                 -HD['HSbb'][s,V] * HD['Dbb'][Dr,Dw] ,
                                 +HD['HSbb'][r,V] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Dr,Dw] * einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][r,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][r,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Ds,:] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][r,s,V,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
    if P==U:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][Q,V,actfloor:actceil,T], HD['Dbbbb'][Dr,Ds,Dw,:] )
    return result


def lucc_VVAAbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,r,s),(T,U,V,W) = e
    Dr, Ds = r-actfloor, s-actfloor
    result = 0
    if P==T:
        if Q==U:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][V,W,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][V,W,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 -HD['HSbbbb'][r,s,V,W] ))
    if Q==T:
        if P==U:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][V,W,s,actfloor:actceil], HD['Dbb'][Dr,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][V,W,r,actfloor:actceil], HD['Dbb'][Ds,:] ) ,
                                 +HD['HSbbbb'][r,s,V,W] ))
    return result


def lucc_VVCAbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(t,u,v,w) = e
    Ds, Dt, Du, Dv, Dw = s-actfloor, t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * fsum(( -HD['HSbbbb'][P,Q,R,t] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                         +HD['HSbbbb'][P,Q,R,u] * HD['Dbbbb'][Ds,Dt,Dv,Dw] ,
                         -HD['HSbbbb'][P,Q,R,w] * HD['Dbbbb'][Ds,Dv,Dt,Du] ,
                         +HD['HSbbbb'][P,Q,R,v] * HD['Dbbbb'][Ds,Dw,Dt,Du] ))
    if s==w:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dv,:] )
    if s==v:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbbbb'][Dt,Du,Dw,:] )
    if s==t:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] )
    if s==u:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Dt,:] )
    return result


def lucc_VVCAbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,Q,R,T] * HD['Dbbbb'][Ds,Du,Dv,Dw]
    if R==T:
        result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Dv,Dw,Du,:,:] )
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,w,actfloor:actceil], HD['Dbbbb'][Ds,Dv,Du,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbbbb'][Ds,Dw,Du,:] ) ,
                             -HD['HSbbbb'][P,Q,v,w] * HD['Dbb'][Ds,Du] ))
    if s==w:
        result += 2 * +HD['HSbbbb'][P,Q,R,T] * HD['Dbb'][Du,Dv]
    if s==v:
        result += 2 * -HD['HSbbbb'][P,Q,R,T] * HD['Dbb'][Du,Dw]
    return result


def lucc_VVCAbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCAbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,v,w) = e
    Ds, Du, Dv, Dw = s-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    result += 2 * -HD['HSbbbb'][P,Q,R,T] * HD['Dbbbb'][Ds,Du,Dv,Dw]
    if Q==T:
        result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dv,Dw,:] ) ,
                             -HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                             -HD['HSbb'][P,R] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                             -HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                             -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,Dw,:] ) ,
                             -einsum( 'i,i->', HD['HSbbbb'][u,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if P==T:
        result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbbabba'][Ds,Du,:,Dv,Dw,:] ) ,
                             +HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,R,:actfloor] ) ,
                             +HD['HSbb'][Q,R] * HD['Dbbbb'][Ds,Du,Dv,Dw] ,
                             +HD['Dbbbb'][Ds,Du,Dv,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,R,:actfloor] ) ,
                             +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dv,Dw,:] ) ,
                             +einsum( 'i,i->', HD['HSbbbb'][u,R,actfloor:actceil,Q], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    return result


def lucc_VVCAbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,w) = e
    Ds, Du, Dw = s-actfloor, u-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             -HD['HSbbbb'][P,Q,u,T] * HD['Dbb'][Ds,Dw] ))
        if Q==T:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dw,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                                 +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -HD['HSbb'][P,u] * HD['Dbb'][Ds,Dw] ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ))
        if P==T:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Ds,Du,:,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Ds,Du,:,Dw,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,u] ) ,
                                 -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 +HD['HSbb'][Q,u] * HD['Dbb'][Ds,Dw] ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,u] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbbbb'][Ds,:,Dw,:] ) ))
    if Q==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,R,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             -HD['HSbbbb'][P,V,R,u] * HD['Dbb'][Ds,Dw] ))
    if P==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][Q,V,R,actfloor:actceil], HD['Dbbbb'][Ds,Du,Dw,:] ) ,
                             +HD['HSbbbb'][Q,V,R,u] * HD['Dbb'][Ds,Dw] ))
    return result


def lucc_VVCAbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,u,V,W) = e
    Ds, Du = s-actfloor, u-actfloor
    result = 0
    if Q==T:
        if R==W:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][P,V,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,V,u,actfloor:actceil], HD['Dbb'][Ds,:] )
        if R==V:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][P,W,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,W,u,actfloor:actceil], HD['Dbb'][Ds,:] )
    if R==W:
        if P==T:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][Q,V,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] )
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][Q,V,u,actfloor:actceil], HD['Dbb'][Ds,:] )
    if R==V:
        if P==T:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][Q,W,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Ds,Du,:,:] )
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][Q,W,u,actfloor:actceil], HD['Dbb'][Ds,:] )
    return result


def lucc_VVCAbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,v,w) = e
    Ds, Dv, Dw = s-actfloor, v-actfloor, w-actfloor
    result = 0
    if P==T:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][U,R,actfloor:actceil,Q], HD['Dbbbb'][Dv,Dw,Ds,:] )
        if Q==U:
            result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Ds,:,:] )
            result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Ds,:,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if Q==U:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Ds,:] )
    if Q==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][U,R,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Ds,:] )
        if P==U:
            result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbbbb'][Dv,Dw,:,Ds,:,:] )
            result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbabab'][Dv,Dw,:,Ds,:,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ,
                                 -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Ds,:] ) ))
    if P==U:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,Q], HD['Dbbbb'][Dv,Dw,Ds,:] )
    return result


def lucc_VVCAbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,w) = e
    Ds, Dw = s-actfloor, w-actfloor
    result = 0
    if R==V:
        result += 2 * +HD['HSbbbb'][P,Q,T,U] * HD['Dbb'][Ds,Dw]
        if Q==U:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                 +HD['HSbb'][P,T] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Ds,:,Dw,:] ) ))
            if P==T:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if Q==T:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,U] ) ,
                                 -HD['HSbb'][P,U] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,U] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbbbb'][Ds,:,Dw,:] ) ))
            if P==U:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][s,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][s,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][s,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if P==U:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,T] ) ,
                                 -HD['HSbb'][Q,T] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,T] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbbbb'][Ds,:,Dw,:] ) ))
        if P==T:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbaba'][Ds,:,Dw,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,U] ) ,
                                 +HD['HSbb'][Q,U] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,U] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbbbb'][Ds,:,Dw,:] ) ))
    if Q==U:
        result += 2 * +HD['HSbbbb'][P,V,R,T] * HD['Dbb'][Ds,Dw]
        if P==T:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbaba'][Dw,:,Ds,:] ) ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                 -HD['HSbb'][R,V] * HD['Dbb'][Ds,Dw] ,
                                 -HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Ds,:] ) ))
    if Q==T:
        result += 2 * -HD['HSbbbb'][P,V,R,U] * HD['Dbb'][Ds,Dw]
        if P==U:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbaba'][Dw,:,Ds,:] ) ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                 +HD['HSbb'][R,V] * HD['Dbb'][Ds,Dw] ,
                                 +HD['Dbb'][Ds,Dw] * einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbbbb'][Dw,:,Ds,:] ) ))
    if P==U:
        result += 2 * -HD['HSbbbb'][Q,V,R,T] * HD['Dbb'][Ds,Dw]
    if P==T:
        result += 2 * +HD['HSbbbb'][Q,V,R,U] * HD['Dbb'][Ds,Dw]
    return result


def lucc_VVCAbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,s),(T,U,V,W) = e
    Ds = s-actfloor
    result = 0
    if R==W:
        if P==T:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][Q,V,actfloor:actceil,U], HD['Dbb'][Ds,:] )
            if Q==U:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][s,V] ,
                                     +einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if Q==U:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,T], HD['Dbb'][Ds,:] )
        if Q==T:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,V,actfloor:actceil,U], HD['Dbb'][Ds,:] )
            if P==U:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][s,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][s,V] ,
                                     -einsum( 'II->', HD['HSbbbb'][s,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][Q,V,actfloor:actceil,T], HD['Dbb'][Ds,:] )
    if R==V:
        if P==T:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][Q,W,actfloor:actceil,U], HD['Dbb'][Ds,:] )
            if Q==U:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaba'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][s,W] ,
                                     -einsum( 'II->', HD['HSbbbb'][s,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][P,W,actfloor:actceil,T], HD['Dbb'][Ds,:] )
        if Q==T:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][P,W,actfloor:actceil,U], HD['Dbb'][Ds,:] )
            if P==U:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaba'][s,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][s,actfloor:actceil,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][s,W] ,
                                     +einsum( 'II->', HD['HSbbbb'][s,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][s,actfloor:actceil,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][Q,W,actfloor:actceil,T], HD['Dbb'][Ds,:] )
    if P==T:
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][V,W,R,actfloor:actceil], HD['Dbb'][Ds,:] )
    if Q==T:
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][V,W,R,actfloor:actceil], HD['Dbb'][Ds,:] )
    return result


def lucc_VVCCbbbb_AAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(t,u,v,w) = e
    Dt, Du, Dv, Dw = t-actfloor, u-actfloor, v-actfloor, w-actfloor
    result = 0
    return result


def lucc_VVCCbbbb_CAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if S==T:
        result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,R,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             +HD['HSbbbb'][P,Q,R,w] * HD['Dbb'][Du,Dv] ,
                             -HD['HSbbbb'][P,Q,R,v] * HD['Dbb'][Du,Dw] ))
    if R==T:
        result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,S,actfloor:actceil], HD['Dbbbb'][Dv,Dw,Du,:] ) ,
                             -HD['HSbbbb'][P,Q,S,w] * HD['Dbb'][Du,Dv] ,
                             +HD['HSbbbb'][P,Q,S,v] * HD['Dbb'][Du,Dw] ))
    return result


def lucc_VVCCbbbb_CCAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if S==U:
        if R==T:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 -HD['HSbbbb'][P,Q,v,w] ))
    if R==U:
        if S==T:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][P,Q,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,w,actfloor:actceil], HD['Dbb'][Dv,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][P,Q,v,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                 +HD['HSbbbb'][P,Q,v,w] ))
    return result


def lucc_VVCCbbbb_VAAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,v,w) = e
    Du, Dv, Dw = u-actfloor, v-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,P], HD['Dbbbb'][Dv,Dw,Du,:] )
    if P==T:
        result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,actfloor:actceil,Q], HD['Dbbbb'][Dv,Dw,Du,:] )
    return result


def lucc_VVCCbbbb_VACAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,w) = e
    Du, Dw = u-actfloor, w-actfloor
    result = 0
    if Q==T:
        result += 2 * -HD['HSbbbb'][P,V,R,S] * HD['Dbb'][Du,Dw]
        if S==V:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,R,:actfloor] ) ,
                                 +HD['HSbb'][P,R] * HD['Dbb'][Du,Dw] ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,R,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][u,R,actfloor:actceil,P], HD['Dbb'][Dw,:] ) ))
        if R==V:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][P,:actfloor,S,:actfloor] ) ,
                                 -HD['HSbb'][P,S] * HD['Dbb'][Du,Dw] ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][P,:actfloor,S,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,S,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][u,S,actfloor:actceil,P], HD['Dbb'][Dw,:] ) ))
    if S==V:
        result += 2 * +HD['HSbbbb'][P,Q,R,T] * HD['Dbb'][Du,Dw]
        if P==T:
            result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,R,:actfloor] ) ,
                                 -HD['HSbb'][Q,R] * HD['Dbb'][Du,Dw] ,
                                 -HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,R,:actfloor] ) ,
                                 +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,R,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 -einsum( 'i,i->', HD['HSbbbb'][u,R,actfloor:actceil,Q], HD['Dbb'][Dw,:] ) ))
    if R==V:
        result += 2 * -HD['HSbbbb'][P,Q,S,T] * HD['Dbb'][Du,Dw]
        if P==T:
            result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dbaba'][Du,:,Dw,:] ) ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbaba'][Q,:actfloor,S,:actfloor] ) ,
                                 +HD['HSbb'][Q,S] * HD['Dbb'][Du,Dw] ,
                                 +HD['Dbb'][Du,Dw] * einsum( 'II->', HD['HSbbbb'][Q,:actfloor,S,:actfloor] ) ,
                                 -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,S,actfloor:actceil], HD['Dbbbb'][Du,:,Dw,:] ) ,
                                 +einsum( 'i,i->', HD['HSbbbb'][u,S,actfloor:actceil,Q], HD['Dbb'][Dw,:] ) ))
    if P==T:
        result += 2 * +HD['HSbbbb'][Q,V,R,S] * HD['Dbb'][Du,Dw]
    return result


def lucc_VVCCbbbb_VACCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,u,V,W) = e
    Du = u-actfloor
    result = 0
    if Q==T:
        if S==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,W,R,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 +HD['HSbbbb'][P,W,R,u] ))
            if R==W:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +HD['HSbb'][P,u] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,V,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 +HD['HSbbbb'][P,V,S,u] ))
        if S==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,V,R,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 -HD['HSbbbb'][P,V,R,u] ))
            if R==V:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][P,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][P,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -HD['HSbb'][P,u] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][P,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,W,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 -HD['HSbbbb'][P,W,S,u] ))
    if P==T:
        if S==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][Q,W,R,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 -HD['HSbbbb'][Q,W,R,u] ))
            if R==W:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -HD['HSbb'][Q,u] ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,u] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==W:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][Q,V,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 -HD['HSbbbb'][Q,V,S,u] ))
        if S==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][Q,V,R,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 +HD['HSbbbb'][Q,V,R,u] ))
            if R==V:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Du,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Du,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaba'][Q,actfloor:actceil,u,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][Q,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     +HD['HSbb'][Q,u] ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][Q,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                     -einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,u] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,u,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][Q,W,S,actfloor:actceil], HD['Dbb'][Du,:] ) ,
                                 +HD['HSbbbb'][Q,W,S,u] ))
    if S==V:
        if R==W:
            result += 2 * fsum(( -einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                                 +HD['HSbbbb'][P,Q,u,T] ))
    if S==W:
        if R==V:
            result += 2 * fsum(( +einsum( 'i,i->', HD['HSbbbb'][P,Q,actfloor:actceil,T], HD['Dbb'][Du,:] ) ,
                                 -HD['HSbbbb'][P,Q,u,T] ))
    return result


def lucc_VVCCbbbb_VVAAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,v,w) = e
    Dv, Dw = v-actfloor, w-actfloor
    result = 0
    if P==T:
        if Q==U:
            result += -einsum( 'ij,ij->', HD['HSbbbb'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    if Q==T:
        if P==U:
            result += +einsum( 'ij,ij->', HD['HSbbbb'][R,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dv,Dw,:,:] )
    return result


def lucc_VVCCbbbb_VVCAbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,w) = e
    Dw = w-actfloor
    result = 0
    if R==V:
        if P==T:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][U,S,actfloor:actceil,Q], HD['Dbb'][Dw,:] )
            if Q==U:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][S,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,S,actfloor:actceil,P], HD['Dbb'][Dw,:] )
        if Q==T:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][U,S,actfloor:actceil,P], HD['Dbb'][Dw,:] )
            if P==U:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,S,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][S,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][S,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,S,actfloor:actceil,Q], HD['Dbb'][Dw,:] )
    if S==V:
        if Q==U:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,P], HD['Dbb'][Dw,:] )
            if P==T:
                result += +einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( +einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if P==T:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][U,R,actfloor:actceil,Q], HD['Dbb'][Dw,:] )
        if Q==T:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][U,R,actfloor:actceil,P], HD['Dbb'][Dw,:] )
            if P==U:
                result += -einsum( 'ijk,ijk->', HD['HSbbbb'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbbbb'][Dw,:,:,:] )
                result += 2 * fsum(( -einsum( 'ijk,ijk->', HD['HSabab'][actfloor:actceil,R,actfloor:actceil,actfloor:actceil], HD['Dbaab'][Dw,:,:,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbaab'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     -einsum( 'i,i->', HD['HSbb'][R,actfloor:actceil], HD['Dbb'][Dw,:] ) ,
                                     +einsum( 'IIj,j->', HD['HSbbbb'][R,:actfloor,:actfloor,actfloor:actceil], HD['Dbb'][Dw,:] ) ))
        if P==U:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][T,R,actfloor:actceil,Q], HD['Dbb'][Dw,:] )
    if P==T:
        if Q==U:
            result += 2 * +einsum( 'i,i->', HD['HSbbbb'][R,S,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    if Q==T:
        if P==U:
            result += 2 * -einsum( 'i,i->', HD['HSbbbb'][R,S,V,actfloor:actceil], HD['Dbb'][Dw,:] )
    return result


def lucc_VVCCbbbb_VVCCbbbb(actfloor, actceil, HD, *e):
    (P,Q,R,S),(T,U,V,W) = e
    result = 0
    if R==W:
        if S==V:
            result += 2 * -HD['HSbbbb'][P,Q,T,U]
            if Q==U:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][P,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if Q==T:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][P,U] ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
            if P==U:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][Q,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if P==T:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][Q,U] ,
                                     +einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if Q==U:
            result += 2 * -HD['HSbbbb'][P,V,S,T]
            if P==T:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,S,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][S,:actfloor,V,:actfloor] ) ,
                                     +HD['HSbb'][S,V] ,
                                     +einsum( 'II->', HD['HSbbbb'][S,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,S,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if Q==T:
            result += 2 * +HD['HSbbbb'][P,V,S,U]
            if P==U:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,S,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][S,:actfloor,V,:actfloor] ) ,
                                     -HD['HSbb'][S,V] ,
                                     -einsum( 'II->', HD['HSbbbb'][S,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,S,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * +HD['HSbbbb'][Q,V,S,T]
        if P==T:
            result += 2 * -HD['HSbbbb'][Q,V,S,U]
    if S==V:
        if Q==T:
            result += 2 * +HD['HSbbbb'][P,W,R,U]
            if P==U:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][R,:actfloor,W,:actfloor] ) ,
                                     -HD['HSbb'][R,W] ,
                                     -einsum( 'II->', HD['HSbbbb'][R,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * +HD['HSbbbb'][Q,W,R,T]
        if Q==U:
            result += 2 * -HD['HSbbbb'][P,W,R,T]
            if P==T:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][R,:actfloor,W,:actfloor] ) ,
                                     +HD['HSbb'][R,W] ,
                                     +einsum( 'II->', HD['HSbbbb'][R,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==T:
            result += 2 * -HD['HSbbbb'][Q,W,R,U]
    if Q==U:
        if S==W:
            result += 2 * +HD['HSbbbb'][P,V,R,T]
            if R==V:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][P,T] ,
                                     -einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,T] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if P==T:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                     -HD['HSbb'][R,V] ,
                                     -einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if R==V:
            result += 2 * +HD['HSbbbb'][P,W,S,T]
            if P==T:
                result += 2 * fsum(( +einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,S,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     -einsum( 'II->', HD['HSbaba'][S,:actfloor,W,:actfloor] ) ,
                                     -HD['HSbb'][S,W] ,
                                     -einsum( 'II->', HD['HSbbbb'][S,:actfloor,W,:actfloor] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==T:
            result += 2 * +HD['HSbbbb'][R,S,V,W]
    if S==W:
        if R==V:
            result += 2 * +HD['HSbbbb'][P,Q,T,U]
            if Q==T:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][P,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][P,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][P,U] ,
                                     +einsum( 'II->', HD['HSbbbb'][P,:actfloor,:actfloor,U] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][P,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
            if P==U:
                result += 2 * fsum(( +einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,T], HD['Daa'][:,:] ) ,
                                     -HD['HSbb'][Q,T] ,
                                     +einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,T] ) ,
                                     +einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,T], HD['Dbb'][:,:] ) ))
            if P==T:
                result += 2 * fsum(( -einsum( 'II->', HD['HSbaab'][Q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSbaab'][Q,actfloor:actceil,actfloor:actceil,U], HD['Daa'][:,:] ) ,
                                     +HD['HSbb'][Q,U] ,
                                     -einsum( 'II->', HD['HSbbbb'][Q,:actfloor,:actfloor,U] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][Q,actfloor:actceil,actfloor:actceil,U], HD['Dbb'][:,:] ) ))
        if Q==T:
            result += 2 * -HD['HSbbbb'][P,V,R,U]
            if P==U:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,R,V,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][R,:actfloor,V,:actfloor] ) ,
                                     +HD['HSbb'][R,V] ,
                                     +einsum( 'II->', HD['HSbbbb'][R,:actfloor,V,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,R,V,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * -HD['HSbbbb'][Q,V,R,T]
        if P==T:
            result += 2 * +HD['HSbbbb'][Q,V,R,U]
    if R==V:
        if Q==T:
            result += 2 * -HD['HSbbbb'][P,W,S,U]
            if P==U:
                result += 2 * fsum(( -einsum( 'ij,ij->', HD['HSabba'][actfloor:actceil,S,W,actfloor:actceil], HD['Daa'][:,:] ) ,
                                     +einsum( 'II->', HD['HSbaba'][S,:actfloor,W,:actfloor] ) ,
                                     +HD['HSbb'][S,W] ,
                                     +einsum( 'II->', HD['HSbbbb'][S,:actfloor,W,:actfloor] ) ,
                                     -einsum( 'ij,ij->', HD['HSbbbb'][actfloor:actceil,S,W,actfloor:actceil], HD['Dbb'][:,:] ) ))
        if P==U:
            result += 2 * -HD['HSbbbb'][Q,W,S,T]
        if P==T:
            result += 2 * +HD['HSbbbb'][Q,W,S,U]
    if Q==T:
        if P==U:
            result += 2 * -HD['HSbbbb'][R,S,V,W]
    return result



FUNCMAPPER = {
'AAaa': lucc_AAaa , 'AAaa_AAaa': lucc_AAaa_AAaa , 'AAaa_AAbb': lucc_AAaa_AAbb , 'AAaa_AAAAaaaa': lucc_AAaa_AAAAaaaa ,
'AAaa_AAAAbaba': lucc_AAaa_AAAAbaba , 'AAaa_AAAAbbbb': lucc_AAaa_AAAAbbbb , 'AAbb': lucc_AAbb , 'AAbb_AAaa': lucc_AAbb_AAaa ,
'AAbb_AAbb': lucc_AAbb_AAbb , 'AAbb_AAAAaaaa': lucc_AAbb_AAAAaaaa , 'AAbb_AAAAbaba': lucc_AAbb_AAAAbaba , 'AAbb_AAAAbbbb': lucc_AAbb_AAAAbbbb ,
'AAAAaaaa': lucc_AAAAaaaa , 'AAAAaaaa_AAaa': lucc_AAAAaaaa_AAaa , 'AAAAaaaa_AAbb': lucc_AAAAaaaa_AAbb , 'AAAAaaaa_AAAAaaaa': lucc_AAAAaaaa_AAAAaaaa ,
'AAAAaaaa_AAAAbaba': lucc_AAAAaaaa_AAAAbaba , 'AAAAaaaa_AAAAbbbb': lucc_AAAAaaaa_AAAAbbbb , 'AAAAbaba': lucc_AAAAbaba , 'AAAAbaba_AAaa': lucc_AAAAbaba_AAaa ,
'AAAAbaba_AAbb': lucc_AAAAbaba_AAbb , 'AAAAbaba_AAAAaaaa': lucc_AAAAbaba_AAAAaaaa , 'AAAAbaba_AAAAbaba': lucc_AAAAbaba_AAAAbaba , 'AAAAbaba_AAAAbbbb': lucc_AAAAbaba_AAAAbbbb ,
'AAAAbbbb': lucc_AAAAbbbb , 'AAAAbbbb_AAaa': lucc_AAAAbbbb_AAaa , 'AAAAbbbb_AAbb': lucc_AAAAbbbb_AAbb , 'AAAAbbbb_AAAAaaaa': lucc_AAAAbbbb_AAAAaaaa ,
'AAAAbbbb_AAAAbaba': lucc_AAAAbbbb_AAAAbaba , 'AAAAbbbb_AAAAbbbb': lucc_AAAAbbbb_AAAAbbbb , 'AAaa_CAaa': lucc_AAaa_CAaa , 'AAaa_VAaa': lucc_AAaa_VAaa ,
'AAaa_VCaa': lucc_AAaa_VCaa , 'CAaa_AAaa': lucc_CAaa_AAaa , 'CAaa_CAaa': lucc_CAaa_CAaa , 'CAaa_VAaa': lucc_CAaa_VAaa ,
'CAaa_VCaa': lucc_CAaa_VCaa , 'VAaa_AAaa': lucc_VAaa_AAaa , 'VAaa_CAaa': lucc_VAaa_CAaa , 'VAaa_VAaa': lucc_VAaa_VAaa ,
'VAaa_VCaa': lucc_VAaa_VCaa , 'VCaa_AAaa': lucc_VCaa_AAaa , 'VCaa_CAaa': lucc_VCaa_CAaa , 'VCaa_VAaa': lucc_VCaa_VAaa ,
'VCaa_VCaa': lucc_VCaa_VCaa , 'AAaa_CAbb': lucc_AAaa_CAbb , 'AAaa_VAbb': lucc_AAaa_VAbb , 'AAaa_VCbb': lucc_AAaa_VCbb ,
'CAaa_AAbb': lucc_CAaa_AAbb , 'CAaa_CAbb': lucc_CAaa_CAbb , 'CAaa_VAbb': lucc_CAaa_VAbb , 'CAaa_VCbb': lucc_CAaa_VCbb ,
'VAaa_AAbb': lucc_VAaa_AAbb , 'VAaa_CAbb': lucc_VAaa_CAbb , 'VAaa_VAbb': lucc_VAaa_VAbb , 'VAaa_VCbb': lucc_VAaa_VCbb ,
'VCaa_AAbb': lucc_VCaa_AAbb , 'VCaa_CAbb': lucc_VCaa_CAbb , 'VCaa_VAbb': lucc_VCaa_VAbb , 'VCaa_VCbb': lucc_VCaa_VCbb ,
'AAaa_CAAAaaaa': lucc_AAaa_CAAAaaaa , 'AAaa_CCAAaaaa': lucc_AAaa_CCAAaaaa , 'AAaa_VAAAaaaa': lucc_AAaa_VAAAaaaa , 'AAaa_VACAaaaa': lucc_AAaa_VACAaaaa ,
'AAaa_VACCaaaa': lucc_AAaa_VACCaaaa , 'AAaa_VVAAaaaa': lucc_AAaa_VVAAaaaa , 'AAaa_VVCAaaaa': lucc_AAaa_VVCAaaaa , 'AAaa_VVCCaaaa': lucc_AAaa_VVCCaaaa ,
'CAaa_AAAAaaaa': lucc_CAaa_AAAAaaaa , 'CAaa_CAAAaaaa': lucc_CAaa_CAAAaaaa , 'CAaa_CCAAaaaa': lucc_CAaa_CCAAaaaa , 'CAaa_VAAAaaaa': lucc_CAaa_VAAAaaaa ,
'CAaa_VACAaaaa': lucc_CAaa_VACAaaaa , 'CAaa_VACCaaaa': lucc_CAaa_VACCaaaa , 'CAaa_VVAAaaaa': lucc_CAaa_VVAAaaaa , 'CAaa_VVCAaaaa': lucc_CAaa_VVCAaaaa ,
'CAaa_VVCCaaaa': lucc_CAaa_VVCCaaaa , 'VAaa_AAAAaaaa': lucc_VAaa_AAAAaaaa , 'VAaa_CAAAaaaa': lucc_VAaa_CAAAaaaa , 'VAaa_CCAAaaaa': lucc_VAaa_CCAAaaaa ,
'VAaa_VAAAaaaa': lucc_VAaa_VAAAaaaa , 'VAaa_VACAaaaa': lucc_VAaa_VACAaaaa , 'VAaa_VACCaaaa': lucc_VAaa_VACCaaaa , 'VAaa_VVAAaaaa': lucc_VAaa_VVAAaaaa ,
'VAaa_VVCAaaaa': lucc_VAaa_VVCAaaaa , 'VAaa_VVCCaaaa': lucc_VAaa_VVCCaaaa , 'VCaa_AAAAaaaa': lucc_VCaa_AAAAaaaa , 'VCaa_CAAAaaaa': lucc_VCaa_CAAAaaaa ,
'VCaa_CCAAaaaa': lucc_VCaa_CCAAaaaa , 'VCaa_VAAAaaaa': lucc_VCaa_VAAAaaaa , 'VCaa_VACAaaaa': lucc_VCaa_VACAaaaa , 'VCaa_VACCaaaa': lucc_VCaa_VACCaaaa ,
'VCaa_VVAAaaaa': lucc_VCaa_VVAAaaaa , 'VCaa_VVCAaaaa': lucc_VCaa_VVCAaaaa , 'VCaa_VVCCaaaa': lucc_VCaa_VVCCaaaa , 'AAaa_CAAAbaba': lucc_AAaa_CAAAbaba ,
'AAaa_CCAAbaba': lucc_AAaa_CCAAbaba , 'AAaa_VAAAbaba': lucc_AAaa_VAAAbaba , 'AAaa_VACAbaba': lucc_AAaa_VACAbaba , 'AAaa_VACCbaba': lucc_AAaa_VACCbaba ,
'AAaa_VVAAbaba': lucc_AAaa_VVAAbaba , 'AAaa_VVCAbaba': lucc_AAaa_VVCAbaba , 'AAaa_VVCCbaba': lucc_AAaa_VVCCbaba , 'CAaa_AAAAbaba': lucc_CAaa_AAAAbaba ,
'CAaa_CAAAbaba': lucc_CAaa_CAAAbaba , 'CAaa_CCAAbaba': lucc_CAaa_CCAAbaba , 'CAaa_VAAAbaba': lucc_CAaa_VAAAbaba , 'CAaa_VACAbaba': lucc_CAaa_VACAbaba ,
'CAaa_VACCbaba': lucc_CAaa_VACCbaba , 'CAaa_VVAAbaba': lucc_CAaa_VVAAbaba , 'CAaa_VVCAbaba': lucc_CAaa_VVCAbaba , 'CAaa_VVCCbaba': lucc_CAaa_VVCCbaba ,
'VAaa_AAAAbaba': lucc_VAaa_AAAAbaba , 'VAaa_CAAAbaba': lucc_VAaa_CAAAbaba , 'VAaa_CCAAbaba': lucc_VAaa_CCAAbaba , 'VAaa_VAAAbaba': lucc_VAaa_VAAAbaba ,
'VAaa_VACAbaba': lucc_VAaa_VACAbaba , 'VAaa_VACCbaba': lucc_VAaa_VACCbaba , 'VAaa_VVAAbaba': lucc_VAaa_VVAAbaba , 'VAaa_VVCAbaba': lucc_VAaa_VVCAbaba ,
'VAaa_VVCCbaba': lucc_VAaa_VVCCbaba , 'VCaa_AAAAbaba': lucc_VCaa_AAAAbaba , 'VCaa_CAAAbaba': lucc_VCaa_CAAAbaba , 'VCaa_CCAAbaba': lucc_VCaa_CCAAbaba ,
'VCaa_VAAAbaba': lucc_VCaa_VAAAbaba , 'VCaa_VACAbaba': lucc_VCaa_VACAbaba , 'VCaa_VACCbaba': lucc_VCaa_VACCbaba , 'VCaa_VVAAbaba': lucc_VCaa_VVAAbaba ,
'VCaa_VVCAbaba': lucc_VCaa_VVCAbaba , 'VCaa_VVCCbaba': lucc_VCaa_VVCCbaba , 'AAaa_CAAAbbbb': lucc_AAaa_CAAAbbbb , 'AAaa_CCAAbbbb': lucc_AAaa_CCAAbbbb ,
'AAaa_VAAAbbbb': lucc_AAaa_VAAAbbbb , 'AAaa_VACAbbbb': lucc_AAaa_VACAbbbb , 'AAaa_VACCbbbb': lucc_AAaa_VACCbbbb , 'AAaa_VVAAbbbb': lucc_AAaa_VVAAbbbb ,
'AAaa_VVCAbbbb': lucc_AAaa_VVCAbbbb , 'AAaa_VVCCbbbb': lucc_AAaa_VVCCbbbb , 'CAaa_AAAAbbbb': lucc_CAaa_AAAAbbbb , 'CAaa_CAAAbbbb': lucc_CAaa_CAAAbbbb ,
'CAaa_CCAAbbbb': lucc_CAaa_CCAAbbbb , 'CAaa_VAAAbbbb': lucc_CAaa_VAAAbbbb , 'CAaa_VACAbbbb': lucc_CAaa_VACAbbbb , 'CAaa_VACCbbbb': lucc_CAaa_VACCbbbb ,
'CAaa_VVAAbbbb': lucc_CAaa_VVAAbbbb , 'CAaa_VVCAbbbb': lucc_CAaa_VVCAbbbb , 'CAaa_VVCCbbbb': lucc_CAaa_VVCCbbbb , 'VAaa_AAAAbbbb': lucc_VAaa_AAAAbbbb ,
'VAaa_CAAAbbbb': lucc_VAaa_CAAAbbbb , 'VAaa_CCAAbbbb': lucc_VAaa_CCAAbbbb , 'VAaa_VAAAbbbb': lucc_VAaa_VAAAbbbb , 'VAaa_VACAbbbb': lucc_VAaa_VACAbbbb ,
'VAaa_VACCbbbb': lucc_VAaa_VACCbbbb , 'VAaa_VVAAbbbb': lucc_VAaa_VVAAbbbb , 'VAaa_VVCAbbbb': lucc_VAaa_VVCAbbbb , 'VAaa_VVCCbbbb': lucc_VAaa_VVCCbbbb ,
'VCaa_AAAAbbbb': lucc_VCaa_AAAAbbbb , 'VCaa_CAAAbbbb': lucc_VCaa_CAAAbbbb , 'VCaa_CCAAbbbb': lucc_VCaa_CCAAbbbb , 'VCaa_VAAAbbbb': lucc_VCaa_VAAAbbbb ,
'VCaa_VACAbbbb': lucc_VCaa_VACAbbbb , 'VCaa_VACCbbbb': lucc_VCaa_VACCbbbb , 'VCaa_VVAAbbbb': lucc_VCaa_VVAAbbbb , 'VCaa_VVCAbbbb': lucc_VCaa_VVCAbbbb ,
'VCaa_VVCCbbbb': lucc_VCaa_VVCCbbbb , 'AAbb_CAaa': lucc_AAbb_CAaa , 'AAbb_VAaa': lucc_AAbb_VAaa , 'AAbb_VCaa': lucc_AAbb_VCaa ,
'CAbb_AAaa': lucc_CAbb_AAaa , 'CAbb_CAaa': lucc_CAbb_CAaa , 'CAbb_VAaa': lucc_CAbb_VAaa , 'CAbb_VCaa': lucc_CAbb_VCaa ,
'VAbb_AAaa': lucc_VAbb_AAaa , 'VAbb_CAaa': lucc_VAbb_CAaa , 'VAbb_VAaa': lucc_VAbb_VAaa , 'VAbb_VCaa': lucc_VAbb_VCaa ,
'VCbb_AAaa': lucc_VCbb_AAaa , 'VCbb_CAaa': lucc_VCbb_CAaa , 'VCbb_VAaa': lucc_VCbb_VAaa , 'VCbb_VCaa': lucc_VCbb_VCaa ,
'AAbb_CAbb': lucc_AAbb_CAbb , 'AAbb_VAbb': lucc_AAbb_VAbb , 'AAbb_VCbb': lucc_AAbb_VCbb , 'CAbb_AAbb': lucc_CAbb_AAbb ,
'CAbb_CAbb': lucc_CAbb_CAbb , 'CAbb_VAbb': lucc_CAbb_VAbb , 'CAbb_VCbb': lucc_CAbb_VCbb , 'VAbb_AAbb': lucc_VAbb_AAbb ,
'VAbb_CAbb': lucc_VAbb_CAbb , 'VAbb_VAbb': lucc_VAbb_VAbb , 'VAbb_VCbb': lucc_VAbb_VCbb , 'VCbb_AAbb': lucc_VCbb_AAbb ,
'VCbb_CAbb': lucc_VCbb_CAbb , 'VCbb_VAbb': lucc_VCbb_VAbb , 'VCbb_VCbb': lucc_VCbb_VCbb , 'AAbb_CAAAaaaa': lucc_AAbb_CAAAaaaa ,
'AAbb_CCAAaaaa': lucc_AAbb_CCAAaaaa , 'AAbb_VAAAaaaa': lucc_AAbb_VAAAaaaa , 'AAbb_VACAaaaa': lucc_AAbb_VACAaaaa , 'AAbb_VACCaaaa': lucc_AAbb_VACCaaaa ,
'AAbb_VVAAaaaa': lucc_AAbb_VVAAaaaa , 'AAbb_VVCAaaaa': lucc_AAbb_VVCAaaaa , 'AAbb_VVCCaaaa': lucc_AAbb_VVCCaaaa , 'CAbb_AAAAaaaa': lucc_CAbb_AAAAaaaa ,
'CAbb_CAAAaaaa': lucc_CAbb_CAAAaaaa , 'CAbb_CCAAaaaa': lucc_CAbb_CCAAaaaa , 'CAbb_VAAAaaaa': lucc_CAbb_VAAAaaaa , 'CAbb_VACAaaaa': lucc_CAbb_VACAaaaa ,
'CAbb_VACCaaaa': lucc_CAbb_VACCaaaa , 'CAbb_VVAAaaaa': lucc_CAbb_VVAAaaaa , 'CAbb_VVCAaaaa': lucc_CAbb_VVCAaaaa , 'CAbb_VVCCaaaa': lucc_CAbb_VVCCaaaa ,
'VAbb_AAAAaaaa': lucc_VAbb_AAAAaaaa , 'VAbb_CAAAaaaa': lucc_VAbb_CAAAaaaa , 'VAbb_CCAAaaaa': lucc_VAbb_CCAAaaaa , 'VAbb_VAAAaaaa': lucc_VAbb_VAAAaaaa ,
'VAbb_VACAaaaa': lucc_VAbb_VACAaaaa , 'VAbb_VACCaaaa': lucc_VAbb_VACCaaaa , 'VAbb_VVAAaaaa': lucc_VAbb_VVAAaaaa , 'VAbb_VVCAaaaa': lucc_VAbb_VVCAaaaa ,
'VAbb_VVCCaaaa': lucc_VAbb_VVCCaaaa , 'VCbb_AAAAaaaa': lucc_VCbb_AAAAaaaa , 'VCbb_CAAAaaaa': lucc_VCbb_CAAAaaaa , 'VCbb_CCAAaaaa': lucc_VCbb_CCAAaaaa ,
'VCbb_VAAAaaaa': lucc_VCbb_VAAAaaaa , 'VCbb_VACAaaaa': lucc_VCbb_VACAaaaa , 'VCbb_VACCaaaa': lucc_VCbb_VACCaaaa , 'VCbb_VVAAaaaa': lucc_VCbb_VVAAaaaa ,
'VCbb_VVCAaaaa': lucc_VCbb_VVCAaaaa , 'VCbb_VVCCaaaa': lucc_VCbb_VVCCaaaa , 'AAbb_CAAAbaba': lucc_AAbb_CAAAbaba , 'AAbb_CCAAbaba': lucc_AAbb_CCAAbaba ,
'AAbb_VAAAbaba': lucc_AAbb_VAAAbaba , 'AAbb_VACAbaba': lucc_AAbb_VACAbaba , 'AAbb_VACCbaba': lucc_AAbb_VACCbaba , 'AAbb_VVAAbaba': lucc_AAbb_VVAAbaba ,
'AAbb_VVCAbaba': lucc_AAbb_VVCAbaba , 'AAbb_VVCCbaba': lucc_AAbb_VVCCbaba , 'CAbb_AAAAbaba': lucc_CAbb_AAAAbaba , 'CAbb_CAAAbaba': lucc_CAbb_CAAAbaba ,
'CAbb_CCAAbaba': lucc_CAbb_CCAAbaba , 'CAbb_VAAAbaba': lucc_CAbb_VAAAbaba , 'CAbb_VACAbaba': lucc_CAbb_VACAbaba , 'CAbb_VACCbaba': lucc_CAbb_VACCbaba ,
'CAbb_VVAAbaba': lucc_CAbb_VVAAbaba , 'CAbb_VVCAbaba': lucc_CAbb_VVCAbaba , 'CAbb_VVCCbaba': lucc_CAbb_VVCCbaba , 'VAbb_AAAAbaba': lucc_VAbb_AAAAbaba ,
'VAbb_CAAAbaba': lucc_VAbb_CAAAbaba , 'VAbb_CCAAbaba': lucc_VAbb_CCAAbaba , 'VAbb_VAAAbaba': lucc_VAbb_VAAAbaba , 'VAbb_VACAbaba': lucc_VAbb_VACAbaba ,
'VAbb_VACCbaba': lucc_VAbb_VACCbaba , 'VAbb_VVAAbaba': lucc_VAbb_VVAAbaba , 'VAbb_VVCAbaba': lucc_VAbb_VVCAbaba , 'VAbb_VVCCbaba': lucc_VAbb_VVCCbaba ,
'VCbb_AAAAbaba': lucc_VCbb_AAAAbaba , 'VCbb_CAAAbaba': lucc_VCbb_CAAAbaba , 'VCbb_CCAAbaba': lucc_VCbb_CCAAbaba , 'VCbb_VAAAbaba': lucc_VCbb_VAAAbaba ,
'VCbb_VACAbaba': lucc_VCbb_VACAbaba , 'VCbb_VACCbaba': lucc_VCbb_VACCbaba , 'VCbb_VVAAbaba': lucc_VCbb_VVAAbaba , 'VCbb_VVCAbaba': lucc_VCbb_VVCAbaba ,
'VCbb_VVCCbaba': lucc_VCbb_VVCCbaba , 'AAbb_CAAAbbbb': lucc_AAbb_CAAAbbbb , 'AAbb_CCAAbbbb': lucc_AAbb_CCAAbbbb , 'AAbb_VAAAbbbb': lucc_AAbb_VAAAbbbb ,
'AAbb_VACAbbbb': lucc_AAbb_VACAbbbb , 'AAbb_VACCbbbb': lucc_AAbb_VACCbbbb , 'AAbb_VVAAbbbb': lucc_AAbb_VVAAbbbb , 'AAbb_VVCAbbbb': lucc_AAbb_VVCAbbbb ,
'AAbb_VVCCbbbb': lucc_AAbb_VVCCbbbb , 'CAbb_AAAAbbbb': lucc_CAbb_AAAAbbbb , 'CAbb_CAAAbbbb': lucc_CAbb_CAAAbbbb , 'CAbb_CCAAbbbb': lucc_CAbb_CCAAbbbb ,
'CAbb_VAAAbbbb': lucc_CAbb_VAAAbbbb , 'CAbb_VACAbbbb': lucc_CAbb_VACAbbbb , 'CAbb_VACCbbbb': lucc_CAbb_VACCbbbb , 'CAbb_VVAAbbbb': lucc_CAbb_VVAAbbbb ,
'CAbb_VVCAbbbb': lucc_CAbb_VVCAbbbb , 'CAbb_VVCCbbbb': lucc_CAbb_VVCCbbbb , 'VAbb_AAAAbbbb': lucc_VAbb_AAAAbbbb , 'VAbb_CAAAbbbb': lucc_VAbb_CAAAbbbb ,
'VAbb_CCAAbbbb': lucc_VAbb_CCAAbbbb , 'VAbb_VAAAbbbb': lucc_VAbb_VAAAbbbb , 'VAbb_VACAbbbb': lucc_VAbb_VACAbbbb , 'VAbb_VACCbbbb': lucc_VAbb_VACCbbbb ,
'VAbb_VVAAbbbb': lucc_VAbb_VVAAbbbb , 'VAbb_VVCAbbbb': lucc_VAbb_VVCAbbbb , 'VAbb_VVCCbbbb': lucc_VAbb_VVCCbbbb , 'VCbb_AAAAbbbb': lucc_VCbb_AAAAbbbb ,
'VCbb_CAAAbbbb': lucc_VCbb_CAAAbbbb , 'VCbb_CCAAbbbb': lucc_VCbb_CCAAbbbb , 'VCbb_VAAAbbbb': lucc_VCbb_VAAAbbbb , 'VCbb_VACAbbbb': lucc_VCbb_VACAbbbb ,
'VCbb_VACCbbbb': lucc_VCbb_VACCbbbb , 'VCbb_VVAAbbbb': lucc_VCbb_VVAAbbbb , 'VCbb_VVCAbbbb': lucc_VCbb_VVCAbbbb , 'VCbb_VVCCbbbb': lucc_VCbb_VVCCbbbb ,
'AAAAaaaa_CAaa': lucc_AAAAaaaa_CAaa , 'AAAAaaaa_VAaa': lucc_AAAAaaaa_VAaa , 'AAAAaaaa_VCaa': lucc_AAAAaaaa_VCaa , 'CAAAaaaa_AAaa': lucc_CAAAaaaa_AAaa ,
'CAAAaaaa_CAaa': lucc_CAAAaaaa_CAaa , 'CAAAaaaa_VAaa': lucc_CAAAaaaa_VAaa , 'CAAAaaaa_VCaa': lucc_CAAAaaaa_VCaa , 'CCAAaaaa_AAaa': lucc_CCAAaaaa_AAaa ,
'CCAAaaaa_CAaa': lucc_CCAAaaaa_CAaa , 'CCAAaaaa_VAaa': lucc_CCAAaaaa_VAaa , 'CCAAaaaa_VCaa': lucc_CCAAaaaa_VCaa , 'VAAAaaaa_AAaa': lucc_VAAAaaaa_AAaa ,
'VAAAaaaa_CAaa': lucc_VAAAaaaa_CAaa , 'VAAAaaaa_VAaa': lucc_VAAAaaaa_VAaa , 'VAAAaaaa_VCaa': lucc_VAAAaaaa_VCaa , 'VACAaaaa_AAaa': lucc_VACAaaaa_AAaa ,
'VACAaaaa_CAaa': lucc_VACAaaaa_CAaa , 'VACAaaaa_VAaa': lucc_VACAaaaa_VAaa , 'VACAaaaa_VCaa': lucc_VACAaaaa_VCaa , 'VACCaaaa_AAaa': lucc_VACCaaaa_AAaa ,
'VACCaaaa_CAaa': lucc_VACCaaaa_CAaa , 'VACCaaaa_VAaa': lucc_VACCaaaa_VAaa , 'VACCaaaa_VCaa': lucc_VACCaaaa_VCaa , 'VVAAaaaa_AAaa': lucc_VVAAaaaa_AAaa ,
'VVAAaaaa_CAaa': lucc_VVAAaaaa_CAaa , 'VVAAaaaa_VAaa': lucc_VVAAaaaa_VAaa , 'VVAAaaaa_VCaa': lucc_VVAAaaaa_VCaa , 'VVCAaaaa_AAaa': lucc_VVCAaaaa_AAaa ,
'VVCAaaaa_CAaa': lucc_VVCAaaaa_CAaa , 'VVCAaaaa_VAaa': lucc_VVCAaaaa_VAaa , 'VVCAaaaa_VCaa': lucc_VVCAaaaa_VCaa , 'VVCCaaaa_AAaa': lucc_VVCCaaaa_AAaa ,
'VVCCaaaa_CAaa': lucc_VVCCaaaa_CAaa , 'VVCCaaaa_VAaa': lucc_VVCCaaaa_VAaa , 'VVCCaaaa_VCaa': lucc_VVCCaaaa_VCaa , 'AAAAaaaa_CAbb': lucc_AAAAaaaa_CAbb ,
'AAAAaaaa_VAbb': lucc_AAAAaaaa_VAbb , 'AAAAaaaa_VCbb': lucc_AAAAaaaa_VCbb , 'CAAAaaaa_AAbb': lucc_CAAAaaaa_AAbb , 'CAAAaaaa_CAbb': lucc_CAAAaaaa_CAbb ,
'CAAAaaaa_VAbb': lucc_CAAAaaaa_VAbb , 'CAAAaaaa_VCbb': lucc_CAAAaaaa_VCbb , 'CCAAaaaa_AAbb': lucc_CCAAaaaa_AAbb , 'CCAAaaaa_CAbb': lucc_CCAAaaaa_CAbb ,
'CCAAaaaa_VAbb': lucc_CCAAaaaa_VAbb , 'CCAAaaaa_VCbb': lucc_CCAAaaaa_VCbb , 'VAAAaaaa_AAbb': lucc_VAAAaaaa_AAbb , 'VAAAaaaa_CAbb': lucc_VAAAaaaa_CAbb ,
'VAAAaaaa_VAbb': lucc_VAAAaaaa_VAbb , 'VAAAaaaa_VCbb': lucc_VAAAaaaa_VCbb , 'VACAaaaa_AAbb': lucc_VACAaaaa_AAbb , 'VACAaaaa_CAbb': lucc_VACAaaaa_CAbb ,
'VACAaaaa_VAbb': lucc_VACAaaaa_VAbb , 'VACAaaaa_VCbb': lucc_VACAaaaa_VCbb , 'VACCaaaa_AAbb': lucc_VACCaaaa_AAbb , 'VACCaaaa_CAbb': lucc_VACCaaaa_CAbb ,
'VACCaaaa_VAbb': lucc_VACCaaaa_VAbb , 'VACCaaaa_VCbb': lucc_VACCaaaa_VCbb , 'VVAAaaaa_AAbb': lucc_VVAAaaaa_AAbb , 'VVAAaaaa_CAbb': lucc_VVAAaaaa_CAbb ,
'VVAAaaaa_VAbb': lucc_VVAAaaaa_VAbb , 'VVAAaaaa_VCbb': lucc_VVAAaaaa_VCbb , 'VVCAaaaa_AAbb': lucc_VVCAaaaa_AAbb , 'VVCAaaaa_CAbb': lucc_VVCAaaaa_CAbb ,
'VVCAaaaa_VAbb': lucc_VVCAaaaa_VAbb , 'VVCAaaaa_VCbb': lucc_VVCAaaaa_VCbb , 'VVCCaaaa_AAbb': lucc_VVCCaaaa_AAbb , 'VVCCaaaa_CAbb': lucc_VVCCaaaa_CAbb ,
'VVCCaaaa_VAbb': lucc_VVCCaaaa_VAbb , 'VVCCaaaa_VCbb': lucc_VVCCaaaa_VCbb , 'AAAAaaaa_CAAAaaaa': lucc_AAAAaaaa_CAAAaaaa , 'AAAAaaaa_CCAAaaaa': lucc_AAAAaaaa_CCAAaaaa ,
'AAAAaaaa_VAAAaaaa': lucc_AAAAaaaa_VAAAaaaa , 'AAAAaaaa_VACAaaaa': lucc_AAAAaaaa_VACAaaaa , 'AAAAaaaa_VACCaaaa': lucc_AAAAaaaa_VACCaaaa , 'AAAAaaaa_VVAAaaaa': lucc_AAAAaaaa_VVAAaaaa ,
'AAAAaaaa_VVCAaaaa': lucc_AAAAaaaa_VVCAaaaa , 'AAAAaaaa_VVCCaaaa': lucc_AAAAaaaa_VVCCaaaa , 'CAAAaaaa_AAAAaaaa': lucc_CAAAaaaa_AAAAaaaa , 'CAAAaaaa_CAAAaaaa': lucc_CAAAaaaa_CAAAaaaa ,
'CAAAaaaa_CCAAaaaa': lucc_CAAAaaaa_CCAAaaaa , 'CAAAaaaa_VAAAaaaa': lucc_CAAAaaaa_VAAAaaaa , 'CAAAaaaa_VACAaaaa': lucc_CAAAaaaa_VACAaaaa , 'CAAAaaaa_VACCaaaa': lucc_CAAAaaaa_VACCaaaa ,
'CAAAaaaa_VVAAaaaa': lucc_CAAAaaaa_VVAAaaaa , 'CAAAaaaa_VVCAaaaa': lucc_CAAAaaaa_VVCAaaaa , 'CAAAaaaa_VVCCaaaa': lucc_CAAAaaaa_VVCCaaaa , 'CCAAaaaa_AAAAaaaa': lucc_CCAAaaaa_AAAAaaaa ,
'CCAAaaaa_CAAAaaaa': lucc_CCAAaaaa_CAAAaaaa , 'CCAAaaaa_CCAAaaaa': lucc_CCAAaaaa_CCAAaaaa , 'CCAAaaaa_VAAAaaaa': lucc_CCAAaaaa_VAAAaaaa , 'CCAAaaaa_VACAaaaa': lucc_CCAAaaaa_VACAaaaa ,
'CCAAaaaa_VACCaaaa': lucc_CCAAaaaa_VACCaaaa , 'CCAAaaaa_VVAAaaaa': lucc_CCAAaaaa_VVAAaaaa , 'CCAAaaaa_VVCAaaaa': lucc_CCAAaaaa_VVCAaaaa , 'CCAAaaaa_VVCCaaaa': lucc_CCAAaaaa_VVCCaaaa ,
'VAAAaaaa_AAAAaaaa': lucc_VAAAaaaa_AAAAaaaa , 'VAAAaaaa_CAAAaaaa': lucc_VAAAaaaa_CAAAaaaa , 'VAAAaaaa_CCAAaaaa': lucc_VAAAaaaa_CCAAaaaa , 'VAAAaaaa_VAAAaaaa': lucc_VAAAaaaa_VAAAaaaa ,
'VAAAaaaa_VACAaaaa': lucc_VAAAaaaa_VACAaaaa , 'VAAAaaaa_VACCaaaa': lucc_VAAAaaaa_VACCaaaa , 'VAAAaaaa_VVAAaaaa': lucc_VAAAaaaa_VVAAaaaa , 'VAAAaaaa_VVCAaaaa': lucc_VAAAaaaa_VVCAaaaa ,
'VAAAaaaa_VVCCaaaa': lucc_VAAAaaaa_VVCCaaaa , 'VACAaaaa_AAAAaaaa': lucc_VACAaaaa_AAAAaaaa , 'VACAaaaa_CAAAaaaa': lucc_VACAaaaa_CAAAaaaa , 'VACAaaaa_CCAAaaaa': lucc_VACAaaaa_CCAAaaaa ,
'VACAaaaa_VAAAaaaa': lucc_VACAaaaa_VAAAaaaa , 'VACAaaaa_VACAaaaa': lucc_VACAaaaa_VACAaaaa , 'VACAaaaa_VACCaaaa': lucc_VACAaaaa_VACCaaaa , 'VACAaaaa_VVAAaaaa': lucc_VACAaaaa_VVAAaaaa ,
'VACAaaaa_VVCAaaaa': lucc_VACAaaaa_VVCAaaaa , 'VACAaaaa_VVCCaaaa': lucc_VACAaaaa_VVCCaaaa , 'VACCaaaa_AAAAaaaa': lucc_VACCaaaa_AAAAaaaa , 'VACCaaaa_CAAAaaaa': lucc_VACCaaaa_CAAAaaaa ,
'VACCaaaa_CCAAaaaa': lucc_VACCaaaa_CCAAaaaa , 'VACCaaaa_VAAAaaaa': lucc_VACCaaaa_VAAAaaaa , 'VACCaaaa_VACAaaaa': lucc_VACCaaaa_VACAaaaa , 'VACCaaaa_VACCaaaa': lucc_VACCaaaa_VACCaaaa ,
'VACCaaaa_VVAAaaaa': lucc_VACCaaaa_VVAAaaaa , 'VACCaaaa_VVCAaaaa': lucc_VACCaaaa_VVCAaaaa , 'VACCaaaa_VVCCaaaa': lucc_VACCaaaa_VVCCaaaa , 'VVAAaaaa_AAAAaaaa': lucc_VVAAaaaa_AAAAaaaa ,
'VVAAaaaa_CAAAaaaa': lucc_VVAAaaaa_CAAAaaaa , 'VVAAaaaa_CCAAaaaa': lucc_VVAAaaaa_CCAAaaaa , 'VVAAaaaa_VAAAaaaa': lucc_VVAAaaaa_VAAAaaaa , 'VVAAaaaa_VACAaaaa': lucc_VVAAaaaa_VACAaaaa ,
'VVAAaaaa_VACCaaaa': lucc_VVAAaaaa_VACCaaaa , 'VVAAaaaa_VVAAaaaa': lucc_VVAAaaaa_VVAAaaaa , 'VVAAaaaa_VVCAaaaa': lucc_VVAAaaaa_VVCAaaaa , 'VVAAaaaa_VVCCaaaa': lucc_VVAAaaaa_VVCCaaaa ,
'VVCAaaaa_AAAAaaaa': lucc_VVCAaaaa_AAAAaaaa , 'VVCAaaaa_CAAAaaaa': lucc_VVCAaaaa_CAAAaaaa , 'VVCAaaaa_CCAAaaaa': lucc_VVCAaaaa_CCAAaaaa , 'VVCAaaaa_VAAAaaaa': lucc_VVCAaaaa_VAAAaaaa ,
'VVCAaaaa_VACAaaaa': lucc_VVCAaaaa_VACAaaaa , 'VVCAaaaa_VACCaaaa': lucc_VVCAaaaa_VACCaaaa , 'VVCAaaaa_VVAAaaaa': lucc_VVCAaaaa_VVAAaaaa , 'VVCAaaaa_VVCAaaaa': lucc_VVCAaaaa_VVCAaaaa ,
'VVCAaaaa_VVCCaaaa': lucc_VVCAaaaa_VVCCaaaa , 'VVCCaaaa_AAAAaaaa': lucc_VVCCaaaa_AAAAaaaa , 'VVCCaaaa_CAAAaaaa': lucc_VVCCaaaa_CAAAaaaa , 'VVCCaaaa_CCAAaaaa': lucc_VVCCaaaa_CCAAaaaa ,
'VVCCaaaa_VAAAaaaa': lucc_VVCCaaaa_VAAAaaaa , 'VVCCaaaa_VACAaaaa': lucc_VVCCaaaa_VACAaaaa , 'VVCCaaaa_VACCaaaa': lucc_VVCCaaaa_VACCaaaa , 'VVCCaaaa_VVAAaaaa': lucc_VVCCaaaa_VVAAaaaa ,
'VVCCaaaa_VVCAaaaa': lucc_VVCCaaaa_VVCAaaaa , 'VVCCaaaa_VVCCaaaa': lucc_VVCCaaaa_VVCCaaaa , 'AAAAaaaa_CAAAbaba': lucc_AAAAaaaa_CAAAbaba , 'AAAAaaaa_CCAAbaba': lucc_AAAAaaaa_CCAAbaba ,
'AAAAaaaa_VAAAbaba': lucc_AAAAaaaa_VAAAbaba , 'AAAAaaaa_VACAbaba': lucc_AAAAaaaa_VACAbaba , 'AAAAaaaa_VACCbaba': lucc_AAAAaaaa_VACCbaba , 'AAAAaaaa_VVAAbaba': lucc_AAAAaaaa_VVAAbaba ,
'AAAAaaaa_VVCAbaba': lucc_AAAAaaaa_VVCAbaba , 'AAAAaaaa_VVCCbaba': lucc_AAAAaaaa_VVCCbaba , 'CAAAaaaa_AAAAbaba': lucc_CAAAaaaa_AAAAbaba , 'CAAAaaaa_CAAAbaba': lucc_CAAAaaaa_CAAAbaba ,
'CAAAaaaa_CCAAbaba': lucc_CAAAaaaa_CCAAbaba , 'CAAAaaaa_VAAAbaba': lucc_CAAAaaaa_VAAAbaba , 'CAAAaaaa_VACAbaba': lucc_CAAAaaaa_VACAbaba , 'CAAAaaaa_VACCbaba': lucc_CAAAaaaa_VACCbaba ,
'CAAAaaaa_VVAAbaba': lucc_CAAAaaaa_VVAAbaba , 'CAAAaaaa_VVCAbaba': lucc_CAAAaaaa_VVCAbaba , 'CAAAaaaa_VVCCbaba': lucc_CAAAaaaa_VVCCbaba , 'CCAAaaaa_AAAAbaba': lucc_CCAAaaaa_AAAAbaba ,
'CCAAaaaa_CAAAbaba': lucc_CCAAaaaa_CAAAbaba , 'CCAAaaaa_CCAAbaba': lucc_CCAAaaaa_CCAAbaba , 'CCAAaaaa_VAAAbaba': lucc_CCAAaaaa_VAAAbaba , 'CCAAaaaa_VACAbaba': lucc_CCAAaaaa_VACAbaba ,
'CCAAaaaa_VACCbaba': lucc_CCAAaaaa_VACCbaba , 'CCAAaaaa_VVAAbaba': lucc_CCAAaaaa_VVAAbaba , 'CCAAaaaa_VVCAbaba': lucc_CCAAaaaa_VVCAbaba , 'CCAAaaaa_VVCCbaba': lucc_CCAAaaaa_VVCCbaba ,
'VAAAaaaa_AAAAbaba': lucc_VAAAaaaa_AAAAbaba , 'VAAAaaaa_CAAAbaba': lucc_VAAAaaaa_CAAAbaba , 'VAAAaaaa_CCAAbaba': lucc_VAAAaaaa_CCAAbaba , 'VAAAaaaa_VAAAbaba': lucc_VAAAaaaa_VAAAbaba ,
'VAAAaaaa_VACAbaba': lucc_VAAAaaaa_VACAbaba , 'VAAAaaaa_VACCbaba': lucc_VAAAaaaa_VACCbaba , 'VAAAaaaa_VVAAbaba': lucc_VAAAaaaa_VVAAbaba , 'VAAAaaaa_VVCAbaba': lucc_VAAAaaaa_VVCAbaba ,
'VAAAaaaa_VVCCbaba': lucc_VAAAaaaa_VVCCbaba , 'VACAaaaa_AAAAbaba': lucc_VACAaaaa_AAAAbaba , 'VACAaaaa_CAAAbaba': lucc_VACAaaaa_CAAAbaba , 'VACAaaaa_CCAAbaba': lucc_VACAaaaa_CCAAbaba ,
'VACAaaaa_VAAAbaba': lucc_VACAaaaa_VAAAbaba , 'VACAaaaa_VACAbaba': lucc_VACAaaaa_VACAbaba , 'VACAaaaa_VACCbaba': lucc_VACAaaaa_VACCbaba , 'VACAaaaa_VVAAbaba': lucc_VACAaaaa_VVAAbaba ,
'VACAaaaa_VVCAbaba': lucc_VACAaaaa_VVCAbaba , 'VACAaaaa_VVCCbaba': lucc_VACAaaaa_VVCCbaba , 'VACCaaaa_AAAAbaba': lucc_VACCaaaa_AAAAbaba , 'VACCaaaa_CAAAbaba': lucc_VACCaaaa_CAAAbaba ,
'VACCaaaa_CCAAbaba': lucc_VACCaaaa_CCAAbaba , 'VACCaaaa_VAAAbaba': lucc_VACCaaaa_VAAAbaba , 'VACCaaaa_VACAbaba': lucc_VACCaaaa_VACAbaba , 'VACCaaaa_VACCbaba': lucc_VACCaaaa_VACCbaba ,
'VACCaaaa_VVAAbaba': lucc_VACCaaaa_VVAAbaba , 'VACCaaaa_VVCAbaba': lucc_VACCaaaa_VVCAbaba , 'VACCaaaa_VVCCbaba': lucc_VACCaaaa_VVCCbaba , 'VVAAaaaa_AAAAbaba': lucc_VVAAaaaa_AAAAbaba ,
'VVAAaaaa_CAAAbaba': lucc_VVAAaaaa_CAAAbaba , 'VVAAaaaa_CCAAbaba': lucc_VVAAaaaa_CCAAbaba , 'VVAAaaaa_VAAAbaba': lucc_VVAAaaaa_VAAAbaba , 'VVAAaaaa_VACAbaba': lucc_VVAAaaaa_VACAbaba ,
'VVAAaaaa_VACCbaba': lucc_VVAAaaaa_VACCbaba , 'VVAAaaaa_VVAAbaba': lucc_VVAAaaaa_VVAAbaba , 'VVAAaaaa_VVCAbaba': lucc_VVAAaaaa_VVCAbaba , 'VVAAaaaa_VVCCbaba': lucc_VVAAaaaa_VVCCbaba ,
'VVCAaaaa_AAAAbaba': lucc_VVCAaaaa_AAAAbaba , 'VVCAaaaa_CAAAbaba': lucc_VVCAaaaa_CAAAbaba , 'VVCAaaaa_CCAAbaba': lucc_VVCAaaaa_CCAAbaba , 'VVCAaaaa_VAAAbaba': lucc_VVCAaaaa_VAAAbaba ,
'VVCAaaaa_VACAbaba': lucc_VVCAaaaa_VACAbaba , 'VVCAaaaa_VACCbaba': lucc_VVCAaaaa_VACCbaba , 'VVCAaaaa_VVAAbaba': lucc_VVCAaaaa_VVAAbaba , 'VVCAaaaa_VVCAbaba': lucc_VVCAaaaa_VVCAbaba ,
'VVCAaaaa_VVCCbaba': lucc_VVCAaaaa_VVCCbaba , 'VVCCaaaa_AAAAbaba': lucc_VVCCaaaa_AAAAbaba , 'VVCCaaaa_CAAAbaba': lucc_VVCCaaaa_CAAAbaba , 'VVCCaaaa_CCAAbaba': lucc_VVCCaaaa_CCAAbaba ,
'VVCCaaaa_VAAAbaba': lucc_VVCCaaaa_VAAAbaba , 'VVCCaaaa_VACAbaba': lucc_VVCCaaaa_VACAbaba , 'VVCCaaaa_VACCbaba': lucc_VVCCaaaa_VACCbaba , 'VVCCaaaa_VVAAbaba': lucc_VVCCaaaa_VVAAbaba ,
'VVCCaaaa_VVCAbaba': lucc_VVCCaaaa_VVCAbaba , 'VVCCaaaa_VVCCbaba': lucc_VVCCaaaa_VVCCbaba , 'AAAAaaaa_CAAAbbbb': lucc_AAAAaaaa_CAAAbbbb , 'AAAAaaaa_CCAAbbbb': lucc_AAAAaaaa_CCAAbbbb ,
'AAAAaaaa_VAAAbbbb': lucc_AAAAaaaa_VAAAbbbb , 'AAAAaaaa_VACAbbbb': lucc_AAAAaaaa_VACAbbbb , 'AAAAaaaa_VACCbbbb': lucc_AAAAaaaa_VACCbbbb , 'AAAAaaaa_VVAAbbbb': lucc_AAAAaaaa_VVAAbbbb ,
'AAAAaaaa_VVCAbbbb': lucc_AAAAaaaa_VVCAbbbb , 'AAAAaaaa_VVCCbbbb': lucc_AAAAaaaa_VVCCbbbb , 'CAAAaaaa_AAAAbbbb': lucc_CAAAaaaa_AAAAbbbb , 'CAAAaaaa_CAAAbbbb': lucc_CAAAaaaa_CAAAbbbb ,
'CAAAaaaa_CCAAbbbb': lucc_CAAAaaaa_CCAAbbbb , 'CAAAaaaa_VAAAbbbb': lucc_CAAAaaaa_VAAAbbbb , 'CAAAaaaa_VACAbbbb': lucc_CAAAaaaa_VACAbbbb , 'CAAAaaaa_VACCbbbb': lucc_CAAAaaaa_VACCbbbb ,
'CAAAaaaa_VVAAbbbb': lucc_CAAAaaaa_VVAAbbbb , 'CAAAaaaa_VVCAbbbb': lucc_CAAAaaaa_VVCAbbbb , 'CAAAaaaa_VVCCbbbb': lucc_CAAAaaaa_VVCCbbbb , 'CCAAaaaa_AAAAbbbb': lucc_CCAAaaaa_AAAAbbbb ,
'CCAAaaaa_CAAAbbbb': lucc_CCAAaaaa_CAAAbbbb , 'CCAAaaaa_CCAAbbbb': lucc_CCAAaaaa_CCAAbbbb , 'CCAAaaaa_VAAAbbbb': lucc_CCAAaaaa_VAAAbbbb , 'CCAAaaaa_VACAbbbb': lucc_CCAAaaaa_VACAbbbb ,
'CCAAaaaa_VACCbbbb': lucc_CCAAaaaa_VACCbbbb , 'CCAAaaaa_VVAAbbbb': lucc_CCAAaaaa_VVAAbbbb , 'CCAAaaaa_VVCAbbbb': lucc_CCAAaaaa_VVCAbbbb , 'CCAAaaaa_VVCCbbbb': lucc_CCAAaaaa_VVCCbbbb ,
'VAAAaaaa_AAAAbbbb': lucc_VAAAaaaa_AAAAbbbb , 'VAAAaaaa_CAAAbbbb': lucc_VAAAaaaa_CAAAbbbb , 'VAAAaaaa_CCAAbbbb': lucc_VAAAaaaa_CCAAbbbb , 'VAAAaaaa_VAAAbbbb': lucc_VAAAaaaa_VAAAbbbb ,
'VAAAaaaa_VACAbbbb': lucc_VAAAaaaa_VACAbbbb , 'VAAAaaaa_VACCbbbb': lucc_VAAAaaaa_VACCbbbb , 'VAAAaaaa_VVAAbbbb': lucc_VAAAaaaa_VVAAbbbb , 'VAAAaaaa_VVCAbbbb': lucc_VAAAaaaa_VVCAbbbb ,
'VAAAaaaa_VVCCbbbb': lucc_VAAAaaaa_VVCCbbbb , 'VACAaaaa_AAAAbbbb': lucc_VACAaaaa_AAAAbbbb , 'VACAaaaa_CAAAbbbb': lucc_VACAaaaa_CAAAbbbb , 'VACAaaaa_CCAAbbbb': lucc_VACAaaaa_CCAAbbbb ,
'VACAaaaa_VAAAbbbb': lucc_VACAaaaa_VAAAbbbb , 'VACAaaaa_VACAbbbb': lucc_VACAaaaa_VACAbbbb , 'VACAaaaa_VACCbbbb': lucc_VACAaaaa_VACCbbbb , 'VACAaaaa_VVAAbbbb': lucc_VACAaaaa_VVAAbbbb ,
'VACAaaaa_VVCAbbbb': lucc_VACAaaaa_VVCAbbbb , 'VACAaaaa_VVCCbbbb': lucc_VACAaaaa_VVCCbbbb , 'VACCaaaa_AAAAbbbb': lucc_VACCaaaa_AAAAbbbb , 'VACCaaaa_CAAAbbbb': lucc_VACCaaaa_CAAAbbbb ,
'VACCaaaa_CCAAbbbb': lucc_VACCaaaa_CCAAbbbb , 'VACCaaaa_VAAAbbbb': lucc_VACCaaaa_VAAAbbbb , 'VACCaaaa_VACAbbbb': lucc_VACCaaaa_VACAbbbb , 'VACCaaaa_VACCbbbb': lucc_VACCaaaa_VACCbbbb ,
'VACCaaaa_VVAAbbbb': lucc_VACCaaaa_VVAAbbbb , 'VACCaaaa_VVCAbbbb': lucc_VACCaaaa_VVCAbbbb , 'VACCaaaa_VVCCbbbb': lucc_VACCaaaa_VVCCbbbb , 'VVAAaaaa_AAAAbbbb': lucc_VVAAaaaa_AAAAbbbb ,
'VVAAaaaa_CAAAbbbb': lucc_VVAAaaaa_CAAAbbbb , 'VVAAaaaa_CCAAbbbb': lucc_VVAAaaaa_CCAAbbbb , 'VVAAaaaa_VAAAbbbb': lucc_VVAAaaaa_VAAAbbbb , 'VVAAaaaa_VACAbbbb': lucc_VVAAaaaa_VACAbbbb ,
'VVAAaaaa_VACCbbbb': lucc_VVAAaaaa_VACCbbbb , 'VVAAaaaa_VVAAbbbb': lucc_VVAAaaaa_VVAAbbbb , 'VVAAaaaa_VVCAbbbb': lucc_VVAAaaaa_VVCAbbbb , 'VVAAaaaa_VVCCbbbb': lucc_VVAAaaaa_VVCCbbbb ,
'VVCAaaaa_AAAAbbbb': lucc_VVCAaaaa_AAAAbbbb , 'VVCAaaaa_CAAAbbbb': lucc_VVCAaaaa_CAAAbbbb , 'VVCAaaaa_CCAAbbbb': lucc_VVCAaaaa_CCAAbbbb , 'VVCAaaaa_VAAAbbbb': lucc_VVCAaaaa_VAAAbbbb ,
'VVCAaaaa_VACAbbbb': lucc_VVCAaaaa_VACAbbbb , 'VVCAaaaa_VACCbbbb': lucc_VVCAaaaa_VACCbbbb , 'VVCAaaaa_VVAAbbbb': lucc_VVCAaaaa_VVAAbbbb , 'VVCAaaaa_VVCAbbbb': lucc_VVCAaaaa_VVCAbbbb ,
'VVCAaaaa_VVCCbbbb': lucc_VVCAaaaa_VVCCbbbb , 'VVCCaaaa_AAAAbbbb': lucc_VVCCaaaa_AAAAbbbb , 'VVCCaaaa_CAAAbbbb': lucc_VVCCaaaa_CAAAbbbb , 'VVCCaaaa_CCAAbbbb': lucc_VVCCaaaa_CCAAbbbb ,
'VVCCaaaa_VAAAbbbb': lucc_VVCCaaaa_VAAAbbbb , 'VVCCaaaa_VACAbbbb': lucc_VVCCaaaa_VACAbbbb , 'VVCCaaaa_VACCbbbb': lucc_VVCCaaaa_VACCbbbb , 'VVCCaaaa_VVAAbbbb': lucc_VVCCaaaa_VVAAbbbb ,
'VVCCaaaa_VVCAbbbb': lucc_VVCCaaaa_VVCAbbbb , 'VVCCaaaa_VVCCbbbb': lucc_VVCCaaaa_VVCCbbbb , 'AAAAbaba_CAaa': lucc_AAAAbaba_CAaa , 'AAAAbaba_VAaa': lucc_AAAAbaba_VAaa ,
'AAAAbaba_VCaa': lucc_AAAAbaba_VCaa , 'CAAAbaba_AAaa': lucc_CAAAbaba_AAaa , 'CAAAbaba_CAaa': lucc_CAAAbaba_CAaa , 'CAAAbaba_VAaa': lucc_CAAAbaba_VAaa ,
'CAAAbaba_VCaa': lucc_CAAAbaba_VCaa , 'CCAAbaba_AAaa': lucc_CCAAbaba_AAaa , 'CCAAbaba_CAaa': lucc_CCAAbaba_CAaa , 'CCAAbaba_VAaa': lucc_CCAAbaba_VAaa ,
'CCAAbaba_VCaa': lucc_CCAAbaba_VCaa , 'VAAAbaba_AAaa': lucc_VAAAbaba_AAaa , 'VAAAbaba_CAaa': lucc_VAAAbaba_CAaa , 'VAAAbaba_VAaa': lucc_VAAAbaba_VAaa ,
'VAAAbaba_VCaa': lucc_VAAAbaba_VCaa , 'VACAbaba_AAaa': lucc_VACAbaba_AAaa , 'VACAbaba_CAaa': lucc_VACAbaba_CAaa , 'VACAbaba_VAaa': lucc_VACAbaba_VAaa ,
'VACAbaba_VCaa': lucc_VACAbaba_VCaa , 'VACCbaba_AAaa': lucc_VACCbaba_AAaa , 'VACCbaba_CAaa': lucc_VACCbaba_CAaa , 'VACCbaba_VAaa': lucc_VACCbaba_VAaa ,
'VACCbaba_VCaa': lucc_VACCbaba_VCaa , 'VVAAbaba_AAaa': lucc_VVAAbaba_AAaa , 'VVAAbaba_CAaa': lucc_VVAAbaba_CAaa , 'VVAAbaba_VAaa': lucc_VVAAbaba_VAaa ,
'VVAAbaba_VCaa': lucc_VVAAbaba_VCaa , 'VVCAbaba_AAaa': lucc_VVCAbaba_AAaa , 'VVCAbaba_CAaa': lucc_VVCAbaba_CAaa , 'VVCAbaba_VAaa': lucc_VVCAbaba_VAaa ,
'VVCAbaba_VCaa': lucc_VVCAbaba_VCaa , 'VVCCbaba_AAaa': lucc_VVCCbaba_AAaa , 'VVCCbaba_CAaa': lucc_VVCCbaba_CAaa , 'VVCCbaba_VAaa': lucc_VVCCbaba_VAaa ,
'VVCCbaba_VCaa': lucc_VVCCbaba_VCaa , 'AAAAbaba_CAbb': lucc_AAAAbaba_CAbb , 'AAAAbaba_VAbb': lucc_AAAAbaba_VAbb , 'AAAAbaba_VCbb': lucc_AAAAbaba_VCbb ,
'CAAAbaba_AAbb': lucc_CAAAbaba_AAbb , 'CAAAbaba_CAbb': lucc_CAAAbaba_CAbb , 'CAAAbaba_VAbb': lucc_CAAAbaba_VAbb , 'CAAAbaba_VCbb': lucc_CAAAbaba_VCbb ,
'CCAAbaba_AAbb': lucc_CCAAbaba_AAbb , 'CCAAbaba_CAbb': lucc_CCAAbaba_CAbb , 'CCAAbaba_VAbb': lucc_CCAAbaba_VAbb , 'CCAAbaba_VCbb': lucc_CCAAbaba_VCbb ,
'VAAAbaba_AAbb': lucc_VAAAbaba_AAbb , 'VAAAbaba_CAbb': lucc_VAAAbaba_CAbb , 'VAAAbaba_VAbb': lucc_VAAAbaba_VAbb , 'VAAAbaba_VCbb': lucc_VAAAbaba_VCbb ,
'VACAbaba_AAbb': lucc_VACAbaba_AAbb , 'VACAbaba_CAbb': lucc_VACAbaba_CAbb , 'VACAbaba_VAbb': lucc_VACAbaba_VAbb , 'VACAbaba_VCbb': lucc_VACAbaba_VCbb ,
'VACCbaba_AAbb': lucc_VACCbaba_AAbb , 'VACCbaba_CAbb': lucc_VACCbaba_CAbb , 'VACCbaba_VAbb': lucc_VACCbaba_VAbb , 'VACCbaba_VCbb': lucc_VACCbaba_VCbb ,
'VVAAbaba_AAbb': lucc_VVAAbaba_AAbb , 'VVAAbaba_CAbb': lucc_VVAAbaba_CAbb , 'VVAAbaba_VAbb': lucc_VVAAbaba_VAbb , 'VVAAbaba_VCbb': lucc_VVAAbaba_VCbb ,
'VVCAbaba_AAbb': lucc_VVCAbaba_AAbb , 'VVCAbaba_CAbb': lucc_VVCAbaba_CAbb , 'VVCAbaba_VAbb': lucc_VVCAbaba_VAbb , 'VVCAbaba_VCbb': lucc_VVCAbaba_VCbb ,
'VVCCbaba_AAbb': lucc_VVCCbaba_AAbb , 'VVCCbaba_CAbb': lucc_VVCCbaba_CAbb , 'VVCCbaba_VAbb': lucc_VVCCbaba_VAbb , 'VVCCbaba_VCbb': lucc_VVCCbaba_VCbb ,
'AAAAbaba_CAAAaaaa': lucc_AAAAbaba_CAAAaaaa , 'AAAAbaba_CCAAaaaa': lucc_AAAAbaba_CCAAaaaa , 'AAAAbaba_VAAAaaaa': lucc_AAAAbaba_VAAAaaaa , 'AAAAbaba_VACAaaaa': lucc_AAAAbaba_VACAaaaa ,
'AAAAbaba_VACCaaaa': lucc_AAAAbaba_VACCaaaa , 'AAAAbaba_VVAAaaaa': lucc_AAAAbaba_VVAAaaaa , 'AAAAbaba_VVCAaaaa': lucc_AAAAbaba_VVCAaaaa , 'AAAAbaba_VVCCaaaa': lucc_AAAAbaba_VVCCaaaa ,
'CAAAbaba_AAAAaaaa': lucc_CAAAbaba_AAAAaaaa , 'CAAAbaba_CAAAaaaa': lucc_CAAAbaba_CAAAaaaa , 'CAAAbaba_CCAAaaaa': lucc_CAAAbaba_CCAAaaaa , 'CAAAbaba_VAAAaaaa': lucc_CAAAbaba_VAAAaaaa ,
'CAAAbaba_VACAaaaa': lucc_CAAAbaba_VACAaaaa , 'CAAAbaba_VACCaaaa': lucc_CAAAbaba_VACCaaaa , 'CAAAbaba_VVAAaaaa': lucc_CAAAbaba_VVAAaaaa , 'CAAAbaba_VVCAaaaa': lucc_CAAAbaba_VVCAaaaa ,
'CAAAbaba_VVCCaaaa': lucc_CAAAbaba_VVCCaaaa , 'CCAAbaba_AAAAaaaa': lucc_CCAAbaba_AAAAaaaa , 'CCAAbaba_CAAAaaaa': lucc_CCAAbaba_CAAAaaaa , 'CCAAbaba_CCAAaaaa': lucc_CCAAbaba_CCAAaaaa ,
'CCAAbaba_VAAAaaaa': lucc_CCAAbaba_VAAAaaaa , 'CCAAbaba_VACAaaaa': lucc_CCAAbaba_VACAaaaa , 'CCAAbaba_VACCaaaa': lucc_CCAAbaba_VACCaaaa , 'CCAAbaba_VVAAaaaa': lucc_CCAAbaba_VVAAaaaa ,
'CCAAbaba_VVCAaaaa': lucc_CCAAbaba_VVCAaaaa , 'CCAAbaba_VVCCaaaa': lucc_CCAAbaba_VVCCaaaa , 'VAAAbaba_AAAAaaaa': lucc_VAAAbaba_AAAAaaaa , 'VAAAbaba_CAAAaaaa': lucc_VAAAbaba_CAAAaaaa ,
'VAAAbaba_CCAAaaaa': lucc_VAAAbaba_CCAAaaaa , 'VAAAbaba_VAAAaaaa': lucc_VAAAbaba_VAAAaaaa , 'VAAAbaba_VACAaaaa': lucc_VAAAbaba_VACAaaaa , 'VAAAbaba_VACCaaaa': lucc_VAAAbaba_VACCaaaa ,
'VAAAbaba_VVAAaaaa': lucc_VAAAbaba_VVAAaaaa , 'VAAAbaba_VVCAaaaa': lucc_VAAAbaba_VVCAaaaa , 'VAAAbaba_VVCCaaaa': lucc_VAAAbaba_VVCCaaaa , 'VACAbaba_AAAAaaaa': lucc_VACAbaba_AAAAaaaa ,
'VACAbaba_CAAAaaaa': lucc_VACAbaba_CAAAaaaa , 'VACAbaba_CCAAaaaa': lucc_VACAbaba_CCAAaaaa , 'VACAbaba_VAAAaaaa': lucc_VACAbaba_VAAAaaaa , 'VACAbaba_VACAaaaa': lucc_VACAbaba_VACAaaaa ,
'VACAbaba_VACCaaaa': lucc_VACAbaba_VACCaaaa , 'VACAbaba_VVAAaaaa': lucc_VACAbaba_VVAAaaaa , 'VACAbaba_VVCAaaaa': lucc_VACAbaba_VVCAaaaa , 'VACAbaba_VVCCaaaa': lucc_VACAbaba_VVCCaaaa ,
'VACCbaba_AAAAaaaa': lucc_VACCbaba_AAAAaaaa , 'VACCbaba_CAAAaaaa': lucc_VACCbaba_CAAAaaaa , 'VACCbaba_CCAAaaaa': lucc_VACCbaba_CCAAaaaa , 'VACCbaba_VAAAaaaa': lucc_VACCbaba_VAAAaaaa ,
'VACCbaba_VACAaaaa': lucc_VACCbaba_VACAaaaa , 'VACCbaba_VACCaaaa': lucc_VACCbaba_VACCaaaa , 'VACCbaba_VVAAaaaa': lucc_VACCbaba_VVAAaaaa , 'VACCbaba_VVCAaaaa': lucc_VACCbaba_VVCAaaaa ,
'VACCbaba_VVCCaaaa': lucc_VACCbaba_VVCCaaaa , 'VVAAbaba_AAAAaaaa': lucc_VVAAbaba_AAAAaaaa , 'VVAAbaba_CAAAaaaa': lucc_VVAAbaba_CAAAaaaa , 'VVAAbaba_CCAAaaaa': lucc_VVAAbaba_CCAAaaaa ,
'VVAAbaba_VAAAaaaa': lucc_VVAAbaba_VAAAaaaa , 'VVAAbaba_VACAaaaa': lucc_VVAAbaba_VACAaaaa , 'VVAAbaba_VACCaaaa': lucc_VVAAbaba_VACCaaaa , 'VVAAbaba_VVAAaaaa': lucc_VVAAbaba_VVAAaaaa ,
'VVAAbaba_VVCAaaaa': lucc_VVAAbaba_VVCAaaaa , 'VVAAbaba_VVCCaaaa': lucc_VVAAbaba_VVCCaaaa , 'VVCAbaba_AAAAaaaa': lucc_VVCAbaba_AAAAaaaa , 'VVCAbaba_CAAAaaaa': lucc_VVCAbaba_CAAAaaaa ,
'VVCAbaba_CCAAaaaa': lucc_VVCAbaba_CCAAaaaa , 'VVCAbaba_VAAAaaaa': lucc_VVCAbaba_VAAAaaaa , 'VVCAbaba_VACAaaaa': lucc_VVCAbaba_VACAaaaa , 'VVCAbaba_VACCaaaa': lucc_VVCAbaba_VACCaaaa ,
'VVCAbaba_VVAAaaaa': lucc_VVCAbaba_VVAAaaaa , 'VVCAbaba_VVCAaaaa': lucc_VVCAbaba_VVCAaaaa , 'VVCAbaba_VVCCaaaa': lucc_VVCAbaba_VVCCaaaa , 'VVCCbaba_AAAAaaaa': lucc_VVCCbaba_AAAAaaaa ,
'VVCCbaba_CAAAaaaa': lucc_VVCCbaba_CAAAaaaa , 'VVCCbaba_CCAAaaaa': lucc_VVCCbaba_CCAAaaaa , 'VVCCbaba_VAAAaaaa': lucc_VVCCbaba_VAAAaaaa , 'VVCCbaba_VACAaaaa': lucc_VVCCbaba_VACAaaaa ,
'VVCCbaba_VACCaaaa': lucc_VVCCbaba_VACCaaaa , 'VVCCbaba_VVAAaaaa': lucc_VVCCbaba_VVAAaaaa , 'VVCCbaba_VVCAaaaa': lucc_VVCCbaba_VVCAaaaa , 'VVCCbaba_VVCCaaaa': lucc_VVCCbaba_VVCCaaaa ,
'AAAAbaba_CAAAbaba': lucc_AAAAbaba_CAAAbaba , 'AAAAbaba_CCAAbaba': lucc_AAAAbaba_CCAAbaba , 'AAAAbaba_VAAAbaba': lucc_AAAAbaba_VAAAbaba , 'AAAAbaba_VACAbaba': lucc_AAAAbaba_VACAbaba ,
'AAAAbaba_VACCbaba': lucc_AAAAbaba_VACCbaba , 'AAAAbaba_VVAAbaba': lucc_AAAAbaba_VVAAbaba , 'AAAAbaba_VVCAbaba': lucc_AAAAbaba_VVCAbaba , 'AAAAbaba_VVCCbaba': lucc_AAAAbaba_VVCCbaba ,
'CAAAbaba_AAAAbaba': lucc_CAAAbaba_AAAAbaba , 'CAAAbaba_CAAAbaba': lucc_CAAAbaba_CAAAbaba , 'CAAAbaba_CCAAbaba': lucc_CAAAbaba_CCAAbaba , 'CAAAbaba_VAAAbaba': lucc_CAAAbaba_VAAAbaba ,
'CAAAbaba_VACAbaba': lucc_CAAAbaba_VACAbaba , 'CAAAbaba_VACCbaba': lucc_CAAAbaba_VACCbaba , 'CAAAbaba_VVAAbaba': lucc_CAAAbaba_VVAAbaba , 'CAAAbaba_VVCAbaba': lucc_CAAAbaba_VVCAbaba ,
'CAAAbaba_VVCCbaba': lucc_CAAAbaba_VVCCbaba , 'CCAAbaba_AAAAbaba': lucc_CCAAbaba_AAAAbaba , 'CCAAbaba_CAAAbaba': lucc_CCAAbaba_CAAAbaba , 'CCAAbaba_CCAAbaba': lucc_CCAAbaba_CCAAbaba ,
'CCAAbaba_VAAAbaba': lucc_CCAAbaba_VAAAbaba , 'CCAAbaba_VACAbaba': lucc_CCAAbaba_VACAbaba , 'CCAAbaba_VACCbaba': lucc_CCAAbaba_VACCbaba , 'CCAAbaba_VVAAbaba': lucc_CCAAbaba_VVAAbaba ,
'CCAAbaba_VVCAbaba': lucc_CCAAbaba_VVCAbaba , 'CCAAbaba_VVCCbaba': lucc_CCAAbaba_VVCCbaba , 'VAAAbaba_AAAAbaba': lucc_VAAAbaba_AAAAbaba , 'VAAAbaba_CAAAbaba': lucc_VAAAbaba_CAAAbaba ,
'VAAAbaba_CCAAbaba': lucc_VAAAbaba_CCAAbaba , 'VAAAbaba_VAAAbaba': lucc_VAAAbaba_VAAAbaba , 'VAAAbaba_VACAbaba': lucc_VAAAbaba_VACAbaba , 'VAAAbaba_VACCbaba': lucc_VAAAbaba_VACCbaba ,
'VAAAbaba_VVAAbaba': lucc_VAAAbaba_VVAAbaba , 'VAAAbaba_VVCAbaba': lucc_VAAAbaba_VVCAbaba , 'VAAAbaba_VVCCbaba': lucc_VAAAbaba_VVCCbaba , 'VACAbaba_AAAAbaba': lucc_VACAbaba_AAAAbaba ,
'VACAbaba_CAAAbaba': lucc_VACAbaba_CAAAbaba , 'VACAbaba_CCAAbaba': lucc_VACAbaba_CCAAbaba , 'VACAbaba_VAAAbaba': lucc_VACAbaba_VAAAbaba , 'VACAbaba_VACAbaba': lucc_VACAbaba_VACAbaba ,
'VACAbaba_VACCbaba': lucc_VACAbaba_VACCbaba , 'VACAbaba_VVAAbaba': lucc_VACAbaba_VVAAbaba , 'VACAbaba_VVCAbaba': lucc_VACAbaba_VVCAbaba , 'VACAbaba_VVCCbaba': lucc_VACAbaba_VVCCbaba ,
'VACCbaba_AAAAbaba': lucc_VACCbaba_AAAAbaba , 'VACCbaba_CAAAbaba': lucc_VACCbaba_CAAAbaba , 'VACCbaba_CCAAbaba': lucc_VACCbaba_CCAAbaba , 'VACCbaba_VAAAbaba': lucc_VACCbaba_VAAAbaba ,
'VACCbaba_VACAbaba': lucc_VACCbaba_VACAbaba , 'VACCbaba_VACCbaba': lucc_VACCbaba_VACCbaba , 'VACCbaba_VVAAbaba': lucc_VACCbaba_VVAAbaba , 'VACCbaba_VVCAbaba': lucc_VACCbaba_VVCAbaba ,
'VACCbaba_VVCCbaba': lucc_VACCbaba_VVCCbaba , 'VVAAbaba_AAAAbaba': lucc_VVAAbaba_AAAAbaba , 'VVAAbaba_CAAAbaba': lucc_VVAAbaba_CAAAbaba , 'VVAAbaba_CCAAbaba': lucc_VVAAbaba_CCAAbaba ,
'VVAAbaba_VAAAbaba': lucc_VVAAbaba_VAAAbaba , 'VVAAbaba_VACAbaba': lucc_VVAAbaba_VACAbaba , 'VVAAbaba_VACCbaba': lucc_VVAAbaba_VACCbaba , 'VVAAbaba_VVAAbaba': lucc_VVAAbaba_VVAAbaba ,
'VVAAbaba_VVCAbaba': lucc_VVAAbaba_VVCAbaba , 'VVAAbaba_VVCCbaba': lucc_VVAAbaba_VVCCbaba , 'VVCAbaba_AAAAbaba': lucc_VVCAbaba_AAAAbaba , 'VVCAbaba_CAAAbaba': lucc_VVCAbaba_CAAAbaba ,
'VVCAbaba_CCAAbaba': lucc_VVCAbaba_CCAAbaba , 'VVCAbaba_VAAAbaba': lucc_VVCAbaba_VAAAbaba , 'VVCAbaba_VACAbaba': lucc_VVCAbaba_VACAbaba , 'VVCAbaba_VACCbaba': lucc_VVCAbaba_VACCbaba ,
'VVCAbaba_VVAAbaba': lucc_VVCAbaba_VVAAbaba , 'VVCAbaba_VVCAbaba': lucc_VVCAbaba_VVCAbaba , 'VVCAbaba_VVCCbaba': lucc_VVCAbaba_VVCCbaba , 'VVCCbaba_AAAAbaba': lucc_VVCCbaba_AAAAbaba ,
'VVCCbaba_CAAAbaba': lucc_VVCCbaba_CAAAbaba , 'VVCCbaba_CCAAbaba': lucc_VVCCbaba_CCAAbaba , 'VVCCbaba_VAAAbaba': lucc_VVCCbaba_VAAAbaba , 'VVCCbaba_VACAbaba': lucc_VVCCbaba_VACAbaba ,
'VVCCbaba_VACCbaba': lucc_VVCCbaba_VACCbaba , 'VVCCbaba_VVAAbaba': lucc_VVCCbaba_VVAAbaba , 'VVCCbaba_VVCAbaba': lucc_VVCCbaba_VVCAbaba , 'VVCCbaba_VVCCbaba': lucc_VVCCbaba_VVCCbaba ,
'AAAAbaba_CAAAbbbb': lucc_AAAAbaba_CAAAbbbb , 'AAAAbaba_CCAAbbbb': lucc_AAAAbaba_CCAAbbbb , 'AAAAbaba_VAAAbbbb': lucc_AAAAbaba_VAAAbbbb , 'AAAAbaba_VACAbbbb': lucc_AAAAbaba_VACAbbbb ,
'AAAAbaba_VACCbbbb': lucc_AAAAbaba_VACCbbbb , 'AAAAbaba_VVAAbbbb': lucc_AAAAbaba_VVAAbbbb , 'AAAAbaba_VVCAbbbb': lucc_AAAAbaba_VVCAbbbb , 'AAAAbaba_VVCCbbbb': lucc_AAAAbaba_VVCCbbbb ,
'CAAAbaba_AAAAbbbb': lucc_CAAAbaba_AAAAbbbb , 'CAAAbaba_CAAAbbbb': lucc_CAAAbaba_CAAAbbbb , 'CAAAbaba_CCAAbbbb': lucc_CAAAbaba_CCAAbbbb , 'CAAAbaba_VAAAbbbb': lucc_CAAAbaba_VAAAbbbb ,
'CAAAbaba_VACAbbbb': lucc_CAAAbaba_VACAbbbb , 'CAAAbaba_VACCbbbb': lucc_CAAAbaba_VACCbbbb , 'CAAAbaba_VVAAbbbb': lucc_CAAAbaba_VVAAbbbb , 'CAAAbaba_VVCAbbbb': lucc_CAAAbaba_VVCAbbbb ,
'CAAAbaba_VVCCbbbb': lucc_CAAAbaba_VVCCbbbb , 'CCAAbaba_AAAAbbbb': lucc_CCAAbaba_AAAAbbbb , 'CCAAbaba_CAAAbbbb': lucc_CCAAbaba_CAAAbbbb , 'CCAAbaba_CCAAbbbb': lucc_CCAAbaba_CCAAbbbb ,
'CCAAbaba_VAAAbbbb': lucc_CCAAbaba_VAAAbbbb , 'CCAAbaba_VACAbbbb': lucc_CCAAbaba_VACAbbbb , 'CCAAbaba_VACCbbbb': lucc_CCAAbaba_VACCbbbb , 'CCAAbaba_VVAAbbbb': lucc_CCAAbaba_VVAAbbbb ,
'CCAAbaba_VVCAbbbb': lucc_CCAAbaba_VVCAbbbb , 'CCAAbaba_VVCCbbbb': lucc_CCAAbaba_VVCCbbbb , 'VAAAbaba_AAAAbbbb': lucc_VAAAbaba_AAAAbbbb , 'VAAAbaba_CAAAbbbb': lucc_VAAAbaba_CAAAbbbb ,
'VAAAbaba_CCAAbbbb': lucc_VAAAbaba_CCAAbbbb , 'VAAAbaba_VAAAbbbb': lucc_VAAAbaba_VAAAbbbb , 'VAAAbaba_VACAbbbb': lucc_VAAAbaba_VACAbbbb , 'VAAAbaba_VACCbbbb': lucc_VAAAbaba_VACCbbbb ,
'VAAAbaba_VVAAbbbb': lucc_VAAAbaba_VVAAbbbb , 'VAAAbaba_VVCAbbbb': lucc_VAAAbaba_VVCAbbbb , 'VAAAbaba_VVCCbbbb': lucc_VAAAbaba_VVCCbbbb , 'VACAbaba_AAAAbbbb': lucc_VACAbaba_AAAAbbbb ,
'VACAbaba_CAAAbbbb': lucc_VACAbaba_CAAAbbbb , 'VACAbaba_CCAAbbbb': lucc_VACAbaba_CCAAbbbb , 'VACAbaba_VAAAbbbb': lucc_VACAbaba_VAAAbbbb , 'VACAbaba_VACAbbbb': lucc_VACAbaba_VACAbbbb ,
'VACAbaba_VACCbbbb': lucc_VACAbaba_VACCbbbb , 'VACAbaba_VVAAbbbb': lucc_VACAbaba_VVAAbbbb , 'VACAbaba_VVCAbbbb': lucc_VACAbaba_VVCAbbbb , 'VACAbaba_VVCCbbbb': lucc_VACAbaba_VVCCbbbb ,
'VACCbaba_AAAAbbbb': lucc_VACCbaba_AAAAbbbb , 'VACCbaba_CAAAbbbb': lucc_VACCbaba_CAAAbbbb , 'VACCbaba_CCAAbbbb': lucc_VACCbaba_CCAAbbbb , 'VACCbaba_VAAAbbbb': lucc_VACCbaba_VAAAbbbb ,
'VACCbaba_VACAbbbb': lucc_VACCbaba_VACAbbbb , 'VACCbaba_VACCbbbb': lucc_VACCbaba_VACCbbbb , 'VACCbaba_VVAAbbbb': lucc_VACCbaba_VVAAbbbb , 'VACCbaba_VVCAbbbb': lucc_VACCbaba_VVCAbbbb ,
'VACCbaba_VVCCbbbb': lucc_VACCbaba_VVCCbbbb , 'VVAAbaba_AAAAbbbb': lucc_VVAAbaba_AAAAbbbb , 'VVAAbaba_CAAAbbbb': lucc_VVAAbaba_CAAAbbbb , 'VVAAbaba_CCAAbbbb': lucc_VVAAbaba_CCAAbbbb ,
'VVAAbaba_VAAAbbbb': lucc_VVAAbaba_VAAAbbbb , 'VVAAbaba_VACAbbbb': lucc_VVAAbaba_VACAbbbb , 'VVAAbaba_VACCbbbb': lucc_VVAAbaba_VACCbbbb , 'VVAAbaba_VVAAbbbb': lucc_VVAAbaba_VVAAbbbb ,
'VVAAbaba_VVCAbbbb': lucc_VVAAbaba_VVCAbbbb , 'VVAAbaba_VVCCbbbb': lucc_VVAAbaba_VVCCbbbb , 'VVCAbaba_AAAAbbbb': lucc_VVCAbaba_AAAAbbbb , 'VVCAbaba_CAAAbbbb': lucc_VVCAbaba_CAAAbbbb ,
'VVCAbaba_CCAAbbbb': lucc_VVCAbaba_CCAAbbbb , 'VVCAbaba_VAAAbbbb': lucc_VVCAbaba_VAAAbbbb , 'VVCAbaba_VACAbbbb': lucc_VVCAbaba_VACAbbbb , 'VVCAbaba_VACCbbbb': lucc_VVCAbaba_VACCbbbb ,
'VVCAbaba_VVAAbbbb': lucc_VVCAbaba_VVAAbbbb , 'VVCAbaba_VVCAbbbb': lucc_VVCAbaba_VVCAbbbb , 'VVCAbaba_VVCCbbbb': lucc_VVCAbaba_VVCCbbbb , 'VVCCbaba_AAAAbbbb': lucc_VVCCbaba_AAAAbbbb ,
'VVCCbaba_CAAAbbbb': lucc_VVCCbaba_CAAAbbbb , 'VVCCbaba_CCAAbbbb': lucc_VVCCbaba_CCAAbbbb , 'VVCCbaba_VAAAbbbb': lucc_VVCCbaba_VAAAbbbb , 'VVCCbaba_VACAbbbb': lucc_VVCCbaba_VACAbbbb ,
'VVCCbaba_VACCbbbb': lucc_VVCCbaba_VACCbbbb , 'VVCCbaba_VVAAbbbb': lucc_VVCCbaba_VVAAbbbb , 'VVCCbaba_VVCAbbbb': lucc_VVCCbaba_VVCAbbbb , 'VVCCbaba_VVCCbbbb': lucc_VVCCbaba_VVCCbbbb ,
'AAAAbbbb_CAaa': lucc_AAAAbbbb_CAaa , 'AAAAbbbb_VAaa': lucc_AAAAbbbb_VAaa , 'AAAAbbbb_VCaa': lucc_AAAAbbbb_VCaa , 'CAAAbbbb_AAaa': lucc_CAAAbbbb_AAaa ,
'CAAAbbbb_CAaa': lucc_CAAAbbbb_CAaa , 'CAAAbbbb_VAaa': lucc_CAAAbbbb_VAaa , 'CAAAbbbb_VCaa': lucc_CAAAbbbb_VCaa , 'CCAAbbbb_AAaa': lucc_CCAAbbbb_AAaa ,
'CCAAbbbb_CAaa': lucc_CCAAbbbb_CAaa , 'CCAAbbbb_VAaa': lucc_CCAAbbbb_VAaa , 'CCAAbbbb_VCaa': lucc_CCAAbbbb_VCaa , 'VAAAbbbb_AAaa': lucc_VAAAbbbb_AAaa ,
'VAAAbbbb_CAaa': lucc_VAAAbbbb_CAaa , 'VAAAbbbb_VAaa': lucc_VAAAbbbb_VAaa , 'VAAAbbbb_VCaa': lucc_VAAAbbbb_VCaa , 'VACAbbbb_AAaa': lucc_VACAbbbb_AAaa ,
'VACAbbbb_CAaa': lucc_VACAbbbb_CAaa , 'VACAbbbb_VAaa': lucc_VACAbbbb_VAaa , 'VACAbbbb_VCaa': lucc_VACAbbbb_VCaa , 'VACCbbbb_AAaa': lucc_VACCbbbb_AAaa ,
'VACCbbbb_CAaa': lucc_VACCbbbb_CAaa , 'VACCbbbb_VAaa': lucc_VACCbbbb_VAaa , 'VACCbbbb_VCaa': lucc_VACCbbbb_VCaa , 'VVAAbbbb_AAaa': lucc_VVAAbbbb_AAaa ,
'VVAAbbbb_CAaa': lucc_VVAAbbbb_CAaa , 'VVAAbbbb_VAaa': lucc_VVAAbbbb_VAaa , 'VVAAbbbb_VCaa': lucc_VVAAbbbb_VCaa , 'VVCAbbbb_AAaa': lucc_VVCAbbbb_AAaa ,
'VVCAbbbb_CAaa': lucc_VVCAbbbb_CAaa , 'VVCAbbbb_VAaa': lucc_VVCAbbbb_VAaa , 'VVCAbbbb_VCaa': lucc_VVCAbbbb_VCaa , 'VVCCbbbb_AAaa': lucc_VVCCbbbb_AAaa ,
'VVCCbbbb_CAaa': lucc_VVCCbbbb_CAaa , 'VVCCbbbb_VAaa': lucc_VVCCbbbb_VAaa , 'VVCCbbbb_VCaa': lucc_VVCCbbbb_VCaa , 'AAAAbbbb_CAbb': lucc_AAAAbbbb_CAbb ,
'AAAAbbbb_VAbb': lucc_AAAAbbbb_VAbb , 'AAAAbbbb_VCbb': lucc_AAAAbbbb_VCbb , 'CAAAbbbb_AAbb': lucc_CAAAbbbb_AAbb , 'CAAAbbbb_CAbb': lucc_CAAAbbbb_CAbb ,
'CAAAbbbb_VAbb': lucc_CAAAbbbb_VAbb , 'CAAAbbbb_VCbb': lucc_CAAAbbbb_VCbb , 'CCAAbbbb_AAbb': lucc_CCAAbbbb_AAbb , 'CCAAbbbb_CAbb': lucc_CCAAbbbb_CAbb ,
'CCAAbbbb_VAbb': lucc_CCAAbbbb_VAbb , 'CCAAbbbb_VCbb': lucc_CCAAbbbb_VCbb , 'VAAAbbbb_AAbb': lucc_VAAAbbbb_AAbb , 'VAAAbbbb_CAbb': lucc_VAAAbbbb_CAbb ,
'VAAAbbbb_VAbb': lucc_VAAAbbbb_VAbb , 'VAAAbbbb_VCbb': lucc_VAAAbbbb_VCbb , 'VACAbbbb_AAbb': lucc_VACAbbbb_AAbb , 'VACAbbbb_CAbb': lucc_VACAbbbb_CAbb ,
'VACAbbbb_VAbb': lucc_VACAbbbb_VAbb , 'VACAbbbb_VCbb': lucc_VACAbbbb_VCbb , 'VACCbbbb_AAbb': lucc_VACCbbbb_AAbb , 'VACCbbbb_CAbb': lucc_VACCbbbb_CAbb ,
'VACCbbbb_VAbb': lucc_VACCbbbb_VAbb , 'VACCbbbb_VCbb': lucc_VACCbbbb_VCbb , 'VVAAbbbb_AAbb': lucc_VVAAbbbb_AAbb , 'VVAAbbbb_CAbb': lucc_VVAAbbbb_CAbb ,
'VVAAbbbb_VAbb': lucc_VVAAbbbb_VAbb , 'VVAAbbbb_VCbb': lucc_VVAAbbbb_VCbb , 'VVCAbbbb_AAbb': lucc_VVCAbbbb_AAbb , 'VVCAbbbb_CAbb': lucc_VVCAbbbb_CAbb ,
'VVCAbbbb_VAbb': lucc_VVCAbbbb_VAbb , 'VVCAbbbb_VCbb': lucc_VVCAbbbb_VCbb , 'VVCCbbbb_AAbb': lucc_VVCCbbbb_AAbb , 'VVCCbbbb_CAbb': lucc_VVCCbbbb_CAbb ,
'VVCCbbbb_VAbb': lucc_VVCCbbbb_VAbb , 'VVCCbbbb_VCbb': lucc_VVCCbbbb_VCbb , 'AAAAbbbb_CAAAaaaa': lucc_AAAAbbbb_CAAAaaaa , 'AAAAbbbb_CCAAaaaa': lucc_AAAAbbbb_CCAAaaaa ,
'AAAAbbbb_VAAAaaaa': lucc_AAAAbbbb_VAAAaaaa , 'AAAAbbbb_VACAaaaa': lucc_AAAAbbbb_VACAaaaa , 'AAAAbbbb_VACCaaaa': lucc_AAAAbbbb_VACCaaaa , 'AAAAbbbb_VVAAaaaa': lucc_AAAAbbbb_VVAAaaaa ,
'AAAAbbbb_VVCAaaaa': lucc_AAAAbbbb_VVCAaaaa , 'AAAAbbbb_VVCCaaaa': lucc_AAAAbbbb_VVCCaaaa , 'CAAAbbbb_AAAAaaaa': lucc_CAAAbbbb_AAAAaaaa , 'CAAAbbbb_CAAAaaaa': lucc_CAAAbbbb_CAAAaaaa ,
'CAAAbbbb_CCAAaaaa': lucc_CAAAbbbb_CCAAaaaa , 'CAAAbbbb_VAAAaaaa': lucc_CAAAbbbb_VAAAaaaa , 'CAAAbbbb_VACAaaaa': lucc_CAAAbbbb_VACAaaaa , 'CAAAbbbb_VACCaaaa': lucc_CAAAbbbb_VACCaaaa ,
'CAAAbbbb_VVAAaaaa': lucc_CAAAbbbb_VVAAaaaa , 'CAAAbbbb_VVCAaaaa': lucc_CAAAbbbb_VVCAaaaa , 'CAAAbbbb_VVCCaaaa': lucc_CAAAbbbb_VVCCaaaa , 'CCAAbbbb_AAAAaaaa': lucc_CCAAbbbb_AAAAaaaa ,
'CCAAbbbb_CAAAaaaa': lucc_CCAAbbbb_CAAAaaaa , 'CCAAbbbb_CCAAaaaa': lucc_CCAAbbbb_CCAAaaaa , 'CCAAbbbb_VAAAaaaa': lucc_CCAAbbbb_VAAAaaaa , 'CCAAbbbb_VACAaaaa': lucc_CCAAbbbb_VACAaaaa ,
'CCAAbbbb_VACCaaaa': lucc_CCAAbbbb_VACCaaaa , 'CCAAbbbb_VVAAaaaa': lucc_CCAAbbbb_VVAAaaaa , 'CCAAbbbb_VVCAaaaa': lucc_CCAAbbbb_VVCAaaaa , 'CCAAbbbb_VVCCaaaa': lucc_CCAAbbbb_VVCCaaaa ,
'VAAAbbbb_AAAAaaaa': lucc_VAAAbbbb_AAAAaaaa , 'VAAAbbbb_CAAAaaaa': lucc_VAAAbbbb_CAAAaaaa , 'VAAAbbbb_CCAAaaaa': lucc_VAAAbbbb_CCAAaaaa , 'VAAAbbbb_VAAAaaaa': lucc_VAAAbbbb_VAAAaaaa ,
'VAAAbbbb_VACAaaaa': lucc_VAAAbbbb_VACAaaaa , 'VAAAbbbb_VACCaaaa': lucc_VAAAbbbb_VACCaaaa , 'VAAAbbbb_VVAAaaaa': lucc_VAAAbbbb_VVAAaaaa , 'VAAAbbbb_VVCAaaaa': lucc_VAAAbbbb_VVCAaaaa ,
'VAAAbbbb_VVCCaaaa': lucc_VAAAbbbb_VVCCaaaa , 'VACAbbbb_AAAAaaaa': lucc_VACAbbbb_AAAAaaaa , 'VACAbbbb_CAAAaaaa': lucc_VACAbbbb_CAAAaaaa , 'VACAbbbb_CCAAaaaa': lucc_VACAbbbb_CCAAaaaa ,
'VACAbbbb_VAAAaaaa': lucc_VACAbbbb_VAAAaaaa , 'VACAbbbb_VACAaaaa': lucc_VACAbbbb_VACAaaaa , 'VACAbbbb_VACCaaaa': lucc_VACAbbbb_VACCaaaa , 'VACAbbbb_VVAAaaaa': lucc_VACAbbbb_VVAAaaaa ,
'VACAbbbb_VVCAaaaa': lucc_VACAbbbb_VVCAaaaa , 'VACAbbbb_VVCCaaaa': lucc_VACAbbbb_VVCCaaaa , 'VACCbbbb_AAAAaaaa': lucc_VACCbbbb_AAAAaaaa , 'VACCbbbb_CAAAaaaa': lucc_VACCbbbb_CAAAaaaa ,
'VACCbbbb_CCAAaaaa': lucc_VACCbbbb_CCAAaaaa , 'VACCbbbb_VAAAaaaa': lucc_VACCbbbb_VAAAaaaa , 'VACCbbbb_VACAaaaa': lucc_VACCbbbb_VACAaaaa , 'VACCbbbb_VACCaaaa': lucc_VACCbbbb_VACCaaaa ,
'VACCbbbb_VVAAaaaa': lucc_VACCbbbb_VVAAaaaa , 'VACCbbbb_VVCAaaaa': lucc_VACCbbbb_VVCAaaaa , 'VACCbbbb_VVCCaaaa': lucc_VACCbbbb_VVCCaaaa , 'VVAAbbbb_AAAAaaaa': lucc_VVAAbbbb_AAAAaaaa ,
'VVAAbbbb_CAAAaaaa': lucc_VVAAbbbb_CAAAaaaa , 'VVAAbbbb_CCAAaaaa': lucc_VVAAbbbb_CCAAaaaa , 'VVAAbbbb_VAAAaaaa': lucc_VVAAbbbb_VAAAaaaa , 'VVAAbbbb_VACAaaaa': lucc_VVAAbbbb_VACAaaaa ,
'VVAAbbbb_VACCaaaa': lucc_VVAAbbbb_VACCaaaa , 'VVAAbbbb_VVAAaaaa': lucc_VVAAbbbb_VVAAaaaa , 'VVAAbbbb_VVCAaaaa': lucc_VVAAbbbb_VVCAaaaa , 'VVAAbbbb_VVCCaaaa': lucc_VVAAbbbb_VVCCaaaa ,
'VVCAbbbb_AAAAaaaa': lucc_VVCAbbbb_AAAAaaaa , 'VVCAbbbb_CAAAaaaa': lucc_VVCAbbbb_CAAAaaaa , 'VVCAbbbb_CCAAaaaa': lucc_VVCAbbbb_CCAAaaaa , 'VVCAbbbb_VAAAaaaa': lucc_VVCAbbbb_VAAAaaaa ,
'VVCAbbbb_VACAaaaa': lucc_VVCAbbbb_VACAaaaa , 'VVCAbbbb_VACCaaaa': lucc_VVCAbbbb_VACCaaaa , 'VVCAbbbb_VVAAaaaa': lucc_VVCAbbbb_VVAAaaaa , 'VVCAbbbb_VVCAaaaa': lucc_VVCAbbbb_VVCAaaaa ,
'VVCAbbbb_VVCCaaaa': lucc_VVCAbbbb_VVCCaaaa , 'VVCCbbbb_AAAAaaaa': lucc_VVCCbbbb_AAAAaaaa , 'VVCCbbbb_CAAAaaaa': lucc_VVCCbbbb_CAAAaaaa , 'VVCCbbbb_CCAAaaaa': lucc_VVCCbbbb_CCAAaaaa ,
'VVCCbbbb_VAAAaaaa': lucc_VVCCbbbb_VAAAaaaa , 'VVCCbbbb_VACAaaaa': lucc_VVCCbbbb_VACAaaaa , 'VVCCbbbb_VACCaaaa': lucc_VVCCbbbb_VACCaaaa , 'VVCCbbbb_VVAAaaaa': lucc_VVCCbbbb_VVAAaaaa ,
'VVCCbbbb_VVCAaaaa': lucc_VVCCbbbb_VVCAaaaa , 'VVCCbbbb_VVCCaaaa': lucc_VVCCbbbb_VVCCaaaa , 'AAAAbbbb_CAAAbaba': lucc_AAAAbbbb_CAAAbaba , 'AAAAbbbb_CCAAbaba': lucc_AAAAbbbb_CCAAbaba ,
'AAAAbbbb_VAAAbaba': lucc_AAAAbbbb_VAAAbaba , 'AAAAbbbb_VACAbaba': lucc_AAAAbbbb_VACAbaba , 'AAAAbbbb_VACCbaba': lucc_AAAAbbbb_VACCbaba , 'AAAAbbbb_VVAAbaba': lucc_AAAAbbbb_VVAAbaba ,
'AAAAbbbb_VVCAbaba': lucc_AAAAbbbb_VVCAbaba , 'AAAAbbbb_VVCCbaba': lucc_AAAAbbbb_VVCCbaba , 'CAAAbbbb_AAAAbaba': lucc_CAAAbbbb_AAAAbaba , 'CAAAbbbb_CAAAbaba': lucc_CAAAbbbb_CAAAbaba ,
'CAAAbbbb_CCAAbaba': lucc_CAAAbbbb_CCAAbaba , 'CAAAbbbb_VAAAbaba': lucc_CAAAbbbb_VAAAbaba , 'CAAAbbbb_VACAbaba': lucc_CAAAbbbb_VACAbaba , 'CAAAbbbb_VACCbaba': lucc_CAAAbbbb_VACCbaba ,
'CAAAbbbb_VVAAbaba': lucc_CAAAbbbb_VVAAbaba , 'CAAAbbbb_VVCAbaba': lucc_CAAAbbbb_VVCAbaba , 'CAAAbbbb_VVCCbaba': lucc_CAAAbbbb_VVCCbaba , 'CCAAbbbb_AAAAbaba': lucc_CCAAbbbb_AAAAbaba ,
'CCAAbbbb_CAAAbaba': lucc_CCAAbbbb_CAAAbaba , 'CCAAbbbb_CCAAbaba': lucc_CCAAbbbb_CCAAbaba , 'CCAAbbbb_VAAAbaba': lucc_CCAAbbbb_VAAAbaba , 'CCAAbbbb_VACAbaba': lucc_CCAAbbbb_VACAbaba ,
'CCAAbbbb_VACCbaba': lucc_CCAAbbbb_VACCbaba , 'CCAAbbbb_VVAAbaba': lucc_CCAAbbbb_VVAAbaba , 'CCAAbbbb_VVCAbaba': lucc_CCAAbbbb_VVCAbaba , 'CCAAbbbb_VVCCbaba': lucc_CCAAbbbb_VVCCbaba ,
'VAAAbbbb_AAAAbaba': lucc_VAAAbbbb_AAAAbaba , 'VAAAbbbb_CAAAbaba': lucc_VAAAbbbb_CAAAbaba , 'VAAAbbbb_CCAAbaba': lucc_VAAAbbbb_CCAAbaba , 'VAAAbbbb_VAAAbaba': lucc_VAAAbbbb_VAAAbaba ,
'VAAAbbbb_VACAbaba': lucc_VAAAbbbb_VACAbaba , 'VAAAbbbb_VACCbaba': lucc_VAAAbbbb_VACCbaba , 'VAAAbbbb_VVAAbaba': lucc_VAAAbbbb_VVAAbaba , 'VAAAbbbb_VVCAbaba': lucc_VAAAbbbb_VVCAbaba ,
'VAAAbbbb_VVCCbaba': lucc_VAAAbbbb_VVCCbaba , 'VACAbbbb_AAAAbaba': lucc_VACAbbbb_AAAAbaba , 'VACAbbbb_CAAAbaba': lucc_VACAbbbb_CAAAbaba , 'VACAbbbb_CCAAbaba': lucc_VACAbbbb_CCAAbaba ,
'VACAbbbb_VAAAbaba': lucc_VACAbbbb_VAAAbaba , 'VACAbbbb_VACAbaba': lucc_VACAbbbb_VACAbaba , 'VACAbbbb_VACCbaba': lucc_VACAbbbb_VACCbaba , 'VACAbbbb_VVAAbaba': lucc_VACAbbbb_VVAAbaba ,
'VACAbbbb_VVCAbaba': lucc_VACAbbbb_VVCAbaba , 'VACAbbbb_VVCCbaba': lucc_VACAbbbb_VVCCbaba , 'VACCbbbb_AAAAbaba': lucc_VACCbbbb_AAAAbaba , 'VACCbbbb_CAAAbaba': lucc_VACCbbbb_CAAAbaba ,
'VACCbbbb_CCAAbaba': lucc_VACCbbbb_CCAAbaba , 'VACCbbbb_VAAAbaba': lucc_VACCbbbb_VAAAbaba , 'VACCbbbb_VACAbaba': lucc_VACCbbbb_VACAbaba , 'VACCbbbb_VACCbaba': lucc_VACCbbbb_VACCbaba ,
'VACCbbbb_VVAAbaba': lucc_VACCbbbb_VVAAbaba , 'VACCbbbb_VVCAbaba': lucc_VACCbbbb_VVCAbaba , 'VACCbbbb_VVCCbaba': lucc_VACCbbbb_VVCCbaba , 'VVAAbbbb_AAAAbaba': lucc_VVAAbbbb_AAAAbaba ,
'VVAAbbbb_CAAAbaba': lucc_VVAAbbbb_CAAAbaba , 'VVAAbbbb_CCAAbaba': lucc_VVAAbbbb_CCAAbaba , 'VVAAbbbb_VAAAbaba': lucc_VVAAbbbb_VAAAbaba , 'VVAAbbbb_VACAbaba': lucc_VVAAbbbb_VACAbaba ,
'VVAAbbbb_VACCbaba': lucc_VVAAbbbb_VACCbaba , 'VVAAbbbb_VVAAbaba': lucc_VVAAbbbb_VVAAbaba , 'VVAAbbbb_VVCAbaba': lucc_VVAAbbbb_VVCAbaba , 'VVAAbbbb_VVCCbaba': lucc_VVAAbbbb_VVCCbaba ,
'VVCAbbbb_AAAAbaba': lucc_VVCAbbbb_AAAAbaba , 'VVCAbbbb_CAAAbaba': lucc_VVCAbbbb_CAAAbaba , 'VVCAbbbb_CCAAbaba': lucc_VVCAbbbb_CCAAbaba , 'VVCAbbbb_VAAAbaba': lucc_VVCAbbbb_VAAAbaba ,
'VVCAbbbb_VACAbaba': lucc_VVCAbbbb_VACAbaba , 'VVCAbbbb_VACCbaba': lucc_VVCAbbbb_VACCbaba , 'VVCAbbbb_VVAAbaba': lucc_VVCAbbbb_VVAAbaba , 'VVCAbbbb_VVCAbaba': lucc_VVCAbbbb_VVCAbaba ,
'VVCAbbbb_VVCCbaba': lucc_VVCAbbbb_VVCCbaba , 'VVCCbbbb_AAAAbaba': lucc_VVCCbbbb_AAAAbaba , 'VVCCbbbb_CAAAbaba': lucc_VVCCbbbb_CAAAbaba , 'VVCCbbbb_CCAAbaba': lucc_VVCCbbbb_CCAAbaba ,
'VVCCbbbb_VAAAbaba': lucc_VVCCbbbb_VAAAbaba , 'VVCCbbbb_VACAbaba': lucc_VVCCbbbb_VACAbaba , 'VVCCbbbb_VACCbaba': lucc_VVCCbbbb_VACCbaba , 'VVCCbbbb_VVAAbaba': lucc_VVCCbbbb_VVAAbaba ,
'VVCCbbbb_VVCAbaba': lucc_VVCCbbbb_VVCAbaba , 'VVCCbbbb_VVCCbaba': lucc_VVCCbbbb_VVCCbaba , 'AAAAbbbb_CAAAbbbb': lucc_AAAAbbbb_CAAAbbbb , 'AAAAbbbb_CCAAbbbb': lucc_AAAAbbbb_CCAAbbbb ,
'AAAAbbbb_VAAAbbbb': lucc_AAAAbbbb_VAAAbbbb , 'AAAAbbbb_VACAbbbb': lucc_AAAAbbbb_VACAbbbb , 'AAAAbbbb_VACCbbbb': lucc_AAAAbbbb_VACCbbbb , 'AAAAbbbb_VVAAbbbb': lucc_AAAAbbbb_VVAAbbbb ,
'AAAAbbbb_VVCAbbbb': lucc_AAAAbbbb_VVCAbbbb , 'AAAAbbbb_VVCCbbbb': lucc_AAAAbbbb_VVCCbbbb , 'CAAAbbbb_AAAAbbbb': lucc_CAAAbbbb_AAAAbbbb , 'CAAAbbbb_CAAAbbbb': lucc_CAAAbbbb_CAAAbbbb ,
'CAAAbbbb_CCAAbbbb': lucc_CAAAbbbb_CCAAbbbb , 'CAAAbbbb_VAAAbbbb': lucc_CAAAbbbb_VAAAbbbb , 'CAAAbbbb_VACAbbbb': lucc_CAAAbbbb_VACAbbbb , 'CAAAbbbb_VACCbbbb': lucc_CAAAbbbb_VACCbbbb ,
'CAAAbbbb_VVAAbbbb': lucc_CAAAbbbb_VVAAbbbb , 'CAAAbbbb_VVCAbbbb': lucc_CAAAbbbb_VVCAbbbb , 'CAAAbbbb_VVCCbbbb': lucc_CAAAbbbb_VVCCbbbb , 'CCAAbbbb_AAAAbbbb': lucc_CCAAbbbb_AAAAbbbb ,
'CCAAbbbb_CAAAbbbb': lucc_CCAAbbbb_CAAAbbbb , 'CCAAbbbb_CCAAbbbb': lucc_CCAAbbbb_CCAAbbbb , 'CCAAbbbb_VAAAbbbb': lucc_CCAAbbbb_VAAAbbbb , 'CCAAbbbb_VACAbbbb': lucc_CCAAbbbb_VACAbbbb ,
'CCAAbbbb_VACCbbbb': lucc_CCAAbbbb_VACCbbbb , 'CCAAbbbb_VVAAbbbb': lucc_CCAAbbbb_VVAAbbbb , 'CCAAbbbb_VVCAbbbb': lucc_CCAAbbbb_VVCAbbbb , 'CCAAbbbb_VVCCbbbb': lucc_CCAAbbbb_VVCCbbbb ,
'VAAAbbbb_AAAAbbbb': lucc_VAAAbbbb_AAAAbbbb , 'VAAAbbbb_CAAAbbbb': lucc_VAAAbbbb_CAAAbbbb , 'VAAAbbbb_CCAAbbbb': lucc_VAAAbbbb_CCAAbbbb , 'VAAAbbbb_VAAAbbbb': lucc_VAAAbbbb_VAAAbbbb ,
'VAAAbbbb_VACAbbbb': lucc_VAAAbbbb_VACAbbbb , 'VAAAbbbb_VACCbbbb': lucc_VAAAbbbb_VACCbbbb , 'VAAAbbbb_VVAAbbbb': lucc_VAAAbbbb_VVAAbbbb , 'VAAAbbbb_VVCAbbbb': lucc_VAAAbbbb_VVCAbbbb ,
'VAAAbbbb_VVCCbbbb': lucc_VAAAbbbb_VVCCbbbb , 'VACAbbbb_AAAAbbbb': lucc_VACAbbbb_AAAAbbbb , 'VACAbbbb_CAAAbbbb': lucc_VACAbbbb_CAAAbbbb , 'VACAbbbb_CCAAbbbb': lucc_VACAbbbb_CCAAbbbb ,
'VACAbbbb_VAAAbbbb': lucc_VACAbbbb_VAAAbbbb , 'VACAbbbb_VACAbbbb': lucc_VACAbbbb_VACAbbbb , 'VACAbbbb_VACCbbbb': lucc_VACAbbbb_VACCbbbb , 'VACAbbbb_VVAAbbbb': lucc_VACAbbbb_VVAAbbbb ,
'VACAbbbb_VVCAbbbb': lucc_VACAbbbb_VVCAbbbb , 'VACAbbbb_VVCCbbbb': lucc_VACAbbbb_VVCCbbbb , 'VACCbbbb_AAAAbbbb': lucc_VACCbbbb_AAAAbbbb , 'VACCbbbb_CAAAbbbb': lucc_VACCbbbb_CAAAbbbb ,
'VACCbbbb_CCAAbbbb': lucc_VACCbbbb_CCAAbbbb , 'VACCbbbb_VAAAbbbb': lucc_VACCbbbb_VAAAbbbb , 'VACCbbbb_VACAbbbb': lucc_VACCbbbb_VACAbbbb , 'VACCbbbb_VACCbbbb': lucc_VACCbbbb_VACCbbbb ,
'VACCbbbb_VVAAbbbb': lucc_VACCbbbb_VVAAbbbb , 'VACCbbbb_VVCAbbbb': lucc_VACCbbbb_VVCAbbbb , 'VACCbbbb_VVCCbbbb': lucc_VACCbbbb_VVCCbbbb , 'VVAAbbbb_AAAAbbbb': lucc_VVAAbbbb_AAAAbbbb ,
'VVAAbbbb_CAAAbbbb': lucc_VVAAbbbb_CAAAbbbb , 'VVAAbbbb_CCAAbbbb': lucc_VVAAbbbb_CCAAbbbb , 'VVAAbbbb_VAAAbbbb': lucc_VVAAbbbb_VAAAbbbb , 'VVAAbbbb_VACAbbbb': lucc_VVAAbbbb_VACAbbbb ,
'VVAAbbbb_VACCbbbb': lucc_VVAAbbbb_VACCbbbb , 'VVAAbbbb_VVAAbbbb': lucc_VVAAbbbb_VVAAbbbb , 'VVAAbbbb_VVCAbbbb': lucc_VVAAbbbb_VVCAbbbb , 'VVAAbbbb_VVCCbbbb': lucc_VVAAbbbb_VVCCbbbb ,
'VVCAbbbb_AAAAbbbb': lucc_VVCAbbbb_AAAAbbbb , 'VVCAbbbb_CAAAbbbb': lucc_VVCAbbbb_CAAAbbbb , 'VVCAbbbb_CCAAbbbb': lucc_VVCAbbbb_CCAAbbbb , 'VVCAbbbb_VAAAbbbb': lucc_VVCAbbbb_VAAAbbbb ,
'VVCAbbbb_VACAbbbb': lucc_VVCAbbbb_VACAbbbb , 'VVCAbbbb_VACCbbbb': lucc_VVCAbbbb_VACCbbbb , 'VVCAbbbb_VVAAbbbb': lucc_VVCAbbbb_VVAAbbbb , 'VVCAbbbb_VVCAbbbb': lucc_VVCAbbbb_VVCAbbbb ,
'VVCAbbbb_VVCCbbbb': lucc_VVCAbbbb_VVCCbbbb , 'VVCCbbbb_AAAAbbbb': lucc_VVCCbbbb_AAAAbbbb , 'VVCCbbbb_CAAAbbbb': lucc_VVCCbbbb_CAAAbbbb , 'VVCCbbbb_CCAAbbbb': lucc_VVCCbbbb_CCAAbbbb ,
'VVCCbbbb_VAAAbbbb': lucc_VVCCbbbb_VAAAbbbb , 'VVCCbbbb_VACAbbbb': lucc_VVCCbbbb_VACAbbbb , 'VVCCbbbb_VACCbbbb': lucc_VVCCbbbb_VACCbbbb , 'VVCCbbbb_VVAAbbbb': lucc_VVCCbbbb_VVAAbbbb ,
'VVCCbbbb_VVCAbbbb': lucc_VVCCbbbb_VVCAbbbb , 'VVCCbbbb_VVCCbbbb': lucc_VVCCbbbb_VVCCbbbb
}